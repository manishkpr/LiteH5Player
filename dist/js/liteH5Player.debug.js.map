{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/events/events.js","webpack:///./node_modules/preact/dist/preact.esm.js","webpack:///./node_modules/resize-sensor/ResizeSensor.min.js","webpack:///./node_modules/url-toolkit/src/url-toolkit.js","webpack:///(webpack)/buildin/global.js","webpack:///(webpack)/buildin/module.js","webpack:///./node_modules/webworkify-webpack/index.js","webpack:///./node_modules/webworkify/index.js","webpack:///./src/Player.js","webpack:///./src/cast/cast_receiver.js","webpack:///./src/cast/cast_sender.js","webpack:///./src/cast/cast_utils.js","webpack:///./src/common/common.js","webpack:///./src/controller/ads_controller.js","webpack:///./src/controller/buffer_controller.js","webpack:///./src/controller/eme_controller.js","webpack:///./src/controller/level_controller.js","webpack:///./src/controller/license_controller.js","webpack:///./src/controller/parser_controller.js","webpack:///./src/controller/playback_controller.js","webpack:///./src/controller/stream_controller.js","webpack:///./src/controller/texttrack_controller.js","webpack:///./src/controller/thumbnail_controller.js","webpack:///./src/core/Debug.js","webpack:///./src/core/EventBus.js","webpack:///./src/core/FactoryMaker.js","webpack:///./src/core/errors.js","webpack:///./src/core/events.js","webpack:///./src/dash/dash_parser.js","webpack:///./src/externals/base64.js","webpack:///./src/externals/underscore.js","webpack:///./src/hls/hls_parser.js","webpack:///./src/index.js","webpack:///./src/loader/fragment_loader.js","webpack:///./src/loader/playlist_loader.js","webpack:///./src/loader/track_loader.js","webpack:///./src/pd/pd_parser.js","webpack:///./src/protection/controller/ProtectionKeyController.js","webpack:///./src/protection/drm/KeySystemCCPlayReady.js","webpack:///./src/protection/drm/KeySystemClearKey.js","webpack:///./src/protection/drm/KeySystemPlayReady.js","webpack:///./src/protection/drm/KeySystemWidevine.js","webpack:///./src/protection/models/ProtectionModel_21Jan2015.js","webpack:///./src/protection/models/ProtectionModel_3Feb2014.js","webpack:///./src/protection/vo/CommonEncryption.js","webpack:///./src/protection/vo/KSUtils.js","webpack:///./src/protection/vo/KeySystemConfiguration.js","webpack:///./src/protection/vo/MediaCapability.js","webpack:///./src/ui/assets/img/logo.png","webpack:///./src/ui/css/ui_skin_youtube.scss?e152","webpack:///./src/ui/js/components/ui_ads_container.js","webpack:///./src/ui/js/components/ui_airplay_toggle_button.js","webpack:///./src/ui/js/components/ui_audio_track_menu.js","webpack:///./src/ui/js/components/ui_bottom_bar.js","webpack:///./src/ui/js/components/ui_buffering_overlay.js","webpack:///./src/ui/js/components/ui_caption_overlay.js","webpack:///./src/ui/js/components/ui_chromecast_overlay.js","webpack:///./src/ui/js/components/ui_chromecast_toggle_button.js","webpack:///./src/ui/js/components/ui_control_bar.js","webpack:///./src/ui/js/components/ui_error_msg_overlay.js","webpack:///./src/ui/js/components/ui_fcc_menu.js","webpack:///./src/ui/js/components/ui_fcc_property_menu.js","webpack:///./src/ui/js/components/ui_fullscreen_toggle_button.js","webpack:///./src/ui/js/components/ui_gradient_bottom.js","webpack:///./src/ui/js/components/ui_hugebutton_overlay.js","webpack:///./src/ui/js/components/ui_logo_overlay.js","webpack:///./src/ui/js/components/ui_pip_toggle_button.js","webpack:///./src/ui/js/components/ui_play_overlay.js","webpack:///./src/ui/js/components/ui_play_toggle_button.js","webpack:///./src/ui/js/components/ui_popup_menu.js","webpack:///./src/ui/js/components/ui_progress_bar.js","webpack:///./src/ui/js/components/ui_quality_menu.js","webpack:///./src/ui/js/components/ui_settings_menu.js","webpack:///./src/ui/js/components/ui_settings_toggle_button.js","webpack:///./src/ui/js/components/ui_subtitles_menu.js","webpack:///./src/ui/js/components/ui_subtitles_toggle_button.js","webpack:///./src/ui/js/components/ui_time_label.js","webpack:///./src/ui/js/components/ui_title_bar.js","webpack:///./src/ui/js/components/ui_tooltip.js","webpack:///./src/ui/js/components/ui_tvnoise_canvas.js","webpack:///./src/ui/js/components/ui_volume_bar.js","webpack:///./src/ui/js/components/ui_volume_toggle_button.js","webpack:///./src/ui/js/components/ui_xspeed_menu.js","webpack:///./src/ui/js/consts.js","webpack:///./src/ui/js/events.js","webpack:///./src/ui/js/id.js","webpack:///./src/ui/js/ui_engine.js","webpack:///./src/ui/js/ui_skin_youtube.js","webpack:///./src/ui/js/ui_tools.js","webpack:///./src/ui_basic/css/ui_basic.scss?bd04","webpack:///./src/ui_basic/js/ui_basic.js","webpack:///./src/utils/Error.js","webpack:///./src/utils/VTTParser.js","webpack:///./src/utils/ajax.js","webpack:///./src/utils/common_utils.js","webpack:///./src/utils/fetch_loader.js","webpack:///./src/utils/string_utils.js","webpack:///./src/utils/timeRanges.js","webpack:///./src/utils/xhr_loader.js","webpack:///./src/videoplayer.js","webpack:///./third_party/hlsjs/src/config.js","webpack:///./third_party/hlsjs/src/controller/abr-controller.js","webpack:///./third_party/hlsjs/src/controller/audio-stream-controller.js","webpack:///./third_party/hlsjs/src/controller/audio-track-controller.js","webpack:///./third_party/hlsjs/src/controller/buffer-controller.js","webpack:///./third_party/hlsjs/src/controller/cap-level-controller.js","webpack:///./third_party/hlsjs/src/controller/eme-controller.js","webpack:///./third_party/hlsjs/src/controller/fps-controller.js","webpack:///./third_party/hlsjs/src/controller/subtitle-stream-controller.js","webpack:///./third_party/hlsjs/src/controller/subtitle-track-controller.js","webpack:///./third_party/hlsjs/src/controller/timeline-controller.js","webpack:///./third_party/hlsjs/src/crypt/aes-crypto.js","webpack:///./third_party/hlsjs/src/crypt/aes-decryptor.js","webpack:///./third_party/hlsjs/src/crypt/decrypter.js","webpack:///./third_party/hlsjs/src/crypt/fast-aes-key.js","webpack:///./third_party/hlsjs/src/demux/aacdemuxer.js","webpack:///./third_party/hlsjs/src/demux/adts.js","webpack:///./third_party/hlsjs/src/demux/demuxer-inline.js","webpack:///./third_party/hlsjs/src/demux/demuxer-worker.js","webpack:///./third_party/hlsjs/src/demux/demuxer.js","webpack:///./third_party/hlsjs/src/demux/exp-golomb.js","webpack:///./third_party/hlsjs/src/demux/id3.js","webpack:///./third_party/hlsjs/src/demux/mp3demuxer.js","webpack:///./third_party/hlsjs/src/demux/mp4demuxer.js","webpack:///./third_party/hlsjs/src/demux/mpegaudio.js","webpack:///./third_party/hlsjs/src/demux/sample-aes.js","webpack:///./third_party/hlsjs/src/demux/tsdemuxer.js","webpack:///./third_party/hlsjs/src/errors.js","webpack:///./third_party/hlsjs/src/event-handler.js","webpack:///./third_party/hlsjs/src/events.js","webpack:///./third_party/hlsjs/src/helper/aac.js","webpack:///./third_party/hlsjs/src/helper/buffer-helper.js","webpack:///./third_party/hlsjs/src/helper/fragment-tracker.js","webpack:///./third_party/hlsjs/src/helper/level-helper.js","webpack:///./third_party/hlsjs/src/helper/mediakeys-helper.js","webpack:///./third_party/hlsjs/src/helper/mediasource-helper.js","webpack:///./third_party/hlsjs/src/loader/fragment.js","webpack:///./third_party/hlsjs/src/loader/level-key.js","webpack:///./third_party/hlsjs/src/loader/m3u8-parser.js","webpack:///./third_party/hlsjs/src/remux/mp4-generator.js","webpack:///./third_party/hlsjs/src/remux/mp4-remuxer.js","webpack:///./third_party/hlsjs/src/remux/passthrough-remuxer.js","webpack:///./third_party/hlsjs/src/task-loop.js","webpack:///./third_party/hlsjs/src/utils/attr-list.js","webpack:///./third_party/hlsjs/src/utils/binary-search.js","webpack:///./third_party/hlsjs/src/utils/cea-608-parser.js","webpack:///./third_party/hlsjs/src/utils/codecs.js","webpack:///./third_party/hlsjs/src/utils/cues.js","webpack:///./third_party/hlsjs/src/utils/discontinuities.js","webpack:///./third_party/hlsjs/src/utils/ewma-bandwidth-estimator.js","webpack:///./third_party/hlsjs/src/utils/ewma.js","webpack:///./third_party/hlsjs/src/utils/logger.js","webpack:///./third_party/hlsjs/src/utils/output-filter.js","webpack:///./third_party/hlsjs/src/utils/texttrack-utils.js","webpack:///./third_party/hlsjs/src/utils/time-ranges.js","webpack:///./third_party/hlsjs/src/utils/vttcue.js","webpack:///./third_party/hlsjs/src/utils/vttparser.js","webpack:///./third_party/hlsjs/src/utils/webvtt-parser.js","webpack:///./third_party/hlsjs/src/utils/xhr-loader.js"],"names":["Player","idContainer","context_","oldmtn","playerContainer_","document","getElementById","media_","querySelector","adContainer_","eventBus_","getInstance","debug_","licenseController_","playlistLoader_","textTrackLoader_","fragmentLoader_","bufferController_","emeController_","parserController_","levelController_","streamController_","playbackController_","textTrackController_","thumbnailController_","castSender_","flagCastConnected_","adsEngine_","autoplayAllowed_","autoplayRequiresMuted_","playerState_","flagContentOpenComplete_","flagAdOpenComplete_","flagPlayedOnce_","setup","media","init","cfg","initComponent","addEventListeners","uninit","open","mediaCfg","log","checkUrl","domain","trigger","ERROR","type","LICENSE_ERROR","drm","setDrmInfo","FINDING_PARSER","url","tracks","i","length","track","id","toString","lang","label","kind","TRACK_LOADING","THUMBNAIL_LOADING","requestAds","updateState","close","state","oldState","newState","STATE_CHANGE","on","listener","scope","off","play","playAd","isPlayingAd","isLinearAd","pause","isPaused","getPosition","getDuration","getSeekableRange","getBufferedRanges","isEnded","mute","unmute","isMuted","setVolume","volume","getVolume","setAudioPlaybackSpeed","speed","setPosition","pos","getWidth","videoWidth","getHeight","videoHeight","resize","width","height","getSubtitleTracks","getCurrentSubtitleTrack","selectSubtitleTrack","getThumbnail","time","undefined","castVideo","requestSession","castStop","stopSession","castInit","castOpen","castAdd","add","castPlay","castPause","castSetPosition","castTest","test","isAirplaySupported","window","WebKitPlaybackTargetAvailabilityEvent","showPlaybackTargetPicker","videoElement","webkitShowPlaybackTargetPicker","isPipSupported","webkitSupportsPresentationMode","webkitSetPresentationMode","setPipPresentation","show","webkitPresentationMode","getState","isFullscreen","fullscreenElement","msFullscreenElement","mozFullScreen","webkitIsFullScreen","getValidBufferPosition","currentPos","create","poster","advertising","cast","__platform__","applicationID","MEDIA_CANPLAY","onMediaCanPlay","MEDIA_ENDED","onMediaEnded","MEDIA_WAITING","onMediaWaiting","MEDIA_PLAYING","onMediaPlaying","MEDIA_PAUSED","onMediaPaused","FOUND_PARSER","onFoundParser","MEDIA_ATTACHED","onMediaAttached","AD_CONTENT_PAUSE_REQUESTED","onAdContentPauseRequested","AD_CONTENT_RESUME_REQUESTED","onAdContentResumeRequested","AD_LOADING_COMPLETE","onAdLoadingComplete","AD_PAUSED","onAdPaused","AD_RESUMED","onAdResumed","CAST_CONNECTED","onCastConnected","CAST_DISCONNECTED","onCastDisconnected","addEventListener","onFullScreenChange","removeEventListeners","removeEventListener","FULLSCREEN_CHANGE","processOpenComplete","data","parser","MEDIA_ATTACHING","vPlayer","setSrc","startLoad","autoplay","manualSchedule","TEST_MSG","test2","attribute","buffered","seekable","setDuration","a","b","instance","printLog","msg","console","CastReceiver","elementId","elementId_","mediaElement_","receiverManager_","genericBus_","oldmtnBus_","mediaManager_","onLoadOrig_","onGetStatusOrig_","onMetadataLoadedOrig_","onStopOrig_","onLoadMetadataErrorOrig_","onErrorOrig_","evHandlers","player_","isConnected_","omPlayer_","omUIEngine_","player","api","setLoggerLevel","LoggerLevel","DEBUG","receiver","logger","setLevelValue","CastReceiverManager","onReady","onReady_","onSenderDisconnected","onSenderDisconnected_","onVisibilityChanged","onVisibilityChanged_","GENERIC_MESSAGE_NAMESPACE","OLDMTN_MESSAGE_NAMESPACE","getCastMessageBus","onMessage","onOldmtnMessage_","initPlayer","UIEngine","installSkin","onStateChange","MEDIA_TIMEUPDATE","onMediaTimeupdated","MEDIA_SEEKING","onMediaSeeking","MEDIA_SEEKED","onMediaSeeked","MEDIA_VOLUME_CHANGED","onMediaVolumeChanged","getMediaElement","getMediaManager","getPlayer","event","getSenders","reason","system","DisconnectReason","REQUESTED_BY_SENDER","stop","e","position","duration","muted","paused","sendMessage_","onSeekStart_","onSeekEnd_","onGenericMessage_","senderId","mediaInfo","contentId","manifestUri","message","deserialize","cmdType","bus","opt_senderId","serialized","serialize","getCastChannel","send","broadcast","onLoad_","unload","info","MediaManager","LoadInfo","protocolFunc","getProtocolFunction_","host","Host","load","onGetStatus_","onMetadataLoaded_","totalTime","onLoadMetadataError_","mediaInformation","contentType","path","getPath_","getExtension_","CreateHlsStreamingProtocol","CreateDashStreamingProtocol","indexOf","CreateSmoothStreamingProtocol","formatDuration_","dur","Math","floor","digit","n","round","slice","hr","min","sec","parts","split","pop","toLowerCase","href","createElement","pathname","start","ev","cb","RemotePlayerHandler","remotePlayer","remotePlayerController","framework","RemotePlayerEventType","IS_MUTED_CHANGED","VOLUME_LEVEL_CHANGED","newVolume","volumeLevel","playOrPause","setVolumeLevel","seek","currentTime","CastSender","receiverAppId","context","receiverAppId_","castContext_","session_","remotePlayerHandler","position_","duration_","paused_","muted_","volume_","options","receiverApplicationId","CastContext","setOptions","CastContextEventType","CAST_STATE_CHANGED","SESSION_STATE_CHANGED","sessionState","SessionState","SESSION_STARTED","SESSION_RESUMED","SESSION_ENDED","RemotePlayer","RemotePlayerController","IS_CONNECTED_CHANGED","onConnectedChanged","IS_MEDIA_LOADED_CHANGED","onMediaLoadedChanged","isConnected","getCurrentSession","castDev","getCastDevice","addMessageListener","onMessageReceived_","loadMedia_SuccessCb","loadMedia_ErrorCb","warn","endSession","castSession","tmp","sendMessage","loadMedia","chrome","MediaInfo","metadata","GenericMediaMetadata","metadataType","MetadataType","GENERIC","request","LoadRequest","namespace","from","old_play","old_pause","addVolume","delVolume","parseFloat","savedPlayerState","remoteCall_","targetName","methodName","args","Array","prototype","call","arguments","__h5player_factory_name","getSingletonFactory","CastUtils","simulateTimeRanges_","obj","end","thing","JSON","stringify","str","parse","key","value","NaN","Infinity","Fragment","byteRangeStart","byteRangeEnd","TrackInfo","rep","PeriodInfo","formatAdsTimeOffset","offset","hour","parseInt","getVMAPItem","breakId","tag","breakType","timeOffset","item","replace","AdsController","adContainer","advertising_","adDisplayContainer_","adsLoader_","adsManager_","cuePoints_","width_","height_","isPlayingAd_","isLinearAd_","isVpaidAd_","isPaused_","adsLoaded_","contentInitialized_","adWidth_","adHeight_","countdownTimer_","isMobilePlatform_","isMobilePlatform","vpaidmode","mode","google","ima","ImaSdkSettings","VpaidMode","DISABLED","ENABLED","INSECURE","settings","setVpaidMode","locale","setLocale","AdDisplayContainer","AdsLoader","getSettings","setDisableCustomPlaybackForIOS10Plus","AdsManagerLoadedEvent","Type","ADS_MANAGER_LOADED","onAdsManagerLoaded","AdErrorEvent","AD_ERROR","onAdError","Events","MEDIA_LOADEDMETADATA","onMediaLoadedMetadata","initialUserAction","stopAdTimer","destroy","initialize","parentNode","clientWidth","clientHeight","adsRequest","AdsRequest","adTagUrl","linearAdSlotWidth","linearAdSlotHeight","nonLinearAdSlotWidth","nonLinearAdSlotHeight","ViewMode","NORMAL","adError","resume","fullscreen","FULLSCREEN","adsManagerLoadedEvent","adsRenderingSettings","AdsRenderingSettings","autoAlign","enablePreloading","restoreCustomPlaybackStateOnAdBreakComplete","useStyledNonLinearAds","getAdsManager","events","AdEvent","AD_BREAK_READY","AD_METADATA","ALL_ADS_COMPLETED","CLICK","COMPLETE","CONTENT_PAUSE_REQUESTED","CONTENT_RESUME_REQUESTED","DURATION_CHANGE","FIRST_QUARTILE","IMPRESSION","INTERACTION","LINEAR_CHANGED","LOADED","LOG","MIDPOINT","PAUSED","RESUMED","SKIPPABLE_STATE_CHANGED","SKIPPED","STARTED","THIRD_QUARTILE","USER_CLOSE","VOLUME_CHANGED","VOLUME_MUTED","index","onAdEvent","adErrorEvent","getError","err","errCode","getErrorCode","errMsg","getMessage","adEvent","ad","getAd","o","adBreakTime","getAdCuePoints","h","join","processWhenAdComplete","isLinear","processWhenAdStart","AD_VOLUME_CHANGED","contentComplete","startAdTimer","setInterval","timeRemaining","getRemainingTime","AD_TIMEUPDATE","clearInterval","apiFw","getApiFramework","AD_STARTED","linear","vpaid","selectionCriteria","CompanionAdSelectionSettings","resourceType","ResourceType","STATIC","creativeType","CreativeType","IMAGE","sizeCriteria","SizeCriteria","IGNORE","companionAds","getCompanionAds","companions","companionAd","content","getContent","push","getContentType","AD_COMPANIONS","AD_COMPLETE","BufferController","mediaSource_","sourceBuffer_","streamInfo_","segments_","appending_","onMediaAttaching","STREAM_UPDATED","onStreamUpdated","BUFFER_CODEC","onBufferCodec","BUFFER_APPENDING","onBufferAppending","BUFFER_EOS","onBufferEOS","onTestMsg","createMediaSource","hasWebKit","hasMediaSource","MediaSource","onMediaSourceOpen","onMediaSourceEnded","onMediaSourceClose","WebKitMediaSource","audio","removeSourceBuffer","video","signalEndOfStream","endOfStream","URL","revokeObjectURL","src","streamInfo","mediaSrc","objURL","createObjectURL","mimeType","container","codec","buffer","addSourceBuffer","sourceBuffer_updatestart","sourceBuffer_update","sourceBuffer_updateend","sourceBuffer_error","sourceBuffer_abort","doAppending","segment","shift","sb","updating","ended","appendBuffer","pending","BUFFER_APPENDED","updateMediaElementDuration","EMEController","protectionModel_","protectionKeyController_","getProtectionModel","attachMedia","audioCodec","videoCodec","onencrypted","mediaKeys","navigator","requestMediaKeySystemAccess","keySystem","getKeySystemBySystemString","systemString","setKeySystem","instance_","LevelController","MANIFEST_PARSED","onManifestParsed","DOMAIN_REGEX","IPADDRESS_REGEX","LicenseController","props","whitelist","setWhitelist","ret","arrRegex","match","ParserController","onFindingParser","getParser","extension","PlaybackController","cfg_","detectAutoplay","playPromise","then","onAutoplayWithSoundSuccess","catch","onAutoplayWithSoundFail","isSeeking","seeking","playbackRate","onMutedAutoplaySuccess","onMutedAutoplayFail","checkMutedAutoplaySupport","mutedAutoplay","onMediaAudioAvailable","onMediaAbort","onMediaCanplay","onMediaCanplayThrough","MEDIA_CANPLAY_THROUGH","onMediaEncrypted","onMediaDurationChanged","MEDIA_DURATION_CHANGED","onMediaError","error","target","code","onMediaInterruptBegin","onMediaInterruptEnd","onMediaLoadedData","hasAudio","webkitAudioDecodedByteCount","mozHasAudio","MEDIA_LOADEDDATA","onMediaLoadStart","onMediaPlay","MEDIA_PLAY","onMediaProgress","progress","onMediaReadyState","onMediaSuspend","onMediaTimeUpdated","removeEventsListeners","getSrc","revokeSrc","bufferedEnd","removeAttribute","State","STOPPED","IDLE","KEY_LOADING","FRAG_LOADING","FRAG_LOADING_WAITING_RETRY","WAITING_LEVEL","PARSING","PARSED","BUFFER_FLUSHING","ENDED","StreamController","hls_","demuxer_","startLoaded_","manualMode_","state_","config","FRAG_LOADED","onFragLoaded","INIT_PTS_FOUND","onInitPtsFound","FRAG_PARSING_INIT_SEGMENT","onFragParsingInitSegment","FRAG_PARSING_DATA","onFragParsingData","FRAG_PARSED","onFragParsed","onBufferAppended","getLevelDetails","details","trackInfo","levelDetails","tick","frag","sn","initSegmentData","initSegment","trackName","cnt","data1","data2","forEach","_checkBuffer","_findFragment","getNextFragment","MANIFEST_LOADING","stopLoad","Cue","WebKitDataCue","VTTCue","TextTrackCue","TextTrackController","currTrackId_","textTracks_","TRACK_LOADED","onTextTrackLoaded","TRACK_ADDED","currTrackId","onTextTrackLoaded_old","cueData","textTrack","addTextTrack","oncuechange","activeCues","currentTarget","startTime","c","trackId","textTracks","text","cue","createCue","addCue","findTrackById","onenter","onexit","currTrack","TRACK_CHANGED","ThumbnailController","xhrLoader_","vttParser_","track_","thumbnailsData_","onThumbnailLoading","file","callbacks","onSuccess","onRequestThumbnailSuccess","parseVttText","baseUrl","thumbnailInfo","subText","x","y","w","ab2str_v1","lastSlash","lastIndexOf","substring","LOG_LEVEL_NONE","LOG_LEVEL_FATAL","LOG_LEVEL_ERROR","LOG_LEVEL_WARNING","LOG_LEVEL_INFO","LOG_LEVEL_DEBUG","Debug","eventBus","logFn","logToBrowserConsole","showLogTimestamp","showCalleeName","Date","getTime","getLogFn","debug","fn","bind","setLogTimestampVisible","setCalleeNameVisible","setLogToBrowserConsole","getLogToBrowserConsole","fatal","params","doLog","level","logTime","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","getClassName","getType","apply","factory","EVENT_PRIORITY_LOW","EVENT_PRIORITY_HIGH","EventBus","handlers","evType","priority","Error","getHandlerIdx","handler","callback","inserted","some","idx","splice","payload","hasOwnProperty","reset","FactoryMaker","extensions","singletonContexts","extend","name","childInstance","override","extensionContext","getExtensionContext","getSingletonInstance","className","setSingletonInstance","getClassFactory","classConstructor","merge","extensionObject","parent","prop","ErrorTypes","ErrorDetails","CoreEvents","AD_ADS_MANAGER_LOADED","MANIFEST_LOADED","DashParser","UTF8","encode","s","u","charCodeAt","decode","v","String","fromCharCode","BASE64","T","encodeArray","charAt","R","decodeArray","ASCII","Uint8Array","encodeASCII","decodeASCII","exports","root","self","global","previousUnderscore","_","ArrayProto","ObjProto","Object","SymbolProto","Symbol","nativeIsArray","isArray","nativeKeys","keys","nativeCreate","Ctor","_wrapped","nodeType","module","VERSION","optimizeCb","func","argCount","collection","accumulator","builtinIteratee","iteratee","identity","isFunction","isObject","matcher","property","restArguments","startIndex","max","rest","baseCreate","result","shallowProperty","has","deepGet","MAX_ARRAY_INDEX","pow","getLength","isArrayLike","each","map","collect","results","currentKey","createReduce","dir","reducer","memo","initial","reduce","foldl","inject","reduceRight","foldr","find","detect","predicate","keyFinder","findIndex","findKey","filter","select","list","reject","negate","every","all","any","contains","includes","include","fromIndex","guard","values","invoke","contextPath","method","pluck","where","attrs","findWhere","lastComputed","computed","shuffle","sample","random","clone","last","rand","temp","sortBy","criteria","sort","left","right","group","behavior","partition","groupBy","indexBy","countBy","reStrSymbol","toArray","isString","size","pass","first","head","take","array","tail","drop","compact","Boolean","flatten","input","shallow","strict","output","isArguments","j","len","without","otherArrays","difference","uniq","unique","isSorted","isBoolean","seen","union","arrays","intersection","argsLength","unzip","zip","object","createPredicateIndexFinder","findLastIndex","sortedIndex","low","high","mid","createIndexFinder","predicateFind","isNaN","range","step","ceil","chunk","count","executeBound","sourceFunc","boundFunc","callingContext","TypeError","bound","callArgs","concat","partial","boundArgs","placeholder","bindAll","memoize","hasher","cache","address","delay","wait","setTimeout","defer","throttle","timeout","previous","later","leading","now","throttled","remaining","clearTimeout","trailing","cancel","debounce","immediate","debounced","callNow","wrap","wrapper","compose","after","times","before","once","hasEnumBug","propertyIsEnumerable","nonEnumerableProps","collectNonEnumProps","nonEnumIdx","constructor","proto","allKeys","mapObject","pairs","invert","functions","methods","names","createAssigner","keysFunc","defaults","source","l","extendOwn","assign","keyInObj","pick","omit","tap","interceptor","isMatch","eq","deepEq","aStack","bStack","valueOf","areArrays","aCtor","bCtor","isEqual","isEmpty","isElement","nodelist","childNodes","Int8Array","isFinite","isSymbol","isNumber","isNull","isUndefined","noConflict","constant","noop","propertyOf","matches","accum","escapeMap","unescapeMap","createEscaper","escaper","testRegexp","RegExp","replaceRegexp","string","escape","unescape","fallback","idCounter","uniqueId","prefix","templateSettings","evaluate","interpolate","noMatch","escapes","escapeRegExp","escapeChar","template","oldSettings","variable","render","Function","argument","chain","_chain","chainResult","mixin","toJSON","define","HlsParser","currentSN_","fragCurrent_","onManifestLoaded","bytes","parseLevelPlaylist","totalduration","fragments","CommonUtils","FragmentLoader","request_","onFragLoading","rangeStart","byteRangeStartOffset","rangeEnd","byteRangeEndOffset","loadsuccess","PlaylistLoader","onManifestLoading","TrackLoader","onTrackLoading","successHandler","xhr","responseText","errorHandler","PDParser","flagGotFragment","loadManifest","ProtectionKeyController","keySystems_","getKeySystems","keySystems","uuid","schemeIdURI","KeySystemCCPlayReady","messageFormat","getRequestHeadersFromMessage","headers","getLicenseRequestFromMessage","getLicenseServerURLFromInitData","initData","DataView","numRecords","getUint16","DOMParser","recordType","recordLength","byteLength","recordData","record","Uint16Array","xmlDoc","parseFromString","getElementsByTagName","laURL","nodeValue","luiurl","getInitData","cpData","PSSHBoxType","playreadySystemID","byteCursor","uint8arraydecodedPROHeader","PROSize","PSSHSize","PSSHBoxBuffer","PSSHBox","PSSHData","parseInitDataFromContentProtection","pro","__text","prheader","ArrayBuffer","setUint32","set","setPlayReadyMessageFormat","format","KeySystemClearKey","getClearKeysFromProtectionData","protectionData","clearkeySet","cp","CommonEncryption","KeySystemPlayReady","dataview","headerNameList","headerValueList","Content","licenseRequest","Challenge","KeySystemWidevine","generateLicense","TextDecoder","assert","kids","keyObj","kty","kid","k","u8arrToB64","TextEncoder","dumpKSConfig","ksString","ksConfig","initDataTypes","distinctiveIdentifier","persistentState","sessionTypes","videoCapabilities","robustness","ProtectionModel_21Jan2015","initDataType_","initData_","keySystem_","promiseAction_","onNeedKey","detachMedia","initDataType","pssh","parsePSSHList","a1","a2","requestKeySystemAccess","onSessionMessage","laUrl","license","session","update","XMLHttpRequest","responseType","withCredentials","onload","status","response","onabort","onerror","updateHeaders","setRequestHeader","body","onSessionChange","audioCapabilities","robustnessLevel","configs_","keySystemAccess","createMediaKeys","setMediaKeys","createSession","generateRequest","ProtectionModel_3Feb2014","mediaKeys_","abInitData","isView","GetKSUUID","actualInitData","readyState","MSMediaKeys","msSetMediaKeys","onSessionError","onSessionAdded","onSessionClose","abMessage","GetKSString","configIdx","videos","videoIdx","isTypeSupported","selectKeySystem","createKeySession","findCencContentProtection","cpArray","retVal","schemeIdUri","getPSSHData","view","version","getUint8","getUint32","getPSSHForKeySystem","psshList","dv","done","nextBox","systemID","psshDataSize","boxStart","val","KSUtils","drmType","KeySystemConfiguration","MediaCapability","UIAdsContainer","main","vopAdContainer","onAdContainerMouseDown","onAdStarted","onAdComplete","myPrintLog","vopPlayer","flagAdStarted","flagIsLinearAd","flagIsVpaidAd","style","zIndex","adDstWidth","adDstHeight","bottom","BOTTOM_BAR_HEIGHT","stopPropagation","UIAirplayToggleButton","componentDidMount","vopAirplayButton","componentWillUnmount","onUICmdAirplay","display","UIAudioTrackMenu","evEmitter","onMenuBackClick_","onMenuBackClick","onMenuItemClick_","onMenuItemClick","onMenuItemBlur_","onMenuItemBlur","onPopupMenuChange","POPUPMENU_CHANGE","audioTrackData","audioTrackList","currAudioTrackId","vopAudioTrackMenu","menuitems","settingMenuUIData","currMenu","emit","menu","nextFocus","dataset","setState","onAudioTrackMenuItemBlur","focus","UIBottomBar","onUICmdControlBarMouseDown","UIBufferingOverlay","addClass","removeClass","UICaptionOverlay","onTrackAdded","onTrackChanged","onAutoHideChange","AUTOHIDE_CHANGE","vopCaptionOverlay","captionStyle","backgroundColor","color","cues","textTrack_","getCurrentCues","updateCurrentCues","renderCues","autohide","allCues","currentCues_","innerText","UIChromecastOverlay","UITools","UIChromecastToggleButton","btnStyle","onUIComponentClick","onUIComponentMouseMove","onControlMouseMove","UIControlBar","UIErrorMsgOverlay","onError","vopErrorMsgOverlay","vopTvNoiseCanvas","vopErrorMsgText","tvNoiseCanvas","element","innerHTML","canvasWidth","canvasHeight","UIFccMenu","onFccPropertyValueChange","FCC_PROPERTY_VALUE_CHANGE","fccData","currFccPropertyName","isEnableFCC","fccPropertyList","currValue","vopFccMenu","fccProperty","onFccMenuItemBlur","tmpFccProperty","UIFccPropertyMenu","componentDidUpdate","prevFocus","relatedTarget","SETTINGS_BUTTON","UIFullscreenToggleButton","vopFullscreenBtn","onFullscreenChanged","onUICmdFullscreen","leaveFullscreen","playerContainer","enterFullscreen","flagIsFullscreen","screen","Component","UIGradientBottom","UIHugeButtonOverlay","uiGiantButton","uiGiantBtnContainer","playerState","onGiantAnimationEnd","updateGiantPlayBtnUI","UILogoOverlay","onLogoClick","onLogoMouseDown","UIPipToggleButton","pipMode","vopPipButton","onUICmdPip","UIPlayOverlay","onPlayOverlayClick","UIPlayToggleButton","onUICmdPlay","UIPopupMenu","onPopupMenuMouseDown","UIProgressBar","progressBarContext","progressBarMoveContext","movePos","flagThumbnailMode","vopProgressBar","vopLoadProgress","vopPlayProgress","vopHoverProgress","vopScrubberContainer","onProgressBarMouseDown_","onProgressBarMouseDown","onProgressBarMouseMove_","onProgressBarMouseMove","onProgressBarMouseLeave_","onProgressBarMouseLeave","onAdTimeUpdate","endStyle","loadProgressTransform","playProgressTransform","scrubberContainerTransform","uiPosition","getProgressBarUIStyle","updateProgressBarUI","updateProgressBarHoverUI","pausedBeforeMousedown","endedBeforeMousedown","captureProgressBarMouseEvents","preventDefault","posBeforeMousedown","timer","doEnterThumbnailMode","getProgressMovePosition","removeAutohideAction","PROGRESSBAR_MOUSEMOVE","PROGRESSBAR_MOUSELEAVE","newProgressBarMouseMove","docProgressBarMouseMove","newProgressBarMouseUp","docProgressBarMouseUp","releaseProgressBarMouseEvents","doProcessThumbnailMove","doProcessThumbnailUp","isPtInElement","clientX","clientY","rect","getBoundingClientRect","offsetX","isLive","uiBufferedPos","transform","UIQualityMenu","qualityData","qualityList","bitrate","isQualityAuto","currQualityId","vopQualityMenu","onQualityMenuItemBlur","UISettingsMenu","SETTINGS_DATA","settingsList","MENUITEM_QUALITY","MENUITEM_AUDIO_TRACK","MENUITEM_FCC","MENUITEM_XSPEED","settingsData","menuStyle","vopSettingsMenu","UISettingsToggleButton","vopSettingsButton","onUICmdSettings","UISubtitlesMenu","textTracksData","vopSubtitlesMenu","onSubtitleMenuBack","SUBTITLES_BUTTON","UISubtitlesToggleButton","onUICmdSubtitles","vopSubtitlesButton","UITimeLabel","vopTimeLabel","timeText","getTimeDisplay","updateTimeDisplay","timeToString","d","UITitleBar","title","description","UIToolTip","vopTooltip","vopTooltipBg","vopTooltipText","updateTooltipUI","currMovePos","thumbnail","getTooltipOffsetX","tooltipWidth","leftMin","offsetLeft","rightMax","currPosWidth","tooltipLeft_RelativeToVideo","tooltipRight_RelativeToVideo","isSprite","background","backgroundSize","strTime","UITvNoiseCanvas","canvasElement","canvasContext","interferenceHeight","lastFrameUpdate","frameInterval","useAnimationFrame","requestAnimationFrame","noiseAnimationWindowPos","frameUpdateHandlerId","renderFrame_","renderFrame","getContext","cancelAnimationFrame","scheduleNextRender","currentPixelOffset","noiseImage","createImageData","putImageData","UIVolumeBar","colorList_volume","vopVolumeSliderWidth","vopVolumeSliderHandleWidth","vopVolumeSlider","vopVolumeSliderHandle","vopVolumeButton","getVolumeInfo","genGradientColor","uiVolumeList","uiVolumeHandleLeft","onVolumeBarMouseMove","onVolumeSliderMouseDown","vLeft","captureVolumeSliderMouseEvents","flagVolumeSliderMousedown","docVolumeSliderMousemove","onVolumeBarMouseDown","valueVolumeMovePosition","getVolumeMovePosition","docVolumeSliderMouseup","releaseVolumeSliderMouseEvents","onVolumeBarMouseUp","newVolumeSliderMousemove","newVolumeSliderMouseup","UIVolumeToggleButton","vopVolumeBtnStyle","vopVolumeBtn","getNewVolumeBtnStyle","onUICmdVolume","newVolumeBtnStyle","oldVolumeBtnStyle","UIXSpeedMenu","xspeedData","currSpeedId","xspeedList","vopXSpeedMenu","getXSpeedValue","onXSpeedMenuItemBlur","CONSTS","ID","h5VideoPlayer_","skinContainerYb_","setAttribute","appendChild","uiPlayer_","cbLog","uninstallSkin","UISkinYoutube","initVariable","adsContainer","componentWillMount","initUIElements","initUIElementsStyles","initUIEventListeners","initPlayerListeners","syncPlayerStateToUI","uninitUIEventListeners","uninitPlayerListeners","ratio","vopBottomBar","metaWidth","metaHeight","timerHideControlBar","onMediaLoadedMetaData","onLog","onAdCompanions","onResizeSensorCb","vopVideo","onPlayerMouseEnter","onPlayerMouseLeave","onPlayerMouseMove","onPlayerMouseDown","onPlayerMouseUp","playerResizeSensor_","playerOpen","playerClose","updateUIStateMachine","playerRequestAds","onBtnInit","onBtnUninit","dstWidth","dstHeight","isPlayerActive","updateCaptionOverlay","controlBarHeight","hasClass","addAutohideAction","flagPlayerMouseDown","currPaused","currEnded","newPaused","pt","onBtnManualSchedule","onBtnInitAD","onBtnDelAll","dellAll","onBtnStop","printLogUI","companion","currState","requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullscreen","mozRequestFullScreen","msRequestFullscreen","msRequestFullScreen","cancelFullscreen","exitFullscreen","exitFullScreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen","elements","cName","trim","posList","colorList","totalRange","gradient","lastRange","top","dom_initUI","UIBasic","createMediaElement","mediaElement","createVideoContainer","createAdsContainer","html5VideoPlayer","vopVideoContainer","vopAdsContainer","WEBVTT","VTTParser","regExNewLine","regExToken","regExWhiteSpace","regExWhiteSpaceWordBoundary","captionArray","lastStartTime","attributes","parseItemAttributes","cuePoints","styles","getSublines","convertCuePointTimes","endTime","timeArray","vttCuePoints","arr","getCaptionStyles","styleObject","search","align","line","subline","lineData","lineCount","ajax","XHR_READYSTATE_UNSENT","XHR_READYSTATE_OPENED","XHR_READYSTATE_HEADERS_RECEIVED","XHR_READYSTATE_LOADING","XHR_READYSTATE_DONE","printlog","_readyStateChangeHandler","oncomplete","_requestError","completeCallback","errorCallback","onreadystatechange","getBrowserInfo","sys","ua","userAgent","edge","ie","firefox","opera","safari","browser","isSafari","isFirefox","isChrome","isChromecast","isEdge","isIE","ActiveXObject","getOSVersion","os","osVersion","nAgt","nVer","appVersion","clientStrings","r","cs","exec","pattern","arrOSV","osv","patternLen","out","startsWith","Number","isInteger","num","searchString","getFormatTime","formatTimeUnit","m","TimeRangesToString","beg","test1","aa","s1","ret2","b1","b2","b3","FetchLoader","fetchRequest","initParams","credentials","headersObj","Headers","Request","totalBytes","fetchPromise","fetch","ok","pump","reader","read","cbSuccess","cbProgress","getReader","StringUtils","ab2str","buf","str2ab","bufView","strLen","str2ab_v1","u8arr","btoa","b64ToU8arr","encoded","atob","TimeRanges","XHRLoader","config_","callbacks_","xhr_","needFailureReport_","remainingAttempts","retryInterval","onloadstart","onloadend","onprogress","loaded","total","ontimeout","VideoPlayer","Cues","hlsDefaultConfig","autoStartLoad","startPosition","defaultAudioCodec","capLevelOnFPSDrop","capLevelToPlayerSize","initialLiveManifestSize","maxBufferLength","maxBufferSize","maxBufferHole","lowBufferWatchdogPeriod","highBufferWatchdogPeriod","nudgeOffset","nudgeMaxRetry","maxFragLookUpTolerance","liveSyncDurationCount","liveMaxLatencyDurationCount","liveSyncDuration","liveMaxLatencyDuration","liveDurationInfinity","maxMaxBufferLength","enableWorker","enableSoftwareAES","manifestLoadingTimeOut","manifestLoadingMaxRetry","manifestLoadingRetryDelay","manifestLoadingMaxRetryTimeout","startLevel","levelLoadingTimeOut","levelLoadingMaxRetry","levelLoadingRetryDelay","levelLoadingMaxRetryTimeout","fragLoadingTimeOut","fragLoadingMaxRetry","fragLoadingRetryDelay","fragLoadingMaxRetryTimeout","startFragPrefetch","fpsDroppedMonitoringPeriod","fpsDroppedMonitoringThreshold","appendErrorMaxRetry","loader","fLoader","pLoader","xhrSetup","licenseXhrSetup","abrController","bufferController","capLevelController","fpsController","stretchShortVideoTrack","maxAudioFramesDrift","forceKeyFrameOnDiscontinuity","abrEwmaFastLive","abrEwmaSlowLive","abrEwmaFastVoD","abrEwmaSlowVoD","abrEwmaDefaultEstimate","abrBandWidthFactor","abrBandWidthUpFactor","abrMaxWithRealBitrate","maxStarvationDelay","maxLoadingDelay","minAutoBitrate","emeEnabled","widevineLicenseUrl","requestMediaKeySystemAccessFunc","subtitleStreamController","subtitleTrackController","timelineController","cueHandler","enableCEA708Captions","enableWebVTT","captionsTextTrack1Label","captionsTextTrack1LanguageCode","captionsTextTrack2Label","captionsTextTrack2LanguageCode","audioStreamController","audioTrackController","emeController","AbrController","hls","FRAG_BUFFERED","lastLoadedFragLevel","_nextAutoLevel","_bwEstimator","onCheck","_abandonRulesCheck","clearTimer","levels","live","ewmaFast","ewmaSlow","fragCurrent","minAutoLevel","stats","aborted","autoLevel","requestDelay","performance","trequest","abs","loadRate","bw","levelBitrate","realBitrate","expectedLen","fragLoadedDelay","bufferStarvationDelay","bufferInfo","fragLevelNextLoadedDelay","nextLoadLevel","levelNextBitrate","toFixed","abort","FRAG_LOAD_EMERGENCY_ABORTED","loadedBytes","loadedDuration","bitrateTest","tparsed","tbuffered","tload","onFragBuffered","fragLoadingProcessingMs","tfirst","bwEstimate","getEstimate","bitrateTestDelay","FRAG_LOAD_ERROR","FRAG_LOAD_TIMEOUT","_findBestLevel","currentLevel","currentFragDuration","currentBw","maxAutoLevel","maxFetchDuration","bwFactor","bwUpFactor","levelInfo","avgDuration","adjustedbw","fetchDuration","trace","forcedAutoLevel","bwEstimator","canEstimate","nextABRAutoLevel","_nextABRAutoLevel","nextLevel","avgbw","bestLevel","LevelHelper","STARTING","WAITING_TRACK","WAITING_INIT_PTS","AudioStreamController","fragmentTracker","MEDIA_DETACHING","AUDIO_TRACKS_UPDATED","AUDIO_TRACK_SWITCHING","AUDIO_TRACK_LOADED","KEY_LOADED","BUFFER_RESET","BUFFER_CREATED","BUFFER_FLUSHED","audioCodecSwap","_state","initPTS","waitingFragment","videoTrackCC","onHandlerDestroying","onHandlerDestroyed","demuxerId","cc","lastCurrentTime","fragLoadError","nextLoadPosition","removeFragment","fragPrevious","demuxer","doTick","trackDetails","loadedmetadata","startFragRequested","mediaBuffer","videoBuffer","mainBufferInfo","bufferLen","bufferEnd","maxConfigBuffer","maxBufLen","audioSwitch","endSN","nextStart","fragLen","PTSKnown","loadIdx","fragLoadIdx","nextBuffered","foundFrag","fragNext","fragmentWithinToleranceTest","candidate","candidateLookupTolerance","startSN","decryptdata","uri","NOT_LOADED","retryDate","waitingFrag","waitingFragCC","onvseeking","onvended","onMediaDetaching","onvseeked","onAudioTracksUpdated","audioTracks","onAudioTrackSwitching","altAudio","onAudioTrackLoaded","newDetails","sliding","curDetails","mergeDetails","startTimeOffset","onKeyLoaded","fragLoaded","appended","pendingBuffering","accurateTimeOffset","fragNew","levelCodec","BUFFER_CODECS","appendObj","pendingData","endPTS","startPTS","endDTS","startDTS","addElementaryStream","ElementaryStreamTypes","AUDIO","nb","updateFragPTSDTS","appendOnBufferFlush","startOffset","endOffset","POSITIVE_INFINITY","AUDIO_TRACK_SWITCHED","MEDIA_ERROR","_checkAppendedParsed","onBufferReset","onBufferCreated","audioTrack","loadError","AUDIO_TRACK_LOAD_ERROR","AUDIO_TRACK_LOAD_TIMEOUT","KEY_LOAD_ERROR","KEY_LOAD_TIMEOUT","BUFFER_FULL_ERROR","mediaBuffered","isBuffered","onBufferFlushed","nextState","previousState","AudioTrackController","ticks","ontick","cleanTimer","updateTrack","NETWORK_ERROR","defaultFound","default","targetduration","setAudioTrackInternal","newId","eventObj","AUDIO_TRACK_LOADING","audioTrackId","LEVEL_PTS_UPDATED","LEVEL_UPDATED","_msDuration","_levelDuration","_live","_objectUrl","onsbue","onSBUpdateEnd","onsbe","onSBUpdateError","pendingTracks","onLevelPtsUpdated","audioBuffer","sourceBuffer","delta","timestampOffset","audioTimestampOffset","audioExpected","videoExpected","sourceBufferNb","ms","mediaSource","onmso","onmse","onmsc","flushRange","segments","MEDIA_DETACHED","checkPendingTracks","pendingTracksNb","createSourceBuffers","_needsFlush","doFlush","_needsEos","checkEos","appending","counter","timeRanges","streamType","BUFFER_APPENDING_ERROR","onBufferCodecs","BUFFER_ADD_CODEC_ERROR","onBufferAppendFail","onBufferEos","dataType","sbobj","onBufferFlushing","flushBufferCounter","onLevelUpdated","flushBuffer","appendError","unshift","BUFFER_APPEND_ERROR","typeIn","bufStart","bufEnd","flushStart","flushEnd","remove","CapLevelController","FPS_DROP_LEVEL_CAPPING","restrictedLevels","autoLevelCapping","onFpsDropLevelCapping","isLevelAllowed","droppedLevel","HTMLVideoElement","firstLevel","getMaxLevel","detectPlayerSize","levelsLength","streamController","nextLevelSwitch","capLevelIndex","validLevels","getMaxLevelByMediaSize","mediaWidth","mediaHeight","atGreatestBandiwdth","curLevel","maxLevelIndex","offsetWidth","contentScaleFactor","offsetHeight","pixelRatio","devicePixelRatio","MAX_LICENSE_REQUEST_FAILURES","KeySystems","WIDEVINE","PLAYREADY","createWidevineMediaKeySystemConfigurations","audioCodecs","videoCodecs","drmSystemOptions","baseConfig","getSupportedMediaKeySystemConfigurations","_widevineLicenseUrl","_licenseXhrSetup","_emeEnabled","_requestMediaKeySystemAccess","_mediaKeysList","_media","_hasSetMediaKeys","_isMediaEncrypted","_requestLicenseFailureCount","getLicenseServerUrl","KEY_SYSTEM_ERROR","KEY_SYSTEM_LICENSE_REQUEST_FAILED","_attemptKeySystemAccess","mediaKeySystemConfigs","mediaKeySystemAccess","_onMediaKeySystemAccessObtained","mediaKeysListItem","mediaKeysSession","mediaKeysSessionInitialized","mediaKeySystemDomain","_onMediaKeysCreated","_onNewMediaKeySession","keySession","sessionId","_onKeySessionMessage","_requestLicense","_onMediaEncrypted","_mediaEncryptionInitDataType","_mediaEncryptionInitData","_attemptSetMediaKeys","_generateRequestWithPreferredKeySession","keysListItem","KEY_SYSTEM_NO_KEYS","KEY_SYSTEM_NO_ACCESS","KEY_SYSTEM_NO_SESSION","_createLicenseXhr","keyMessage","_onLicenseRequestReadyStageChange","statusText","attemptsLeft","_generateLicenseRequestChallenge","challenge","FPSController","isVideoPlaybackQualityAvailable","getVideoPlaybackQuality","checkFPSInterval","checkFPS","decodedFrames","droppedFrames","lastTime","currentPeriod","currentDropped","lastDroppedFrames","currentDecoded","lastDecodedFrames","droppedFPS","FPS_DROP","totalDroppedFrames","videoPlaybackQuality","totalVideoFrames","droppedVideoFrames","webkitDecodedFrameCount","webkitDroppedFrameCount","SubtitleStreamController","SUBTITLE_TRACKS_UPDATED","SUBTITLE_TRACK_SWITCH","SUBTITLE_TRACK_LOADED","SUBTITLE_FRAG_PROCESSED","vttFragSNsProcessed","vttFragQueues","currentlyProcessing","currentTrackId","decrypter","observer","clearVttFragQueues","nextFrag","onSubtitleFragProcessed","success","processedFragSNs","fragQueue","currentFragSN","alreadyProcessed","alreadyInQueue","fragInQueue","onSubtitleTracksUpdated","subtitleTracks","onSubtitleTrackSwitch","currentTrack","onSubtitleTrackLoaded","decryptData","decrypt","iv","decryptedData","FRAG_DECRYPTED","tstart","tdecrypt","filterSubtitleTracks","textTrackList","SubtitleTrackController","subtitleDisplay","_onTextTracksChanged","subtitleTrack","queuedDefaultTrack","trackChangeListener","useTextTrackPolling","subtitlePollingInterval","subtitles","onTick","SUBTITLE_TRACK_LOADING","setSubtitleTrackInternal","subtitleTrackId","reuseVttTextTrack","inUseTrack","manifestTrack","textTrack1","textTrack2","x1","x2","y1","y2","TimelineController","FRAG_PARSING_USERDATA","LEVEL_SWITCHING","enabled","unparsedVttFrags","cueRanges","captionsTracks","captionsProperties","languageCode","channel1","channel2","cea608Parser","addCues","ranges","merged","cueRange","overlap","newCue","getExistingTrack","createCaptionsTrack","existingTrack","createTextTrack","_cleanTracks","lastSn","prevCC","vttCCs","ccOffset","presentationOffset","inUseTracks","onLevelSwitching","closedCaptions","_parseVTTs","new","getCueById","textTrackCue","onFragDecrypted","onFragParsingUserdata","samples","ccdatas","extractCea608Data","addData","pts","byteArray","tmpByte","ccbyte1","ccbyte2","ccValid","ccType","actualCCBytes","AESCrypto","subtle","aesIV","removePadding","outputBytes","paddingBytes","AESDecryptor","rcon","subMix","Uint32Array","invSubMix","sBox","invSBox","initTable","uint8ArrayToUint32Array_","arrayBuffer","newArray","subMix0","subMix1","subMix2","subMix3","invSubMix0","invSubMix1","invSubMix2","invSubMix3","xi","sx","x4","x8","t","expandKey","keyBuffer","sameKey","keySize","ksRows","ksRow","invKsRow","keySchedule","invKeySchedule","sbox","prev","networkToHostOrderSwap","word","inputArrayBuffer","removePKCS7Padding","nRounds","invSBOX","initVector","initVector0","initVector1","initVector2","initVector3","inputInt32","Int32Array","outputInt32","t0","t1","t2","t3","s0","s2","s3","inputWords0","inputWords1","inputWords2","inputWords3","swapWord","Decrypter","logEnabled","browserCrypto","crypto","webkitSubtle","disableWebCrypto","isSync","decryptor","fastAesKey","aesKey","onWebCryptoError","Event","FRAG_DECRYPT_ERROR","FastAESKey","importKey","ADTS","AACDemuxer","remuxer","resetInitSegment","_audioTrack","sequenceNumber","isAAC","manifestCodec","inputTimeScale","resetTimeStamp","probe","id3Data","getID3Data","append","contiguous","timestamp","getTimeStamp","frameIndex","stamp","id3Samples","dts","isHeader","initTrackConfig","frame","appendFrame","remux","getAudioConfig","isHeaderPattern","getHeaderLength","getFullFrameLength","getFrameDuration","parseFrameHeader","adtsObjectType","adtsSampleingIndex","adtsExtensionSampleingIndex","adtsChanelConfig","adtsSampleingRates","FRAG_PARSING_ERROR","samplerate","channelCount","headerLength","frameLength","newOffset","frameDuration","header","aacSample","unit","subarray","DemuxerInline","typeSupported","vendor","discontinuity","trackSwitch","defaultInitPTS","localthis","pushDecrypted","muxConfig","demux","mux","setDecryptData","DemuxerWorker","removeListener","forwardMessage","postMessage","cmd","FRAG_PARSING_METADATA","transferable","Demuxer","mp4","mpeg","mp3","Worker","work","require","onwmsg","onWorkerMessage","OTHER_ERROR","INTERNAL_EXCEPTION","filename","lineno","objectURL","terminate","removeAllListeners","lastFrag","nextSN","ExpGolomb","bytesAvailable","bitsAvailable","loadWord","workingBytes","availableBytes","skipBits","skipBytes","readBits","bits","valu","skipLZ","leadingZeroCount","skipUEG","skipEG","readUEG","clz","readEG","readBoolean","readUByte","readUShort","readUInt","skipScalingList","lastScale","nextScale","deltaScale","readSPS","frameCropLeftOffset","frameCropRightOffset","frameCropTopOffset","frameCropBottomOffset","profileIdc","profileCompat","levelIdc","numRefFramesInPicOrderCntCycle","picWidthInMbsMinus1","picHeightInMapUnitsMinus1","frameMbsOnlyFlag","scalingListCount","chromaFormatIdc","picOrderCntType","aspectRatioIdc","readSliceType","ID3","isFooter","front","_readSize","frames","getID3Frames","isTimeStampFrame","_readTimeStamp","_getFrameData","frameData","_decodeFrame","_decodePrivFrame","_decodeTextFrame","_decodeURLFrame","timeStampFrame","pts33Bit","owner","_utf8ArrayToStr","privateData","exitOnNull","char2","char3","utf8ArrayToStr","MP3Demuxer","UINT32_MAX","MP4Demuxer","parseInitSegment","audiovideo","findBox","bin2str","readUint16","readUint32","writeUint32","subresults","endbox","parseSegmentIndex","moov","moovEndOffset","sidx","references","timescale","earliestPresentationTime","firstOffset","startByte","referencesCount","referenceIndex","referenceInfo","referenceSize","referenceType","subsegmentDuration","traks","tkhd","trak","mdhd","hdlr","hdlrType","codecBox","codecType","getStartDTS","fragment","trafs","baseTimes","traf","tfhd","scale","baseTime","tfdt","offsetStartDTS","baseMediaDecodeTime","upper","lower","MpegAudio","BitratesMap","SamplingRateMap","SamplesCoefficients","BytesInSlot","parseHeader","samplesPerFrame","sampleRate","headerB","headerC","headerE","headerF","headerG","columnInBitrates","bitRate","columnInSampleRates","sampleCoefficient","bytesInSlot","SampleAesDecrypter","discardEPB","decryptBuffer","encryptedData","decryptAacSample","sampleIndex","sync","curUnit","encryptedBuffer","byteOffset","decryptAacSamples","getAvcEncryptedData","decodedData","encryptedDataLen","outputPos","inputPos","getAvcDecryptedUnit","decryptAvcSample","unitIndex","decryptAvcSamples","curUnits","units","RemuxerTrackIdConfig","id3","TSDemuxer","sampleAes","syncOffset","_syncOffset","scanwindow","createTrack","pid","dropped","pmtParsed","_pmtId","_avcTrack","_id3Track","_txtTrack","aacOverFlow","aacLastPTS","avcSample","_duration","stt","atf","pes","unknownPIDs","avcTrack","id3Track","avcId","audioId","id3Id","pmtId","avcData","pesData","audioData","parsePAT","_parsePAT","parsePMT","_parsePMT","parsePES","_parsePES","parseAVCPES","_parseAVCPES","parseAACPES","_parseAACPES","parseMPEGPES","_parseMPEGPES","parseID3PES","_parseID3PES","parsedPIDs","avc","decryptAndRemux","videoTrack","decryptAndRemuxAvc","_initPTS","_initDTS","mpegSupported","isSampleAes","sectionLength","tableEnd","programInfoLength","stream","pesFlags","pesPrefix","pesLen","pesHdrLen","pesPts","pesDts","payloadStartOffset","newData","dataLen","pushAccesUnit","nbSamples","sps","_parseAVCNALu","expGolombDecoder","spsfound","createAVCSample","audFound","sliceType","payloadType","payloadSize","endOfCaptions","countryCode","providerCode","userStructure","userDataType","firstByte","secondByte","totalCCs","_insertSampleInOrder","codecarray","codecstring","pps","_getLastNalUnit","lastUnit","overflow","naluState","lastState","unitType","lastUnitStart","lastUnitType","EPBPositions","newLength","sourceIndex","newPTS","MUX_ERROR","MANIFEST_LOAD_ERROR","MANIFEST_LOAD_TIMEOUT","MANIFEST_PARSING_ERROR","MANIFEST_INCOMPATIBLE_CODECS_ERROR","LEVEL_LOAD_ERROR","LEVEL_LOAD_TIMEOUT","LEVEL_SWITCH_ERROR","REMUX_ALLOC_ERROR","BUFFER_STALLED_ERROR","BUFFER_SEEK_OVER_HOLE","BUFFER_NUDGE_ON_STALL","FORBIDDEN_EVENT_NAMES","Set","EventHandler","onEvent","handledEvents","useGenericHandler","registerListeners","unregisterListeners","isEventHandler","onEventGeneric","eventToFunction","funcName","HlsEvents","LEVEL_SWITCHED","LEVEL_LOADING","LEVEL_LOADED","FRAG_LOAD_PROGRESS","FRAG_CHANGED","DESTROYING","STREAM_STATE_TRANSITION","AAC","getSilentFrame","BufferHelper","maxHoleDuration","vbuffered","bufferedInfo","buffered2","bufferStart","bufferStartNext","diff","buf2len","buf2end","FragmentState","APPENDING","PARTIAL","OK","FragmentTracker","bufferPadding","getBufferedFrag","levelType","bufferedFrags","fragmentEntity","bufferedFragKey","detectEvictedFragments","elementaryStream","timeRange","fragmentTimes","esData","isTimeBuffered","detectPartialFragments","fragKey","getFragmentKey","hasElementaryStream","getBufferedTimes","fragmentPartial","getPartialFragment","timePadding","bestFragment","bestOverlap","isPartial","hasFragment","removeAllFragments","updatePTS","fromIdx","toIdx","fragFrom","fragTo","fragToPTS","maxStartPTS","deltaPTS","drift","fragIdx","oldDetails","oldfragments","newfragments","PTSFrag","oldFrag","newFrag","backtracked","getMediaSource","_url","_byteRange","_decryptdata","tagList","_elementaryStreams","VIDEO","createInitializationVector","segmentNumber","uint8View","fragmentDecryptdataFromLevelkey","levelkey","baseuri","reluri","relurl","buildAbsoluteURL","baseurl","alwaysNormalize","_programDateTime","rawProgramDateTime","rawByteRange","byteRange","lastByteRangeEndOffset","LevelKey","_uri","MASTER_PLAYLIST_REGEX","MASTER_PLAYLIST_MEDIA_REGEX","LEVEL_PLAYLIST_REGEX_FAST","LEVEL_PLAYLIST_REGEX_SLOW","M3U8Parser","findGroup","groups","mediaGroupId","matchingGroup","convertAVC1ToAVCOTI","avcdata","substr","resolve","parseMasterPlaylist","lastIndex","setCodecs","codecs","filtered","preferred","unknownCodecs","resolution","decimalResolution","decimalInteger","NAME","CODECS","parseMasterPlaylistMedia","audioGroups","medias","TYPE","groupId","DEFAULT","autoselect","AUTOSELECT","forced","FORCED","URI","LANGUAGE","groupCodec","currentSN","prevFrag","programDateTime","pdt","endPdt","value1","value2","toUpperCase","decryptparams","keyAttrs","decryptmethod","enumeratedString","decrypturi","decryptiv","hexadecimalInteger","startParams","startAttrs","decimalFloatingPoint","mapAttrs","BYTERANGE","averagetargetduration","startCC","endCC","endsWith","needSidxRanges","MP4","types","avc1","avcC","btrt","dinf","dref","esds","ftyp","mdat","mdia","mfhd","minf","moof","mp4a","mvex","mvhd","pasp","sdtp","stbl","stco","stsc","stsd","stsz","stts","trun","trex","vmhd","smhd","videoHdlr","audioHdlr","HDLR_TYPES","STTS","STSC","STCO","STSZ","VMHD","SMHD","STSD","majorBrand","avc1Brand","minorVersion","FTYP","box","DINF","upperWordDuration","lowerWordDuration","boxes","flags","dependsOn","isDependedOn","hasRedundancy","avcc","hSpacing","vSpacing","configlen","sampleDependencyTable","upperWordBaseMediaDecodeTime","lowerWordBaseMediaDecodeTime","arraylen","cts","isLeading","paddingValue","isNonSync","degradPrio","movie","MAX_SILENT_FRAME_DURATION","MP4Remuxer","ISGenerated","defaultTimeStamp","generateIS","nbAudioSamples","nbVideoSamples","audioTimeOffset","videoTimeOffset","audiovideoDeltaDts","remuxAudio","audioTrackLength","remuxVideo","videoData","remuxEmptyAudio","remuxID3","remuxText","audioSamples","videoSamples","computePTSDTS","initDTS","timeScale","mp4SampleDuration","firstPTS","firstDTS","nextDTS","lastPTS","lastDTS","inputSamples","outputSamples","ptsNormalize","_PTSNormalize","nextAvcDts","deltadts","deltapts","PTSDTSshift","curr","nbNalu","naluLen","nbUnits","sampleLen","mdatSize","avcSampleUnits","mp4SampleLength","compositionTimeOffset","unitData","unitDataLen","lastFrameDuration","gapTolerance","deltaToFrameEnd","nextAudioPts","hasVideo","mp4timeScale","scaleFactor","inputSampleDuration","rawMPEG","mp4Sample","fillFrame","nextPts","missing","newStamp","audioSample","numMissingFrames","unitLen","lastSampleDuration","sampleDuration","silentFrame","reference","PassThroughRemuxer","rawData","TaskLoop","_tickInterval","_tickCallCount","hasInterval","millis","DECIMAL_RESOLUTION_REGEX","ATTR_LIST_REGEX","AttrList","parseAttrList","attr","attrName","intValue","MAX_SAFE_INTEGER","stringValue","hexadecimalIntegerAsNumber","res","quote","BinarySearch","comparisonFunction","minIndex","maxIndex","currentIndex","currentElement","comparisonResult","specialCea608CharsCodes","getCharForByte","byte","charCode","NR_ROWS","NR_COLS","rowsLowCh1","rowsHighCh1","rowsLowCh2","rowsHighCh2","backgroundColors","verboseFilter","verboseLevel","setTime","newTime","severity","minLevel","numArrayToHexArray","numArray","hexArray","PenState","foreground","underline","italics","flash","setStyles","attribs","isDefault","equals","other","copy","newPenState","StyledUnicodeChar","uchar","penState","setChar","setPenState","newChar","Row","chars","currPenState","equal","empty","setCursor","absPos","moveCursor","relPos","newPos","backSpace","insertChar","char","clearFromPos","startPos","clear","clearToEndOfRow","getTextString","setPenStyles","currChar","CaptionScreen","rows","currRow","nrRollUpRows","row","setPen","setPAC","pacData","newRow","topRowIndex","lastOutputScreen","prevLineTime","cueStartTime","indent","prevPos","setBkgData","bkgData","setRollUpRows","nrRows","rollUp","getDisplayText","topRow","asOneRow","displayText","rowNr","rowText","getTextAndFormat","Cea608Channel","channelNumber","outputFilter","chNr","verbose","displayedMemory","nonDisplayedMemory","currRollUpRow","writeScreen","lastCueEndTime","getHandler","setHandler","newHandler","setMode","newMode","insertChars","outputDataUpdate","ccRCL","ccBS","ccAOF","ccAON","ccDER","ccRU","ccFON","ccRDC","ccTR","ccRTD","ccEDM","ccCR","ccENM","ccEOC","ccTO","nrCols","ccMIDROW","colorIndex","colors","dispatch","dispatchCue","cueSplitAtTime","Cea608Parser","field","out1","out2","outputs","channels","currChNr","lastCmdA","lastCmdB","bufferedData","dataCounters","byteList","cmdFound","charsFound","padding","parseCmd","parseMidrow","parsePAC","parseBackgroundAttributes","parseChars","channel","cond1","cond2","case1","case2","interpretPAC","pacIndex","channelNr","charCodes","charCode1","oneCode","hexCodes","sampleEntryCodesISO","isCodecType","typeCodes","isCodecSupportedInMp4","captionScreen","indenting","findFirstFragWithCC","findFragWithCC","shouldAlignOnDiscontinuities","findDiscontinuousReferenceFrag","adjustPts","alignDiscontinuities","firstFrag","currentFrag","CC","lastLevel","shouldAlign","prevDetails","prevFrags","curFrags","prevStartFrag","referenceFrag","lastPDT","newPDT","EwmaBandWidthEstimator","slow","fast","defaultEstimate","defaultEstimate_","minWeight_","minDelayMs_","slow_","fast_","durationMs","numBytes","bandwidth","weight","getTotalWeight","EWMA","halfLife","alpha_","exp","estimate_","totalWeight_","adjAlpha","zeroFactor","fakeLogger","exportedLogger","formatMsg","consolePrintFn","exportLoggerFunctions","debugConfig","enableLogs","OutputFilter","sendAddTrackEvent","clearCurrentCues","videoEl","createEvent","initEvent","dispatchEvent","removeCue","autoKeyword","directionSetting","lr","rl","alignSetting","middle","findDirectionSetting","findAlignSetting","cobj","p","isIE8","baseObj","enumerable","hasBeenReset","_id","_pauseOnExit","_startTime","_endTime","_text","_region","_vertical","_snapToLines","_line","_lineAlign","_position","_positionAlign","_size","_align","defineProperty","get","setting","SyntaxError","displayState","getCueAsHTML","WebVTT","convertCueToDOMTree","StringDecoder","decodeURIComponent","encodeURIComponent","decoder","regionList","parseTimeStamp","computeSeconds","f","Settings","dflt","defaultKey","alt","integer","percent","parseOptions","keyValueDelim","groupDelim","kv","center","parseCue","oInput","consumeTimeStamp","ts","consumeCueSettings","region","vals","vals0","vertical","lineAlign","snapToLines","skipWhitespace","fixLineBreaks","collectNextLine","alreadyCollectedLine","hasSubstring","oncue","flush","onflush","inputString","cueString2millis","timeString","secs","mins","hours","hash","calculateOffset","presentationTime","currCC","WebVTTParser","vttByteArray","syncPTS","callBack","errorCallBack","re","vttLines","cueTime","mpegTs","localTime","parsingError","inHeader","cueOffset","onparsingerror","XhrLoader","requestTimeout","retryTimeout","retry","retryDelay","loadInternal","readystatechange","loadprogress","loadtimeout","responseURL","maxRetry","maxRetryDelay","onTimeout","lengthComputable","onProgress"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH,oBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;;;;;;;;;AC7SA;AAAA;AACA;;AAEA;AACA;AACA,uBAAuB;AACvB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,MAAM;AAClB;AACA,iBAAiB;;AAEjB;AACA,2BAA2B;;AAE3B;AACA,4BAA4B;;AAE5B;AACA,8BAA8B;AAC9B;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,0BAA0B,YAAY;AACpD;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,SAAS;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,KAAK;AAC9B;AACA;AACA,GAAG;AACH;;AAEA;AACA,kCAAkC,0DAA0D;AAC5F;;AAEA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;;AAEA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,WAAW,MAAM;AACjB;AACA;AACA,2CAA2C;AAC3C;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,MAAM;AACjB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,aAAa,OAAO;AACpB;AACA;AACA,uBAAuB;AACvB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,IAAI;AACf,WAAW,IAAI;AACf,WAAW,QAAQ;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,2CAA2C;AAC3C,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,sFAAsF;AACtF,GAAG;AACH,0FAA0F;AAC1F;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,QAAQ;AACnB,WAAW,MAAM;AACjB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,4CAA4C,KAAK;AACjD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,WAAW,QAAQ;AACnB,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA,iBAAiB,UAAU;AAC3B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,iBAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,KAAK;AAChB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA,2BAA2B,KAAK;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,QAAQ,wCAAwC,mCAAmC;AAC9F,WAAW,QAAQ;AACnB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA,WAAW,UAAU;AACrB,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,6BAA6B;AAC7B;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,WAAW,QAAQ;AACnB,WAAW,MAAM;AACjB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,WAAW,UAAU;AACrB;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW;AACX;AACA;;AAEA;AACA,WAAW;AACX;AACA;;AAEA;AACA,WAAW;AACX;AACA;AACA;;AAEA;;AAEA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,cAAc,QAAQ;AACtB;AACA;AACA;;AAEA;AACA,YAAY,OAAO;AACnB,YAAY,SAAS;AACrB;AACA;AACA;AACA,iDAAiD;AACjD;AACA;AACA;AACA,EAAE;;;AAGF;AACA,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA,EAAE;;;AAGF;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA,CAAC;;AAED;AACA,WAAW,MAAM;AACjB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,OAAO,YAAY,OAAO;AAC7C;AACA;AACA;AACA,8BAA8B;AAC9B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACQ;AACR;;;;;;;;;;;;AC7+BA,+EAAe,uFAA2D,iCAAiC;AAAA,+GAAiE,iBAAiB,iBAAiB,aAAa,aAAa,+BAA+B,gBAAgB,QAAQ,qBAAqB,wBAAwB,IAAI,sBAAsB,gBAAgB,+HAA+H,gBAAgB,sBAAsB,0DAA0D,sDAAsD,sFAAsF,0BAA0B,SAAS,QAAQ,UAAU,WAAW,kBAAkB,aAAa,oBAAoB,YAAY,wBAAwB,SAAS,QAAQ,gBAAgB,EAAE,sNAAsN,oHAAoH,iGAAiG,kHAAkH,IAAI,sBAAsB,8DAA8D,KAAK,yBAAyB,kEAAkE,mBAAmB,+DAA+D,gCAAgC,qHAAqH,+BAA+B,iBAAiB,uQAAuQ,yCAAyC,IAAI,cAAc,aAAa,qCAAqC,+CAA+C,4BAA4B,IAAI,mBAAmB,iBAAiB,sBAAsB,+FAA+F,GAAG,GAAG,SAAS,E;;;;;;;;;;;ACAl/E;;AAEA;AACA,iB;AACA;;AAEA,uDAAuD,eAAe;AACtE,oCAAoC;AACpC;AACA;;AAEA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sFAAsF;AACtF;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAKA;AACA,CAAC;AACD;;;;;;;;;;;;AClKA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;;;;;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;;;;;ACrBA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,mDAAmD,cAAc;;AAEjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;;AAEA;AACA;AACA,0DAA0D,cAAc;AACxE;;AAEA;AACA;AACA;AACA,qCAAqC,0BAA0B,EAAE;AACjE,2CAA2C,eAAe;AAC1D;AACA;AACA;;AAEA;AACA,8DAA8D,+DAA+D;;AAE7H;AACA;;AAEA;AACA,kDAAkD,oBAAoB,WAAW;;AAEjF;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,6CAA6C;AAC7C;;AAEA;AACA,uBAAuB;AACvB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,iBAAiB;AAClC,mBAAmB,4BAA4B;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,2BAA2B;AAChD;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,uCAAuC,kCAAkC;;AAEzE;;AAEA,oDAAoD,sBAAsB;AAC1E;AACA;AACA;AACA;AACA;AACA,qFAAqF,sCAAsC,EAAE;AAC7H,sIAAsI,+CAA+C,yEAAyE,gBAAgB,EAAE;AAChR,GAAG;;AAEH,iHAAiH,4CAA4C,sEAAsE,gBAAgB,SAAS;;AAE5P,qCAAqC,0BAA0B;AAC/D,qBAAqB;;AAErB;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;ACzMA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,yCAAyC,OAAO;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6CAA6C,OAAO;AACpD;AACA;AACA;AACA;AACA,8CAA8C,iBAAiB,EAAE;AACjE;AACA;AACA;AACA;;AAEA,oBAAoB;AACpB;AACA,0CAA0C;AAC1C;AACA,sDAAsD;AACtD,+CAA+C;AAC/C,UAAU;AACV;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,YAAY,GAAG;AACf;;AAEA;;AAEA,gCAAgC,0BAA0B;AAC1D,kCAAkC,aAAa;AAC/C;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC/EA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;AAGA;;;;AAEA;;;;AACA;;;;AACA;;;;AAEA;;;;AAEA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AAEA;;;;AAGA;;;;AACA;;;;AAGA;;AAKA;;;;;;AAEA;;;AARA;;;AAJA;AAaA,SAASA,MAAT,CAAgBC,WAAhB,EAA6B;AAC3B,MAAIC,WAAWC,MAAf,CAD2B,CACJ;AACvB,MAAIC,mBAAmBC,SAASC,cAAT,CAAwBL,WAAxB,CAAvB;;AAEA;AACA,4BAAWG,gBAAX;;AAEA,MAAIG,SAASF,SAASG,aAAT,CAAuB,YAAvB,CAAb;AACA,MAAIC,eAAeJ,SAASG,aAAT,CAAuB,oBAAvB,CAAnB;;AAEA,MAAIE,YAAY,wBAASR,QAAT,EAAmBS,WAAnB,EAAhB;AACA,MAAIC,SAAS,qBAAMV,QAAN,EAAgBS,WAAhB,EAAb;AACA,MAAIE,qBAAqB,kCAAzB;;AAEA,MAAIC,wBAAJ;AACA,MAAIC,yBAAJ;AACA,MAAIC,wBAAJ;;AAEA,MAAIC,0BAAJ;AACA,MAAIC,uBAAJ;AACA,MAAIC,0BAAJ;AACA,MAAIC,yBAAJ;AACA,MAAIC,0BAAJ;AACA,MAAIC,4BAAJ;AACA,MAAIC,6BAAJ;AACA,MAAIC,6BAAJ;;AAEA;AACA,MAAIC,oBAAJ;AACA,MAAIC,qBAAqB,KAAzB;;AAEA;AACA,MAAIC,mBAAJ;;AAEA;AACA,MAAIC,yBAAJ;AACA,MAAIC,+BAAJ;;AAEA;AACA,MAAIC,eAAe,MAAnB,CAvC2B,CAuCA;;AAE3B;AACA,MAAIC,2BAA2B,KAA/B;AACA,MAAIC,sBAAsB,KAA1B;AACA,MAAIC,kBAAkB,KAAtB;;AAEA,WAASC,KAAT,GAAiB;AACf;;AAEAhC,aAASiC,KAAT,GAAiB5B,MAAjB;AACD;;AAED,WAAS6B,IAAT,CAAcC,GAAd,EAAmB;AACjBnC,aAASmC,GAAT,GAAeA,GAAf;;AAEAC;AACAC;AACD;;AAED,WAASC,MAAT,GAAkB,CAAE;;AAEpB,WAASC,IAAT,CAAcC,QAAd,EAAwB;AACtB9B,WAAO+B,GAAP,CAAW,eAAX;;AAEA,QAAI,CAAC9B,mBAAmB+B,QAAnB,CAA4BvC,SAASwC,MAArC,CAAL,EAAmD;AACjDnC,gBAAUoC,OAAV,CAAkB,iBAAOC,KAAzB,EAAgC;AAC9BC,cAAM,mBAAWC;AADa,OAAhC;AAGA,aAAO,KAAP;AACD;;AAED;AACAP,aAASQ,GAAT,GAAeR,SAASQ,GAAT,IAAgB,EAA/B;;AAEAhD,aAASwC,QAAT,GAAoBA,QAApB;;AAEAxB,mBAAeiC,UAAf,CAA0BT,QAA1B;AACA;AACAhC,cAAUoC,OAAV,CAAkB,iBAAOM,cAAzB,EAAyC;AACvCC,WAAKX,SAASW;AADyB,KAAzC;;AAIA,QAAIX,SAASY,MAAb,EAAqB;AACnB;AACA,WAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIb,SAASY,MAAT,CAAgBE,MAApC,EAA4CD,GAA5C,EAAiD;AAC/C,YAAIE,QAAQf,SAASY,MAAT,CAAgBC,CAAhB,CAAZ;AACA;AACAE,cAAMC,EAAN,GAAWH,EAAEI,QAAF,EAAX;AACA,YAAI,CAACF,MAAMG,IAAX,EAAiB;AACf,cAAIH,MAAMI,KAAV,EAAiB;AACfJ,kBAAMG,IAAN,GAAaH,MAAMI,KAAnB;AACD,WAFD,MAEO;AACLJ,kBAAMG,IAAN,GAAaH,MAAMI,KAAN,GAAc,eAAeN,EAAEI,QAAF,EAA1C;AACD;AACF;AACD,YAAIF,MAAMK,IAAN,KAAe,WAAnB,EAAgC;AAC9BpD,oBAAUoC,OAAV,CAAkB,iBAAOiB,aAAzB,EAAwC;AACtCN,mBAAOA;AAD+B,WAAxC;AAGD;AACF;;AAED;AACA,WAAK,IAAIF,KAAI,CAAb,EAAgBA,KAAIb,SAASY,MAAT,CAAgBE,MAApC,EAA4CD,IAA5C,EAAiD;AAC/C,YAAIE,SAAQf,SAASY,MAAT,CAAgBC,EAAhB,CAAZ;AACA,YAAIE,OAAMK,IAAN,KAAe,YAAnB,EAAiC;AAC/BpD,oBAAUoC,OAAV,CAAkB,iBAAOkB,iBAAzB,EAA4C;AAC1CP,mBAAOA;AADmC,WAA5C;AAGD;AACF;AACF;;AAED,QAAI9B,UAAJ,EAAgB;AACdA,iBAAWsC,UAAX;AACD,KAFD,MAEO;AACLjC,4BAAsB,IAAtB;AACD;AACDC,sBAAkB,KAAlB;AACAF,+BAA2B,KAA3B;;AAEAmC,gBAAY,SAAZ;AACD;;AAED,WAASC,KAAT,GAAiB;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEAD,gBAAY,MAAZ;AACD;;AAED,WAASA,WAAT,CAAqBE,KAArB,EAA4B;AAC1B,QAAIC,WAAWvC,YAAf;AACA,QAAIwC,WAAWF,KAAf;;AAEAtC,mBAAewC,QAAf;AACA5D,cAAUoC,OAAV,CAAkB,iBAAOyB,YAAzB,EAAuC;AACrCF,gBAAUA,QAD2B;AAErCC,gBAAUA;AAF2B,KAAvC;AAID;;AAED;AACA;AACA,WAASE,EAAT,CAAYxB,IAAZ,EAAkByB,QAAlB,EAA4BC,KAA5B,EAAmC;AACjChE,cAAU8D,EAAV,CAAaxB,IAAb,EAAmByB,QAAnB,EAA6BC,KAA7B;AACD;;AAED,WAASC,GAAT,CAAa3B,IAAb,EAAmByB,QAAnB,EAA6BC,KAA7B,EAAoC;AAClChE,cAAUiE,GAAV,CAAc3B,IAAd,EAAoByB,QAApB,EAA8BC,KAA9B;AACD;;AAED,WAASE,IAAT,GAAgB;AACd,QAAIlD,kBAAJ,EAAwB;AACtBD,kBAAYmD,IAAZ;AACD,KAFD,MAEO;AACL,UAAI,CAAC3C,eAAL,EAAsB;AACpB,YAAIN,UAAJ,EAAgB;AACdA,qBAAWkD,MAAX;AACD,SAFD,MAEO;AACLvD,8BAAoBsD,IAApB;AACD;AACD3C,0BAAkB,IAAlB;AACD,OAPD,MAOO;AACL,YAAIN,cAAcA,WAAWmD,WAAX,EAAd,IAA0CnD,WAAWoD,UAAX,EAA9C,EAAuE;AACrEpD,qBAAWiD,IAAX;AACD,SAFD,MAEO;AACLtD,8BAAoBsD,IAApB;AACD;AACF;AACF;AACF;;AAED,WAASI,KAAT,GAAiB;AACf,QAAItD,kBAAJ,EAAwB;AACtBD,kBAAYuD,KAAZ;AACD,KAFD,MAEO,IAAIrD,cAAcA,WAAWmD,WAAX,EAAd,IAA0CnD,WAAWoD,UAAX,EAA9C,EAAuE;AAC5EpD,iBAAWqD,KAAX;AACD,KAFM,MAEA;AACL,UAAI,CAAC1D,mBAAL,EAA0B;AACxB;AACD;AACDA,0BAAoB0D,KAApB;AACD;AACF;;AAED,WAASC,QAAT,GAAoB;AAClB,QAAIvD,kBAAJ,EAAwB;AACtB,aAAOD,YAAYwD,QAAZ,EAAP;AACD,KAFD,MAEO;AACL,UAAItD,cAAcA,WAAWmD,WAAX,EAAd,IAA0CnD,WAAWoD,UAAX,EAA9C,EAAuE;AACrE,eAAOpD,WAAWsD,QAAX,EAAP;AACD,OAFD,MAEO;AACL,YAAI,CAAC3D,mBAAL,EAA0B;AACxB;AACD;AACD,eAAOA,oBAAoB2D,QAApB,EAAP;AACD;AACF;AACF;;AAED,WAASC,WAAT,GAAuB;AACrB,QAAIxD,kBAAJ,EAAwB;AACtB,aAAOD,YAAYyD,WAAZ,EAAP;AACD,KAFD,MAEO,IAAIvD,cAAcA,WAAWmD,WAAX,EAAd,IAA0CnD,WAAWoD,UAAX,EAA9C,EAAuE;AAC5E,aAAOpD,WAAWuD,WAAX,EAAP;AACD,KAFM,MAEA;AACL,UAAI,CAAC5D,mBAAL,EAA0B;AACxB;AACD;AACD,aAAOA,oBAAoB4D,WAApB,EAAP;AACD;AACF;;AAED,WAASC,WAAT,GAAuB;AACrB,QAAIzD,kBAAJ,EAAwB;AACtB,aAAOD,YAAY0D,WAAZ,EAAP;AACD,KAFD,MAEO,IAAIxD,cAAcA,WAAWmD,WAAX,EAAd,IAA0CnD,WAAWoD,UAAX,EAA9C,EAAuE;AAC5E,aAAOpD,WAAWwD,WAAX,EAAP;AACD,KAFM,MAEA;AACL,UAAI,CAAC7D,mBAAL,EAA0B;AACxB;AACD;AACD,aAAOA,oBAAoB6D,WAApB,EAAP;AACD;AACF;;AAED,WAASC,gBAAT,GAA4B;AAC1B,QAAI,CAAC9D,mBAAL,EAA0B;AACxB;AACD;AACD,WAAOA,oBAAoB8D,gBAApB,EAAP;AACD;;AAED,WAASC,iBAAT,GAA6B;AAC3B,QAAI,CAAC/D,mBAAL,EAA0B;AACxB;AACD;AACD,WAAOA,oBAAoB+D,iBAApB,EAAP;AACD;;AAED,WAASC,OAAT,GAAmB;AACjB,QAAI3D,cAAcA,WAAWmD,WAAX,EAAd,IAA0CnD,WAAWoD,UAAX,EAA9C,EAAuE,CAAE,CAAzE,MAA+E;AAC7E,UAAI,CAACzD,mBAAL,EAA0B;AACxB;AACD;AACD,aAAOA,oBAAoBgE,OAApB,EAAP;AACD;AACF;;AAED,WAASC,IAAT,GAAgB;AACd,QAAI7D,kBAAJ,EAAwB;AACtBD,kBAAY8D,IAAZ;AACD,KAFD,MAEO,IAAI5D,cAAcA,WAAWmD,WAAX,EAAd,IAA0CnD,WAAWoD,UAAX,EAA9C,EAAuE;AAC5EpD,iBAAW4D,IAAX;AACD,KAFM,MAEA;AACL,UAAI,CAACjE,mBAAL,EAA0B;AACxB;AACD;AACDA,0BAAoBiE,IAApB;AACD;AACF;;AAED,WAASC,MAAT,GAAkB;AAChB,QAAI9D,kBAAJ,EAAwB;AACtBD,kBAAY+D,MAAZ;AACD,KAFD,MAEO,IAAI7D,cAAcA,WAAWmD,WAAX,EAAd,IAA0CnD,WAAWoD,UAAX,EAA9C,EAAuE;AAC5EpD,iBAAW6D,MAAX;AACD,KAFM,MAEA;AACL,UAAI,CAAClE,mBAAL,EAA0B;AACxB;AACD;AACDA,0BAAoBkE,MAApB;AACD;AACF;;AAED,WAASC,OAAT,GAAmB;AACjB,QAAI/D,kBAAJ,EAAwB;AACtB,aAAOD,YAAYgE,OAAZ,EAAP;AACD,KAFD,MAEO,IAAI9D,cAAcA,WAAWmD,WAAX,EAAd,IAA0CnD,WAAWoD,UAAX,EAA9C,EAAuE;AAC5E,aAAOpD,WAAW8D,OAAX,EAAP;AACD,KAFM,MAEA;AACL,UAAI,CAACnE,mBAAL,EAA0B;AACxB;AACD;AACD,aAAOA,oBAAoBmE,OAApB,EAAP;AACD;AACF;;AAED,WAASC,SAAT,CAAmBC,MAAnB,EAA2B;AACzB,QAAIjE,kBAAJ,EAAwB;AACtBD,kBAAYiE,SAAZ,CAAsBC,MAAtB;AACD,KAFD,MAEO,IAAIhE,cAAcA,WAAWmD,WAAX,EAAd,IAA0CnD,WAAWoD,UAAX,EAA9C,EAAuE;AAC5EpD,iBAAW+D,SAAX,CAAqBC,MAArB;AACD,KAFM,MAEA;AACL,UAAI,CAACrE,mBAAL,EAA0B;AACxB;AACD;AACDA,0BAAoBoE,SAApB,CAA8BC,MAA9B;AACD;AACF;;AAED,WAASC,SAAT,GAAqB;AACnB,QAAIlE,kBAAJ,EAAwB;AACtB,aAAOD,YAAYmE,SAAZ,EAAP;AACD,KAFD,MAEO,IAAIjE,cAAcA,WAAWmD,WAAX,EAAd,IAA0CnD,WAAWoD,UAAX,EAA9C,EAAuE;AAC5E,aAAOpD,WAAWiE,SAAX,EAAP;AACD,KAFM,MAEA;AACL,UAAI,CAACtE,mBAAL,EAA0B;AACxB;AACD;;AAED,aAAOA,oBAAoBsE,SAApB,EAAP;AACD;AACF;;AAED,WAASC,qBAAT,CAA+BC,KAA/B,EAAsC;AACpCxE,wBAAoBuE,qBAApB,CAA0CC,KAA1C;AACD;;AAED,WAASC,WAAT,CAAqBC,GAArB,EAA0B;AACxB,QAAItE,kBAAJ,EAAwB;AACtBD,kBAAYsE,WAAZ,CAAwBC,GAAxB;AACD,KAFD,MAEO;AACL1E,0BAAoByE,WAApB,CAAgCC,GAAhC;AACD;AACF;;AAED,WAASC,QAAT,GAAoB;AAClB,WAAO3E,oBAAoB4E,UAApB,EAAP;AACD;;AAED,WAASC,SAAT,GAAqB;AACnB,WAAO7E,oBAAoB8E,WAApB,EAAP;AACD;;AAED,WAASC,MAAT,CAAgBC,KAAhB,EAAuBC,MAAvB,EAA+B;AAC7B,QAAI5E,UAAJ,EAAgB;AACdA,iBAAW0E,MAAX,CAAkBC,KAAlB,EAAyBC,MAAzB;AACD;AACF;;AAED;AACA,WAAS1B,MAAT,GAAkB;AAChB,QAAIlD,UAAJ,EAAgB;AACdA,iBAAWkD,MAAX;AACD;;AAED;AACA;AACA;;AAEA;AACD;;AAED;AACA,WAAS2B,iBAAT,GAA6B;AAC3B,WAAOjF,qBAAqBiF,iBAArB,EAAP;AACD;;AAED,WAASC,uBAAT,GAAmC;AACjC,WAAOlF,qBAAqBkF,uBAArB,EAAP;AACD;;AAED,WAASC,mBAAT,CAA6BhD,EAA7B,EAAiC;AAC/BnC,yBAAqBmF,mBAArB,CAAyChD,EAAzC;AACD;;AAED;AACA,WAASiD,YAAT,CAAsBC,IAAtB,EAA4B;AAC1B,QAAIpF,oBAAJ,EAA0B;AACxB,aAAOA,qBAAqBmF,YAArB,CAAkCC,IAAlC,CAAP;AACD,KAFD,MAEO;AACL,aAAOC,SAAP;AACD;AACF;;AAED;AACA,WAASC,SAAT,GAAqB;AACnBrF,gBAAYsF,cAAZ;AACD;;AAED,WAASC,QAAT,GAAoB;AAClBvF,gBAAYwF,WAAZ;AACD;;AAED,WAASC,QAAT,CAAkB7E,GAAlB,EAAuB;AACrBZ,gBAAYW,IAAZ,CAAiBC,GAAjB;AACD;;AAED,WAAS8E,QAAT,CAAkBzE,QAAlB,EAA4B;AAC1BjB,gBAAYgB,IAAZ,CAAiBC,QAAjB;AACD;;AAED,WAAS0E,OAAT,GAAmB;AACjB3F,gBAAY4F,GAAZ;AACD;;AAED,WAASC,QAAT,GAAoB;AAClB7F,gBAAYmD,IAAZ;AACD;;AAED,WAAS2C,SAAT,GAAqB;AACnB9F,gBAAYuD,KAAZ;AACD;;AAED,WAASwC,eAAT,CAAyBZ,IAAzB,EAA+B;AAC7BnF,gBAAYsE,WAAZ,CAAwBa,IAAxB;AACD;;AAED,WAASa,QAAT,GAAoB;AAClBhG,gBAAYiG,IAAZ;AACD;;AAED;AACA,WAASC,kBAAT,GAA8B;AAC5B,QAAIC,OAAOC,qCAAX,EAAkD;AAChD,aAAO,IAAP;AACD;AACD,WAAO,KAAP;AACD;;AAED,WAASC,wBAAT,GAAoC;AAClC,QAAIH,oBAAJ,EAA0B;AACxB,UAAII,eAAexH,MAAnB;AACAwH,mBAAaC,8BAAb;AACD;AACF;;AAED;AACA,WAASC,cAAT,GAA0B;AACxB,QAAIF,eAAexH,MAAnB;AACA,QAAIwH,gBACFA,aAAaG,8BADX,IAEF,OAAOH,aAAaI,yBAApB,KAAkD,UAFpD,EAEgE;AAC9D,aAAO,IAAP;AACD;AACD,WAAO,KAAP;AACD;;AAED,WAASC,kBAAT,CAA4BC,IAA5B,EAAkC;AAChC,QAAIJ,gBAAJ,EAAsB;AACpB,UAAIF,eAAexH,MAAnB;AACA,UAAI8H,QAAQN,aAAaO,sBAAb,KAAwC,QAApD,EAA8D;AAC5DP,qBAAaI,yBAAb,CAAuC,oBAAvC;AACD,OAFD,MAEO,IAAI,CAACE,IAAD,IACTN,aAAaO,sBAAb,KAAwC,oBADnC,EACyD;AAC9DP,qBAAaI,yBAAb,CAAuC,QAAvC;AACD;AACF;AACF;;AAED;AACA,WAASI,QAAT,GAAoB;AAClB,WAAOzG,YAAP;AACD;;AAED,WAAS0G,YAAT,GAAwB;AACtB,WAAOnI,SAASoI,iBAAT,IACLpI,SAASqI,mBADJ,IAELrI,SAASsI,aAFJ,IAGLtI,SAASuI,kBAHX;AAID;;AAED,WAASC,sBAAT,CAAgCC,UAAhC,EAA4C;AAC1C,QAAInH,cAAcA,WAAWoD,UAAX,EAAd,IAAyCpD,WAAWmD,WAAX,EAA7C,EAAuE;AACrE,aAAO,CAAP;AACD,KAFD,MAEO;AACL,aAAOxD,oBAAoBuH,sBAApB,CAA2CC,UAA3C,CAAP;AACD;AACF;;AAED;AACA;AACA,WAASxG,aAAT,GAAyB;AACvBxB,sBAAkB,+BAAeZ,QAAf,EAAyBS,WAAzB,EAAlB;AACAI,uBAAmB,4BAAYb,QAAZ,EAAsBS,WAAtB,EAAnB;AACAK,sBAAkB,+BAAed,QAAf,EAAyB6I,MAAzB,EAAlB;;AAEAzH,0BAAsB,mCAAmBpB,QAAnB,EAA6BS,WAA7B,EAAtB;AACAY,2BAAuB,oCAAoBrB,QAApB,EAA8BS,WAA9B,EAAvB;AACAM,wBAAoB,iCAAiBf,QAAjB,EAA2BS,WAA3B,EAApB;AACAO,qBAAiB,8BAAchB,QAAd,EAAwBS,WAAxB,EAAjB;AACAQ,wBAAoB,iCAAiBjB,QAAjB,EAA2BS,WAA3B,EAApB;AACAS,uBAAmB,gCAAgBlB,QAAhB,EAA0BS,WAA1B,EAAnB;AACAU,wBAAoB,iCAAiBnB,QAAjB,EAA2BS,WAA3B,EAApB;AACAa,2BAAuB,oCAAoBtB,QAApB,EAA8BS,WAA9B,EAAvB;;AAEA;AACA,QAAIT,SAASmC,GAAT,CAAa2G,MAAjB,EAAyB;AACvBzI,aAAOyI,MAAP,GAAgB9I,SAASmC,GAAT,CAAa2G,MAA7B;AACD;AACD;AACA,QAAI9I,SAASmC,GAAT,CAAa4G,WAAjB,EAA8B;AAC5BtH,mBAAa,8BAAczB,QAAd,EAAwBS,WAAxB,CAAoCF,YAApC,EAAkDF,MAAlD,EAA0DL,SAASmC,GAAT,CAAa4G,WAAvE,CAAb;AACD;AACD;AACA,QAAIrB,OAAOsB,IAAP,IAAetB,OAAOsB,IAAP,CAAYC,YAA/B,EAA6C;AAC3C;AACD,KAFD,MAEO;AACL,UAAIjJ,SAASmC,GAAT,CAAa6G,IAAb,IAAqBhJ,SAASmC,GAAT,CAAa6G,IAAb,CAAkBE,aAA3C,EAA0D;AACxD3H,sBAAc,2BAAWvB,QAAX,EAAqBS,WAArB,CAAiCT,SAASmC,GAAT,CAAa6G,IAAb,CAAkBE,aAAnD,CAAd;AACD;AACF;AACF;;AAED,WAAS7G,iBAAT,GAA6B;AAC3B;AACA7B,cAAU8D,EAAV,CAAa,iBAAO6E,aAApB,EAAmCC,cAAnC,EAAmD,EAAnD;AACA5I,cAAU8D,EAAV,CAAa,iBAAO+E,WAApB,EAAiCC,YAAjC,EAA+C,EAA/C;AACA9I,cAAU8D,EAAV,CAAa,iBAAOiF,aAApB,EAAmCC,cAAnC,EAAmD,EAAnD;AACAhJ,cAAU8D,EAAV,CAAa,iBAAOmF,aAApB,EAAmCC,cAAnC,EAAmD,EAAnD;AACAlJ,cAAU8D,EAAV,CAAa,iBAAOqF,YAApB,EAAkCC,aAAlC,EAAiD,EAAjD;;AAEA;AACApJ,cAAU8D,EAAV,CAAa,iBAAOuF,YAApB,EAAkCC,aAAlC;AACAtJ,cAAU8D,EAAV,CAAa,iBAAOyF,cAApB,EAAoCC,eAApC;;AAEA;AACAxJ,cAAU8D,EAAV,CAAa,iBAAO2F,0BAApB,EAAgDC,yBAAhD,EAA2E,EAA3E;AACA1J,cAAU8D,EAAV,CAAa,iBAAO6F,2BAApB,EAAiDC,0BAAjD,EAA6E,EAA7E;AACA5J,cAAU8D,EAAV,CAAa,iBAAO+F,mBAApB,EAAyCC,mBAAzC,EAA8D,EAA9D;AACA9J,cAAU8D,EAAV,CAAa,iBAAOiG,SAApB,EAA+BC,UAA/B,EAA2C,EAA3C;AACAhK,cAAU8D,EAAV,CAAa,iBAAOmG,UAApB,EAAgCC,WAAhC,EAA6C,EAA7C;;AAEA;AACAlK,cAAU8D,EAAV,CAAa,iBAAOqG,cAApB,EAAoCC,eAApC;AACApK,cAAU8D,EAAV,CAAa,iBAAOuG,iBAApB,EAAuCC,kBAAvC;;AAEA;AACA3K,aAAS4K,gBAAT,CAA0B,kBAA1B,EAA8CC,kBAA9C;AACA7K,aAAS4K,gBAAT,CAA0B,qBAA1B,EAAiDC,kBAAjD;AACA7K,aAAS4K,gBAAT,CAA0B,wBAA1B,EAAoDC,kBAApD;AACA7K,aAAS4K,gBAAT,CAA0B,oBAA1B,EAAgDC,kBAAhD;AACA7K,aAAS4K,gBAAT,CAA0B,oBAA1B,EAAgDC,kBAAhD;AACD;;AAED,WAASC,oBAAT,GAAgC;AAC9B;AACAzK,cAAUiE,GAAV,CAAc,iBAAO0E,aAArB,EAAoCC,cAApC,EAAoD,EAApD;AACA5I,cAAUiE,GAAV,CAAc,iBAAO4E,WAArB,EAAkCC,YAAlC,EAAgD,EAAhD;AACA9I,cAAUiE,GAAV,CAAc,iBAAO8E,aAArB,EAAoCC,cAApC,EAAoD,EAApD;AACAhJ,cAAUiE,GAAV,CAAc,iBAAOgF,aAArB,EAAoCC,cAApC,EAAoD,EAApD;AACAlJ,cAAUiE,GAAV,CAAc,iBAAOkF,YAArB,EAAmCC,aAAnC,EAAkD,EAAlD;;AAEA;AACApJ,cAAUiE,GAAV,CAAc,iBAAOoF,YAArB,EAAmCC,aAAnC;AACAtJ,cAAUiE,GAAV,CAAc,iBAAOsF,cAArB,EAAqCC,eAArC;;AAEA;AACAxJ,cAAUiE,GAAV,CAAc,iBAAOwF,0BAArB,EAAiDC,yBAAjD,EAA4E,EAA5E;AACA1J,cAAUiE,GAAV,CAAc,iBAAO0F,2BAArB,EAAkDC,0BAAlD,EAA8E,EAA9E;AACA5J,cAAUiE,GAAV,CAAc,iBAAO4F,mBAArB,EAA0CC,mBAA1C,EAA+D,EAA/D;AACA9J,cAAUiE,GAAV,CAAc,iBAAO8F,SAArB,EAAgCC,UAAhC,EAA4C,EAA5C;AACAhK,cAAUiE,GAAV,CAAc,iBAAOgG,UAArB,EAAiCC,WAAjC,EAA8C,EAA9C;;AAEAvK,aAAS+K,mBAAT,CAA6B,kBAA7B,EAAiDF,kBAAjD;AACA7K,aAAS+K,mBAAT,CAA6B,qBAA7B,EAAoDF,kBAApD;AACA7K,aAAS+K,mBAAT,CAA6B,wBAA7B,EAAuDF,kBAAvD;AACA7K,aAAS+K,mBAAT,CAA6B,oBAA7B,EAAmDF,kBAAnD;AACA7K,aAAS+K,mBAAT,CAA6B,oBAA7B,EAAmDF,kBAAnD;AACD;;AAED,WAASA,kBAAT,GAA8B;AAC5B;AACAxK,cAAUoC,OAAV,CAAkB,iBAAOuI,iBAAzB;AACD;;AAED;AACA;AACA,WAAS/B,cAAT,GAA0B;AACxB,QAAI,CAACvH,wBAAL,EAA+B;AAC7BA,iCAA2B,IAA3B;AACAuJ;AACD;AACF;;AAED,WAAS9B,YAAT,GAAwB;AACtBtF,gBAAY,OAAZ;AACD;;AAED,WAASwF,cAAT,GAA0B,CAAE;;AAE5B,WAASE,cAAT,GAA0B;AACxB1F,gBAAY,SAAZ;AACD;;AAED,WAAS4F,aAAT,GAAyB;AACvB5F,gBAAY,QAAZ;AACD;;AAED,WAAS8F,aAAT,CAAuBuB,IAAvB,EAA6B;AAC3B,QAAIC,SAASD,KAAKC,MAAlB;;AAEAtL,aAASsL,MAAT,GAAkBA,MAAlB;AACA,YAAQA,OAAOxI,IAAf;AACE,WAAK,MAAL;AACA,WAAK,KAAL;AACEtC,kBAAUoC,OAAV,CAAkB,iBAAO2I,eAAzB,EAA0C;AACxCtJ,iBAAO5B;AADiC,SAA1C;AAGA;AACF,WAAK,IAAL;AACE,YAAImL,UAAU,2BAAYxL,QAAZ,EAAsBS,WAAtB,EAAd;AACA+K,gBAAQC,MAAR,CAAezL,SAASwC,QAAT,CAAkBW,GAAjC;AACA;AACF;AACE;AAZJ;AAcD;;AAED,WAAS6G,eAAT,GAA2B;AACzB7I,sBAAkBuK,SAAlB;AACD;;AAED,WAASxB,yBAAT,GAAqC;AACnC9I,wBAAoB0D,KAApB;AACD;;AAED,WAASsF,0BAAT,GAAsC;AACpC,QAAI,CAAChJ,oBAAoBgE,OAApB,EAAL,EAAoC;AAClChE,0BAAoBsD,IAApB;AACD;AACF;;AAED,WAAS4F,mBAAT,GAA+B;AAC7BxI,0BAAsB,IAAtB;AACAsJ;AACD;;AAED,WAASZ,UAAT,GAAsB;AACpBxG,gBAAY,QAAZ;AACD;;AAED,WAAS0G,WAAT,GAAuB;AACrB1G,gBAAY,SAAZ;AACD;;AAED,WAAS4G,eAAT,GAA2B;AACzBpJ,yBAAqB,IAArB;AACD;;AAED,WAASsJ,kBAAT,GAA8B;AAC5BtJ,yBAAqB,KAArB;AACD;AACD;;AAEA,WAAS4J,mBAAT,GAA+B;AAC7B,QAAIvJ,4BAA4BC,mBAAhC,EAAqD;AACnD;AACAkC,kBAAY,QAAZ;;AAEA,UAAIhE,SAASmC,GAAT,CAAawJ,QAAjB,EAA2B;AACzBjH;AACD;AACF;AACF;;AAED;AACA;AACA,WAASkH,cAAT,GAA0B;AACxBzK,sBAAkByK,cAAlB;AACD;;AAED,WAASpE,IAAT,GAAgB;AACdhH,cAAUoC,OAAV,CAAkB,iBAAOiJ,QAAzB;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACD;;AAED,WAASC,KAAT,GAAiB,CAAE;;AAEnB,WAASC,SAAT,GAAqB;AACnB,QAAI9J,QAAQ5B,MAAZ;AACAK,WAAO+B,GAAP,uBAA+B,qBAAWgB,QAAX,CAAoBxB,MAAM+J,QAA1B,CAA/B;AACAtL,WAAO+B,GAAP,sBAA8B,qBAAWgB,QAAX,CAAoBxB,MAAMgK,QAA1B,CAA9B;;AAEAlL,sBAAkBmL,WAAlB,CAA8B,GAA9B;;AAEA,QAAIC,IAAI,CAAR;AACA,QAAIC,IAAID,CAAR;AACD;;AAED,MAAIE,WAAW;AACbnK,UAAMA,IADO;AAEbI,YAAQA,MAFK;AAGbC,UAAMA,IAHO;AAIb0B,WAAOA,KAJM;AAKbK,QAAIA,EALS;AAMbG,SAAKA,GANQ;AAObC,UAAMA,IAPO;AAQbI,WAAOA,KARM;AASbC,cAAUA,QATG;AAUbC,iBAAaA,WAVA;AAWba,iBAAaA,WAXA;AAYbZ,iBAAaA,WAZA;AAabC,sBAAkBA,gBAbL;AAcbC,uBAAmBA,iBAdN;AAebC,aAASA,OAfI;AAgBbC,UAAMA,IAhBO;AAiBbC,YAAQA,MAjBK;AAkBbC,aAASA,OAlBI;AAmBbC,eAAWA,SAnBE;AAoBbE,eAAWA,SApBE;AAqBbC,2BAAuBA,qBArBV;AAsBb;AACAI,cAAUA,QAvBG;AAwBbE,eAAWA,SAxBE;AAyBbE,YAAQA,MAzBK;AA0BbmC,kBAAcA,YA1BD;AA2Bb;AACAK,4BAAwBA,sBA5BX;AA6Bb;AACAhE,YAAQA,MA9BK;AA+Bb;AACA2B,uBAAmBA,iBAhCN;AAiCbC,6BAAyBA,uBAjCZ;AAkCbC,yBAAqBA,mBAlCR;AAmCb;AACAC,kBAAcA,YApCD;AAqCb;AACAG,eAAWA,SAtCE;AAuCbE,cAAUA,QAvCG;AAwCbE,cAAUA,QAxCG;AAyCbC,cAAUA,QAzCG;AA0CbC,aAASA,OA1CI;AA2CbE,cAAUA,QA3CG;AA4CbC,eAAWA,SA5CE;AA6CbC,qBAAiBA,eA7CJ;AA8CbC,cAAUA,QA9CG;AA+Cb;AACAW,wBAAoBA,kBAhDP;AAiDb;AACAN,8BAA0BA,wBAlDb;AAmDb;AACAS,cAAUA,QApDG;AAqDb;AACAuD,oBAAgBA,cAtDH;AAuDbpE,UAAMA,IAvDO;AAwDbsE,WAAOA;AAxDM,GAAf;;AA2DA9J;;AAEA,SAAOqK,QAAP;AACD;;AAjxBD;AAixBC;;kBAEcvM,M;;;;;;;;;;;;AC3zBf;;;;AAEA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;;;AAEA,SAASwM,QAAT,CAAkBC,GAAlB,EAAuB;AACrBC,UAAQ/J,GAAR,CAAY,mBAAmB8J,GAA/B;AACD;;AAED;AACA,SAASE,YAAT,CAAsBC,SAAtB,EAAiC;AAC/BJ,WAAS,uBAAT;;AAEA,MAAItM,WAAW,EAAf;AACA,MAAIQ,kBAAJ;AACA,MAAIE,eAAJ;;AAEA,MAAIiM,aAAaD,SAAjB;AACA,MAAIE,gBAAgB,IAApB;AACA,MAAIC,mBAAmB,IAAvB;AACA,MAAIC,cAAc,IAAlB;AACA,MAAIC,aAAa,IAAjB;AACA,MAAIC,gBAAgB,IAApB;AACA,MAAIC,cAAc,IAAlB;AACA,MAAIC,mBAAmB,IAAvB;AACA,MAAIC,wBAAwB,IAA5B;AACA,MAAIC,cAAc,IAAlB;AACA,MAAIC,2BAA2B,IAA/B;AACA,MAAIC,eAAe,IAAnB;AACA,MAAIC,aAAa,EAAjB;AACA,MAAIC,UAAU,IAAd;AACA,MAAIC,eAAe,IAAnB;;AAEA,MAAIC,kBAAJ;AACA,MAAIC,oBAAJ;;AAEA,WAAS3L,KAAT,GAAiB;AACf;AACAxB,gBAAY,wBAASR,QAAT,EAAmBS,WAAnB,EAAZ;AACAC,aAAS,qBAAMV,QAAN,EAAgBS,WAAhB,EAAT;;AAEAuI,SAAK4E,MAAL,CAAYC,GAAZ,CAAgBC,cAAhB,CAA+B9E,KAAK4E,MAAL,CAAYC,GAAZ,CAAgBE,WAAhB,CAA4BC,KAA3D;AACAhF,SAAKiF,QAAL,CAAcC,MAAd,CAAqBC,aAArB,CAAmCnF,KAAKiF,QAAL,CAAcF,WAAd,CAA0BC,KAA7D;;AAEA;AACAnB,uBAAmB7D,KAAKiF,QAAL,CAAcG,mBAAd,CAAkC3N,WAAlC,EAAnB;AACAoM,qBAAiBwB,OAAjB,GAA2BC,QAA3B;AACAzB,qBAAiB0B,oBAAjB,GAAwCC,qBAAxC;AACA3B,qBAAiB4B,mBAAjB,GAAuCC,oBAAvC;;AAEA;AACApC,aAAS,0CAA0C,qBAAUqC,yBAA7D;AACArC,aAAS,yCAAyC,qBAAUsC,wBAA5D;;AAEA7B,iBAAaF,iBAAiBgC,iBAAjB,CACX,qBAAUD,wBADC,CAAb;AAEA7B,eAAW+B,SAAX,GAAuBC,gBAAvB;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACD;;AAED,WAASC,UAAT,GAAsB;AACpBtB,gBAAY,IAAIzN,OAAOH,MAAX,CAAkB6M,UAAlB,CAAZ;AACAgB,kBAAc,IAAI1N,OAAOgP,QAAX,CAAoBvB,SAApB,CAAd;AACAC,gBAAYuB,WAAZ;;AAEAxB,cAAUpJ,EAAV,CAAa,iBAAOD,YAApB,EAAkC8K,aAAlC;AACAzB,cAAUpJ,EAAV,CAAa,iBAAO8K,gBAApB,EAAsCC,kBAAtC;AACA3B,cAAUpJ,EAAV,CAAa,iBAAOmF,aAApB,EAAmCC,cAAnC;AACAgE,cAAUpJ,EAAV,CAAa,iBAAOqF,YAApB,EAAkCC,aAAlC;AACA8D,cAAUpJ,EAAV,CAAa,iBAAOgL,aAApB,EAAmCC,cAAnC;AACA7B,cAAUpJ,EAAV,CAAa,iBAAOkL,YAApB,EAAkCC,aAAlC;AACA/B,cAAUpJ,EAAV,CAAa,iBAAOoL,oBAApB,EAA0CC,oBAA1C;AACD;;AAED;AACA,WAASC,eAAT,GAA2B;AACzB,WAAOhD,aAAP;AACD;;AAED,WAASiD,eAAT,GAA2B;AACzB,WAAO7C,aAAP;AACD;;AAED,WAAS8C,SAAT,GAAqB;AACnB,WAAOtC,OAAP;AACD;;AAED,WAASc,QAAT,GAAoB;AAClBhC,aAAS,SAAT;AACAmB,mBAAe,IAAf;AACD;;AAED,WAASe,qBAAT,CAA+BuB,KAA/B,EAAsC;AACpCzD,aAAS,sBAAT;AACA;AACA;AACA,QAAIO,iBAAiBmD,UAAjB,GAA8B1M,MAA9B,KAAyC,CAAzC,IACFyM,MAAME,MAAN,KACAjH,KAAKiF,QAAL,CAAciC,MAAd,CAAqBC,gBAArB,CAAsCC,mBAFxC,EAE6D;AAC3DvD,uBAAiBwD,IAAjB;AACD;AACF;;AAED,WAASlB,aAAT,CAAuBmB,CAAvB,EAA0B;AACxB,QAAIlM,WAAWkM,EAAElM,QAAjB;AACA,QAAIA,aAAa,QAAjB,EAA2B;AACzBkM,QAAEC,QAAF,GAAa7C,UAAU1I,WAAV,EAAb;AACAsL,QAAEE,QAAF,GAAa9C,UAAUzI,WAAV,EAAb;AACAqL,QAAE7K,MAAF,GAAWiI,UAAUhI,SAAV,EAAX;AACA4K,QAAEG,KAAF,GAAU/C,UAAUnI,OAAV,EAAV;AACA+K,QAAEI,MAAF,GAAWhD,UAAU3I,QAAV,EAAX;AACD;AACD4L,iBAAa;AACX7N,YAAM,iBAAOuB,YADF;AAEXgH,YAAMiF;AAFK,KAAb,EAGGvD,UAHH;AAID;;AAED,WAASsC,kBAAT,GAA8B;AAC5B,QAAIkB,WAAW7C,UAAU1I,WAAV,EAAf;AACA,QAAIwL,WAAW9C,UAAUzI,WAAV,EAAf;;AAEAqH,4BAAsBiE,QAAtB,oBAA6CC,QAA7C;AACA;AACAG,iBAAa;AACX7N,YAAM,iBAAOsM,gBADF;AAEX/D,YAAM;AACJkF,kBAAUA,QADN;AAEJC,kBAAUA;AAFN;AAFK,KAAb,EAMGzD,UANH;AAOD;;AAED,WAASrD,cAAT,GAA0B;AACxBiH,iBAAa;AACX7N,YAAM,iBAAO2G;AADF,KAAb,EAEGsD,UAFH;AAGD;;AAED,WAASnD,aAAT,GAAyB;AACvB+G,iBAAa;AACX7N,YAAM,iBAAO6G;AADF,KAAb,EAEGoD,UAFH;AAGD;;AAED,WAASwC,cAAT,GAA0B;AACxB,QAAIgB,WAAW7C,UAAU1I,WAAV,EAAf;AACA,QAAIwL,WAAW9C,UAAUzI,WAAV,EAAf;;AAEA0L,iBAAa;AACX7N,YAAM,iBAAOwM,aADF;AAEXjE,YAAM;AACJkF,kBAAUA,QADN;AAEJC,kBAAUA;AAFN;AAFK,KAAb,EAMGzD,UANH;AAOD;;AAED,WAAS0C,aAAT,GAAyB;AACvB,QAAIc,WAAW7C,UAAU1I,WAAV,EAAf;AACA,QAAIwL,WAAW9C,UAAUzI,WAAV,EAAf;;AAEA0L,iBAAa;AACX7N,YAAM,iBAAO0M,YADF;AAEXnE,YAAM;AACJkF,kBAAUA,QADN;AAEJC,kBAAUA;AAFN;AAFK,KAAb,EAMGzD,UANH;AAOD;;AAED,WAAS4C,oBAAT,GAAgC;AAC9B,QAAIc,QAAQ/C,UAAUnI,OAAV,EAAZ;AACA,QAAIE,SAASiI,UAAUhI,SAAV,EAAb;AACAiL,iBAAa;AACX7N,YAAM,iBAAO4M,oBADF;AAEXrE,YAAM;AACJoF,eAAOA,KADH;AAEJhL,gBAAQA;AAFJ;AAFK,KAAb,EAMGsH,UANH;AAOD;;AAED,WAAS6D,YAAT,GAAwB;AACtBtE,aAAS,aAAT;AACD;;AAED,WAASuE,UAAT,GAAsB;AACpBvE,aAAS,WAAT;AACD;;AAED,WAASoC,oBAAT,CAA8BqB,KAA9B,EAAqC;AACnCzD,aAAS,qBAAT;AACA;AACA;AACA;AACA;AACD;;AAED,WAASwE,iBAAT,CAA2Bf,KAA3B,EAAkC;AAChCzD,aAAS,+BAA+ByD,MAAMjN,IAArC,GAA4C,cAA5C,GAA6DiN,MAAMgB,QAA5E;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,YAAQhB,MAAM1E,IAAN,CAAWvI,IAAnB;AACE,WAAK,MAAL;AACE;AACE8J,wBAAclI,IAAd;AACD;AACD;AACF,WAAK,OAAL;AACE;AACEkI,wBAAc9H,KAAd;AACD;AACD;AACF,WAAK,MAAL;AACE;AACE,cAAIkM,YAAYjB,MAAM1E,IAAN,CAAWpJ,KAA3B;AACA,cAAIgP,YAAYD,UAAU,WAAV,CAAhB;AACA,cAAIE,cAAcD,SAAlB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD;AACD;AACF;AACE;AApCJ;AAsCD;;AAED,WAASlC,gBAAT,CAA0BgB,KAA1B,EAAiC;AAC/B,QAAIoB,UAAU,qBAAUC,WAAV,CAAsBrB,MAAM1E,IAA5B,CAAd;AACA,QAAIA,OAAO8F,QAAQ9F,IAAnB;AACAiB,aAAS,mCAAmCyD,MAAM1E,IAAlD;AACAiB,aAAS,gCAAgC6E,OAAzC;;AAEA,QAAIA,QAAQE,OAAR,KAAoB,MAAxB,EAAgC;AAC9BrC,iBAAW3D,IAAX;AACA;AACAqC,gBAAUxL,IAAV,CAAemJ,IAAf;AACD,KAJD,MAIO,IAAI8F,QAAQE,OAAR,KAAoB,MAAxB,EAAgC;AACrC3D,gBAAUnL,IAAV,CAAe4O,OAAf;AACD,KAFM,MAEA,IAAIA,QAAQE,OAAR,KAAoB,KAAxB,EAA+B;AACpC3D,gBAAU9B,cAAV;AACD,KAFM,MAEA,IAAIuF,QAAQE,OAAR,KAAoB,MAAxB,EAAgC;AACrC3D,gBAAUhJ,IAAV;AACD,KAFM,MAEA,IAAIyM,QAAQE,OAAR,KAAoB,OAAxB,EAAiC;AACtC3D,gBAAU5I,KAAV;AACD,KAFM,MAEA,IAAIqM,QAAQE,OAAR,KAAoB,QAAxB,EAAkC;AACvC3D,gBAAU/I,MAAV;AACD,KAFM,MAEA,IAAIwM,QAAQE,OAAR,KAAoB,aAAxB,EAAuC;AAC5C3D,gBAAU7H,WAAV,CAAsBwF,KAAKkF,QAA3B;AACD,KAFM,MAEA,IAAIY,QAAQE,OAAR,KAAoB,WAAxB,EAAqC;AAC1C3D,gBAAUlI,SAAV,CAAoB6F,KAAK5F,MAAzB;AACD,KAFM,MAEA,IAAI0L,QAAQE,OAAR,KAAoB,MAAxB,EAAgC;AACrC3D,gBAAUrI,IAAV;AACD,KAFM,MAEA,IAAI8L,QAAQE,OAAR,KAAoB,QAAxB,EAAkC;AACvC3D,gBAAUpI,MAAV;AACD,KAFM,MAEA,IAAI6L,QAAQE,OAAR,KAAoB,MAAxB,EAAgC;AACrC3D,gBAAUlG,IAAV;AACA;AACA;AACA;AACA;AACD;AACD;AACD;;AAED,WAASmJ,YAAT,CAAsBQ,OAAtB,EAA+BG,GAA/B,EAAoCC,YAApC,EAAkD;AAChD;AACA,QAAI,CAAC9D,YAAL,EAAmB;AACjB;AACD;;AAED,QAAI+D,aAAa,qBAAUC,SAAV,CAAoBN,OAApB,CAAjB;AACA,QAAII,YAAJ,EAAkB;AAChBD,UAAII,cAAJ,CAAmBH,YAAnB,EAAiCI,IAAjC,CAAsCH,UAAtC;AACD,KAFD,MAEO;AACLF,UAAIM,SAAJ,CAAcJ,UAAd;AACD;AACF;;AAED;AACA;AACA,WAASK,OAAT,CAAiB9B,KAAjB,EAAwB;AACtBzD,aAAS,SAAT;;AAEA,QAAIkB,OAAJ,EAAa;AACXA,cAAQsE,MAAR;AACAtE,gBAAU,IAAV;AACD;;AAED,QAAIuE,OAAO,IAAI/I,KAAKiF,QAAL,CAAc+D,YAAd,CAA2BC,QAA/B,CAAwClC,MAAM1E,IAA9C,EAAoD0E,MAAMgB,QAA1D,CAAX;;AAEA,QAAI5N,MAAM4O,KAAKZ,OAAL,CAAalP,KAAb,CAAmBgP,SAA7B;AACA,QAAIiB,eAAeC,qBAAqBJ,KAAKZ,OAAL,CAAalP,KAAlC,CAAnB;AACA,QAAImQ,OAAO,IAAIpJ,KAAK4E,MAAL,CAAYC,GAAZ,CAAgBwE,IAApB,CAAyB;AAClC,aAAOlP,GAD2B;AAElC,sBAAgByJ;AAFkB,KAAzB,CAAX;AAIAY,cAAU,IAAIxE,KAAK4E,MAAL,CAAYC,GAAZ,CAAgB/N,MAApB,CAA2BsS,IAA3B,CAAV;AACA5E,YAAQ8E,IAAR,CAAaJ,aAAaE,IAAb,CAAb;AACD;;AAED,WAASG,YAAT,CAAsBxC,KAAtB,EAA6B;AAC3BzD,aAAS,cAAT,EAAyByD,KAAzB;AACD;;AAED,WAASyC,iBAAT,CAA2BT,IAA3B,EAAiC;AAC/B,QAAIU,YAAY7F,cAAc4D,QAA9B;;AAEAlE,aAAS,uBAAuB,cAAvB,GAAwCmG,SAAjD;AACAtF,0BAAsB4E,IAAtB;AACD;;AAED,WAASW,oBAAT,CAA8B3C,KAA9B,EAAqC;AACnCzD,aAAS,sBAAT;AACAe,6BAAyB0C,KAAzB;AACD;;AAED;AACA;AACA,WAASoC,oBAAT,CAA8BQ,gBAA9B,EAAgD;AAC9C,QAAIxP,MAAMwP,iBAAiB1B,SAA3B;AACA,QAAInO,OAAO6P,iBAAiBC,WAAjB,IAAgC,EAA3C;AACA,QAAIC,OAAOC,SAAS3P,GAAT,KAAiB,EAA5B;AACA,QAAI4P,cAAcF,IAAd,MAAwB,MAAxB,IACF/P,SAAS,uBADP,IAEFA,SAAS,+BAFX,EAE4C;AAC1C,aAAOkG,KAAK4E,MAAL,CAAYC,GAAZ,CAAgBmF,0BAAvB;AACD,KAJD,MAIO,IAAID,cAAcF,IAAd,MAAwB,KAAxB,IACT/P,SAAS,sBADJ,EAC4B;AACjC,aAAOkG,KAAK4E,MAAL,CAAYC,GAAZ,CAAgBoF,2BAAvB;AACD,KAHM,MAGA,IAAIJ,KAAKK,OAAL,CAAa,MAAb,IAAuB,CAAC,CAAxB,IACTpQ,SAAS,6BADJ,EACmC;AACxC,aAAOkG,KAAK4E,MAAL,CAAYC,GAAZ,CAAgBsF,6BAAvB;AACD;AACD,WAAO,IAAP;AACD;;AAED,WAASC,eAAT,CAAyBC,GAAzB,EAA8B;AAC5BA,UAAMC,KAAKC,KAAL,CAAWF,GAAX,CAAN;;AAEA,aAASG,KAAT,CAAeC,CAAf,EAAkB;AAChB,aAAO,CAAC,OAAOH,KAAKI,KAAL,CAAWD,CAAX,CAAR,EAAuBE,KAAvB,CAA6B,CAAC,CAA9B,CAAP;AACD;AACD,QAAIC,KAAKN,KAAKC,KAAL,CAAWF,MAAM,IAAjB,CAAT;AACA,QAAIQ,MAAMP,KAAKC,KAAL,CAAWF,MAAM,EAAjB,IAAuB,EAAjC;AACA,QAAIS,MAAMT,MAAM,EAAhB;AACA,QAAI,CAACO,EAAL,EAAS;AACP,aAAOJ,MAAMK,GAAN,IAAa,GAAb,GAAmBL,MAAMM,GAAN,CAA1B;AACD,KAFD,MAEO;AACL,aAAON,MAAMI,EAAN,IAAY,GAAZ,GAAkBJ,MAAMK,GAAN,CAAlB,GAA+B,GAA/B,GAAqCL,MAAMM,GAAN,CAA5C;AACD;AACF;;AAED;;;;;;;AAOA,WAASf,aAAT,CAAuB5P,GAAvB,EAA4B;AAC1B,QAAI4Q,QAAQ5Q,IAAI6Q,KAAJ,CAAU,GAAV,CAAZ;AACA;AACA,QAAID,MAAMzQ,MAAN,KAAiB,CAAjB,IAAuByQ,MAAM,CAAN,MAAa,EAAb,IAAmBA,MAAMzQ,MAAN,KAAiB,CAA/D,EAAmE;AACjE,aAAO,EAAP;AACD;AACD,WAAOyQ,MAAME,GAAN,GAAYC,WAAZ,EAAP;AACD;;AAED;;;;;;;AAOA,WAASpB,QAAT,CAAkB3P,GAAlB,EAAuB;AACrB,QAAIgR,OAAOhU,SAASiU,aAAT,CAAuB,GAAvB,CAAX;AACAD,SAAKA,IAAL,GAAYhR,GAAZ;AACA,WAAOgR,KAAKE,QAAL,IAAiB,EAAxB;AACD;;AAED,WAASC,KAAT,GAAiB;AACfzH,qBAAiByH,KAAjB;AACD;;AAED,WAASvJ,gBAAT,CAA0BwJ,EAA1B,EAA8BC,EAA9B,EAAkC;AAChCjH,eAAWgH,EAAX,IAAiBC,EAAjB;AACD;;AAED,MAAInI,WAAW;AACbiI,WAAOA,KADM;AAEbvJ,sBAAkBA;AAFL,GAAf;AAIA/I;AACA,SAAOqK,QAAP;AACD;;kBAEcI,Y;;;;;;;;;;;;AChdf;;;;AAEA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA;AACA;AACA,SAASgI,mBAAT,GAA+B;AAC7B,WAASvS,IAAT,CAAcwS,YAAd,EAA4BC,sBAA5B,EAAoD;AAClDD,mBAAeA,YAAf;AACAC,6BAAyBA,sBAAzB;;AAEAA,2BAAuB5J,gBAAvB,CACE/B,KAAK4L,SAAL,CAAeC,qBAAf,CAAqCC,gBADvC,EAEE,YAAW;AACTtI,cAAQ/J,GAAR,CAAY,YAAYiS,aAAanP,OAArC;AACD,KAJH;;AAMAoP,2BAAuB5J,gBAAvB,CACE/B,KAAK4L,SAAL,CAAeC,qBAAf,CAAqCE,oBADvC,EAEE,YAAW;AACT,UAAIC,YAAYN,aAAaO,WAA7B;AACAzI,cAAQ/J,GAAR,CAAY,mBAAmBuS,SAA/B;AACD,KALH;AAMD;;AAED,WAAStQ,IAAT,GAAgB;AACd,QAAIgQ,aAAa3P,QAAjB,EAA2B;AACzB4P,6BAAuBO,WAAvB;AACD;AACF;;AAED,WAASpQ,KAAT,GAAiB;AACf,QAAI,CAAC4P,aAAa3P,QAAlB,EAA4B;AAC1B4P,6BAAuBO,WAAvB;AACD;AACF;;AAED,WAAS1P,SAAT,CAAmBC,MAAnB,EAA2B;AACzBiP,iBAAaO,WAAb,GAA2BxP,MAA3B;AACAkP,2BAAuBQ,cAAvB;;AAEA;AACA;AACD;;AAED,WAASzP,SAAT,GAAqB;AACnB,WAAOgP,aAAaO,WAApB;AACD;;AAED,WAASG,IAAT,CAAc1O,IAAd,EAAoB;AAClBgO,iBAAaW,WAAb,GAA2B3O,IAA3B;AACAiO,2BAAuBS,IAAvB;AACD;;AAED,WAAS/E,IAAT,GAAgB;AACdsE,2BAAuBtE,IAAvB;AACD;;AAED,MAAIhE,WAAW;AACbnK,UAAMA,IADO;AAEbwC,UAAMA,IAFO;AAGbI,WAAOA,KAHM;AAIbU,eAAWA,SAJE;AAKbE,eAAWA,SALE;AAMb0P,UAAMA,IANO;AAOb/E,UAAMA;AAPO,GAAf;AASA,SAAOhE,QAAP;AACD;;AAED;AACA;AACA,SAASiJ,UAAT,CAAoBC,aAApB,EAAmC;AACjC,MAAIvV,WAAW,KAAKwV,OAApB;AACA,MAAIC,iBAAiBF,aAArB;AACA,MAAI/U,YAAY,wBAASR,QAAT,EAAmBS,WAAnB,EAAhB;AACA,MAAIC,SAAS,qBAAMV,QAAN,EAAgBS,WAAhB,EAAb;;AAEA,MAAIiU,eAAe,IAAnB;AACA,MAAIC,yBAAyB,IAA7B;AACA,MAAIe,eAAe,IAAnB;AACA,MAAIC,WAAW,IAAf;;AAEA,MAAIC,sBAAsB,IAAInB,mBAAJ,EAA1B;;AAEA;AACA,MAAIoB,kBAAJ;AACA,MAAIC,kBAAJ;AACA,MAAIC,gBAAJ;AACA,MAAIC,eAAJ;AACA,MAAIC,gBAAJ;;AAEA,WAASjU,KAAT,GAAiB;AACfwK,YAAQ/J,GAAR,CAAY,aAAZ;;AAEA,QAAIyT,UAAU,EAAd;;AAEA;AACA;AACA;AACAA,YAAQC,qBAAR,GAAgCZ,aAAhC;;AAEA;AACA;AACA;AACA;AACA;AACAG,mBAAe1M,KAAK4L,SAAL,CAAewB,WAAf,CAA2B3V,WAA3B,EAAf;AACAiV,iBAAaW,UAAb,CAAwBH,OAAxB;;AAEAR,iBAAa3K,gBAAb,CAA8B/B,KAAK4L,SAAL,CAAe0B,oBAAf,CAAoCC,kBAAlE,EACE,UAASjG,CAAT,EAAY;AACV;AACD,KAHH;;AAMAoF,iBAAa3K,gBAAb,CACE/B,KAAK4L,SAAL,CAAe0B,oBAAf,CAAoCE,qBADtC,EAEE,UAASzG,KAAT,EAAgB;AACdvD,cAAQ/J,GAAR,CAAY,yBAAyBsN,MAAM0G,YAA3C;AACA,cAAQ1G,MAAM0G,YAAd;AACE,aAAKzN,KAAK4L,SAAL,CAAe8B,YAAf,CAA4BC,eAAjC;AACA,aAAK3N,KAAK4L,SAAL,CAAe8B,YAAf,CAA4BE,eAAjC;AACE;AACF,aAAK5N,KAAK4L,SAAL,CAAe8B,YAAf,CAA4BG,aAAjC;AACE;AACA;AACA;AAPJ;AASD,KAbH;;AAeAnC,mBAAe,IAAI1L,KAAK4L,SAAL,CAAekC,YAAnB,EAAf;AACAnC,6BAAyB,IAAI3L,KAAK4L,SAAL,CAAemC,sBAAnB,CAA0CrC,YAA1C,CAAzB;AACAC,2BAAuB5J,gBAAvB,CACE/B,KAAK4L,SAAL,CAAeC,qBAAf,CAAqCmC,oBADvC,EAEEC,kBAFF;AAGAtC,2BAAuB5J,gBAAvB,CACE/B,KAAK4L,SAAL,CAAeC,qBAAf,CAAqCqC,uBADvC,EAEEC,oBAFF;;AAIA;AACAvB,wBAAoB1T,IAApB,CAAyBwS,YAAzB,EAAuCC,sBAAvC;AACD;;AAED,WAASsC,kBAAT,GAA8B;AAC5BzK,YAAQ/J,GAAR,CAAY,0DAA0DiS,aAAa0C,WAAnF;;AAEAzB,eAAW3M,KAAK4L,SAAL,CAAewB,WAAf,CAA2B3V,WAA3B,GAAyC4W,iBAAzC,EAAX;AACA,QAAI1B,QAAJ,EAAc;AACZ;AACA,UAAI2B,UAAU3B,SAAS4B,aAAT,EAAd;AACA;AACA5B,eAAS6B,kBAAT,CAA4B,qBAAU5I,wBAAtC,EACE6I,kBADF;AAED,KAND,MAMO;AACLjL,cAAQ/J,GAAR,CAAY,wBAAZ;AACD;;AAED;AACA,QAAIiS,aAAa0C,WAAjB,EAA8B;AAC5B5W,gBAAUoC,OAAV,CAAkB,iBAAO+H,cAAzB;AACD,KAFD,MAEO;AACLnK,gBAAUoC,OAAV,CAAkB,iBAAOiI,iBAAzB;AACD;AACF;;AAED,WAASsM,oBAAT,GAAgC;AAC9B3K,YAAQ/J,GAAR,CAAY,0BAAZ;AACD;;AAED,WAASiV,mBAAT,GAA+B;AAC7BlL,YAAQ/J,GAAR,CAAY,yBAAZ;AACD;;AAED,WAASkV,iBAAT,GAA6B;AAC3BnL,YAAQ/J,GAAR,CAAY,uBAAZ;AACD;;AAED,WAASP,IAAT,CAAcC,GAAd,EAAmB;AACjB,QAAIoK,MAAM;AACR8E,eAAS,MADD;AAERhG,YAAMlJ;AAFE,KAAV;AAIAwO,iBAAapE,GAAb;AACD;;AAED,WAAShK,IAAT,CAAc4O,OAAd,EAAuB;AACrBA,YAAQE,OAAR,GAAkB,MAAlB;AACAV,iBAAaQ,OAAb;AACD;;AAED,WAAShK,GAAT,GAAe;AACb,QAAIoF,MAAM;AACR,iBAAW;AADH,KAAV;AAGAoE,iBAAapE,GAAb;AACD;;AAED,WAAS7H,IAAT,GAAgB;AACd,QAAI6H,MAAM;AACR,iBAAW;AADH,KAAV;AAGAoE,iBAAapE,GAAb;AACD;;AAED,WAASzH,KAAT,GAAiB;AACf,QAAIyH,MAAM;AACR,iBAAW;AADH,KAAV;AAGAoE,iBAAapE,GAAb;AACD;;AAED,WAASxH,QAAT,GAAoB;AAClB,WAAOgR,OAAP;AACD;;AAED,WAASlQ,WAAT,CAAqBC,GAArB,EAA0B;AACxB,QAAIyG,MAAM;AACR8E,eAAS,aADD;AAERhG,YAAM;AACJkF,kBAAUzK;AADN;AAFE,KAAV;AAMA6K,iBAAapE,GAAb;AACD;;AAED,WAASvH,WAAT,GAAuB;AACrB,WAAO6Q,SAAP;AACD;;AAED,WAAS5Q,WAAT,GAAuB;AACrB,WAAO6Q,SAAP;AACD;;AAED,WAAStQ,SAAT,CAAmBC,MAAnB,EAA2B;AACzB,QAAI8G,MAAM;AACR8E,eAAS,WADD;AAERhG,YAAM;AACJ5F,gBAAQA;AADJ;AAFE,KAAV;AAMAkL,iBAAapE,GAAb;;AAEA;AACA;AACD;;AAED,WAAS7G,SAAT,GAAqB;AACnB,WAAOuQ,OAAP;AACD;;AAED,WAAS5Q,IAAT,GAAgB;AACd,QAAIkH,MAAM;AACR8E,eAAS;AADD,KAAV;AAGAV,iBAAapE,GAAb;AACD;;AAED,WAASjH,MAAT,GAAkB;AAChB,QAAIiH,MAAM;AACR8E,eAAS;AADD,KAAV;AAGAV,iBAAapE,GAAb;AACD;;AAED,WAAShH,OAAT,GAAmB;AACjB,WAAOyQ,MAAP;AACD;;AAED;AACA,WAASnP,cAAT,GAA0B;AACxB,QAAI,CAAC6O,YAAL,EAAmB;AACjBlJ,cAAQoL,IAAR,CAAa,mCAAb;AACA;AACD;;AAEDlC,iBAAa7O,cAAb;AACD;;AAED,WAASgR,UAAT,GAAsB;AACpB,QAAI,CAACnC,YAAL,EAAmB;AACjB;AACD;;AAED,QAAIoC,cAAcpC,aAAa2B,iBAAb,EAAlB;AACA;AACA;AACAS,gBAAYD,UAAZ,CAAuB,IAAvB;AACD;;AAED,MAAIE,MAAM,CAAV;;AAEA,WAASvQ,IAAT,GAAgB;AACd;AACAmO,aAASqC,WAAT,CAAqB,qBAAUpJ,wBAA/B,EACEmJ,IAAItU,QAAJ,EADF,EAEE,YAAW,CAAE,CAFf,EAEiB;AACf,gBAAW,CAAE,CAHf,EAFc,CAKI;AAClBsU;AACArT;AACA;AACA;AACA;AACA;AACD;;AAED,WAASuT,SAAT,CAAmB9U,GAAnB,EAAwBL,IAAxB,EAA8B;AAC5B0J,YAAQ/J,GAAR,CAAY,YAAZ;;AAEA,QAAIuG,QAAQA,KAAK4L,SAAb,IAA0BF,aAAa0C,WAA3C,EAAwD;AACtD,UAAIpG,YAAY,IAAIkH,OAAOlP,IAAP,CAAY/G,KAAZ,CAAkBkW,SAAtB,CAAgChV,GAAhC,EAAqCL,IAArC,CAAhB;;AAEAkO,gBAAUoH,QAAV,GAAqB,IAAIF,OAAOlP,IAAP,CAAY/G,KAAZ,CAAkBoW,oBAAtB,EAArB;AACArH,gBAAUoH,QAAV,CAAmBE,YAAnB,GAAkCJ,OAAOlP,IAAP,CAAY/G,KAAZ,CAAkBsW,YAAlB,CAA+BC,OAAjE;;AAEA,UAAIC,UAAU,IAAIP,OAAOlP,IAAP,CAAY/G,KAAZ,CAAkByW,WAAtB,CAAkC1H,SAAlC,CAAd;;AAEA;AACA;;AAEA2E,eAASsC,SAAT,CAAmBQ,OAAnB,EAA4Bf,mBAA5B,EAAiDC,iBAAjD;AACD,KAZD,MAYO;AACLjD,qBAAe,IAAf;AACAC,+BAAyB,IAAzB;AACD;;AAEDnI,YAAQ/J,GAAR,CAAY,YAAZ;AACD;;AAED,WAASgV,kBAAT,CAA4BkB,SAA5B,EAAuCnH,UAAvC,EAAmD;AACjD,QAAIL,UAAU,qBAAUC,WAAV,CAAsBI,UAAtB,CAAd;AACA,QAAIlB,IAAIa,QAAQ9F,IAAR,IAAgB,EAAxB;AACAiF,MAAEsI,IAAF,GAAS,YAAT;;AAEApM,YAAQ/J,GAAR,CAAY,6BAA6BkW,SAA7B,GAAyC,gBAAzC,GAA4DnH,UAA5D,GAAyE,UAAzE,GAAsFL,QAAQrO,IAA1G;AACA,YAAQqO,QAAQrO,IAAhB;AACE,WAAK,iBAAOuB,YAAZ;AACE,YAAIiM,EAAElM,QAAF,KAAe,QAAnB,EAA6B;AAC3B;AACAyR,sBAAYvF,EAAEC,QAAd;AACAuF,sBAAYxF,EAAEE,QAAd;AACAwF,mBAAS1F,EAAEG,KAAX;AACAwF,oBAAU3F,EAAE7K,MAAZ;AACAsQ,oBAAUzF,EAAEI,MAAZ;AACD;AACD;AACA;AACF,WAAK,iBAAOtB,gBAAZ;AACEyG,oBAAYvF,EAAEC,QAAd;AACAuF,oBAAYxF,EAAEE,QAAd;AACAhQ,kBAAUoC,OAAV,CAAkB,iBAAOwM,gBAAzB;AACA5C,gBAAQ/J,GAAR,kBAA2B0O,QAAQ9F,IAAR,CAAakF,QAAxC,SAAoDY,QAAQ9F,IAAR,CAAamF,QAAjE;AACA;AACF,WAAK,iBAAO/G,aAAZ;AACEsM,kBAAU,KAAV;AACAvV,kBAAUoC,OAAV,CAAkB,iBAAO6G,aAAzB;AACA;AACF,WAAK,iBAAOE,YAAZ;AACEoM,kBAAU,IAAV;AACAvV,kBAAUoC,OAAV,CAAkB,iBAAO+G,YAAzB;AACA;AACF,WAAK,iBAAO2F,aAAZ;AACEuG,oBAAYvF,EAAEC,QAAd;AACAuF,oBAAYxF,EAAEE,QAAd;AACAhQ,kBAAUoC,OAAV,CAAkB,iBAAO0M,aAAzB;AACA;AACF,WAAK,iBAAOE,YAAZ;AACEqG,oBAAYvF,EAAEC,QAAd;AACAuF,oBAAYxF,EAAEE,QAAd;AACAhQ,kBAAUoC,OAAV,CAAkB,iBAAO4M,YAAzB;AACA;AACF,WAAK,iBAAOE,oBAAZ;AACEsG,iBAAS1F,EAAEG,KAAX;AACAwF,kBAAU3F,EAAE7K,MAAZ;AACAjF,kBAAUoC,OAAV,CAAkB,iBAAO8M,oBAAzB;AACA;AACF;AACE;AA1CJ;AA4CD;;AAED,WAASmJ,QAAT,GAAoB;AAClBjD,wBAAoBlR,IAApB;AACD;;AAED,WAASoU,SAAT,GAAqB;AACnBlD,wBAAoB9Q,KAApB;AACD;;AAED,WAASiU,SAAT,GAAqB;AACnB,QAAItT,SAASgP,oBAAoB/O,SAApB,KAAkC,GAA/C;;AAEAkQ,wBAAoBpQ,SAApB,CAA8BC,MAA9B;AACD;;AAED,WAASuT,SAAT,CAAmBvT,MAAnB,EAA2B;AACzB,QAAIA,SAASgP,oBAAoB/O,SAApB,KAAkC,GAA/C;AACAkQ,wBAAoBpQ,SAApB,CAA8BC,MAA9B;AACD;;AAED,WAAS2R,WAAT,GAAuB;AACrB,WAAO1C,gBAAgBA,aAAa0C,WAApC;AACD;;AAED,WAAShC,IAAT,CAAc1O,IAAd,EAAoB;AAClBkP,wBAAoBR,IAApB,CAAyB6D,WAAWvS,IAAX,CAAzB;AACD;;AAED,WAAS2J,IAAT,GAAgB;AACduF,wBAAoBvF,IAApB;AACD;;AAED,WAAStE,SAAT,GAAqB;AACnBS,YAAQ/J,GAAR,CAAY,yBAAyBiS,aAAaW,WAAlD;AACA,QAAIX,aAAawE,gBAAjB,EAAmC;AACjC1M,cAAQ/J,GAAR,CAAY,gDAAgDiS,aAAawE,gBAAb,CAA8B7D,WAA1F;AACD;AACF;;AAED,WAAS8D,WAAT,CAAqBC,UAArB,EAAiCC,UAAjC,EAA6C;AAC3C,QAAIC,OAAOC,MAAMC,SAAN,CAAgB7F,KAAhB,CAAsB8F,IAAtB,CAA2BC,SAA3B,EAAsC,CAAtC,CAAX;AACA/I,iBAAa;AACX,cAAQ,MADG;AAEX,oBAAcyI,UAFH;AAGX,oBAAcC,UAHH;AAIX,cAAQC;AAJG,KAAb;AAMD;;AAED,WAAS3I,YAAT,CAAsBQ,OAAtB,EAA+B;AAC7B,QAAIK,aAAa,qBAAUC,SAAV,CAAoBN,OAApB,CAAjB;AACA3E,YAAQ/J,GAAR,CAAY,eAAe+O,UAA3B;AACA;AACAmE,aAASqC,WAAT,CACE,qBAAUpJ,wBADZ,EAEE4C,UAFF,EAGE,YAAW,CAAE,CAHf,EAGiB;AACf,gBAAW,CAAE,CAJf,EAJ6B,CAQX;AACnB;;AAED,MAAInF,WAAW;AACb;AACAxF,oBAAgBA,cAFH;AAGbgR,gBAAYA,UAHC;AAIb3V,UAAMA,IAJO;AAKbK,UAAMA,IALO;AAMb4E,SAAKA,GANQ;AAObzC,UAAMA,IAPO;AAQbI,WAAOA,KARM;AASbC,cAAUA,QATG;AAUbc,iBAAaA,WAVA;AAWbb,iBAAaA,WAXA;AAYbC,iBAAaA,WAZA;AAabO,eAAWA,SAbE;AAcbE,eAAWA,SAdE;AAebL,UAAMA,IAfO;AAgBbC,YAAQA,MAhBK;AAiBbC,aAASA,OAjBI;AAkBbiC,UAAMA,IAlBO;AAmBb;AACAyQ,eAAWA,SApBE;AAqBb5H,UAAMA,IArBO;AAsBbwI,cAAUA,QAtBG;AAuBbC,eAAWA,SAvBE;AAwBbC,eAAWA,SAxBE;AAyBbC,eAAWA,SAzBE;AA0Bb5D,UAAMA,IA1BO;AA2BbrJ,eAAWA;AA3BE,GAAf;;AA8BA/J;AACA,SAAOqK,QAAP;AACD;;AAEDiJ,WAAWqE,uBAAX,GAAqC,YAArC;kBACe,uBAAaC,mBAAb,CAAiCtE,UAAjC,C;;;;;;;;;;;;;;;;;;AChef,IAAIuE,YAAY,SAAZA,SAAY,GAAW,CAAE,CAA7B;;AAEA;AACA;AACAA,UAAUlL,yBAAV,GAAsC,kCAAtC;AACAkL,UAAUjL,wBAAV,GAAqC,mCAArC;;AAEAiL,UAAUC,mBAAV,GAAgC,UAASC,GAAT,EAAc;AAC5C,SAAO;AACLzW,YAAQyW,IAAIzW,MADP;AAEL;AACA;AACA;AACAgR,WAAO,eAASjR,CAAT,EAAY;AACjB,aAAO0W,IAAIzF,KAAJ,CAAUjR,CAAV,CAAP;AACD,KAPI;AAQL2W,SAAK,aAAS3W,CAAT,EAAY;AACf,aAAO0W,IAAIC,GAAJ,CAAQ3W,CAAR,CAAP;AACD;AAVI,GAAP;AAYD,CAbD;;AAeAwW,UAAUpI,SAAV,GAAsB,UAASwI,KAAT,EAAgB;AACpC,SAAOC,KAAKC,SAAL,CAAeF,KAAf,CAAP;AACD,CAFD;;AAIAJ,UAAUzI,WAAV,GAAwB,UAASgJ,GAAT,EAAc;AACpC,SAAOF,KAAKG,KAAL,CAAWD,GAAX,EAAgB,UAASE,GAAT,EAAcC,KAAd,EAAqB;AAC1C,QAAIA,SAAS,KAAb,EAAoB;AAClB,aAAOC,GAAP;AACD,KAFD,MAEO,IAAID,SAAS,WAAb,EAA0B;AAC/B,aAAO,CAACE,QAAR;AACD,KAFM,MAEA,IAAIF,SAAS,UAAb,EAAyB;AAC9B,aAAOE,QAAP;AACD,KAFM,MAEA,IAAIF,SAAS,QAAOA,KAAP,yCAAOA,KAAP,MAAgB,QAAzB,IACTA,MAAM,UAAN,KAAqB,YADhB,EAC8B;AACnC;AACA;AACA,aAAOV,UAAUC,mBAAV,CAA8BS,KAA9B,CAAP;AACD;AACD,WAAOA,KAAP;AACD,GAdM,CAAP;AAeD,CAhBD;;AAkBA;AACA;;kBAEeV,S;;;;;;;;;;;;;;;;;;IC/CFa,Q,WAAAA,Q,GACX,oBAAc;AAAA;;AACZ,OAAK5X,IAAL,GAAY,IAAZ,CADY,CACM;AAClB,OAAKK,GAAL,GAAW,IAAX,CAFY,CAEK;;AAEjB,OAAKwX,cAAL,GAAsB,IAAtB;AACA,OAAKC,YAAL,GAAoB,IAApB;AACD,C;;IAGUC,S,WAAAA,S,GACX,qBAAc;AAAA;;AACZ,OAAK/X,IAAL,GAAY,IAAZ,CADY,CACM;AAClB,OAAKgY,GAAL,GAAW,IAAX,CAFY,CAEK;AAClB,C;;IAGUC,U,WAAAA,U,GACX,sBAAc;AAAA;;AACZ,OAAK5X,GAAL,GAAW,IAAX,CADY,CACK;AACjB,OAAKqN,QAAL,GAAgB,IAAhB,CAFY,CAEU;AACtB,OAAKpN,MAAL,GAAc,EAAd,CAHY,CAGM;AACnB,C;;;;;;;;;;;;;;;;ACtBH;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,SAAS4X,mBAAT,CAA6BC,MAA7B,EAAqC;AACnC,MAAIC,OAAOC,SAASF,SAAS,IAAlB,CAAX;AACA,MAAIpH,MAAMsH,SAASA,SAAUF,SAAS,IAAnB,IAA4B,EAArC,CAAV;AACA,MAAInH,MAAMqH,SAASA,SAAUF,SAAS,IAAnB,IAA4B,EAArC,CAAV;;AAEA,SAAOC,KAAKzX,QAAL,KAAkB,GAAlB,GAAwBoQ,IAAIpQ,QAAJ,EAAxB,GAAyC,GAAzC,GAA+CqQ,IAAIrQ,QAAJ,EAA/C,GAAgE,MAAvE;AACD;;AAED,SAAS2X,WAAT,CAAqBC,OAArB,EAA8BJ,MAA9B,EAAsCK,GAAtC,EAA2C;AACzC,MAAIC,YAAY,kBAAhB;AACA,MAAIF,UAAUA,OAAd;AACA,MAAIG,aAAaR,oBAAoBC,MAApB,CAAjB;AACA,MAAI9X,MAAMmY,GAAV;;AAEA,MAAIG,OAAO,uPAAuPC,OAAvP,CAA+P,SAA/P,EAA0QH,SAA1Q,EAAqRG,OAArR,CAA6R,gBAA7R,EAA+SL,OAA/S,EAAwTK,OAAxT,CAAgU,WAAhU,EAA6UF,UAA7U,EAAyVE,OAAzV,CAAiW,QAAjW,EAA2WvY,GAA3W,CAAX;AACA,SAAOsY,IAAP;AACD;;AAED,SAASE,aAAT,CAAuBC,WAAvB,EAAoC3Z,KAApC,EAA2C8G,WAA3C,EAAwD;AACtD,MAAI/I,WAAW,KAAKwV,OAApB;;AAEA,MAAIhV,YAAY,wBAASR,QAAT,EAAmBS,WAAnB,EAAhB;AACA,MAAIC,SAAS,qBAAMV,QAAN,EAAgBS,WAAhB,EAAb;AACA,MAAIF,eAAeqb,WAAnB;AACA,MAAIvb,SAAS4B,KAAb;AACA,MAAI4Z,eAAe9S,WAAnB;;AAEA;AACA,MAAI+S,sBAAsB,IAA1B;AACA,MAAIC,aAAa,IAAjB;AACA,MAAIC,cAAc,IAAlB;;AAEA;AACA,MAAIC,aAAa,IAAjB;;AAEA;AACA,MAAIC,eAAJ;AACA,MAAIC,gBAAJ;;AAEA;AACA,MAAIC,eAAe,KAAnB;AACA,MAAIC,cAAc,KAAlB;AACA,MAAIC,aAAa,KAAjB;AACA,MAAIC,YAAY,KAAhB;;AAEA,MAAIC,aAAa,KAAjB;AACA,MAAIC,sBAAsB,KAA1B;AACA,MAAIC,WAAW,CAAf;AACA,MAAIC,YAAY,CAAhB;;AAEA,MAAIC,kBAAkB,IAAtB;AACA,MAAI9G,kBAAJ;AACA,MAAID,kBAAJ;;AAEA,MAAIgH,oBAAoB,uBAAYC,gBAAZ,EAAxB;;AAEA,WAAS9a,KAAT,GAAiB;AACf,QAAI6Z,aAAakB,SAAjB,EAA4B;AAC1B,UAAIC,OAAO,CAAC,CAAZ;AACA,UAAInB,aAAakB,SAAb,KAA2B,UAA/B,EAA2C;AACzCC,eAAOC,OAAOC,GAAP,CAAWC,cAAX,CAA0BC,SAA1B,CAAoCC,QAA3C;AACD,OAFD,MAEO,IAAIxB,aAAakB,SAAb,KAA2B,SAA/B,EAA0C;AAC/CC,eAAOC,OAAOC,GAAP,CAAWC,cAAX,CAA0BC,SAA1B,CAAoCE,OAA3C;AACD,OAFM,MAEA,IAAIzB,aAAakB,SAAb,KAA2B,UAA/B,EAA2C;AAChDC,eAAOC,OAAOC,GAAP,CAAWC,cAAX,CAA0BC,SAA1B,CAAoCG,QAA3C;AACD;AACD,UAAIP,SAAS,CAAC,CAAd,EAAiB;AACfC,eAAOC,GAAP,CAAWM,QAAX,CAAoBC,YAApB,CAAiCT,IAAjC;AACD;AACF;;AAED,QAAInB,aAAa6B,MAAjB,EAAyB;AACvBT,aAAOC,GAAP,CAAWM,QAAX,CAAoBG,SAApB,CAA8B9B,aAAa6B,MAA3C;AACD;;AAED5B,0BACE,IAAImB,OAAOC,GAAP,CAAWU,kBAAf,CACErd,YADF,EAEEF,MAFF,EAGE,IAHF,CADF;AAKA;;AAEA0b,iBAAa,IAAIkB,OAAOC,GAAP,CAAWW,SAAf,CAAyB/B,mBAAzB,CAAb;AACA;AACA;AACAC,eAAW+B,WAAX,GAAyBC,oCAAzB,CAA8D,IAA9D;AACAhC,eAAWhR,gBAAX,CACEkS,OAAOC,GAAP,CAAWc,qBAAX,CAAiCC,IAAjC,CAAsCC,kBADxC,EAEEC,kBAFF,EAGE,KAHF,EAIE,IAJF;AAKApC,eAAWhR,gBAAX,CACEkS,OAAOC,GAAP,CAAWkB,YAAX,CAAwBH,IAAxB,CAA6BI,QAD/B,EAEEC,SAFF,EAGE,KAHF,EAIE,IAJF;;AAMA;AACA9B,iBAAa,KAAb;AACAC,0BAAsB,KAAtB;AACAjc,cAAU8D,EAAV,CAAarE,OAAOse,MAAP,CAAcC,oBAA3B,EAAiDC,qBAAjD,EAAwE,IAAxE;AACAje,cAAU8D,EAAV,CAAarE,OAAOse,MAAP,CAAclV,WAA3B,EAAwCC,YAAxC,EAAsD,IAAtD;AACD;;AAED,WAAS/G,IAAT,GAAgB;AACdmc;AACA3a;AACD;;AAED,WAASE,KAAT,GAAiB;AACf0a;AACA,QAAI3C,WAAJ,EAAiB;AACfA,kBAAY4C,OAAZ;AACA5C,oBAAc,IAAd;AACD;AACF;;AAED,WAAS0C,iBAAT,GAA6B;AAC3B;AACA;AACA;AACA;AACA5C,wBAAoB+C,UAApB;AACD;;AAED,WAAS9a,UAAT,GAAsB;AACpBmY,aAAS3b,aAAaue,UAAb,CAAwBC,WAAjC;AACA5C,cAAU5b,aAAaue,UAAb,CAAwBE,YAAlC;AACAte,WAAO+B,GAAP,CAAW,aAAayZ,MAAb,GAAsB,YAAtB,GAAqCC,OAAhD;AACA;AACA;AACA;;AAEAzb,WAAO+B,GAAP,CAAW,qCAAqCoZ,aAAaP,GAA7D;AACA,QAAI2D,aAAa,IAAIhC,OAAOC,GAAP,CAAWgC,UAAf,EAAjB;AACAD,eAAWE,QAAX,GAAsBtD,aAAaP,GAAnC;AACA;AACA;AACA2D,eAAWG,iBAAX,GAA+BlD,MAA/B;AACA+C,eAAWI,kBAAX,GAAgClD,OAAhC;AACA8C,eAAWK,oBAAX,GAAkCpD,MAAlC;AACA+C,eAAWM,qBAAX,GAAmCpD,OAAnC;;AAEA;AACA;AACA;;AAEA;;;;;;AAMA;;AAEAJ,eAAWhY,UAAX,CAAsBkb,UAAtB;AACD;;AAED;AACA,WAASta,MAAT,GAAkB;AAChB;AACA,QAAI,CAACqX,WAAL,EAAkB;AAChB;AACD;;AAED,QAAIS,uBAAuBD,UAA3B,EAAuC;AACrC,UAAI;AACFkC;AACA1C,oBAAY9Z,IAAZ,CAAiBga,MAAjB,EAAyBC,OAAzB,EAAkCc,OAAOC,GAAP,CAAWsC,QAAX,CAAoBC,MAAtD;AACAzD,oBAAY1H,KAAZ;AACD,OAJD,CAIE,OAAOoL,OAAP,EAAgB;AAChB;AACD;AACF;AACF;;AAED,WAAS3a,QAAT,GAAoB;AAClB,WAAOwX,SAAP;AACD;;AAED,WAAS3X,WAAT,GAAuB;AACrB,WAAOwX,YAAP;AACD;;AAED,WAASvX,UAAT,GAAsB;AACpB,WAAOwX,WAAP;AACD;;AAED,WAAS9W,OAAT,GAAmB;AACjB,QAAIyW,YAAYtW,SAAZ,OAA4B,CAAhC,EAAmC;AACjC,aAAO,IAAP;AACD,KAFD,MAEO;AACL,aAAO,KAAP;AACD;AACF;;AAED,WAASL,IAAT,GAAgB;AACd2W,gBAAYxW,SAAZ,CAAsB,CAAtB;AACD;;AAED,WAASF,MAAT,GAAkB;AAChB0W,gBAAYxW,SAAZ,CAAsB,CAAtB;AACD;;AAED,WAASE,SAAT,GAAqB;AACnB,WAAOsW,YAAYtW,SAAZ,EAAP;AACD;;AAED,WAASF,SAAT,CAAmBC,MAAnB,EAA2B;AACzBuW,gBAAYxW,SAAZ,CAAsBC,MAAtB;AACD;;AAED,WAAST,WAAT,GAAuB;AACrB,WAAO6Q,SAAP;AACD;;AAED,WAAS5Q,WAAT,GAAuB;AACrB,WAAO6Q,SAAP;AACD;;AAED,WAASpR,IAAT,GAAgB;AACd,QAAIsX,WAAJ,EAAiB;AACfA,kBAAY2D,MAAZ;AACD;AACF;;AAED,WAAS7a,KAAT,GAAiB;AACf,QAAIkX,WAAJ,EAAiB;AACfA,kBAAYlX,KAAZ;AACD;AACF;;AAED,WAASqB,MAAT,CAAgBC,KAAhB,EAAuBC,MAAvB,EAA+BuZ,UAA/B,EAA2C;AACzC,QAAI5D,WAAJ,EAAiB;AACfE,eAAS9V,KAAT;AACA+V,gBAAU9V,MAAV;AACA2V,kBAAY7V,MAAZ,CAAmB+V,MAAnB,EAA2BC,OAA3B,EAAoCc,OAAOC,GAAP,CAAWsC,QAAX,CAAoBK,UAAxD;AACD;AACF;;AAED;AACA,WAAS1B,kBAAT,CAA4B2B,qBAA5B,EAAmD;AACjDpf,WAAO+B,GAAP,CAAW,qBAAX;;AAEA,QAAIsd,uBAAuB,IAAI9C,OAAOC,GAAP,CAAW8C,oBAAf,EAA3B;AACAD,yBAAqBE,SAArB,GAAiC,IAAjC;AACA,QAAIpE,aAAaqE,gBAAjB,EAAmC;AACjCH,2BAAqBG,gBAArB,GAAwCrE,aAAaqE,gBAArD;AACD;AACDH,yBAAqBI,2CAArB,GAAmE,IAAnE;AACA;AACAJ,yBAAqBK,qBAArB,GAA6C,IAA7C;;AAEApE,kBAAc8D,sBAAsBO,aAAtB,CAAoChgB,MAApC,EAA4C0f,oBAA5C,CAAd;;AAEA;AACA;AACA/D,gBAAYjR,gBAAZ,CACEkS,OAAOC,GAAP,CAAWkB,YAAX,CAAwBH,IAAxB,CAA6BI,QAD/B,EAEEC,SAFF,EAGE,KAHF,EAIE,IAJF;AAKA,QAAIgC,SAAS;AACX;AACArD,WAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBuC,cAFb,EAGXvD,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBwC,WAHb,EAIXxD,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwByC,iBAJb,EAKXzD,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB0C,KALb,EAMX1D,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB2C,QANb,EAOX3D,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB4C,uBAPb,EAQX5D,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB6C,wBARb,EASX7D,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB8C,eATb,EAUX9D,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB+C,cAVb,EAWX/D,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBgD,UAXb,EAYXhE,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBiD,WAZb,EAaXjE,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBkD,cAbb,EAcXlE,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBmD,MAdb,EAeXnE,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBoD,GAfb,EAgBXpE,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBqD,QAhBb,EAiBXrE,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBsD,MAjBb,EAkBXtE,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBuD,OAlBb,EAmBXvE,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBwD,uBAnBb,EAoBXxE,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwByD,OApBb,EAqBXzE,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB0D,OArBb,EAsBX1E,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB2D,cAtBb,EAuBX3E,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB4D,UAvBb,EAwBX5E,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB6D,cAxBb,EAyBX7E,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB8D,YAzBb,CAAb;AA2BA,SAAK,IAAIC,KAAT,IAAkB1B,MAAlB,EAA0B;AACxBtE,kBAAYjR,gBAAZ,CACEuV,OAAO0B,KAAP,CADF,EAEEC,SAFF,EAGE,KAHF,EAIE,IAJF;AAKD;;AAEDzF,iBAAa,IAAb;AACA,QAAIC,mBAAJ,EAAyB;AACvB/b,aAAO+B,GAAP,CAAW,iCAAX;AACAjC,gBAAUoC,OAAV,CAAkB,iBAAOyH,mBAAzB;AACD;;AAED3J,WAAO+B,GAAP,CAAW,qBAAX;AACD;;AAED,WAAS6b,SAAT,CAAmB4D,YAAnB,EAAiC;AAC/BxhB,WAAO+B,GAAP,CAAW,oBAAoByf,aAAaC,QAAb,GAAwB1e,QAAxB,EAA/B;AACA,QAAI2e,MAAMF,aAAaC,QAAb,EAAV;AACA;AACAzhB,WAAO+B,GAAP,CAAW,UAAX,EAAuB2f,GAAvB;;AAEA,QAAIC,UAAUD,IAAIE,YAAJ,EAAd;AACA,QAAIC,SAASH,IAAII,UAAJ,EAAb;;AAEA,QAAIxG,WAAJ,EAAiB;AACfA,kBAAY4C,OAAZ;AACD;AACD;AACD;;AAED,WAASqD,SAAT,CAAmBQ,OAAnB,EAA4B;AAC1B/hB,WAAO+B,GAAP,CAAW,iBAAiBggB,QAAQ3f,IAApC;AACA,QAAI4f,KAAKD,QAAQE,KAAR,EAAT;;AAEA,YAAQF,QAAQ3f,IAAhB;AACE,WAAKma,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBuC,cAA7B;AACE;AACE9f,iBAAO+B,GAAP,CAAW,4BAA4BggB,QAAQG,CAAR,CAAUC,WAAjD;AACD;AACD;AACF,WAAK5F,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBwC,WAA7B;AACE;AACE;AACA;AACA;AACAxE,uBAAawG,QAAQK,cAAR,EAAb;AACApiB,iBAAO+B,GAAP,CAAW,iBAAiBwZ,WAAW8G,CAAX,CAAaC,IAAb,CAAkB,GAAlB,CAA5B;AACD;AACD;AACF,WAAK/F,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB0C,KAA7B;AACE;AACE;AACD;AACD;AACF,WAAK1D,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB2C,QAA7B;AACE;AACE;AACA;AACA;AACAqC;AACD;AACD;AACF,WAAKhG,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB4C,uBAA7B;AACE;AACErgB,oBAAUoC,OAAV,CAAkB,iBAAOqH,0BAAzB;AACD;AACD;AACF,WAAKgT,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB6C,wBAA7B;AACE;AACEtgB,oBAAUoC,OAAV,CAAkB,iBAAOuH,2BAAzB;AACD;AACD;AACF,WAAK8S,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB8C,eAA7B;AACE,SAAE;AACF;AACF,WAAK9D,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBgD,UAA7B;AACE,SAAE;AACF;AACF,WAAKhE,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBkD,cAA7B;AACE,SAAE;AACF;AACF,WAAKlE,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBmD,MAA7B;AACE;AACE;AACA;AACA,cAAI,CAACsB,GAAGQ,QAAH,EAAL,EAAoB;AAClB;AACA;AACD;AACF;AACD;AACF,WAAKjG,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBsD,MAA7B;AACE;AACEhF,sBAAY,IAAZ;AACA/b,oBAAUoC,OAAV,CAAkB,iBAAO2H,SAAzB;AACD;AACD;AACF,WAAK0S,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwBuD,OAA7B;AACE;AACEjF,sBAAY,KAAZ;AACA/b,oBAAUoC,OAAV,CAAkB,iBAAO6H,UAAzB;AACD;AACD;AACF,WAAKwS,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwByD,OAA7B;AACE;AACE;AACAuB;AACD;AACD;AACF,WAAKhG,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB0D,OAA7B;AACE;AACE;AACA;AACA;AACAwB,6BAAmBT,EAAnB;AACD;AACD;AACF,WAAKzF,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB2D,cAA7B;AACE,SAAE;AACF;AACF,WAAK3E,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB4D,UAA7B;AACE;AACE,cAAIvF,cAAcD,WAAlB,EAA+B;AAC7B4G;AACD;AACF;AACD;AACF,WAAKhG,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB6D,cAA7B;AACE;AACEphB,iBAAO+B,GAAP,CAAW,wBAAwBuZ,YAAYtW,SAAZ,EAAnC;AACAlF,oBAAUoC,OAAV,CAAkB,iBAAOwgB,iBAAzB;AACD;AACD;AACF,WAAKnG,OAAOC,GAAP,CAAWqD,OAAX,CAAmBtC,IAAnB,CAAwB8D,YAA7B;AACE;AACErhB,iBAAO+B,GAAP,CAAW,sBAAsBuZ,YAAYtW,SAAZ,EAAjC;AACAlF,oBAAUoC,OAAV,CAAkB,iBAAOwgB,iBAAzB;AACD;AACD;AACF;AACE;AA1GJ;AA4GD;;AAED,WAAS3E,qBAAT,GAAiC;AAC/B;AACA;AACAje,cAAUiE,GAAV,CAAcxE,OAAOse,MAAP,CAAcC,oBAA5B,EAAkDC,qBAAlD,EAAyE,IAAzE;AACA/d,WAAO+B,GAAP,CAAW,2BAA2B,IAA3B,GACT,uBADS,GACiBga,mBADjB,GACuC,IADvC,GAET,cAFS,GAEQD,UAFnB;AAGAC,0BAAsB,IAAtB;AACA,QAAID,UAAJ,EAAgB;AACd9b,aAAO+B,GAAP,CAAW,wBAAX;AACAjC,gBAAUoC,OAAV,CAAkB,iBAAOyH,mBAAzB;AACA;AACD;AACD3J,WAAO+B,GAAP,CAAW,wBAAX;AACD;;AAED,WAAS6G,YAAT,GAAwB;AACtByS,eAAWsH,eAAX;AACD;;AAED;AACA,WAASC,YAAT,GAAwB;AACtB1G,sBAAkB2G,YAAY,YAAW;AACvC,UAAIC,gBAAgBxH,YAAYyH,gBAAZ,EAApB;AACA;AACA,UAAID,kBAAkB,CAAC,CAAvB,EAA0B;AACxB;AACD;;AAED3N,kBAAYC,YAAY0N,aAAxB;AACA;AACA,UAAIpH,gBAAgB,CAACG,SAArB,EAAgC;AAC9B;AACA/b,kBAAUoC,OAAV,CAAkB,iBAAO8gB,aAAzB;AACD;AACF,KAbiB,EAaf,GAbe,CAAlB;AAcD;;AAED,WAAS/E,WAAT,GAAuB;AACrB,QAAI/B,eAAJ,EAAqB;AACnB+G,oBAAc/G,eAAd;AACAA,wBAAkB,IAAlB;AACD;AACF;;AAED,WAASuG,kBAAT,CAA4BT,EAA5B,EAAgC;AAC9B;AACAtG,mBAAe,IAAf;AACAC,kBAAcqG,GAAGQ,QAAH,EAAd;;AAEA;AACA;AACA;AACA;AACA,QAAIU,QAAQlB,GAAGmB,eAAH,EAAZ;AACAvH,iBAAcsH,UAAU,OAAX,GAAsB,IAAtB,GAA6B,KAA1C;AACA/N,gBAAY,CAAZ;AACAC,gBAAY4M,GAAGzd,WAAH,EAAZ;AACAyX,eAAWgG,GAAG3c,QAAH,EAAX;AACA4W,gBAAY+F,GAAGzc,SAAH,EAAZ;;AAEAzF,cAAUoC,OAAV,CAAkB,iBAAOkhB,UAAzB,EAAqC;AACnCC,cAAQ1H,WAD2B;AAEnC2H,aAAO1H,UAF4B;AAGnClW,aAAOsW,QAH4B;AAInCrW,cAAQsW;AAJ2B,KAArC;AAMA,QAAIN,WAAJ,EAAiB;AACfiH;AACA9iB,gBAAUoC,OAAV,CAAkB,iBAAO8gB,aAAzB;AACD,KAHD,MAGO;AACLljB,gBAAUoC,OAAV,CAAkB,iBAAOuH,2BAAzB;AACD;;AAED;AACA,QAAI8Z,oBAAoB,IAAIhH,OAAOC,GAAP,CAAWgH,4BAAf,EAAxB;AACAD,sBAAkBE,YAAlB,GAAiClH,OAAOC,GAAP,CAAWgH,4BAAX,CAAwCE,YAAxC,CAAqDC,MAAtF;AACAJ,sBAAkBK,YAAlB,GAAiCrH,OAAOC,GAAP,CAAWgH,4BAAX,CAAwCK,YAAxC,CAAqDC,KAAtF;AACAP,sBAAkBQ,YAAlB,GAAiCxH,OAAOC,GAAP,CAAWgH,4BAAX,CAAwCQ,YAAxC,CAAqDC,MAAtF;;AAEA;AACA,QAAIC,eAAelC,GAAGmC,eAAH,CAAmB3I,MAAnB,EAA2BC,OAA3B,EAAoC8H,iBAApC,CAAnB;AACA,QAAIa,aAAa,EAAjB;AACA,SAAK,IAAIzhB,IAAI,CAAb,EAAgBA,IAAIuhB,aAAathB,MAAjC,EAAyCD,GAAzC,EAA8C;AAC5C,UAAI0hB,cAAcH,aAAavhB,CAAb,CAAlB;;AAEA,UAAI+C,QAAQ2e,YAAYhf,QAAZ,EAAZ;AACA,UAAIM,SAAS0e,YAAY9e,SAAZ,EAAb;AACA,UAAI+e,UAAUD,YAAYE,UAAZ,EAAd;AACAH,iBAAWI,IAAX,CAAgB;AACd9e,eAAOA,KADO;AAEdC,gBAAQA,MAFM;AAGd2e,iBAASA;AAHK,OAAhB;;AAMAtkB,aAAO+B,GAAP,gBAAwBY,CAAxB,gBAAoC0hB,YAAYI,cAAZ,EAApC,eAA0EJ,YAAYhf,QAAZ,EAA1E,iBAA4Ggf,YAAY9e,SAAZ,EAA5G;AACD;AACD,QAAI6e,WAAWxhB,MAAX,GAAoB,CAAxB,EAA2B;AACzB9C,gBAAUoC,OAAV,CAAkB,iBAAOwiB,aAAzB,EAAwC;AACtCN,oBAAYA;AAD0B,OAAxC;AAGD;AACF;;AAED,WAAS7B,qBAAT,GAAiC;AAC/B;AACA7G,mBAAe,KAAf;AACAuC;AACA9I,gBAAYC,SAAZ;AACAtV,cAAUoC,OAAV,CAAkB,iBAAO8gB,aAAzB;AACAljB,cAAUoC,OAAV,CAAkB,iBAAOyiB,WAAzB;AACD;;AAED;AACA,WAAS7d,IAAT,GAAgB;AACd;;AAEA,QAAIiV,uBAAuBD,UAA3B,EAAuC;AACrC,UAAI;AACFkC;AACA1C,oBAAY9Z,IAAZ,CAAiBga,MAAjB,EAAyBC,OAAzB,EAAkCc,OAAOC,GAAP,CAAWsC,QAAX,CAAoBC,MAAtD;AACAzD,oBAAY1H,KAAZ;AACD,OAJD,CAIE,OAAOoL,OAAP,EAAgB;AAChB;AACD;AACF;AACF;;AAED,MAAIrT,WAAW;AACb9J,UAAMA,IADO;AAEb0B,WAAOA,KAFM;AAGbW,iBAAaA,WAHA;AAIbC,gBAAYA,UAJC;AAKbH,UAAMA,IALO;AAMbI,WAAOA,KANM;AAObC,cAAUA,QAPG;AAQbM,UAAMA,IARO;AASbC,YAAQA,MATK;AAUbC,aAASA,OAVI;AAWbG,eAAWA,SAXE;AAYbF,eAAWA,SAZE;AAabR,iBAAaA,WAbA;AAcbC,iBAAaA,WAdA;AAebkB,YAAQA,MAfK;AAgBbpC,gBAAYA,UAhBC;AAiBbY,YAAQA,MAjBK;;AAmBb;AACA6C,UAAMA;AApBO,GAAf;;AAuBAxF;AACA,SAAOqK,QAAP;AACD;;AAEDsP,cAAchC,uBAAd,GAAwC,eAAxC;kBACe,uBAAaC,mBAAb,CAAiC+B,aAAjC,C;;;;;;;;;;;;;;;;ACrlBf;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;;;AAEA,SAAS2J,gBAAT,GAA4B;AAC1B,MAAItlB,WAAW,KAAKwV,OAApB;;AAEA,MAAIhV,YAAY,wBAASR,QAAT,EAAmBS,WAAnB,EAAhB;AACA,MAAIC,SAAS,qBAAMV,QAAN,EAAgBS,WAAhB,EAAb;;AAEA,MAAI8kB,eAAe,IAAnB;AACA,MAAIllB,eAAJ;AACA,MAAImlB,gBAAgB,EAApB;;AAEA,MAAIC,oBAAJ;;AAEA,MAAIC,YAAY,IAAhB;AACA;AACA,MAAIC,aAAa,KAAjB;;AAEA,WAAS3jB,KAAT,GAAiB;AACfxB,cAAU8D,EAAV,CAAa,iBAAOiH,eAApB,EAAqCqa,gBAArC;;AAEAplB,cAAU8D,EAAV,CAAa,iBAAOuhB,cAApB,EAAoCC,eAApC;;AAEAtlB,cAAU8D,EAAV,CAAa,iBAAOyhB,YAApB,EAAkCC,aAAlC;AACAxlB,cAAU8D,EAAV,CAAa,iBAAO2hB,gBAApB,EAAsCC,iBAAtC;AACA1lB,cAAU8D,EAAV,CAAa,iBAAO6hB,UAApB,EAAgCC,WAAhC;;AAEA;AACA5lB,cAAU8D,EAAV,CAAa,iBAAOuH,QAApB,EAA8Bwa,SAA9B;AACD;;AAED,WAASC,iBAAT,GAA6B;AAC3B5lB,WAAO+B,GAAP,CAAW,sCAAX;AACA;AACA,QAAI8jB,YAAa,uBAAuB7e,MAAxC;AACA,QAAI8e,iBAAkB,iBAAiB9e,MAAvC;;AAEA,QAAI8e,cAAJ,EAAoB;AAClBjB,qBAAe,IAAIkB,WAAJ,EAAf;AACAlB,mBAAaxa,gBAAb,CAA8B,YAA9B,EAA4C2b,iBAA5C,EAA+D,KAA/D;AACAnB,mBAAaxa,gBAAb,CAA8B,aAA9B,EAA6C4b,kBAA7C,EAAiE,KAAjE;AACApB,mBAAaxa,gBAAb,CAA8B,aAA9B,EAA6C6b,kBAA7C,EAAiE,KAAjE;AACD,KALD,MAKO,IAAIL,SAAJ,EAAe;AACpBhB,qBAAe,IAAIsB,iBAAJ,EAAf;AACAtB,mBAAaxa,gBAAb,CAA8B,kBAA9B,EAAkD2b,iBAAlD,EAAqE,KAArE;AACD;;AAEDhmB,WAAO+B,GAAP,CAAW,sCAAX;;AAEA,WAAO8iB,YAAP;AACD;;AAED,WAASthB,KAAT,GAAiB;AACfvD,WAAO+B,GAAP,CAAW,0BAAX;AACA,QAAI+iB,cAAcsB,KAAlB,EAAyB;AACvBvB,mBAAawB,kBAAb,CAAgCvB,cAAcsB,KAA9C;AACD;AACD,QAAItB,cAAcwB,KAAlB,EAAyB;AACvBzB,mBAAawB,kBAAb,CAAgCvB,cAAcwB,KAA9C;AACD;AACF;;AAED,WAAS9a,WAAT,CAAqBqO,KAArB,EAA4B;AAC1B,QAAIgL,aAAa/U,QAAb,IAAyB+J,KAA7B,EAAoC;AAClCgL,mBAAa/U,QAAb,GAAwB+J,KAAxB;AACD;;AAED,WAAOgL,aAAa/U,QAApB;AACD;;AAED,WAASyW,iBAAT,GAA6B;AAC3BvmB,WAAO+B,GAAP,CAAW,oBAAX;AACA8iB,iBAAa2B,WAAb;AACD;;AAED,WAAS1f,IAAT,GAAgB,CAAE;;AAElB,WAASkf,iBAAT,GAA6B;AAC3BhmB,WAAO+B,GAAP,CAAW,oBAAX;;AAEA;AACA8iB,iBAAara,mBAAb,CAAiC,YAAjC,EAA+Cwb,iBAA/C;AACAnB,iBAAara,mBAAb,CAAiC,kBAAjC,EAAqDwb,iBAArD;;AAEAS,QAAIC,eAAJ,CAAoB/mB,OAAOgnB,GAA3B;AACA7mB,cAAUoC,OAAV,CAAkB,iBAAOmH,cAAzB,EAAyC,EAAzC;AACD;;AAED,WAAS4c,kBAAT,GAA8B;AAC5BjmB,WAAO+B,GAAP,CAAW,qBAAX;AACD;;AAED,WAASmkB,kBAAT,GAA8B;AAC5BlmB,WAAO+B,GAAP,CAAW,qBAAX;AACD;;AAED,WAASqjB,eAAT,CAAyBxV,CAAzB,EAA4B;AAC1BmV,kBAAcnV,EAAEgX,UAAhB;AACD;;AAED,WAAS1B,gBAAT,CAA0Bva,IAA1B,EAAgC;AAC9BhL,aAASgL,KAAKpJ,KAAd;;AAEA,QAAIslB,WAAWjB,mBAAf;AACA,QAAIkB,SAAS9f,OAAOyf,GAAP,CAAWM,eAAX,CAA2BF,QAA3B,CAAb;AACAlnB,WAAOgnB,GAAP,GAAaG,MAAb;AACD;;AAED,WAASxB,aAAT,CAAuB3a,IAAvB,EAA6B;AAC3B,QAAIjI,SAASiI,IAAb;;AAEA,QAAIjI,OAAO0jB,KAAX,EAAkB;AAChB,UAAIY,WAActkB,OAAO0jB,KAAP,CAAaa,SAA3B,gBAA+CvkB,OAAO0jB,KAAP,CAAac,KAAhE;AACA,UAAIC,SAAStC,aAAauC,eAAb,CAA6BJ,QAA7B,CAAb;AACAlC,oBAAcsB,KAAd,GAAsBe,MAAtB;;AAEAA,aAAO9c,gBAAP,CAAwB,aAAxB,EAAuCgd,wBAAvC;AACAF,aAAO9c,gBAAP,CAAwB,QAAxB,EAAkCid,mBAAlC;AACAH,aAAO9c,gBAAP,CAAwB,WAAxB,EAAqCkd,sBAArC;AACAJ,aAAO9c,gBAAP,CAAwB,OAAxB,EAAiCmd,kBAAjC;AACAL,aAAO9c,gBAAP,CAAwB,OAAxB,EAAiCod,kBAAjC;AACD;AACD,QAAI/kB,OAAO4jB,KAAX,EAAkB;AAChB,UAAIU,YAActkB,OAAO4jB,KAAP,CAAaW,SAA3B,gBAA+CvkB,OAAO4jB,KAAP,CAAaY,KAAhE;AACA,UAAIC,UAAStC,aAAauC,eAAb,CAA6BJ,SAA7B,CAAb;AACAlC,oBAAcwB,KAAd,GAAsBa,OAAtB;;AAEAA,cAAO9c,gBAAP,CAAwB,aAAxB,EAAuCgd,wBAAvC;AACAF,cAAO9c,gBAAP,CAAwB,QAAxB,EAAkCid,mBAAlC;AACAH,cAAO9c,gBAAP,CAAwB,WAAxB,EAAqCkd,sBAArC;AACAJ,cAAO9c,gBAAP,CAAwB,OAAxB,EAAiCmd,kBAAjC;AACAL,cAAO9c,gBAAP,CAAwB,OAAxB,EAAiCod,kBAAjC;AACD;AACF;;AAED,WAASC,WAAT,GAAuB;AACrB,QAAIzC,UAAJ,EAAgB;AACd;AACA;AACD;;AAED,QAAID,aAAaA,UAAUpiB,MAA3B,EAAmC;AACjC,UAAI+kB,UAAU3C,UAAU4C,KAAV,EAAd;AACA,UAAI;AACF,YAAIxlB,OAAOulB,QAAQvlB,IAAnB;AAAA,YACEylB,KAAK/C,cAAc1iB,IAAd,CADP;AAEA,YAAIylB,EAAJ,EAAQ;AACN,cAAI,CAACA,GAAGC,QAAR,EAAkB;AAChB7C,yBAAa,IAAb;;AAEA;AACA4C,eAAGE,KAAH,GAAW,KAAX;AACAF,eAAGG,YAAH,CAAgBL,QAAQhd,IAAxB;AACD;AACF;AACF,OAZD,CAYE,OAAO+W,GAAP,EAAY;AACZ;AACA1hB,eAAO+B,GAAP,0CAAkD2f,IAAIjR,OAAtD;AACD;AACF;AACF;;AAED,WAAS+U,iBAAT,CAA2B7a,IAA3B,EAAiC;AAC/B,QAAI,CAACqa,SAAL,EAAgB;AACdA,kBAAY,CAACra,IAAD,CAAZ;AACD,KAFD,MAEO;AACLqa,gBAAUR,IAAV,CAAe7Z,IAAf;AACD;;AAED+c;AACD;;AAED,WAAShC,WAAT,GAAuB;AACrBa;AACD;;AAED,WAASZ,SAAT,GAAqB;AACnB,QAAIpkB,QAAQjC,SAASiC,KAArB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD;;AAED;AACA,WAAS8lB,wBAAT,GAAoC;AAClCrnB,WAAO+B,GAAP,CAAW,8BAAX;AACD;;AAED,WAASulB,mBAAT,GAA+B;AAC7BtnB,WAAO+B,GAAP,CAAW,yBAAX;AACD;;AAED,WAASwlB,sBAAT,GAAkC;AAChCvnB,WAAO+B,GAAP,CAAW,yBAAX;AACAkjB,iBAAa,KAAb;;AAEA,QAAIgD,UAAUjD,UAAUpiB,MAAxB;AACA,QAAIqlB,YAAY,CAAhB,EAAmB;AACjBnoB,gBAAUoC,OAAV,CAAkB,iBAAOgmB,eAAzB,EAA0C,EAAED,gBAAF,EAA1C;AACD,KAFD,MAEO;AACLP;AACD;;AAEDS;AACD;;AAED,WAASX,kBAAT,CAA4B5X,CAA5B,EAA+B;AAC7B5P,WAAO+B,GAAP,CAAW,qBAAX,EAAkC6N,CAAlC;AACD;;AAED,WAAS6X,kBAAT,GAA8B;AAC5BznB,WAAO+B,GAAP,CAAW,qBAAX;AACD;AACD;;AAEA,WAASomB,0BAAT,GAAsC;AACpC;AACA,SAAK,IAAI/lB,IAAT,IAAiB0iB,aAAjB,EAAgC;AAC9B,UAAIA,cAAc1iB,IAAd,EAAoB0lB,QAApB,KAAiC,IAArC,EAA2C;AACzC;AACD;AACF;;AAED,QAAIjD,gBAAgBA,aAAa/U,QAAb,KAA0BiV,YAAYjV,QAA1D,EAAoE;AAClE;AACD;AACF;;AAED,MAAInE,WAAW;AACbia,uBAAmBA,iBADN;AAEbriB,WAAOA,KAFM;AAGbiI,iBAAaA,WAHA;AAIb+a,uBAAmBA,iBAJN;AAKbzf,UAAMA;AALO,GAAf;AAOAxF;AACA,SAAOqK,QAAP;AACD;;AAEDiZ,iBAAiB3L,uBAAjB,GAA2C,kBAA3C;kBACe,uBAAaC,mBAAb,CAAiC0L,gBAAjC,C;;;;;;;;;;;;;;;;AC7Pf;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;;;AAEA,SAASwD,aAAT,GAAyB;AACvB,MAAI9oB,WAAW,KAAKwV,OAApB;AACA,MAAIhV,YAAY,wBAASR,QAAT,EAAmBS,WAAnB,EAAhB;AACA,MAAIC,SAAS,qBAAMV,QAAN,EAAgBS,WAAhB,EAAb;;AAEA,MAAIglB,oBAAJ;AACA,MAAIsD,mBAAmB,IAAvB;AACA,MAAIC,2BAA2B,uCAAwBhpB,QAAxB,EAAkCS,WAAlC,EAA/B;;AAEA,WAASuB,KAAT,GAAiB;AACf+mB,uBAAmBE,oBAAnB;AACAF,qBAAiBG,WAAjB,CAA6BlpB,SAASiC,KAAtC;;AAEAzB,cAAU8D,EAAV,CAAa,iBAAOyhB,YAApB,EAAkCC,aAAlC;AACD;;AAED,WAASA,aAAT,CAAuB3a,IAAvB,EAA6B;AAC3B,QAAIjI,SAASiI,IAAb;AACA,QAAIjI,OAAO0jB,KAAX,EAAkB;AAChBrB,kBAAYziB,GAAZ,CAAgBmmB,UAAhB,GAAgC/lB,OAAO0jB,KAAP,CAAaa,SAA7C,gBAAiEvkB,OAAO0jB,KAAP,CAAac,KAA9E;AACD;AACD,QAAIxkB,OAAO4jB,KAAX,EAAkB;AAChBvB,kBAAYziB,GAAZ,CAAgBomB,UAAhB,GAAgChmB,OAAO4jB,KAAP,CAAaW,SAA7C,gBAAiEvkB,OAAO4jB,KAAP,CAAaY,KAA9E;AACD;AACF;;AAED,WAASqB,kBAAT,GAA8B;AAC5B,QAAIhnB,QAAQjC,SAASiC,KAArB;AACA,QAAIA,MAAMonB,WAAN,KAAsB1iB,SAAtB,IACF1E,MAAMqnB,SAAN,KAAoB3iB,SADlB,IAEF4iB,UAAUC,2BAAV,KAA0C7iB,SAFxC,IAGF,OAAO4iB,UAAUC,2BAAjB,KAAiD,UAHnD,EAG+D;AAC7D9oB,aAAO+B,GAAP,CAAW,8CAAX;AACA,aAAO,qCAAP;AACD,KAND,MAMO;AACL/B,aAAO+B,GAAP,CAAW,6CAAX;AACA,aAAO,oCAAP;AACD;AACF;;AAED,WAASQ,UAAT,CAAoB8O,IAApB,EAA0B;AACxB0T,kBAAc1T,IAAd;;AAEA,QAAI,CAACA,KAAK/O,GAAN,IAAa,CAAC+O,KAAK/O,GAAL,CAASF,IAA3B,EAAiC;AAC/B;AACD;;AAED,QAAI2mB,YAAYT,yBAAyBU,0BAAzB,CAAoD3X,KAAK/O,GAAL,CAASF,IAA7D,CAAhB;AACApC,WAAO+B,GAAP,CAAW,qCAAqCgnB,UAAUE,YAA1D;AACAZ,qBAAiBa,YAAjB,CAA8BH,SAA9B;AACAV,qBAAiB9lB,UAAjB,CAA4B8O,IAA5B;AACD;;AAED,MAAI8X,YAAY;AACd5mB,gBAAYA;AADE,GAAhB;AAGAjB;AACA,SAAO6nB,SAAP;AACD;;AAEDf,cAAcnP,uBAAd,GAAwC,eAAxC;kBACe,uBAAaC,mBAAb,CAAiCkP,aAAjC,C;;;;;;;;;;;;;;;;ACtEf;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,SAASgB,eAAT,GAA2B;AACzB,MAAI9pB,WAAW,KAAKwV,OAApB;AACA,MAAIhV,YAAY,wBAASR,QAAT,EAAmBS,WAAnB,EAAhB;AACA,MAAIC,SAAS,qBAAMV,QAAN,EAAgBS,WAAhB,EAAb;;AAEA,MAAIglB,oBAAJ;;AAEA,WAASzjB,KAAT,GAAiB;AACfxB,cAAU8D,EAAV,CAAa,iBAAOylB,eAApB,EAAqCC,gBAArC;AACD;;AAED,WAASA,gBAAT,CAA0B1C,UAA1B,EAAsC;AACpC7B,kBAAc6B,UAAd;;AAEA9mB,cAAUoC,OAAV,CAAkB,iBAAOijB,cAAzB,EAAyC,EAACyB,YAAY7B,WAAb,EAAzC;AACD;;AAED,MAAIoE,YAAY,EAAhB;AAEA7nB;AACA,SAAO6nB,SAAP;AACD;;AAEDC,gBAAgBnQ,uBAAhB,GAA0C,iBAA1C;kBACe,uBAAaC,mBAAb,CAAiCkQ,eAAjC,C;;;;;;;;;;;;;;;;;;AC3Bf;AACA,IAAMG,eAAe,mCAArB;AACA;AACA,IAAMC,kBAAkB,6FAAxB;;IAGMC,iB;AACJ,6BAAYC,KAAZ,EAAmB;AAAA;;AACjB,SAAKC,SAAL,GAAiB,EAAjB;AACD;;8BAEDC,Y,yBAAaD,S,EAAW;AACtB,SAAKA,SAAL,GAAiBA,SAAjB;;AAEA;AACA;AACA;AACA;AACA;AACD,G;;8BAED3nB,Q,qBAASC,M,EAAQ;AACf,QAAI4nB,MAAM,KAAV;AACA,QAAI5nB,OAAOuR,WAAP,OAAyB,WAA7B,EAA0C;AACxCqW,YAAM,IAAN;AACD,KAFD,MAEO,IAAI,KAAKF,SAAL,CAAe/mB,MAAf,GAAwB,CAA5B,EAA+B;AACpC;AACA,UAAIknB,WAAW7nB,OAAO8nB,KAAP,CAAaP,eAAb,CAAf;AACA;AACA,UAAIM,QAAJ,EAAc;AACZ,aAAK,IAAInnB,IAAI,CAAb,EAAgBA,IAAI,KAAKgnB,SAAL,CAAe/mB,MAAnC,EAA2CD,GAA3C,EAAgD;AAC9C,cAAImnB,SAAS,CAAT,MAAgB,KAAKH,SAAL,CAAehnB,CAAf,CAApB,EAAuC;AACrCknB,kBAAM,IAAN;AACA;AACD;AACF;AACF,OAPD,MAOO;AACL;AACA,YAAIC,YAAW7nB,OAAO8nB,KAAP,CAAaR,YAAb,CAAf;AACA;AACA,YAAIO,SAAJ,EAAc;AACZ,eAAK,IAAInnB,KAAI,CAAb,EAAgBA,KAAI,KAAKgnB,SAAL,CAAe/mB,MAAnC,EAA2CD,IAA3C,EAAgD;AAC9C,gBAAImnB,UAAS,CAAT,MAAgB,KAAKH,SAAL,CAAehnB,EAAf,CAApB,EAAuC;AACrCknB,oBAAM,IAAN;AACA;AACD;AACF;AACF;AACF;AACF;;AAED,WAAOA,GAAP;AACD,G;;;;;kBAGYJ,iB;;;;;;;;;;;;;;;;ACzDf;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;;;AAEA,SAASO,gBAAT,GAA4B;AAC1B,MAAI1qB,WAAW,KAAKwV,OAApB;AACA,MAAIhV,YAAY,wBAASR,QAAT,EAAmBS,WAAnB,EAAhB;AACA,MAAIC,SAAS,qBAAMV,QAAN,EAAgBS,WAAhB,EAAb;;AAEA,WAASuB,KAAT,GAAiB;AACfxB,cAAU8D,EAAV,CAAa,iBAAOpB,cAApB,EAAoCynB,eAApC;AACD;;AAED,WAASA,eAAT,CAAyBtf,IAAzB,EAA+B;AAC7B,QAAIlI,MAAMkI,KAAKlI,GAAf;;AAEA,QAAImI,SAASsf,UAAUznB,GAAV,CAAb;AACA3C,cAAUoC,OAAV,CAAkB,iBAAOiH,YAAzB,EAAuC,EAAEyB,cAAF,EAAvC;AACD;;AAED,WAASsf,SAAT,CAAmBznB,GAAnB,EAAwB;AACtB,QAAImI,SAAS,IAAb;AACA,QAAIuf,YAAY1nB,IAAI6Q,KAAJ,CAAU,GAAV,EAAeC,GAAf,EAAhB;AACA,QAAI4W,cAAc,KAAlB,EAAyB;AACvBvf,eAAS,2BAAWtL,QAAX,EAAqBS,WAArB,EAAT;AACA6K,aAAOxI,IAAP,GAAc,MAAd;AACD,KAHD,MAGO,IAAI+nB,cAAc,MAAlB,EAA0B;AAC/Bvf,eAAS,0BAAUtL,QAAV,EAAoBS,WAApB,EAAT;AACA6K,aAAOxI,IAAP,GAAc,KAAd;AACD,KAHM,MAGA,IAAI+nB,cAAc,KAAlB,EAAyB;AAC9Bvf,eAAS,yBAAStL,QAAT,EAAmBS,WAAnB,EAAT;AACA6K,aAAOxI,IAAP,GAAc,IAAd;AACD;;AAED,WAAOwI,MAAP;AACD;;AAED,MAAIue,YAAY,EAAhB;AAEA7nB;AACA,SAAO6nB,SAAP;AACD;;AAEDa,iBAAiB/Q,uBAAjB,GAA2C,kBAA3C;kBACe,uBAAaC,mBAAb,CAAiC8Q,gBAAjC,C;;;;;;;;;;;;;;;;ACjDf;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;;;AAEA;;;;;;;;;;AAUA,SAASI,kBAAT,GAA8B;AAC5B,MAAI9qB,WAAW,KAAKwV,OAApB;AACA,MAAIhV,YAAY,wBAASR,QAAT,EAAmBS,WAAnB,EAAhB;AACA,MAAIC,SAAS,qBAAMV,QAAN,EAAgBS,WAAhB,EAAb;;AAEA,MAAIJ,SAASL,SAASiC,KAAtB;AACA,MAAI8oB,OAAO/qB,SAASmC,GAApB;;AAEA;AACA,MAAIT,yBAAJ;AACA,MAAIC,+BAAJ;;AAEA,WAASK,KAAT,GAAiB;AACfK;AACD;;AAED;AACA,WAAS2oB,cAAT,GAA0B;AACxBtqB,WAAO+B,GAAP,CAAW,sBAAsBsoB,KAAKpf,QAAtC;AACA,QAAIof,KAAKpf,QAAT,EAAmB;AACjB;AACA,UAAIsf,cAAcvmB,MAAlB,CAFiB,CAES;AAC1B,UAAIumB,gBAAgBtkB,SAApB,EAA+B;AAC7B;AACA;AACA;AACA;AACA;;AAEAskB,oBAAYC,IAAZ,CAAiBC,0BAAjB,EAA6CC,KAA7C,CAAmDC,uBAAnD;AACD;AACF;AACF;;AAED,WAAS3mB,IAAT,GAAgB;AACdhE,WAAO+B,GAAP,CAAW,qCAAX;AACA,WAAOpC,OAAOqE,IAAP,EAAP;AACD;;AAED,WAASI,KAAT,GAAiB;AACfpE,WAAO+B,GAAP,CAAW,sCAAX;AACApC,WAAOyE,KAAP;AACD;;AAED,WAASC,QAAT,GAAoB;AAClB,WAAO1E,OAAOqQ,MAAd;AACD;;AAED,WAAS1L,WAAT,GAAuB;AACrB,WAAO3E,OAAOgV,WAAd;AACD;;AAED,WAASpQ,WAAT,GAAuB;AACrB,WAAO5E,OAAOmQ,QAAd;AACD;;AAED,WAAStL,gBAAT,GAA4B;AAC1B,WAAO7E,OAAO4L,QAAd;AACD;;AAED,WAAS9G,iBAAT,GAA6B;AAC3B,WAAO9E,OAAO2L,QAAd;AACD;;AAED,WAASnG,WAAT,CAAqBa,IAArB,EAA2B;AACzBrG,WAAOgV,WAAP,GAAqB3O,IAArB;AACD;;AAED,WAAS4kB,SAAT,GAAqB;AACnB,WAAOjrB,OAAOkrB,OAAd;AACD;;AAED,WAASnmB,OAAT,GAAmB;AACjB,WAAO/E,OAAOooB,KAAd;AACD;;AAED,WAASpjB,IAAT,GAAgB;AACdhF,WAAOoQ,KAAP,GAAe,IAAf;AACD;;AAED,WAASnL,MAAT,GAAkB;AAChBjF,WAAOoQ,KAAP,GAAe,KAAf;AACD;;AAED,WAASlL,OAAT,GAAmB;AACjB,WAAOlF,OAAOoQ,KAAd;AACD;;AAED,WAASjL,SAAT,CAAmBC,MAAnB,EAA2B;AACzBpF,WAAOoF,MAAP,GAAgBA,MAAhB;AACD;;AAED,WAASC,SAAT,GAAqB;AACnB,WAAOrF,OAAOoF,MAAd;AACD;;AAED,WAASE,qBAAT,CAA+BC,KAA/B,EAAsC;AACpCvF,WAAOmrB,YAAP,GAAsB5lB,KAAtB;AACD;;AAED,WAASI,UAAT,GAAsB;AACpB,WAAO3F,OAAO2F,UAAd;AACD;;AAED,WAASE,WAAT,GAAuB;AACrB,WAAO7F,OAAO6F,WAAd;AACD;AACD;;AAEA;AACA;AACA;AACA,WAASulB,sBAAT,GAAkC;AAChC/qB,WAAO+B,GAAP,CAAW,yBAAX;AACAf,uBAAmB,IAAnB;AACAC,6BAAyB,IAAzB;AACD;;AAED,WAAS+pB,mBAAT,GAA+B;AAC7BhrB,WAAO+B,GAAP,CAAW,sBAAX;AACA;AACAf,uBAAmB,KAAnB;AACAC,6BAAyB,KAAzB;;AAEA6D,cAAU,CAAV;AACAF;AACD;;AAED,WAASqmB,yBAAT,GAAqC;AACnCjrB,WAAO+B,GAAP,CAAW,4BAAX;AACA+C,cAAU,CAAV;AACAH;AACA,QAAI4lB,cAAcvmB,MAAlB;AACA,QAAIumB,gBAAgBtkB,SAApB,EAA+B;AAC7BskB,kBAAYC,IAAZ,CAAiBO,sBAAjB,EAAyCL,KAAzC,CAA+CM,mBAA/C;AACD;AACF;;AAED,WAASP,0BAAT,CAAoCpZ,IAApC,EAA0C;AACxC;AACArR,WAAO+B,GAAP,CAAW,6BAAX;AACAf,uBAAmB,IAAnB;AACAC,6BAAyB,KAAzB;AACD;;AAED,WAAS0pB,uBAAT,CAAiCjJ,GAAjC,EAAsC;AACpC;AACA1hB,WAAO+B,GAAP,CAAW,iCAAX,EAA8C2f,GAA9C;AACA1gB,uBAAmB,KAAnB;AACA,QAAIqpB,KAAKa,aAAT,EAAwB;AACtBD;AACD;AACF;AACD;;AAEA;AACA,WAASE,qBAAT,GAAiC;AAC/BnrB,WAAO+B,GAAP,CAAW,6CAAX;AACD;;AAED,WAASqpB,YAAT,CAAsBxb,CAAtB,EAAyB;AACvB5P,WAAO+B,GAAP,CAAW,oCAAX;AACD;;AAED,WAASspB,cAAT,GAA0B;AACxB;AACArrB,WAAO+B,GAAP,CAAW,sCAAX;AACAjC,cAAUoC,OAAV,CAAkB,iBAAOuG,aAAzB;AACD;;AAED,WAAS6iB,qBAAT,GAAiC;AAC/BtrB,WAAO+B,GAAP,CAAW,6CAAX;AACA,QAAI0J,IAAI9L,MAAR;AACAG,cAAUoC,OAAV,CAAkB,iBAAOqpB,qBAAzB;AACD;;AAED,WAASC,gBAAT,GAA4B;AAC1BxrB,WAAO+B,GAAP,CAAW,wCAAX;AACD;;AAED,WAAS0pB,sBAAT,GAAkC;AAChC;AACA;AACA;AACA3rB,cAAUoC,OAAV,CAAkB,iBAAOwpB,sBAAzB;AACD;;AAED,WAAS9iB,YAAT,GAAwB;AACtB5I,WAAO+B,GAAP,CAAW,oCAAX;AACAjC,cAAUoC,OAAV,CAAkB,iBAAOyG,WAAzB;AACD;;AAED,WAASgjB,YAAT,CAAsB/b,CAAtB,EAAyB;AACvB,QAAIgc,cAAJ;AACA,QAAIhc,EAAEic,MAAF,IAAYjc,EAAEic,MAAF,CAASD,KAAzB,EAAgC;AAC9BA,cAAQhc,EAAEic,MAAF,CAASD,KAAjB;AACD;AACD5rB,WAAO+B,GAAP,+CAAuD6pB,MAAME,IAA7D,cAA0EF,MAAMnb,OAAhF;AACD;;AAED,WAASsb,qBAAT,GAAiC;AAC/B/rB,WAAO+B,GAAP,CAAW,6CAAX;AACD;;AAED,WAASiqB,mBAAT,GAA+B;AAC7BhsB,WAAO+B,GAAP,CAAW,2CAAX;AACD;;AAED,WAASkqB,iBAAT,GAA6B;AAC3BjsB,WAAO+B,GAAP,CAAW,yCAAX;;AAEA,aAASmqB,QAAT,GAAoB;AAClB,UAAI,OAAOvsB,OAAOwsB,2BAAd,KAA8C,WAAlD,EAA+D;AAC7D;AACA,YAAIxsB,OAAOwsB,2BAAP,GAAqC,CAAzC,EAA4C;AAC1CrgB,kBAAQ/J,GAAR,CAAY,iBAAZ;AACD,SAFD,MAEO;AACL+J,kBAAQ/J,GAAR,CAAY,2BAAZ;AACD;AACF,OAPD,MAOO,IAAI,OAAOpC,OAAOysB,WAAd,KAA8B,WAAlC,EAA+C;AACpD;AACA,YAAIzsB,OAAOysB,WAAX,EAAwB;AACtBtgB,kBAAQ/J,GAAR,CAAY,iBAAZ;AACD,SAFD,MAEO;AACL+J,kBAAQ/J,GAAR,CAAY,2BAAZ;AACD;AACF,OAPM,MAOA;AACL+J,gBAAQ/J,GAAR,CAAY,gCAAZ;AACD;AACF;;AAED;AACAjC,cAAUoC,OAAV,CAAkB,iBAAOmqB,gBAAzB;AACD;;AAED,WAAStO,qBAAT,GAAiC;AAC/B/d,WAAO+B,GAAP,CAAW,0CACT,WADS,GACKpC,OAAO2F,UADZ,GAET,YAFS,GAEM3F,OAAO6F,WAFb,GAGT,cAHS,GAGQ7F,OAAOmQ,QAH1B;AAIA,QAAIpK,QAAQ/F,OAAO2F,UAAnB;AACA,QAAIK,SAAShG,OAAO6F,WAApB;AACA1F,cAAUoC,OAAV,CAAkB,iBAAO4b,oBAAzB,EAA+C;AAC7CpY,aAAOA,KADsC;AAE7CC,cAAQA;AAFqC,KAA/C;AAID;;AAED,WAAS2mB,gBAAT,GAA4B;AAC1BtsB,WAAO+B,GAAP,CAAW,wCAAX;AACD;;AAED,WAASmH,aAAT,GAAyB;AACvBlJ,WAAO+B,GAAP,CAAW,oCAAX;AACAjC,cAAUoC,OAAV,CAAkB,iBAAO+G,YAAzB;AACD;;AAED,WAASsjB,WAAT,GAAuB;AACrBvsB,WAAO+B,GAAP,CAAW,mCAAX;AACAjC,cAAUoC,OAAV,CAAkB,iBAAOsqB,UAAzB;AACD;;AAED,WAASxjB,cAAT,GAA0B;AACxBhJ,WAAO+B,GAAP,CAAW,sCAAX;AACAjC,cAAUoC,OAAV,CAAkB,iBAAO6G,aAAzB;AACD;;AAED,WAAS0jB,eAAT,CAAyB7c,CAAzB,EAA4B;AAC1B,QAAI8c,WAAW,qBAAW3pB,QAAX,CAAoBpD,OAAO2L,QAA3B,CAAf;;AAEA;AACD;;AAED,WAASqhB,iBAAT,CAA2B/c,CAA3B,EAA8B;AAC5B5P,WAAO+B,GAAP,CAAW,yCAAX;AACD;;AAED,WAAS8M,cAAT,GAA0B;AACxB/O,cAAUoC,OAAV,CAAkB,iBAAO0M,aAAzB;AACD;;AAED,WAASG,aAAT,GAAyB;AACvBjP,cAAUoC,OAAV,CAAkB,iBAAO4M,YAAzB;AACD;;AAED,WAAS8d,cAAT,GAA0B;AACxB5sB,WAAO+B,GAAP,CAAW,sCAAX;AACD;;AAED,WAAS8qB,kBAAT,CAA4Bjd,CAA5B,EAA+B;AAC7B9P,cAAUoC,OAAV,CAAkB,iBAAOwM,gBAAzB;AACD;;AAED,WAASO,oBAAT,GAAgC;AAC9B;AACAnP,cAAUoC,OAAV,CAAkB,iBAAO8M,oBAAzB;AACD;;AAED,WAASlG,cAAT,GAA0B;AACxB9I,WAAO+B,GAAP,CAAW,sCAAX;AACAjC,cAAUoC,OAAV,CAAkB,iBAAO2G,aAAzB;AACD;AACD;;AAEA;AACA,WAASlH,iBAAT,GAA6B;AAC3BhC,WAAO0K,gBAAP,CAAwB,mBAAxB,EAA6C8gB,qBAA7C;AACAxrB,WAAO0K,gBAAP,CAAwB,OAAxB,EAAiC+gB,YAAjC;AACAzrB,WAAO0K,gBAAP,CAAwB,SAAxB,EAAmCghB,cAAnC;AACA1rB,WAAO0K,gBAAP,CAAwB,gBAAxB,EAA0CihB,qBAA1C;AACA3rB,WAAO0K,gBAAP,CAAwB,gBAAxB,EAA0CohB,sBAA1C;AACA9rB,WAAO0K,gBAAP,CAAwB,WAAxB,EAAqCmhB,gBAArC;AACA7rB,WAAO0K,gBAAP,CAAwB,OAAxB,EAAiCzB,YAAjC;AACAjJ,WAAO0K,gBAAP,CAAwB,OAAxB,EAAiCshB,YAAjC;AACAhsB,WAAO0K,gBAAP,CAAwB,gBAAxB,EAA0C0hB,qBAA1C;AACApsB,WAAO0K,gBAAP,CAAwB,cAAxB,EAAwC2hB,mBAAxC;AACArsB,WAAO0K,gBAAP,CAAwB,YAAxB,EAAsC4hB,iBAAtC;AACAtsB,WAAO0K,gBAAP,CAAwB,gBAAxB,EAA0C0T,qBAA1C;AACApe,WAAO0K,gBAAP,CAAwB,WAAxB,EAAqCiiB,gBAArC;AACA3sB,WAAO0K,gBAAP,CAAwB,OAAxB,EAAiCnB,aAAjC;AACAvJ,WAAO0K,gBAAP,CAAwB,MAAxB,EAAgCkiB,WAAhC;AACA5sB,WAAO0K,gBAAP,CAAwB,SAAxB,EAAmCrB,cAAnC;AACArJ,WAAO0K,gBAAP,CAAwB,UAAxB,EAAoCoiB,eAApC;AACA9sB,WAAO0K,gBAAP,CAAwB,YAAxB,EAAsCsiB,iBAAtC;AACAhtB,WAAO0K,gBAAP,CAAwB,SAAxB,EAAmCwE,cAAnC;AACAlP,WAAO0K,gBAAP,CAAwB,QAAxB,EAAkC0E,aAAlC;AACApP,WAAO0K,gBAAP,CAAwB,SAAxB,EAAmCuiB,cAAnC;AACAjtB,WAAO0K,gBAAP,CAAwB,YAAxB,EAAsCwiB,kBAAtC;AACAltB,WAAO0K,gBAAP,CAAwB,cAAxB,EAAwC4E,oBAAxC;AACAtP,WAAO0K,gBAAP,CAAwB,SAAxB,EAAmCvB,cAAnC;AACD;;AAED,WAASgkB,qBAAT,GAAiC;AAC/BntB,WAAO6K,mBAAP,CAA2B,mBAA3B,EAAgD2gB,qBAAhD;AACAxrB,WAAO6K,mBAAP,CAA2B,OAA3B,EAAoC4gB,YAApC;AACAzrB,WAAO6K,mBAAP,CAA2B,SAA3B,EAAsC6gB,cAAtC;AACA1rB,WAAO6K,mBAAP,CAA2B,gBAA3B,EAA6C8gB,qBAA7C;AACA3rB,WAAO6K,mBAAP,CAA2B,gBAA3B,EAA6CihB,sBAA7C;AACA9rB,WAAO6K,mBAAP,CAA2B,WAA3B,EAAwCghB,gBAAxC;AACA7rB,WAAO6K,mBAAP,CAA2B,OAA3B,EAAoC5B,YAApC;AACAjJ,WAAO6K,mBAAP,CAA2B,OAA3B,EAAoCmhB,YAApC;AACAhsB,WAAO6K,mBAAP,CAA2B,gBAA3B,EAA6CuhB,qBAA7C;AACApsB,WAAO6K,mBAAP,CAA2B,cAA3B,EAA2CwhB,mBAA3C;AACArsB,WAAO6K,mBAAP,CAA2B,YAA3B,EAAyCyhB,iBAAzC;AACAtsB,WAAO6K,mBAAP,CAA2B,gBAA3B,EAA6CuT,qBAA7C;AACApe,WAAO6K,mBAAP,CAA2B,WAA3B,EAAwC8hB,gBAAxC;AACA3sB,WAAO6K,mBAAP,CAA2B,OAA3B,EAAoCtB,aAApC;AACAvJ,WAAO6K,mBAAP,CAA2B,MAA3B,EAAmC+hB,WAAnC;AACA5sB,WAAO6K,mBAAP,CAA2B,SAA3B,EAAsCxB,cAAtC;AACArJ,WAAO6K,mBAAP,CAA2B,UAA3B,EAAuCiiB,eAAvC;AACA9sB,WAAO6K,mBAAP,CAA2B,YAA3B,EAAyCmiB,iBAAzC;AACAhtB,WAAO6K,mBAAP,CAA2B,SAA3B,EAAsCqE,cAAtC;AACAlP,WAAO6K,mBAAP,CAA2B,QAA3B,EAAqCuE,aAArC;AACApP,WAAO6K,mBAAP,CAA2B,SAA3B,EAAsCoiB,cAAtC;AACAjtB,WAAO6K,mBAAP,CAA2B,YAA3B,EAAyCqiB,kBAAzC;AACAltB,WAAO6K,mBAAP,CAA2B,cAA3B,EAA2CyE,oBAA3C;AACAtP,WAAO6K,mBAAP,CAA2B,SAA3B,EAAsC1B,cAAtC;AACD;;AAED,WAASiC,MAAT,CAAgB+b,MAAhB,EAAwB;AACtBnnB,WAAOgnB,GAAP,GAAaG,MAAb;AACD;;AAED,WAASiG,MAAT,GAAkB;AAChB,WAAOptB,OAAOgnB,GAAd;AACD;;AAED,WAASqG,SAAT,GAAqB;AACnBvG,QAAIC,eAAJ,CAAoB/mB,OAAOgnB,GAA3B;AACD;;AAED,WAAS1e,sBAAT,CAAgCC,UAAhC,EAA4C;AAC1C,QAAI+kB,oBAAJ;AACA,SAAK,IAAItqB,IAAI,CAAb,EAAgBA,IAAIhD,OAAO2L,QAAP,CAAgB1I,MAApC,EAA4C,EAAED,CAA9C,EAAiD;AAC/C,UAAIiR,QAAQjU,OAAO2L,QAAP,CAAgBsI,KAAhB,CAAsBjR,CAAtB,CAAZ;AACA,UAAI2W,MAAM3Z,OAAO2L,QAAP,CAAgBgO,GAAhB,CAAoB3W,CAApB,CAAV;;AAEA,UAAIuF,cAAc0L,KAAd,IAAuB1L,cAAcoR,GAAzC,EAA8C;AAC5C2T,sBAAc3T,GAAd;AACA;AACD;AACF;;AAED,WAAO2T,WAAP;AACD;;AAED,WAAS1pB,KAAT,GAAiB;AACfvD,WAAO+B,GAAP,CAAW,+BAAX;AACA;AACA;AACA,QAAIpC,MAAJ,EAAY;AACVA,aAAOutB,eAAP,CAAuB,KAAvB;AACAvtB,aAAOiS,IAAP;AACD;AACF;;AAED,MAAIjG,WAAW;AACb2e,oBAAgBA,cADH;AAEbtmB,UAAMA,IAFO;AAGbI,WAAOA,KAHM;AAIbC,cAAUA,QAJG;AAKbC,iBAAaA,WALA;AAMba,iBAAaA,WANA;AAObZ,iBAAaA,WAPA;AAQbC,sBAAkBA,gBARL;AASbC,uBAAmBA,iBATN;AAUbmmB,eAAWA,SAVE;AAWblmB,aAASA,OAXI;AAYbC,UAAMA,IAZO;AAabC,YAAQA,MAbK;AAcbC,aAASA,OAdI;AAebC,eAAWA,SAfE;AAgBbE,eAAWA,SAhBE;AAiBbC,2BAAuBA,qBAjBV;AAkBbK,gBAAYA,UAlBC;AAmBbE,iBAAaA,WAnBA;;AAqBbjC,WAAOA,KArBM;AAsBbwH,YAAQA,MAtBK;AAuBbiiB,eAAWA,SAvBE;AAwBb/kB,4BAAwBA;AAxBX,GAAf;;AA2BA3G;AACA,SAAOqK,QAAP;AACD;;AAEDye,mBAAmBnR,uBAAnB,GAA6C,oBAA7C;kBACe,uBAAaC,mBAAb,CAAiCkR,kBAAjC,C;;;;;;;;;;;;;;;;;AC9bf;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AAEA;;;;AACA;;;;AAIO,IAAM+C,wBAAQ;AACnBC,WAAS,SADU;AAEnBC,QAAM,MAFa;AAGnBC,eAAa,aAHM;AAInBC,gBAAc,cAJK;AAKnBC,8BAA4B,4BALT;AAMnBC,iBAAe,eANI;AAOnBC,WAAS,SAPU;AAQnBC,UAAQ,QARW;AASnBC,mBAAiB,iBATE;AAUnBC,SAAO,OAVY;AAWnB1rB,SAAO;AAXY,CAAd;;AAcP,SAAS2rB,gBAAT,GAA4B;AAC1B,MAAIxuB,WAAW,KAAKwV,OAApB;AACA,MAAIhV,YAAY,wBAASR,QAAT,EAAmBS,WAAnB,EAAhB;AACA,MAAIC,SAAS,qBAAMV,QAAN,EAAgBS,WAAhB,EAAb;;AAEA,MAAIglB,oBAAJ;;AAEA,MAAIgJ,aAAJ;AACA,MAAIC,iBAAJ;;AAEA;AACA,MAAIC,qBAAJ;AACA,MAAIC,cAAc,KAAlB;AACA;AACA,MAAIC,eAAJ;;AAEA,WAAS7sB,KAAT,GAAiB;AACf6sB,aAAShB,MAAME,IAAf;;AAEAU,WAAOjuB,SAAP;AACAiuB,SAAKK,MAAL;AACA;;AAEAJ,eAAW,sBAAYD,IAAZ,EAAkB,MAAlB,CAAX;;AAEAjuB,cAAU8D,EAAV,CAAa,iBAAOylB,eAApB,EAAqCC,gBAArC;AACAxpB,cAAU8D,EAAV,CAAa,iBAAOuhB,cAApB,EAAoCC,eAApC;;AAEAtlB,cAAU8D,EAAV,CAAa,iBAAOyqB,WAApB,EAAiCC,YAAjC;;AAEAxuB,cAAU8D,EAAV,CAAa,iBAAO2qB,cAApB,EAAoCC,cAApC,EAAoD,EAApD;AACA1uB,cAAU8D,EAAV,CAAa,iBAAO6qB,yBAApB,EAA+CC,wBAA/C,EAAyE,EAAzE;AACA5uB,cAAU8D,EAAV,CAAa,iBAAO+qB,iBAApB,EAAuCC,iBAAvC,EAA0D,EAA1D;AACA9uB,cAAU8D,EAAV,CAAa,iBAAOirB,WAApB,EAAiCC,YAAjC,EAA+C,EAA/C;;AAEAhvB,cAAU8D,EAAV,CAAa,iBAAOskB,eAApB,EAAqC6G,gBAArC;;AAEA;AACAjvB,cAAU8D,EAAV,CAAa,iBAAOuH,QAApB,EAA8Bwa,SAA9B;AACD;;AAED;AACA,WAASqJ,eAAT,GAA2B;AACzB,QAAIC,UAAU,IAAd;AACA,SAAK,IAAItsB,IAAI,CAAb,EAAgBA,IAAIoiB,YAAYriB,MAAZ,CAAmBE,MAAvC,EAA+CD,GAA/C,EAAoD;AAClD,UAAIusB,YAAYnK,YAAYriB,MAAZ,CAAmBC,CAAnB,CAAhB;AACA,UAAIusB,UAAU9sB,IAAV,KAAmB,QAAvB,EAAiC;AAC/B6sB,kBAAUC,UAAUC,YAApB;AACA;AACD;AACF;;AAED,WAAOF,OAAP;AACD;;AAED;AACA,WAAS3F,gBAAT,GAA4B,CAC3B;;AAED,WAASlE,eAAT,CAAyBxV,CAAzB,EAA4B;AAC1BmV,kBAAcnV,EAAEgX,UAAhB;AACAwI;AACD;;AAED,WAASzJ,SAAT,GAAqB;AACnByJ;AACD;;AAED,WAASd,YAAT,CAAsB1e,CAAtB,EAAyB;AACvB,QAAIyf,OAAOzf,EAAEyf,IAAb;AACA,QAAI1kB,OAAO0kB,KAAK1kB,IAAhB;;AAEA3K,WAAO+B,GAAP,wBAAgCstB,KAAKC,EAArC,gBAAkDD,KAAKzb,KAAvD,mBAA0Eyb,KAAKvf,QAA/E;AACA,QAAIuf,KAAKC,EAAL,KAAY,aAAhB,EAA+B;AAC7BD,WAAK1kB,IAAL,GAAYA,IAAZ;AACAwjB,eAAShB,MAAME,IAAf;AACA+B;AACD,KAJD,MAIO;AACLjB,eAAShB,MAAMO,OAAf;;AAEA,UAAIuB,UAAUD,iBAAd;AACA,UAAIO,kBAAkBN,QAAQO,WAAR,GAAsBP,QAAQO,WAAR,CAAoB7kB,IAA1C,GAAiD,EAAvE;AACAqjB,eAASxJ,IAAT,CAAc7Z,IAAd,EAAoB4kB,eAApB,EAAqCtpB,SAArC,EAAgDA,SAAhD,EAA2DopB,IAA3D,EAAiEtK,YAAYjV,QAA7E,EAAuF,IAAvF,EAA6F7J,SAA7F;AACD;AACF;;AAED,WAASuoB,cAAT,CAAwB7jB,IAAxB,EAA8B;AAC5B,QAAIc,IAAI,CAAR;AACA,QAAIC,IAAID,CAAR;AACD;;AAED,WAASijB,wBAAT,CAAkC/jB,IAAlC,EAAwC;AACtC7K,cAAUoC,OAAV,CAAkB,iBAAOmjB,YAAzB,EAAuC1a,KAAKjI,MAA5C;;AAEA1C,WAAO+B,GAAP,CAAW,2BAAX;AACA,SAAK,IAAI0tB,SAAT,IAAsB9kB,KAAKjI,MAA3B,EAAmC;AACjC,UAAIG,QAAQ8H,KAAKjI,MAAL,CAAY+sB,SAAZ,CAAZ;AACA,UAAID,cAAc3sB,MAAM2sB,WAAxB;AACA,UAAIA,WAAJ,EAAiB;AACf1vB,kBAAUoC,OAAV,CAAkB,iBAAOqjB,gBAAzB,EAA2C;AACzCnjB,gBAAMqtB,SADmC;AAEzCnL,mBAAS,aAFgC;AAGzC3Z,gBAAM6kB;AAHmC,SAA3C;AAKD;AACF;AACF;;AAED,WAASZ,iBAAT,CAA2BjkB,IAA3B,EAAiC;AAC/B;AACA,QAAI+kB,MAAM,CAAV;AACA,QAAI/kB,KAAKglB,KAAT,EAAgB;AACdD;AACD;AACD,QAAI/kB,KAAKilB,KAAT,EAAgB;AACdF;AACD;AACD;;AAEA1vB,WAAO+B,GAAP,8BAAsC2tB,GAAtC;AACA,KAAC/kB,KAAKglB,KAAN,EAAahlB,KAAKilB,KAAlB,EAAyBC,OAAzB,CAAiC,UAAC1I,MAAD,EAAS7F,KAAT,EAAmB;AAClD,UAAI6F,MAAJ,EAAY;AACVnnB,eAAO+B,GAAP,uBAA+Buf,KAA/B;AACAxhB,kBAAUoC,OAAV,CAAkB,iBAAOqjB,gBAAzB,EAA2C;AACzCnjB,gBAAMuI,KAAKvI,IAD8B;AAEzCkiB,mBAAS,MAFgC;AAGzC3Z,gBAAMwc;AAHmC,SAA3C;AAKD;AACF,KATD;AAUD;;AAED,WAAS2H,YAAT,CAAsBnkB,IAAtB,EAA4B;AAC1B3K,WAAO+B,GAAP,CAAW,eAAX;AACAosB,aAAShB,MAAMQ,MAAf;AACD;;AAED,WAASoB,gBAAT,CAA0Bnf,CAA1B,EAA6B;AAC3B,QAAIrO,QAAQjC,SAASiC,KAArB;AACA;AACAvB,WAAO+B,GAAP,wCAAgD,qBAAWgB,QAAX,CAAoBxB,MAAM+J,QAA1B,CAAhD,mBAAiG/J,MAAMuO,QAAvG;AACA,QAAIqe,WAAWhB,MAAMQ,MAAjB,IAA2B/d,EAAEqY,OAAF,KAAc,CAA7C,EAAgD;AAC9CkG,eAAShB,MAAME,IAAf;AACA;AACD;AACF;;AAED;AACA,WAASyC,YAAT,GAAwB,CAAE;;AAE1B,WAASC,aAAT,GAAyB;AACvB,QAAInlB,SAAStL,SAASsL,MAAtB;AACA,QAAIykB,OAAOzkB,OAAOolB,eAAP,EAAX;AACA,WAAOX,IAAP;AACD;;AAED,WAASD,IAAT,GAAgB;AACd,YAAQjB,MAAR;AACE,WAAKhB,MAAME,IAAX;AACE;AACE,cAAIgC,OAAOU,eAAX;AACA,cAAIV,IAAJ,EAAU;AACRvvB,sBAAUoC,OAAV,CAAkB,iBAAOqrB,YAAzB,EAAuC,EAAE8B,UAAF,EAAvC;AACAlB,qBAAShB,MAAMI,YAAf;AACD,WAHD,MAGO;AACLztB,sBAAUoC,OAAV,CAAkB,iBAAOujB,UAAzB;AACD;AACF;AACD;AACF,WAAK0H,MAAMC,OAAX;AACE;AAbJ;;AAgBA0C;AACD;;AAED,WAAS5kB,cAAT,GAA0B;AACxBkkB;AACD;;AAED,WAASpkB,SAAT,GAAqB;AACnBlL,cAAUoC,OAAV,CAAkB,iBAAO+tB,gBAAzB,EAA2C,EAAExtB,KAAKnD,SAASwC,QAAT,CAAkBW,GAAzB,EAA3C;AACD;;AAED,WAASytB,QAAT,GAAoB;AAClB/B,aAAShB,MAAMC,OAAf;AACD;;AAED,MAAIjE,YAAY;AACd;AACAje,oBAAgBA,cAFF;AAGdF,eAAWA,SAHG;AAIdklB,cAAUA;AAJI,GAAhB;AAMA5uB;AACA,SAAO6nB,SAAP;AACD;;AAED2E,iBAAiB7U,uBAAjB,GAA2C,kBAA3C;kBACe,uBAAaC,mBAAb,CAAiC4U,gBAAjC,C;;;;;;;;;;;;;;;;ACjOf;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;;;AAEA;AACA;AACA,IAAIqC,MAAMnpB,OAAOopB,aAAP,IAAwBppB,OAAOqpB,MAA/B,IAAyCrpB,OAAOspB,YAA1D;;AAEA,SAASC,mBAAT,GAA+B;AAC7B,MAAIjxB,WAAW,KAAKwV,OAApB;;AAEA,MAAInV,SAASL,SAASiC,KAAtB;AACA,MAAIzB,YAAY,wBAASR,QAAT,EAAmBS,WAAnB,EAAhB;AACA,MAAIC,SAAS,qBAAMV,QAAN,EAAgBS,WAAhB,EAAb;;AAEA,MAAIywB,eAAe,EAAnB;AACA,MAAIC,cAAc,EAAlB;;AAEA,WAASnvB,KAAT,GAAiB;AACfxB,cAAU8D,EAAV,CAAa,iBAAO8sB,YAApB,EAAkCC,iBAAlC;AACD;;AAED,WAASA,iBAAT,CAA2B/gB,CAA3B,EAA8B;AAC5B,QAAI4gB,iBAAiB,EAArB,EAAyB;AACvBA,qBAAe,GAAf;AACD;AACDC,gBAAYjM,IAAZ,CAAiB5U,EAAE/M,KAAnB;;AAEA/C,cAAUoC,OAAV,CAAkB,iBAAO0uB,WAAzB,EAAsC;AACpC/tB,aAAO+M,EAAE/M,KAD2B;AAEpCguB,mBAAaL;AAFuB,KAAtC;AAID;;AAED,WAASM,qBAAT,CAA+BlhB,CAA/B,EAAkC;AAChC,QAAImhB,UAAUnhB,EAAEmhB,OAAhB;AACA,QAAI7tB,OAAO0M,EAAE1M,IAAb;AACA,QAAID,QAAQ2M,EAAE3M,KAAd;AACA,QAAI+tB,YAAYrxB,OAAOsxB,YAAP,CAAoB/tB,IAApB,EAA0BD,KAA1B,EAAiCA,KAAjC,CAAhB;AACA+tB,cAAU1U,IAAV,GAAiB,QAAjB;AACA0U,cAAUE,WAAV,GAAwB,UAASthB,CAAT,EAAY;AAClC,UAAMuhB,aAAavhB,EAAEwhB,aAAF,CAAgBD,UAAnC;AACArlB,cAAQ/J,GAAR,CAAY,cAAZ,EAA4BovB,WAAW,CAAX,CAA5B;;AAEA;AACA,UAAME,YAAYF,WAAWA,WAAWvuB,MAAX,GAAoB,CAA/B,EAAkCyuB,SAApD;;AAEA,UAAIC,IAAI,IAAR;AACA,UAAI7lB,IAAI,CAAR;AACA,UAAIC,IAAID,CAAR;AACD,KAVD;;AAYA,QAAI8lB,UAAU,CAAC5xB,OAAO6xB,UAAP,CAAkB5uB,MAAlB,GAA2B,CAA5B,EAA+BG,QAA/B,EAAd;;AAEA,SAAK,IAAIJ,IAAI,CAAb,EAAgBA,IAAIouB,QAAQnuB,MAA5B,EAAoCD,GAApC,EAAyC;AACvC,UAAIoY,OAAOgW,QAAQpuB,CAAR,CAAX;AACA,UAAIgI,OAAO;AACT4mB,iBAASA,OADA;AAET3d,eAAOmH,KAAKnH,KAFH;AAGT0F,aAAKyB,KAAKzB,GAHD;AAITmY,cAAM1W,KAAKpQ;AAJF,OAAX;;AAOA,UAAI+mB,MAAMC,UAAUhnB,IAAV,CAAV;AACAqmB,gBAAUY,MAAV,CAAiBF,GAAjB;AACD;;AAED,QAAI7uB,QAAQ;AACVC,UAAIyuB,OADM;AAEVvuB,YAAM4M,EAAE3M,KAFE;AAGVA,aAAO2M,EAAE3M;AAHC,KAAZ;AAKAwtB,gBAAYjM,IAAZ,CAAiB3hB,KAAjB;;AAEA;AACA,QAAI2tB,iBAAiB,EAArB,EAAyB;AACvB,UAAIe,YAAY,GAAhB,EAAqB;AACnBf,uBAAee,OAAf;AACAP,kBAAU1U,IAAV,GAAiB,SAAjB;AACD;AACF;;AAED;AACAxc,cAAUoC,OAAV,CAAkB,iBAAO0uB,WAAzB,EAAsC;AACpC/tB,aAAOA,KAD6B;AAEpCguB,mBAAaL;AAFuB,KAAtC;AAID;;AAED,WAASmB,SAAT,CAAmBhnB,IAAnB,EAAyB;AACvB,aAASknB,aAAT,CAAuB/uB,EAAvB,EAA2B;AACzB,UAAI+mB,YAAJ;AACA,WAAK,IAAIlnB,IAAI,CAAb,EAAgBA,IAAIhD,OAAO6xB,UAAP,CAAkB5uB,MAAtC,EAA8CD,GAA9C,EAAmD;AACjD,YAAIE,QAAQlD,OAAO6xB,UAAP,CAAkB7uB,CAAlB,CAAZ;AACA,YAAIG,OAAOH,EAAEI,QAAF,EAAX,EAAyB;AACvB8mB,gBAAMhnB,KAAN;AACD;AACF;AACD,aAAOgnB,GAAP;AACD;;AAED,QAAI6H,MAAM,IAAIvB,GAAJ,CAAQxlB,KAAKiJ,KAAb,EAAoBjJ,KAAK2O,GAAzB,EAA8B,EAA9B,CAAV;AACAoY,QAAI/mB,IAAJ,GAAWA,IAAX;AACA;AACA;AACA+mB,QAAII,OAAJ,GAAc,YAAW;AACvB,UAAInnB,OAAO,KAAKA,IAAhB;AACAmB,cAAQ/J,GAAR,gBAAyB4I,KAAKiJ,KAA9B,UAAwCjJ,KAAK2O,GAA7C,YAAuD3O,KAAK8mB,IAA5D;AACD,KAHD;AAIAC,QAAIK,MAAJ,GAAa,YAAW;AACtB,UAAIpnB,OAAO,KAAKA,IAAhB;AACAmB,cAAQ/J,GAAR,eAAwB4I,KAAKiJ,KAA7B,UAAuCjJ,KAAK2O,GAA5C,YAAsD3O,KAAK8mB,IAA3D;AACD,KAHD;;AAKA,WAAOC,GAAP;AACD;;AAED,WAAST,YAAT,GAAwB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACD;;AAED,WAASrrB,iBAAT,GAA6B;AAC3B,WAAO6qB,WAAP;AACD;;AAED;;;AAGA,WAAS5qB,uBAAT,GAAmC;AACjC,QAAImsB,kBAAJ;AACA,SAAK,IAAIrvB,IAAI,CAAb,EAAgBA,IAAI8tB,YAAY7tB,MAAhC,EAAwCD,GAAxC,EAA6C;AAC3C,UAAIE,QAAQ4tB,YAAY9tB,CAAZ,CAAZ;AACA,UAAIE,MAAMC,EAAN,KAAa0tB,YAAjB,EAA+B;AAC7BwB,oBAAYnvB,KAAZ;AACD;AACF;AACD,WAAOmvB,SAAP;AACD;;AAED,WAASlsB,mBAAT,CAA6BhD,EAA7B,EAAiC;AAC/B0tB,mBAAe1tB,EAAf;;AAEAhD,cAAUoC,OAAV,CAAkB,iBAAO+vB,aAAzB,EAAwC;AACtCpB,mBAAaL;AADyB,KAAxC;AAGD;;AAED,MAAI7kB,WAAW;AACb/F,uBAAmBA,iBADN;AAEbC,6BAAyBA,uBAFZ;AAGbC,yBAAqBA;AAHR,GAAf;;AAMAxE;;AAEA,SAAOqK,QAAP;AACD;;AAED4kB,oBAAoBtX,uBAApB,GAA8C,qBAA9C;kBACe,uBAAaC,mBAAb,CAAiCqX,mBAAjC,C;;;;;;;;;;;;;;;;AC/Pf;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;;;AAEA,SAAS2B,mBAAT,GAA+B;AAC7B,MAAI5yB,WAAW,KAAKwV,OAApB;AACA,MAAIhV,YAAY,wBAASR,QAAT,EAAmBS,WAAnB,EAAhB;AACA,MAAIC,SAAS,qBAAMV,QAAN,EAAgBS,WAAhB,EAAb;;AAEA,MAAIoyB,aAAa,0BAAjB;AACA,MAAIC,aAAa,yBAAU9yB,QAAV,EAAoBS,WAApB,EAAjB;;AAEA,MAAIsyB,eAAJ;AACA,MAAIC,wBAAJ;;AAEA,WAAShxB,KAAT,GAAiB;AACfxB,cAAU8D,EAAV,CAAa,iBAAOR,iBAApB,EAAuCmvB,kBAAvC;AACD;;AAED,WAASA,kBAAT,CAA4B5nB,IAA5B,EAAkC;AAChC0nB,aAAS1nB,KAAK9H,KAAd;;AAEA,QAAIkV,UAAU;AACZtV,WAAK4vB,OAAOG;AADA,KAAd;AAGA,QAAIC,YAAY;AACdC,iBAAWC;AADG,KAAhB;AAGAR,eAAWvgB,IAAX,CAAgBmG,OAAhB,EAAyB,IAAzB,EAA+B0a,SAA/B;AACD;;AAED,WAASE,yBAAT,CAAmCxL,MAAnC,EAA2C;AACzC,aAASyL,YAAT,CAAsBnB,IAAtB,EAA4BoB,OAA5B,EAAqC;AACnC,UAAIC,gBAAgB,EAApB;AACA,UAAIC,UAAU,IAAd;AACA,UAAIzR,QAAQmQ,KAAKjf,OAAL,CAAa,GAAb,CAAZ;AACA,UAAI8O,QAAQ,CAAZ,EAAe;AACbwR,sBAAcrwB,GAAd,GAAoBgvB,KAAKxe,KAAL,CAAW,CAAX,EAAcqO,KAAd,CAApB;AACD,OAFD,MAEO;AACLwR,sBAAcrwB,GAAd,GAAoBgvB,IAApB;AACD;AACD,UAAIqB,cAAcrwB,GAAd,CAAkB+P,OAAlB,CAA0B,KAA1B,IAAmC,CAAvC,EAA0C;AACxC,YAAIqgB,OAAJ,EAAa;AACX,cAAIA,QAAQA,QAAQjwB,MAAR,GAAiB,CAAzB,MAAgC,GAApC,EAAyC;AACvCkwB,0BAAcrwB,GAAd,GAAoBowB,UAAU,GAAV,GAAgBC,cAAcrwB,GAAlD;AACD,WAFD,MAEO;AACLqwB,0BAAcrwB,GAAd,GAAoBowB,UAAUC,cAAcrwB,GAA5C;AACD;AACF;AACF;AACD6e,cAAQmQ,KAAKjf,OAAL,CAAa,GAAb,CAAR;AACA,UAAI8O,QAAQ,CAAZ,EAAe;AACbyR,kBAAWtB,KAAKxe,KAAL,CAAWqO,QAAQ,CAAnB,CAAD,CAAwBhO,KAAxB,CAA8B,GAA9B,CAAV;AACAwf,sBAAcE,CAAd,GAAkBD,QAAQ,CAAR,IAAatY,SAASsY,QAAQ,CAAR,CAAT,CAAb,GAAoC,IAAtD;AACAD,sBAAcG,CAAd,GAAkBF,QAAQ,CAAR,IAAatY,SAASsY,QAAQ,CAAR,CAAT,CAAb,GAAoC,IAAtD;AACAD,sBAAcI,CAAd,GAAkBH,QAAQ,CAAR,IAAatY,SAASsY,QAAQ,CAAR,CAAT,CAAb,GAAoC,IAAtD;AACAD,sBAAczQ,CAAd,GAAkB0Q,QAAQ,CAAR,IAAatY,SAASsY,QAAQ,CAAR,CAAT,CAAb,GAAoC,IAAtD;AACD;AACD,aAAOD,aAAP;AACD;;AAED,QAAInoB,OAAO,uBAAYwoB,SAAZ,CAAsBhM,MAAtB,CAAX;AACAmL,sBAAkBF,WAAWzY,KAAX,CAAiBhP,IAAjB,CAAlB;;AAEA,QAAIyoB,YAAYf,OAAOG,IAAP,CAAYa,WAAZ,CAAwB,GAAxB,CAAhB;AACA,QAAIR,UAAUR,OAAOG,IAAP,CAAYc,SAAZ,CAAsB,CAAtB,EAAyBF,SAAzB,CAAd;AACA,SAAK,IAAIzwB,IAAI,CAAb,EAAgBA,IAAI2vB,gBAAgB1vB,MAApC,EAA4CD,GAA5C,EAAiD;AAC/C2vB,sBAAgB3vB,CAAhB,EAAmBgI,IAAnB,GAA0BioB,aAAaN,gBAAgB3vB,CAAhB,EAAmBgI,IAAhC,EAAsCkoB,OAAtC,CAA1B;AACD;AACF;;AAED,WAAS9sB,YAAT,CAAsBC,IAAtB,EAA4B;AAC1B,QAAI,CAACssB,eAAL,EAAsB;AACpB,aAAO,IAAP;AACD;;AAED,SAAK,IAAI3vB,CAAT,IAAc2vB,eAAd,EAA+B;AAC7B,UAAIjhB,OAAOihB,gBAAgB3vB,CAAhB,CAAX;AACA,UAAI0O,KAAKuC,KAAL,IAAc5N,IAAd,IAAsBA,QAAQqL,KAAKiI,GAAvC,EAA4C;AAC1C,eAAOjI,IAAP;AACD;AACF;;AAED,WAAO,IAAP;AACD;;AAED,MAAI8X,YAAY;AACdpjB,kBAAcA;AADA,GAAhB;AAGAzE;AACA,SAAO6nB,SAAP;AACD;;AAED+I,oBAAoBjZ,uBAApB,GAA8C,qBAA9C;kBACe,uBAAaC,mBAAb,CAAiCgZ,mBAAjC,C;;;;;;;;;;;;;;;;ACrEf;;;;AACA;;;;AACA;;;;;;AAEA,IAAMqB,iBAAiB,CAAvB,C,CAlCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA,IAAMC,kBAAkB,CAAxB;AACA,IAAMC,kBAAkB,CAAxB;AACA,IAAMC,oBAAoB,CAA1B;AACA,IAAMC,iBAAiB,CAAvB;AACA,IAAMC,kBAAkB,CAAxB;;AAEA;;;AAGA,SAASC,KAAT,GAAiB;;AAEf,MAAI/e,UAAU,KAAKA,OAAnB;AACA,MAAIgf,WAAW,wBAAShf,OAAT,EAAkB/U,WAAlB,EAAf;;AAEA,MAAMg0B,QAAQ,EAAd;;AAEA,MAAIpoB,iBAAJ;AAAA,MACEqoB,4BADF;AAAA,MAEEC,yBAFF;AAAA,MAGEC,uBAHF;AAAA,MAIE7C,kBAJF;;AAMA,WAAS/vB,KAAT,GAAiB;AACf0yB,0BAAsB,IAAtB;AACAC,uBAAmB,IAAnB;AACAC,qBAAiB,IAAjB;AACA7C,gBAAY,IAAI8C,IAAJ,GAAWC,OAAX,EAAZ;;AAEA,QAAI,OAAOptB,MAAP,KAAkB,WAAlB,IAAiCA,OAAO8E,OAA5C,EAAqD;AACnDioB,YAAMP,eAAN,IAAyBa,SAASrtB,OAAO8E,OAAP,CAAe8f,KAAxB,CAAzB;AACAmI,YAAMN,eAAN,IAAyBY,SAASrtB,OAAO8E,OAAP,CAAe8f,KAAxB,CAAzB;AACAmI,YAAML,iBAAN,IAA2BW,SAASrtB,OAAO8E,OAAP,CAAeoL,IAAxB,CAA3B;AACA6c,YAAMJ,cAAN,IAAwBU,SAASrtB,OAAO8E,OAAP,CAAeuF,IAAxB,CAAxB;AACA0iB,YAAMH,eAAN,IAAyBS,SAASrtB,OAAO8E,OAAP,CAAewoB,KAAxB,CAAzB;AACD;AACF;;AAED,WAASD,QAAT,CAAkBE,EAAlB,EAAsB;AACpB,QAAIA,MAAMA,GAAGC,IAAb,EAAmB;AACjB,aAAOD,GAAGC,IAAH,CAAQxtB,OAAO8E,OAAf,CAAP;AACD;AACD;AACA,WAAO9E,OAAO8E,OAAP,CAAe/J,GAAf,CAAmByyB,IAAnB,CAAwBxtB,OAAO8E,OAA/B,CAAP;AACD;;AAED;;;;;;;AAOA,WAAS2oB,sBAAT,CAAgC5a,KAAhC,EAAuC;AACrCoa,uBAAmBpa,KAAnB;AACD;AACD;;;;;;;AAOA,WAAS6a,oBAAT,CAA8B7a,KAA9B,EAAqC;AACnCqa,qBAAiBra,KAAjB;AACD;AACD;;;;;;;AAOA,WAAS8a,sBAAT,CAAgC9a,KAAhC,EAAuC;AACrCma,0BAAsBna,KAAtB;AACD;AACD;;;;;;AAMA,WAAS+a,sBAAT,GAAkC;AAChC,WAAOZ,mBAAP;AACD;;AAED,WAASa,KAAT,GAA0B;AAAA,sCAARC,MAAQ;AAARA,YAAQ;AAAA;;AACxBC,4BAAMvB,eAAN,SAA0BsB,MAA1B;AACD;;AAED,WAASlJ,KAAT,GAA0B;AAAA,uCAARkJ,MAAQ;AAARA,YAAQ;AAAA;;AACxBC,4BAAMtB,eAAN,SAA0BqB,MAA1B;AACD;;AAED,WAAS5d,IAAT,GAAyB;AAAA,uCAAR4d,MAAQ;AAARA,YAAQ;AAAA;;AACvBC,4BAAMrB,iBAAN,SAA4BoB,MAA5B;AACD;;AAED,WAASzjB,IAAT,GAAyB;AAAA,uCAARyjB,MAAQ;AAARA,YAAQ;AAAA;;AACvBC,4BAAMpB,cAAN,SAAyBmB,MAAzB;AACD;;AAED,WAASR,KAAT,GAA0B;AAAA,uCAARQ,MAAQ;AAARA,YAAQ;AAAA;;AACxBC,4BAAMnB,eAAN,SAA0BkB,MAA1B;AACD;;AAED,WAAS/yB,GAAT,GAAwB;AAAA,uCAAR+yB,MAAQ;AAARA,YAAQ;AAAA;;AACtBC,4BAAMnB,eAAN,SAA0BkB,MAA1B;AACD;;AAED;;;;;;AAMA,WAASC,KAAT,CAAeC,KAAf,EAAiC;AAC/B,QAAIvkB,UAAU,EAAd;AACA,QAAIwkB,UAAU,IAAd;;AAEA,QAAIhB,gBAAJ,EAAsB;AACpB;AACA;AACA;AACA;AACAgB,gBAAU,IAAId,IAAJ,EAAV;AACA1jB,iBAAW,MAAM,CAAC,OAAOwkB,QAAQC,QAAR,KAAqB,CAA5B,CAAD,EAAiCjiB,KAAjC,CAAuC,CAAC,CAAxC,CAAN,GAAmD,GAAnD,GACT,CAAC,MAAMgiB,QAAQE,OAAR,EAAP,EAA0BliB,KAA1B,CAAgC,CAAC,CAAjC,CADS,GAC6B,GAD7B,GAET,CAAC,MAAMgiB,QAAQG,QAAR,EAAP,EAA2BniB,KAA3B,CAAiC,CAAC,CAAlC,CAFS,GAE8B,GAF9B,GAGT,CAAC,MAAMgiB,QAAQI,UAAR,EAAP,EAA6BpiB,KAA7B,CAAmC,CAAC,CAApC,CAHS,GAGgC,GAHhC,GAIT,CAAC,MAAMgiB,QAAQK,UAAR,EAAP,EAA6BriB,KAA7B,CAAmC,CAAC,CAApC,CAJS,GAIgC,GAJhC,GAKT,CAAC,MAAMgiB,QAAQM,eAAR,EAAP,EAAkCtiB,KAAlC,CAAwC,CAAC,CAAzC,CALS,GAKqC,GALhD;AAMD;;AAED,QAAIihB,kBAAkB,IAAlB,IAA0B,KAAKsB,YAAnC,EAAiD;AAC/C/kB,iBAAW,MAAM,KAAK+kB,YAAL,EAAN,GAA4B,GAAvC;AACA,UAAI,KAAKC,OAAT,EAAkB;AAChBhlB,mBAAW,MAAM,KAAKglB,OAAL,EAAN,GAAuB,GAAlC;AACD;AACF;;AAED,QAAIhlB,QAAQ7N,MAAR,GAAiB,CAArB,EAAwB;AACtB6N,iBAAW,GAAX;AACD;;AA3B8B,uCAARqkB,MAAQ;AAARA,YAAQ;AAAA;;AA6B/Bjc,UAAM6c,KAAN,CAAY,IAAZ,EAAkBZ,MAAlB,EAA0BjF,OAA1B,CAAkC,UAAS9U,IAAT,EAAe;AAC/CtK,iBAAWsK,OAAO,GAAlB;AACD,KAFD;;AAIA,QAAIgZ,MAAMiB,KAAN,CAAJ,EAAkB;AAChBjB,YAAMiB,KAAN,EAAavkB,OAAb;AACD;;AAEDqjB,aAAS5xB,OAAT,CAAiB,iBAAOye,GAAxB,EAA6B;AAC3BlQ,eAASA;AADkB,KAA7B;AAGD;;AAED9E,aAAW;AACTkpB,WAAOA,KADE;AAETjJ,WAAOA,KAFE;AAGT1U,UAAMA,IAHG;AAIT7F,UAAMA,IAJG;AAKTijB,WAAOA,KALE;AAMTvyB,SAAKA,GANI;AAOT0yB,4BAAwBA,sBAPf;AAQTC,0BAAsBA,oBARb;AASTC,4BAAwBA,sBATf;AAUTC,4BAAwBA;AAVf,GAAX;;AAaAtzB;;AAEA,SAAOqK,QAAP;AACD;;AAEDkoB,MAAM5a,uBAAN,GAAgC,OAAhC;AACA,IAAM0c,UAAU,uBAAazc,mBAAb,CAAiC2a,KAAjC,CAAhB;AACA8B,QAAQpC,cAAR,GAAyBA,cAAzB;AACAoC,QAAQnC,eAAR,GAA0BA,eAA1B;AACAmC,QAAQlC,eAAR,GAA0BA,eAA1B;AACAkC,QAAQjC,iBAAR,GAA4BA,iBAA5B;AACAiC,QAAQhC,cAAR,GAAyBA,cAAzB;AACAgC,QAAQ/B,eAAR,GAA0BA,eAA1B;kBACe+B,O;;;;;;;;;;;;;;;;AC5Lf;;;;;;AAEA,IAAMC,qBAAqB,CAA3B,C,CAhCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA,IAAMC,sBAAsB,IAA5B;;AAEA,SAASC,QAAT,GAAoB;;AAElB,MAAIC,WAAW,EAAf;;AAEA,WAASnyB,EAAT,CAAYoyB,MAAZ,EAAoBnyB,QAApB,EAA8BC,KAA9B,EAAoE;AAAA,QAA/BmyB,QAA+B,uEAApBL,kBAAoB;;;AAElE,QAAI,CAACI,MAAL,EAAa;AACX,YAAM,IAAIE,KAAJ,CAAU,0CAAV,CAAN;AACD;AACD,QAAI,CAACryB,QAAD,IAAa,OAAOA,QAAP,KAAqB,UAAtC,EAAkD;AAChD,YAAM,IAAIqyB,KAAJ,CAAU,kCAAkCryB,QAA5C,CAAN;AACD;;AAED,QAAIsyB,cAAcH,MAAd,EAAsBnyB,QAAtB,EAAgCC,KAAhC,KAA0C,CAA9C,EAAiD;;AAEjDiyB,aAASC,MAAT,IAAmBD,SAASC,MAAT,KAAoB,EAAvC;;AAEA,QAAMI,UAAU;AACdC,gBAAUxyB,QADI;AAEdC,aAAOA,KAFO;AAGdmyB,gBAAUA;AAHI,KAAhB;;AAMA,QAAMK,WAAWP,SAASC,MAAT,EAAiBO,IAAjB,CAAsB,UAACxb,IAAD,EAAOyb,GAAP,EAAe;AACpD,UAAIP,WAAWlb,KAAKkb,QAApB,EAA8B;AAC5BF,iBAASC,MAAT,EAAiBS,MAAjB,CAAwBD,GAAxB,EAA6B,CAA7B,EAAgCJ,OAAhC;AACA,eAAO,IAAP;AACD;AACF,KALgB,CAAjB;;AAOA,QAAI,CAACE,QAAL,EAAe;AACbP,eAASC,MAAT,EAAiBxR,IAAjB,CAAsB4R,OAAtB;AACD;AACF;;AAED,WAASryB,GAAT,CAAaiyB,MAAb,EAAqBnyB,QAArB,EAA+BC,KAA/B,EAAsC;AACpC,QAAI,CAACkyB,MAAD,IAAW,CAACnyB,QAAZ,IAAwB,CAACkyB,SAASC,MAAT,CAA7B,EAA+C;AAC/C,QAAMQ,MAAML,cAAcH,MAAd,EAAsBnyB,QAAtB,EAAgCC,KAAhC,CAAZ;AACA,QAAI0yB,MAAM,CAAV,EAAa;AACbT,aAASC,MAAT,EAAiBS,MAAjB,CAAwBD,GAAxB,EAA6B,CAA7B;AACD;;AAED,WAASt0B,OAAT,CAAiB8zB,MAAjB,EAAyBU,OAAzB,EAAkC;AAChC,QAAI,CAACV,MAAD,IAAW,CAACD,SAASC,MAAT,CAAhB,EAAkC;;AAElCU,cAAUA,WAAW,EAArB;;AAEA,QAAIA,QAAQC,cAAR,CAAuB,QAAvB,CAAJ,EAAsC,MAAM,IAAIT,KAAJ,CAAU,qDAAV,CAAN;;AAEtCQ,YAAQV,MAAR,GAAiBA,MAAjB;;AAEAD,aAASC,MAAT,EAAiBnG,OAAjB,CAAyB;AAAA,aAAWuG,QAAQC,QAAR,CAAiBtd,IAAjB,CAAsBqd,QAAQtyB,KAA9B,EAAqC4yB,OAArC,CAAX;AAAA,KAAzB;AACD;;AAED,WAASP,aAAT,CAAuBH,MAAvB,EAA+BnyB,QAA/B,EAAyCC,KAAzC,EAAgD;;AAE9C,QAAI0yB,MAAM,CAAC,CAAX;;AAEA,QAAI,CAACT,SAASC,MAAT,CAAL,EAAuB,OAAOQ,GAAP;;AAEvBT,aAASC,MAAT,EAAiBO,IAAjB,CAAsB,UAACxb,IAAD,EAAOuG,KAAP,EAAiB;AACrC,UAAIvG,KAAKsb,QAAL,KAAkBxyB,QAAlB,KAA+B,CAACC,KAAD,IAAUA,UAAUiX,KAAKjX,KAAxD,CAAJ,EAAoE;AAClE0yB,cAAMlV,KAAN;AACA,eAAO,IAAP;AACD;AACF,KALD;AAMA,WAAOkV,GAAP;AACD;;AAED,WAASI,KAAT,GAAiB;AACfb,eAAW,EAAX;AACD;;AAED,MAAMpqB,WAAW;AACf/H,QAAIA,EADW;AAEfG,SAAKA,GAFU;AAGf7B,aAASA,OAHM;AAIf00B,WAAOA;AAJQ,GAAjB;;AAOA,SAAOjrB,QAAP;AACD;;AAEDmqB,SAAS7c,uBAAT,GAAmC,UAAnC;AACA,IAAM0c,UAAU,uBAAazc,mBAAb,CAAiC4c,QAAjC,CAAhB;AACAH,QAAQC,kBAAR,GAA6BA,kBAA7B;AACAD,QAAQE,mBAAR,GAA8BA,mBAA9B;kBACeF,O;;;;;;;;;;;;;;;AC1Hf;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;;;AAGA,IAAIkB,eAAgB,YAAW;;AAE7B,MAAIlrB,iBAAJ;AACA,MAAImrB,aAAa,EAAjB;AACA,MAAIC,oBAAoB,EAAxB;;AAEA,WAASC,MAAT,CAAgBC,IAAhB,EAAsBC,aAAtB,EAAqCC,QAArC,EAA+CriB,OAA/C,EAAwD;AACtD,QAAIsiB,mBAAmBC,oBAAoBviB,OAApB,CAAvB;AACA,QAAI,CAACsiB,iBAAiBH,IAAjB,CAAD,IAA2BC,aAA/B,EAA8C;AAC5CE,uBAAiBH,IAAjB,IAAyB;AACvBtrB,kBAAUurB,aADa;AAEvBC,kBAAUA;AAFa,OAAzB;AAID;AACF;;AAED;;;;;;;;;;;;AAYA,WAASG,oBAAT,CAA8BxiB,OAA9B,EAAuCyiB,SAAvC,EAAkD;AAChD,SAAK,IAAI50B,CAAT,IAAco0B,iBAAd,EAAiC;AAC/B,UAAI1d,MAAM0d,kBAAkBp0B,CAAlB,CAAV;AACA,UAAI0W,IAAIvE,OAAJ,KAAgBA,OAAhB,IAA2BuE,IAAI4d,IAAJ,KAAaM,SAA5C,EAAuD;AACrD,eAAOle,IAAI1N,QAAX;AACD;AACF;AACD,WAAO,IAAP;AACD;;AAED;;;;;;;;;AASA,WAAS6rB,oBAAT,CAA8B1iB,OAA9B,EAAuCyiB,SAAvC,EAAkD5rB,QAAlD,EAA4D;AAC1D,SAAK,IAAIhJ,CAAT,IAAco0B,iBAAd,EAAiC;AAC/B,UAAI1d,MAAM0d,kBAAkBp0B,CAAlB,CAAV;AACA,UAAI0W,IAAIvE,OAAJ,KAAgBA,OAAhB,IAA2BuE,IAAI4d,IAAJ,KAAaM,SAA5C,EAAuD;AACrDR,0BAAkBp0B,CAAlB,EAAqBgJ,QAArB,GAAgCA,QAAhC;AACA;AACD;AACF;AACDorB,sBAAkBvS,IAAlB,CAAuB;AACrByS,YAAMM,SADe;AAErBziB,eAASA,OAFY;AAGrBnJ,gBAAUA;AAHW,KAAvB;AAKD;;AAED,WAAS8rB,eAAT,CAAyBC,gBAAzB,EAA2C;AACzC,WAAO,UAAS5iB,OAAT,EAAkB;AACvB,UAAIA,YAAY7O,SAAhB,EAA2B;AACzB6O,kBAAU,EAAV;AACD;;AAED,aAAO;AACL3M,gBAAQ,kBAAW;AACjB,iBAAOwvB,MAAMD,iBAAiBze,uBAAvB,EAAgDye,iBAAiBhC,KAAjB,CAAuB;AAC5E5gB,qBAASA;AADmE,WAAvB,EAEpDkE,SAFoD,CAAhD,EAEQlE,OAFR,EAEiBkE,SAFjB,CAAP;AAGD;AALI,OAAP;AAOD,KAZD;AAaD;;AAED,WAASE,mBAAT,CAA6Bwe,gBAA7B,EAA+C;AAC7C,WAAO,UAAS5iB,OAAT,EAAkB;AACvB,UAAInJ,iBAAJ;AACA,UAAImJ,YAAY7O,SAAhB,EAA2B;AACzB6O,kBAAU,EAAV;AACD;AACD,aAAO;AACL/U,qBAAa,uBAAW;AACtB;AACA,cAAI,CAAC4L,QAAL,EAAe;AACbA,uBAAW2rB,qBAAqBxiB,OAArB,EAA8B4iB,iBAAiBze,uBAA/C,CAAX;AACD;AACD;AACA,cAAI,CAACtN,QAAL,EAAe;AACbA,uBAAWgsB,MAAMD,iBAAiBze,uBAAvB,EAAgDye,iBAAiBhC,KAAjB,CAAuB;AAChF5gB,uBAASA;AADuE,aAAvB,EAExDkE,SAFwD,CAAhD,EAEIlE,OAFJ,EAEakE,SAFb,CAAX;AAGA+d,8BAAkBvS,IAAlB,CAAuB;AACrByS,oBAAMS,iBAAiBze,uBADF;AAErBnE,uBAASA,OAFY;AAGrBnJ,wBAAUA;AAHW,aAAvB;AAKD;AACD,iBAAOA,QAAP;AACD;AAlBI,OAAP;AAoBD,KAzBD;AA0BD;;AAED,WAASgsB,KAAT,CAAeV,IAAf,EAAqBS,gBAArB,EAAuC5iB,OAAvC,EAAgD8D,IAAhD,EAAsD;AACpD,QAAIwe,mBAAmBC,oBAAoBviB,OAApB,CAAvB;AACA,QAAI8iB,kBAAkBR,iBAAiBH,IAAjB,CAAtB;AACA,QAAIW,eAAJ,EAAqB;AACnB,UAAIzN,YAAYyN,gBAAgBjsB,QAAhC;AACA,UAAIisB,gBAAgBT,QAApB,EAA8B;AAAE;AAC9BhN,oBAAYA,UAAUuL,KAAV,CAAgB;AAC1B5gB,mBAASA,OADiB;AAE1B6gB,mBAAShqB,QAFiB;AAG1BksB,kBAAQH;AAHkB,SAAhB,EAIT9e,IAJS,CAAZ;AAKA,aAAK,IAAMkf,IAAX,IAAmB3N,SAAnB,EAA8B;AAC5B,cAAIuN,iBAAiBf,cAAjB,CAAgCmB,IAAhC,CAAJ,EAA2C;AACzCJ,6BAAiBI,IAAjB,IAAyB3N,UAAU2N,IAAV,CAAzB;AACD;AACF;AACF,OAXD,MAWO;AAAE;AACP,eAAO3N,UAAUuL,KAAV,CAAgB;AACrB5gB,mBAASA,OADY;AAErB6gB,mBAAShqB;AAFY,SAAhB,EAGJiN,IAHI,CAAP;AAID;AACF;AACD,WAAO8e,gBAAP;AACD;;AAED,WAASL,mBAAT,CAA6BviB,OAA7B,EAAsC;AACpC,QAAIsiB,yBAAJ;AACAN,eAAWjH,OAAX,CAAmB,UAASxW,GAAT,EAAc;AAC/B,UAAIA,QAAQvE,OAAZ,EAAqB;AACnBsiB,2BAAmB/d,GAAnB;AACD;AACF,KAJD;AAKA,QAAI,CAAC+d,gBAAL,EAAuB;AACrBA,yBAAmBN,WAAWtS,IAAX,CAAgB1P,OAAhB,CAAnB;AACD;AACD,WAAOsiB,gBAAP;AACD;;AAEDzrB,aAAW;AACTqrB,YAAQA,MADC;AAETM,0BAAsBA,oBAFb;AAGTE,0BAAsBA,oBAHb;AAITte,yBAAqBA,mBAJZ;AAKTue,qBAAiBA;AALR,GAAX;;AAQA,SAAO9rB,QAAP;AAED,CA5JmB,EAApB;;kBA8JekrB,Y;;;;;;;;;;;;;;;AC/LR,IAAMkB,kCAAa;AACxB;AACA11B,iBAAe;AAFS,CAAnB;;AAKA,IAAM21B,sCAAe,EAArB,C;;;;;;;;;;;;;;;;;;ACLP;;;;IAIMC,U;AACJ;;;AAGA,sBAAc;AAAA;;AACZ;AACA,SAAKxvB,aAAL,GAAqB,cAArB;AACA,SAAK8iB,qBAAL,GAA6B,qBAA7B;AACA,SAAKG,sBAAL,GAA8B,sBAA9B;AACA,SAAK/iB,WAAL,GAAmB,YAAnB;AACA,SAAK0jB,gBAAL,GAAwB,iBAAxB;AACA,SAAKvO,oBAAL,GAA4B,qBAA5B;AACA,SAAK7U,YAAL,GAAoB,aAApB;AACA,SAAKujB,UAAL,GAAkB,WAAlB;AACA,SAAKzjB,aAAL,GAAqB,cAArB;AACA,SAAK6F,aAAL,GAAqB,cAArB;AACA,SAAKE,YAAL,GAAoB,aAApB;AACA,SAAKJ,gBAAL,GAAwB,iBAAxB;AACA,SAAKM,oBAAL,GAA4B,oBAA5B;AACA,SAAKnG,aAAL,GAAqB,cAArB;;AAEA;AACA,SAAK8U,QAAL,GAAgB,SAAhB;AACA,SAAKyF,UAAL,GAAkB,WAAlB;AACA,SAAKuB,WAAL,GAAmB,YAAnB;AACA,SAAK9a,SAAL,GAAiB,UAAjB;AACA,SAAKE,UAAL,GAAkB,WAAlB;AACA,SAAKR,0BAAL,GAAkC,yBAAlC;AACA,SAAKE,2BAAL,GAAmC,0BAAnC;AACA,SAAKyuB,qBAAL,GAA6B,oBAA7B;AACA,SAAKlV,aAAL,GAAqB,cAArB;AACA,SAAK0B,aAAL,GAAqB,cAArB;AACA,SAAKhC,iBAAL,GAAyB,iBAAzB;AACA;AACA,SAAK/Y,mBAAL,GAA2B,mBAA3B;;AAEA;AACA,SAAKc,iBAAL,GAAyB,kBAAzB;;AAEA;AACA,SAAK9G,YAAL,GAAoB,aAApB;;AAEA,SAAKnB,cAAL,GAAsB,eAAtB;AACA,SAAK2G,YAAL,GAAoB,aAApB;AACA,SAAKgc,cAAL,GAAsB,eAAtB,CAxCY,CAwC2B;AACvC;AACA,SAAKxE,GAAL,GAAW,KAAX;AACA,SAAKxe,KAAL,GAAa,OAAb;AACA;AACA,SAAKiB,iBAAL,GAAyB,kBAAzB;AACA;AACA,SAAKD,aAAL,GAAqB,cAArB;AACA,SAAKutB,YAAL,GAAoB,aAApB;AACA,SAAKE,WAAL,GAAmB,YAAnB;AACA,SAAKqB,aAAL,GAAqB,cAArB;AACA;AACA,SAAKhoB,cAAL,GAAsB,eAAtB;AACA,SAAKE,iBAAL,GAAyB,kBAAzB;;AAEA;AACA,SAAK8lB,gBAAL,GAAwB,oBAAxB;AACA,SAAKkI,eAAL,GAAuB,mBAAvB;AACA,SAAK9O,eAAL,GAAuB,mBAAvB;AACA,SAAKkE,YAAL,GAAoB,gBAApB;AACA,SAAKc,WAAL,GAAmB,eAAnB;AACA,SAAKE,cAAL,GAAsB,iBAAtB;AACA,SAAKE,yBAAL,GAAiC,2BAAjC;AACA,SAAKE,iBAAL,GAAyB,oBAAzB;AACA,SAAKE,WAAL,GAAmB,eAAnB;AACA,SAAKxJ,YAAL,GAAoB,gBAApB;AACA,SAAKE,gBAAL,GAAwB,oBAAxB;AACA,SAAK2C,eAAL,GAAuB,mBAAvB;AACA,SAAKzC,UAAL,GAAkB,cAAlB;AACA,SAAK5a,eAAL,GAAuB,mBAAvB;AACA,SAAKxB,cAAL,GAAsB,kBAAtB;AACA;;AAEA;AACA,SAAK8B,QAAL,GAAgB,SAAhB;AACD,C;;AAGH,IAAI0S,SAAS,IAAIoa,UAAJ,EAAb;kBACepa,M;;;;;;;;;;;;;;;;ACvFf;;;;;;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,SAASua,UAAT,GAAsB;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACD;;AAEDA,WAAWnf,uBAAX,GAAqC,YAArC;kBACe,uBAAaC,mBAAb,CAAiCkf,UAAjC,C;;;;;;;;;;;;;;AC7Rf;;AAEA;AACA;;AAEA,IAAIC,OAAO,EAAX;AACAA,KAAKC,MAAL,GAAc,UAASC,CAAT,EAAY;AACxB,MAAIC,IAAI,EAAR;AACA,OAAK,IAAI71B,IAAI,CAAb,EAAgBA,IAAI41B,EAAE31B,MAAtB,EAA8B,EAAED,CAAhC,EAAmC;AACjC,QAAI2uB,IAAIiH,EAAEE,UAAF,CAAa91B,CAAb,CAAR;AACA,QAAI2uB,IAAI,IAAR,EAAc;AACZkH,QAAEhU,IAAF,CAAO8M,CAAP;AACD,KAFD,MAEO,IAAIA,IAAI,KAAR,EAAe;AACpBkH,QAAEhU,IAAF,CAAO,OAAQ8M,KAAK,CAApB;AACAkH,QAAEhU,IAAF,CAAO,OAAQ,KAAK8M,CAApB;AACD,KAHM,MAGA,IAAIA,IAAI,OAAR,EAAiB;AACtBkH,QAAEhU,IAAF,CAA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","file":"js\\liteH5Player.debug.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","/** Virtual DOM Node */\nfunction VNode() {}\n\n/** Global options\n *\t@public\n *\t@namespace options {Object}\n */\nvar options = {\n\n\t/** If `true`, `prop` changes trigger synchronous component updates.\n  *\t@name syncComponentUpdates\n  *\t@type Boolean\n  *\t@default true\n  */\n\t//syncComponentUpdates: true,\n\n\t/** Processes all created VNodes.\n  *\t@param {VNode} vnode\tA newly-created VNode to normalize/process\n  */\n\t//vnode(vnode) { }\n\n\t/** Hook invoked after a component is mounted. */\n\t// afterMount(component) { }\n\n\t/** Hook invoked after the DOM is updated with a component's latest render. */\n\t// afterUpdate(component) { }\n\n\t/** Hook invoked immediately before a component is unmounted. */\n\t// beforeUnmount(component) { }\n};\n\nvar stack = [];\n\nvar EMPTY_CHILDREN = [];\n\n/**\n * JSX/hyperscript reviver.\n * @see http://jasonformat.com/wtf-is-jsx\n * Benchmarks: https://esbench.com/bench/57ee8f8e330ab09900a1a1a0\n *\n * Note: this is exported as both `h()` and `createElement()` for compatibility reasons.\n *\n * Creates a VNode (virtual DOM element). A tree of VNodes can be used as a lightweight representation\n * of the structure of a DOM tree. This structure can be realized by recursively comparing it against\n * the current _actual_ DOM structure, and applying only the differences.\n *\n * `h()`/`createElement()` accepts an element name, a list of attributes/props,\n * and optionally children to append to the element.\n *\n * @example The following DOM tree\n *\n * `<div id=\"foo\" name=\"bar\">Hello!</div>`\n *\n * can be constructed using this function as:\n *\n * `h('div', { id: 'foo', name : 'bar' }, 'Hello!');`\n *\n * @param {string} nodeName\tAn element name. Ex: `div`, `a`, `span`, etc.\n * @param {Object} attributes\tAny attributes/props to set on the created element.\n * @param rest\t\t\tAdditional arguments are taken to be children to append. Can be infinitely nested Arrays.\n *\n * @public\n */\nfunction h(nodeName, attributes) {\n\tvar children = EMPTY_CHILDREN,\n\t    lastSimple,\n\t    child,\n\t    simple,\n\t    i;\n\tfor (i = arguments.length; i-- > 2;) {\n\t\tstack.push(arguments[i]);\n\t}\n\tif (attributes && attributes.children != null) {\n\t\tif (!stack.length) stack.push(attributes.children);\n\t\tdelete attributes.children;\n\t}\n\twhile (stack.length) {\n\t\tif ((child = stack.pop()) && child.pop !== undefined) {\n\t\t\tfor (i = child.length; i--;) {\n\t\t\t\tstack.push(child[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tif (typeof child === 'boolean') child = null;\n\n\t\t\tif (simple = typeof nodeName !== 'function') {\n\t\t\t\tif (child == null) child = '';else if (typeof child === 'number') child = String(child);else if (typeof child !== 'string') simple = false;\n\t\t\t}\n\n\t\t\tif (simple && lastSimple) {\n\t\t\t\tchildren[children.length - 1] += child;\n\t\t\t} else if (children === EMPTY_CHILDREN) {\n\t\t\t\tchildren = [child];\n\t\t\t} else {\n\t\t\t\tchildren.push(child);\n\t\t\t}\n\n\t\t\tlastSimple = simple;\n\t\t}\n\t}\n\n\tvar p = new VNode();\n\tp.nodeName = nodeName;\n\tp.children = children;\n\tp.attributes = attributes == null ? undefined : attributes;\n\tp.key = attributes == null ? undefined : attributes.key;\n\n\t// if a \"vnode hook\" is defined, pass every created VNode to it\n\tif (options.vnode !== undefined) options.vnode(p);\n\n\treturn p;\n}\n\n/**\n *  Copy all properties from `props` onto `obj`.\n *  @param {Object} obj\t\tObject onto which properties should be copied.\n *  @param {Object} props\tObject from which to copy properties.\n *  @returns obj\n *  @private\n */\nfunction extend(obj, props) {\n  for (var i in props) {\n    obj[i] = props[i];\n  }return obj;\n}\n\n/**\n * Call a function asynchronously, as soon as possible. Makes\n * use of HTML Promise to schedule the callback if available,\n * otherwise falling back to `setTimeout` (mainly for IE<11).\n *\n * @param {Function} callback\n */\nvar defer = typeof Promise == 'function' ? Promise.resolve().then.bind(Promise.resolve()) : setTimeout;\n\n/**\n * Clones the given VNode, optionally adding attributes/props and replacing its children.\n * @param {VNode} vnode\t\tThe virtual DOM element to clone\n * @param {Object} props\tAttributes/props to add when cloning\n * @param {VNode} rest\t\tAny additional arguments will be used as replacement children.\n */\nfunction cloneElement(vnode, props) {\n  return h(vnode.nodeName, extend(extend({}, vnode.attributes), props), arguments.length > 2 ? [].slice.call(arguments, 2) : vnode.children);\n}\n\n// DOM properties that should NOT have \"px\" added when numeric\nvar IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i;\n\n/** Managed queue of dirty components to be re-rendered */\n\nvar items = [];\n\nfunction enqueueRender(component) {\n\tif (!component._dirty && (component._dirty = true) && items.push(component) == 1) {\n\t\t(options.debounceRendering || defer)(rerender);\n\t}\n}\n\nfunction rerender() {\n\tvar p,\n\t    list = items;\n\titems = [];\n\twhile (p = list.pop()) {\n\t\tif (p._dirty) renderComponent(p);\n\t}\n}\n\n/**\n * Check if two nodes are equivalent.\n *\n * @param {Node} node\t\t\tDOM Node to compare\n * @param {VNode} vnode\t\t\tVirtual DOM node to compare\n * @param {boolean} [hydrating=false]\tIf true, ignores component constructors when comparing.\n * @private\n */\nfunction isSameNodeType(node, vnode, hydrating) {\n  if (typeof vnode === 'string' || typeof vnode === 'number') {\n    return node.splitText !== undefined;\n  }\n  if (typeof vnode.nodeName === 'string') {\n    return !node._componentConstructor && isNamedNode(node, vnode.nodeName);\n  }\n  return hydrating || node._componentConstructor === vnode.nodeName;\n}\n\n/**\n * Check if an Element has a given nodeName, case-insensitively.\n *\n * @param {Element} node\tA DOM Element to inspect the name of.\n * @param {String} nodeName\tUnnormalized name to compare against.\n */\nfunction isNamedNode(node, nodeName) {\n  return node.normalizedNodeName === nodeName || node.nodeName.toLowerCase() === nodeName.toLowerCase();\n}\n\n/**\n * Reconstruct Component-style `props` from a VNode.\n * Ensures default/fallback values from `defaultProps`:\n * Own-properties of `defaultProps` not present in `vnode.attributes` are added.\n *\n * @param {VNode} vnode\n * @returns {Object} props\n */\nfunction getNodeProps(vnode) {\n  var props = extend({}, vnode.attributes);\n  props.children = vnode.children;\n\n  var defaultProps = vnode.nodeName.defaultProps;\n  if (defaultProps !== undefined) {\n    for (var i in defaultProps) {\n      if (props[i] === undefined) {\n        props[i] = defaultProps[i];\n      }\n    }\n  }\n\n  return props;\n}\n\n/** Create an element with the given nodeName.\n *\t@param {String} nodeName\n *\t@param {Boolean} [isSvg=false]\tIf `true`, creates an element within the SVG namespace.\n *\t@returns {Element} node\n */\nfunction createNode(nodeName, isSvg) {\n\tvar node = isSvg ? document.createElementNS('http://www.w3.org/2000/svg', nodeName) : document.createElement(nodeName);\n\tnode.normalizedNodeName = nodeName;\n\treturn node;\n}\n\n/** Remove a child node from its parent if attached.\n *\t@param {Element} node\t\tThe node to remove\n */\nfunction removeNode(node) {\n\tvar parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n\n/** Set a named attribute on the given Node, with special behavior for some names and event handlers.\n *\tIf `value` is `null`, the attribute/handler will be removed.\n *\t@param {Element} node\tAn element to mutate\n *\t@param {string} name\tThe name/key to set, such as an event or attribute name\n *\t@param {any} old\tThe last value that was set for this name/node pair\n *\t@param {any} value\tAn attribute value, such as a function to be used as an event handler\n *\t@param {Boolean} isSvg\tAre we currently diffing inside an svg?\n *\t@private\n */\nfunction setAccessor(node, name, old, value, isSvg) {\n\tif (name === 'className') name = 'class';\n\n\tif (name === 'key') {\n\t\t// ignore\n\t} else if (name === 'ref') {\n\t\tif (old) old(null);\n\t\tif (value) value(node);\n\t} else if (name === 'class' && !isSvg) {\n\t\tnode.className = value || '';\n\t} else if (name === 'style') {\n\t\tif (!value || typeof value === 'string' || typeof old === 'string') {\n\t\t\tnode.style.cssText = value || '';\n\t\t}\n\t\tif (value && typeof value === 'object') {\n\t\t\tif (typeof old !== 'string') {\n\t\t\t\tfor (var i in old) {\n\t\t\t\t\tif (!(i in value)) node.style[i] = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (var i in value) {\n\t\t\t\tnode.style[i] = typeof value[i] === 'number' && IS_NON_DIMENSIONAL.test(i) === false ? value[i] + 'px' : value[i];\n\t\t\t}\n\t\t}\n\t} else if (name === 'dangerouslySetInnerHTML') {\n\t\tif (value) node.innerHTML = value.__html || '';\n\t} else if (name[0] == 'o' && name[1] == 'n') {\n\t\tvar useCapture = name !== (name = name.replace(/Capture$/, ''));\n\t\tname = name.toLowerCase().substring(2);\n\t\tif (value) {\n\t\t\tif (!old) node.addEventListener(name, eventProxy, useCapture);\n\t\t} else {\n\t\t\tnode.removeEventListener(name, eventProxy, useCapture);\n\t\t}\n\t\t(node._listeners || (node._listeners = {}))[name] = value;\n\t} else if (name !== 'list' && name !== 'type' && !isSvg && name in node) {\n\t\tsetProperty(node, name, value == null ? '' : value);\n\t\tif (value == null || value === false) node.removeAttribute(name);\n\t} else {\n\t\tvar ns = isSvg && name !== (name = name.replace(/^xlink:?/, ''));\n\t\tif (value == null || value === false) {\n\t\t\tif (ns) node.removeAttributeNS('http://www.w3.org/1999/xlink', name.toLowerCase());else node.removeAttribute(name);\n\t\t} else if (typeof value !== 'function') {\n\t\t\tif (ns) node.setAttributeNS('http://www.w3.org/1999/xlink', name.toLowerCase(), value);else node.setAttribute(name, value);\n\t\t}\n\t}\n}\n\n/** Attempt to set a DOM property to the given value.\n *\tIE & FF throw for certain property-value combinations.\n */\nfunction setProperty(node, name, value) {\n\ttry {\n\t\tnode[name] = value;\n\t} catch (e) {}\n}\n\n/** Proxy an event to hooked event handlers\n *\t@private\n */\nfunction eventProxy(e) {\n\treturn this._listeners[e.type](options.event && options.event(e) || e);\n}\n\n/** Queue of components that have been mounted and are awaiting componentDidMount */\nvar mounts = [];\n\n/** Diff recursion count, used to track the end of the diff cycle. */\nvar diffLevel = 0;\n\n/** Global flag indicating if the diff is currently within an SVG */\nvar isSvgMode = false;\n\n/** Global flag indicating if the diff is performing hydration */\nvar hydrating = false;\n\n/** Invoke queued componentDidMount lifecycle methods */\nfunction flushMounts() {\n\tvar c;\n\twhile (c = mounts.pop()) {\n\t\tif (options.afterMount) options.afterMount(c);\n\t\tif (c.componentDidMount) c.componentDidMount();\n\t}\n}\n\n/** Apply differences in a given vnode (and it's deep children) to a real DOM Node.\n *\t@param {Element} [dom=null]\t\tA DOM node to mutate into the shape of the `vnode`\n *\t@param {VNode} vnode\t\t\tA VNode (with descendants forming a tree) representing the desired DOM structure\n *\t@returns {Element} dom\t\t\tThe created/mutated element\n *\t@private\n */\nfunction diff(dom, vnode, context, mountAll, parent, componentRoot) {\n\t// diffLevel having been 0 here indicates initial entry into the diff (not a subdiff)\n\tif (!diffLevel++) {\n\t\t// when first starting the diff, check if we're diffing an SVG or within an SVG\n\t\tisSvgMode = parent != null && parent.ownerSVGElement !== undefined;\n\n\t\t// hydration is indicated by the existing element to be diffed not having a prop cache\n\t\thydrating = dom != null && !('__preactattr_' in dom);\n\t}\n\n\tvar ret = idiff(dom, vnode, context, mountAll, componentRoot);\n\n\t// append the element if its a new parent\n\tif (parent && ret.parentNode !== parent) parent.appendChild(ret);\n\n\t// diffLevel being reduced to 0 means we're exiting the diff\n\tif (! --diffLevel) {\n\t\thydrating = false;\n\t\t// invoke queued componentDidMount lifecycle methods\n\t\tif (!componentRoot) flushMounts();\n\t}\n\n\treturn ret;\n}\n\n/** Internals of `diff()`, separated to allow bypassing diffLevel / mount flushing. */\nfunction idiff(dom, vnode, context, mountAll, componentRoot) {\n\tvar out = dom,\n\t    prevSvgMode = isSvgMode;\n\n\t// empty values (null, undefined, booleans) render as empty Text nodes\n\tif (vnode == null || typeof vnode === 'boolean') vnode = '';\n\n\t// Fast case: Strings & Numbers create/update Text nodes.\n\tif (typeof vnode === 'string' || typeof vnode === 'number') {\n\n\t\t// update if it's already a Text node:\n\t\tif (dom && dom.splitText !== undefined && dom.parentNode && (!dom._component || componentRoot)) {\n\t\t\t/* istanbul ignore if */ /* Browser quirk that can't be covered: https://github.com/developit/preact/commit/fd4f21f5c45dfd75151bd27b4c217d8003aa5eb9 */\n\t\t\tif (dom.nodeValue != vnode) {\n\t\t\t\tdom.nodeValue = vnode;\n\t\t\t}\n\t\t} else {\n\t\t\t// it wasn't a Text node: replace it with one and recycle the old Element\n\t\t\tout = document.createTextNode(vnode);\n\t\t\tif (dom) {\n\t\t\t\tif (dom.parentNode) dom.parentNode.replaceChild(out, dom);\n\t\t\t\trecollectNodeTree(dom, true);\n\t\t\t}\n\t\t}\n\n\t\tout['__preactattr_'] = true;\n\n\t\treturn out;\n\t}\n\n\t// If the VNode represents a Component, perform a component diff:\n\tvar vnodeName = vnode.nodeName;\n\tif (typeof vnodeName === 'function') {\n\t\treturn buildComponentFromVNode(dom, vnode, context, mountAll);\n\t}\n\n\t// Tracks entering and exiting SVG namespace when descending through the tree.\n\tisSvgMode = vnodeName === 'svg' ? true : vnodeName === 'foreignObject' ? false : isSvgMode;\n\n\t// If there's no existing element or it's the wrong type, create a new one:\n\tvnodeName = String(vnodeName);\n\tif (!dom || !isNamedNode(dom, vnodeName)) {\n\t\tout = createNode(vnodeName, isSvgMode);\n\n\t\tif (dom) {\n\t\t\t// move children into the replacement node\n\t\t\twhile (dom.firstChild) {\n\t\t\t\tout.appendChild(dom.firstChild);\n\t\t\t} // if the previous Element was mounted into the DOM, replace it inline\n\t\t\tif (dom.parentNode) dom.parentNode.replaceChild(out, dom);\n\n\t\t\t// recycle the old element (skips non-Element node types)\n\t\t\trecollectNodeTree(dom, true);\n\t\t}\n\t}\n\n\tvar fc = out.firstChild,\n\t    props = out['__preactattr_'],\n\t    vchildren = vnode.children;\n\n\tif (props == null) {\n\t\tprops = out['__preactattr_'] = {};\n\t\tfor (var a = out.attributes, i = a.length; i--;) {\n\t\t\tprops[a[i].name] = a[i].value;\n\t\t}\n\t}\n\n\t// Optimization: fast-path for elements containing a single TextNode:\n\tif (!hydrating && vchildren && vchildren.length === 1 && typeof vchildren[0] === 'string' && fc != null && fc.splitText !== undefined && fc.nextSibling == null) {\n\t\tif (fc.nodeValue != vchildren[0]) {\n\t\t\tfc.nodeValue = vchildren[0];\n\t\t}\n\t}\n\t// otherwise, if there are existing or new children, diff them:\n\telse if (vchildren && vchildren.length || fc != null) {\n\t\t\tinnerDiffNode(out, vchildren, context, mountAll, hydrating || props.dangerouslySetInnerHTML != null);\n\t\t}\n\n\t// Apply attributes/props from VNode to the DOM Element:\n\tdiffAttributes(out, vnode.attributes, props);\n\n\t// restore previous SVG mode: (in case we're exiting an SVG namespace)\n\tisSvgMode = prevSvgMode;\n\n\treturn out;\n}\n\n/** Apply child and attribute changes between a VNode and a DOM Node to the DOM.\n *\t@param {Element} dom\t\t\tElement whose children should be compared & mutated\n *\t@param {Array} vchildren\t\tArray of VNodes to compare to `dom.childNodes`\n *\t@param {Object} context\t\t\tImplicitly descendant context object (from most recent `getChildContext()`)\n *\t@param {Boolean} mountAll\n *\t@param {Boolean} isHydrating\tIf `true`, consumes externally created elements similar to hydration\n */\nfunction innerDiffNode(dom, vchildren, context, mountAll, isHydrating) {\n\tvar originalChildren = dom.childNodes,\n\t    children = [],\n\t    keyed = {},\n\t    keyedLen = 0,\n\t    min = 0,\n\t    len = originalChildren.length,\n\t    childrenLen = 0,\n\t    vlen = vchildren ? vchildren.length : 0,\n\t    j,\n\t    c,\n\t    f,\n\t    vchild,\n\t    child;\n\n\t// Build up a map of keyed children and an Array of unkeyed children:\n\tif (len !== 0) {\n\t\tfor (var i = 0; i < len; i++) {\n\t\t\tvar _child = originalChildren[i],\n\t\t\t    props = _child['__preactattr_'],\n\t\t\t    key = vlen && props ? _child._component ? _child._component.__key : props.key : null;\n\t\t\tif (key != null) {\n\t\t\t\tkeyedLen++;\n\t\t\t\tkeyed[key] = _child;\n\t\t\t} else if (props || (_child.splitText !== undefined ? isHydrating ? _child.nodeValue.trim() : true : isHydrating)) {\n\t\t\t\tchildren[childrenLen++] = _child;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (vlen !== 0) {\n\t\tfor (var i = 0; i < vlen; i++) {\n\t\t\tvchild = vchildren[i];\n\t\t\tchild = null;\n\n\t\t\t// attempt to find a node based on key matching\n\t\t\tvar key = vchild.key;\n\t\t\tif (key != null) {\n\t\t\t\tif (keyedLen && keyed[key] !== undefined) {\n\t\t\t\t\tchild = keyed[key];\n\t\t\t\t\tkeyed[key] = undefined;\n\t\t\t\t\tkeyedLen--;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// attempt to pluck a node of the same type from the existing children\n\t\t\telse if (!child && min < childrenLen) {\n\t\t\t\t\tfor (j = min; j < childrenLen; j++) {\n\t\t\t\t\t\tif (children[j] !== undefined && isSameNodeType(c = children[j], vchild, isHydrating)) {\n\t\t\t\t\t\t\tchild = c;\n\t\t\t\t\t\t\tchildren[j] = undefined;\n\t\t\t\t\t\t\tif (j === childrenLen - 1) childrenLen--;\n\t\t\t\t\t\t\tif (j === min) min++;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t// morph the matched/found/created DOM child to match vchild (deep)\n\t\t\tchild = idiff(child, vchild, context, mountAll);\n\n\t\t\tf = originalChildren[i];\n\t\t\tif (child && child !== dom && child !== f) {\n\t\t\t\tif (f == null) {\n\t\t\t\t\tdom.appendChild(child);\n\t\t\t\t} else if (child === f.nextSibling) {\n\t\t\t\t\tremoveNode(f);\n\t\t\t\t} else {\n\t\t\t\t\tdom.insertBefore(child, f);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// remove unused keyed children:\n\tif (keyedLen) {\n\t\tfor (var i in keyed) {\n\t\t\tif (keyed[i] !== undefined) recollectNodeTree(keyed[i], false);\n\t\t}\n\t}\n\n\t// remove orphaned unkeyed children:\n\twhile (min <= childrenLen) {\n\t\tif ((child = children[childrenLen--]) !== undefined) recollectNodeTree(child, false);\n\t}\n}\n\n/** Recursively recycle (or just unmount) a node and its descendants.\n *\t@param {Node} node\t\t\t\t\t\tDOM node to start unmount/removal from\n *\t@param {Boolean} [unmountOnly=false]\tIf `true`, only triggers unmount lifecycle, skips removal\n */\nfunction recollectNodeTree(node, unmountOnly) {\n\tvar component = node._component;\n\tif (component) {\n\t\t// if node is owned by a Component, unmount that component (ends up recursing back here)\n\t\tunmountComponent(component);\n\t} else {\n\t\t// If the node's VNode had a ref function, invoke it with null here.\n\t\t// (this is part of the React spec, and smart for unsetting references)\n\t\tif (node['__preactattr_'] != null && node['__preactattr_'].ref) node['__preactattr_'].ref(null);\n\n\t\tif (unmountOnly === false || node['__preactattr_'] == null) {\n\t\t\tremoveNode(node);\n\t\t}\n\n\t\tremoveChildren(node);\n\t}\n}\n\n/** Recollect/unmount all children.\n *\t- we use .lastChild here because it causes less reflow than .firstChild\n *\t- it's also cheaper than accessing the .childNodes Live NodeList\n */\nfunction removeChildren(node) {\n\tnode = node.lastChild;\n\twhile (node) {\n\t\tvar next = node.previousSibling;\n\t\trecollectNodeTree(node, true);\n\t\tnode = next;\n\t}\n}\n\n/** Apply differences in attributes from a VNode to the given DOM Element.\n *\t@param {Element} dom\t\tElement with attributes to diff `attrs` against\n *\t@param {Object} attrs\t\tThe desired end-state key-value attribute pairs\n *\t@param {Object} old\t\t\tCurrent/previous attributes (from previous VNode or element's prop cache)\n */\nfunction diffAttributes(dom, attrs, old) {\n\tvar name;\n\n\t// remove attributes no longer present on the vnode by setting them to undefined\n\tfor (name in old) {\n\t\tif (!(attrs && attrs[name] != null) && old[name] != null) {\n\t\t\tsetAccessor(dom, name, old[name], old[name] = undefined, isSvgMode);\n\t\t}\n\t}\n\n\t// add new & update changed attributes\n\tfor (name in attrs) {\n\t\tif (name !== 'children' && name !== 'innerHTML' && (!(name in old) || attrs[name] !== (name === 'value' || name === 'checked' ? dom[name] : old[name]))) {\n\t\t\tsetAccessor(dom, name, old[name], old[name] = attrs[name], isSvgMode);\n\t\t}\n\t}\n}\n\n/** Retains a pool of Components for re-use, keyed on component name.\n *\tNote: since component names are not unique or even necessarily available, these are primarily a form of sharding.\n *\t@private\n */\nvar components = {};\n\n/** Reclaim a component for later re-use by the recycler. */\nfunction collectComponent(component) {\n\tvar name = component.constructor.name;\n\t(components[name] || (components[name] = [])).push(component);\n}\n\n/** Create a component. Normalizes differences between PFC's and classful Components. */\nfunction createComponent(Ctor, props, context) {\n\tvar list = components[Ctor.name],\n\t    inst;\n\n\tif (Ctor.prototype && Ctor.prototype.render) {\n\t\tinst = new Ctor(props, context);\n\t\tComponent.call(inst, props, context);\n\t} else {\n\t\tinst = new Component(props, context);\n\t\tinst.constructor = Ctor;\n\t\tinst.render = doRender;\n\t}\n\n\tif (list) {\n\t\tfor (var i = list.length; i--;) {\n\t\t\tif (list[i].constructor === Ctor) {\n\t\t\t\tinst.nextBase = list[i].nextBase;\n\t\t\t\tlist.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn inst;\n}\n\n/** The `.render()` method for a PFC backing instance. */\nfunction doRender(props, state, context) {\n\treturn this.constructor(props, context);\n}\n\n/** Set a component's `props` (generally derived from JSX attributes).\n *\t@param {Object} props\n *\t@param {Object} [opts]\n *\t@param {boolean} [opts.renderSync=false]\tIf `true` and {@link options.syncComponentUpdates} is `true`, triggers synchronous rendering.\n *\t@param {boolean} [opts.render=true]\t\t\tIf `false`, no render will be triggered.\n */\nfunction setComponentProps(component, props, opts, context, mountAll) {\n\tif (component._disable) return;\n\tcomponent._disable = true;\n\n\tif (component.__ref = props.ref) delete props.ref;\n\tif (component.__key = props.key) delete props.key;\n\n\tif (!component.base || mountAll) {\n\t\tif (component.componentWillMount) component.componentWillMount();\n\t} else if (component.componentWillReceiveProps) {\n\t\tcomponent.componentWillReceiveProps(props, context);\n\t}\n\n\tif (context && context !== component.context) {\n\t\tif (!component.prevContext) component.prevContext = component.context;\n\t\tcomponent.context = context;\n\t}\n\n\tif (!component.prevProps) component.prevProps = component.props;\n\tcomponent.props = props;\n\n\tcomponent._disable = false;\n\n\tif (opts !== 0) {\n\t\tif (opts === 1 || options.syncComponentUpdates !== false || !component.base) {\n\t\t\trenderComponent(component, 1, mountAll);\n\t\t} else {\n\t\t\tenqueueRender(component);\n\t\t}\n\t}\n\n\tif (component.__ref) component.__ref(component);\n}\n\n/** Render a Component, triggering necessary lifecycle events and taking High-Order Components into account.\n *\t@param {Component} component\n *\t@param {Object} [opts]\n *\t@param {boolean} [opts.build=false]\t\tIf `true`, component will build and store a DOM node if not already associated with one.\n *\t@private\n */\nfunction renderComponent(component, opts, mountAll, isChild) {\n\tif (component._disable) return;\n\n\tvar props = component.props,\n\t    state = component.state,\n\t    context = component.context,\n\t    previousProps = component.prevProps || props,\n\t    previousState = component.prevState || state,\n\t    previousContext = component.prevContext || context,\n\t    isUpdate = component.base,\n\t    nextBase = component.nextBase,\n\t    initialBase = isUpdate || nextBase,\n\t    initialChildComponent = component._component,\n\t    skip = false,\n\t    rendered,\n\t    inst,\n\t    cbase;\n\n\t// if updating\n\tif (isUpdate) {\n\t\tcomponent.props = previousProps;\n\t\tcomponent.state = previousState;\n\t\tcomponent.context = previousContext;\n\t\tif (opts !== 2 && component.shouldComponentUpdate && component.shouldComponentUpdate(props, state, context) === false) {\n\t\t\tskip = true;\n\t\t} else if (component.componentWillUpdate) {\n\t\t\tcomponent.componentWillUpdate(props, state, context);\n\t\t}\n\t\tcomponent.props = props;\n\t\tcomponent.state = state;\n\t\tcomponent.context = context;\n\t}\n\n\tcomponent.prevProps = component.prevState = component.prevContext = component.nextBase = null;\n\tcomponent._dirty = false;\n\n\tif (!skip) {\n\t\trendered = component.render(props, state, context);\n\n\t\t// context to pass to the child, can be updated via (grand-)parent component\n\t\tif (component.getChildContext) {\n\t\t\tcontext = extend(extend({}, context), component.getChildContext());\n\t\t}\n\n\t\tvar childComponent = rendered && rendered.nodeName,\n\t\t    toUnmount,\n\t\t    base;\n\n\t\tif (typeof childComponent === 'function') {\n\t\t\t// set up high order component link\n\n\t\t\tvar childProps = getNodeProps(rendered);\n\t\t\tinst = initialChildComponent;\n\n\t\t\tif (inst && inst.constructor === childComponent && childProps.key == inst.__key) {\n\t\t\t\tsetComponentProps(inst, childProps, 1, context, false);\n\t\t\t} else {\n\t\t\t\ttoUnmount = inst;\n\n\t\t\t\tcomponent._component = inst = createComponent(childComponent, childProps, context);\n\t\t\t\tinst.nextBase = inst.nextBase || nextBase;\n\t\t\t\tinst._parentComponent = component;\n\t\t\t\tsetComponentProps(inst, childProps, 0, context, false);\n\t\t\t\trenderComponent(inst, 1, mountAll, true);\n\t\t\t}\n\n\t\t\tbase = inst.base;\n\t\t} else {\n\t\t\tcbase = initialBase;\n\n\t\t\t// destroy high order component link\n\t\t\ttoUnmount = initialChildComponent;\n\t\t\tif (toUnmount) {\n\t\t\t\tcbase = component._component = null;\n\t\t\t}\n\n\t\t\tif (initialBase || opts === 1) {\n\t\t\t\tif (cbase) cbase._component = null;\n\t\t\t\tbase = diff(cbase, rendered, context, mountAll || !isUpdate, initialBase && initialBase.parentNode, true);\n\t\t\t}\n\t\t}\n\n\t\tif (initialBase && base !== initialBase && inst !== initialChildComponent) {\n\t\t\tvar baseParent = initialBase.parentNode;\n\t\t\tif (baseParent && base !== baseParent) {\n\t\t\t\tbaseParent.replaceChild(base, initialBase);\n\n\t\t\t\tif (!toUnmount) {\n\t\t\t\t\tinitialBase._component = null;\n\t\t\t\t\trecollectNodeTree(initialBase, false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (toUnmount) {\n\t\t\tunmountComponent(toUnmount);\n\t\t}\n\n\t\tcomponent.base = base;\n\t\tif (base && !isChild) {\n\t\t\tvar componentRef = component,\n\t\t\t    t = component;\n\t\t\twhile (t = t._parentComponent) {\n\t\t\t\t(componentRef = t).base = base;\n\t\t\t}\n\t\t\tbase._component = componentRef;\n\t\t\tbase._componentConstructor = componentRef.constructor;\n\t\t}\n\t}\n\n\tif (!isUpdate || mountAll) {\n\t\tmounts.unshift(component);\n\t} else if (!skip) {\n\t\t// Ensure that pending componentDidMount() hooks of child components\n\t\t// are called before the componentDidUpdate() hook in the parent.\n\t\t// Note: disabled as it causes duplicate hooks, see https://github.com/developit/preact/issues/750\n\t\t// flushMounts();\n\n\t\tif (component.componentDidUpdate) {\n\t\t\tcomponent.componentDidUpdate(previousProps, previousState, previousContext);\n\t\t}\n\t\tif (options.afterUpdate) options.afterUpdate(component);\n\t}\n\n\tif (component._renderCallbacks != null) {\n\t\twhile (component._renderCallbacks.length) {\n\t\t\tcomponent._renderCallbacks.pop().call(component);\n\t\t}\n\t}\n\n\tif (!diffLevel && !isChild) flushMounts();\n}\n\n/** Apply the Component referenced by a VNode to the DOM.\n *\t@param {Element} dom\tThe DOM node to mutate\n *\t@param {VNode} vnode\tA Component-referencing VNode\n *\t@returns {Element} dom\tThe created/mutated element\n *\t@private\n */\nfunction buildComponentFromVNode(dom, vnode, context, mountAll) {\n\tvar c = dom && dom._component,\n\t    originalComponent = c,\n\t    oldDom = dom,\n\t    isDirectOwner = c && dom._componentConstructor === vnode.nodeName,\n\t    isOwner = isDirectOwner,\n\t    props = getNodeProps(vnode);\n\twhile (c && !isOwner && (c = c._parentComponent)) {\n\t\tisOwner = c.constructor === vnode.nodeName;\n\t}\n\n\tif (c && isOwner && (!mountAll || c._component)) {\n\t\tsetComponentProps(c, props, 3, context, mountAll);\n\t\tdom = c.base;\n\t} else {\n\t\tif (originalComponent && !isDirectOwner) {\n\t\t\tunmountComponent(originalComponent);\n\t\t\tdom = oldDom = null;\n\t\t}\n\n\t\tc = createComponent(vnode.nodeName, props, context);\n\t\tif (dom && !c.nextBase) {\n\t\t\tc.nextBase = dom;\n\t\t\t// passing dom/oldDom as nextBase will recycle it if unused, so bypass recycling on L229:\n\t\t\toldDom = null;\n\t\t}\n\t\tsetComponentProps(c, props, 1, context, mountAll);\n\t\tdom = c.base;\n\n\t\tif (oldDom && dom !== oldDom) {\n\t\t\toldDom._component = null;\n\t\t\trecollectNodeTree(oldDom, false);\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n/** Remove a component from the DOM and recycle it.\n *\t@param {Component} component\tThe Component instance to unmount\n *\t@private\n */\nfunction unmountComponent(component) {\n\tif (options.beforeUnmount) options.beforeUnmount(component);\n\n\tvar base = component.base;\n\n\tcomponent._disable = true;\n\n\tif (component.componentWillUnmount) component.componentWillUnmount();\n\n\tcomponent.base = null;\n\n\t// recursively tear down & recollect high-order component children:\n\tvar inner = component._component;\n\tif (inner) {\n\t\tunmountComponent(inner);\n\t} else if (base) {\n\t\tif (base['__preactattr_'] && base['__preactattr_'].ref) base['__preactattr_'].ref(null);\n\n\t\tcomponent.nextBase = base;\n\n\t\tremoveNode(base);\n\t\tcollectComponent(component);\n\n\t\tremoveChildren(base);\n\t}\n\n\tif (component.__ref) component.__ref(null);\n}\n\n/** Base Component class.\n *\tProvides `setState()` and `forceUpdate()`, which trigger rendering.\n *\t@public\n *\n *\t@example\n *\tclass MyFoo extends Component {\n *\t\trender(props, state) {\n *\t\t\treturn <div />;\n *\t\t}\n *\t}\n */\nfunction Component(props, context) {\n\tthis._dirty = true;\n\n\t/** @public\n  *\t@type {object}\n  */\n\tthis.context = context;\n\n\t/** @public\n  *\t@type {object}\n  */\n\tthis.props = props;\n\n\t/** @public\n  *\t@type {object}\n  */\n\tthis.state = this.state || {};\n}\n\nextend(Component.prototype, {\n\n\t/** Returns a `boolean` indicating if the component should re-render when receiving the given `props` and `state`.\n  *\t@param {object} nextProps\n  *\t@param {object} nextState\n  *\t@param {object} nextContext\n  *\t@returns {Boolean} should the component re-render\n  *\t@name shouldComponentUpdate\n  *\t@function\n  */\n\n\t/** Update component state by copying properties from `state` to `this.state`.\n  *\t@param {object} state\t\tA hash of state properties to update with new values\n  *\t@param {function} callback\tA function to be called once component state is updated\n  */\n\tsetState: function setState(state, callback) {\n\t\tvar s = this.state;\n\t\tif (!this.prevState) this.prevState = extend({}, s);\n\t\textend(s, typeof state === 'function' ? state(s, this.props) : state);\n\t\tif (callback) (this._renderCallbacks = this._renderCallbacks || []).push(callback);\n\t\tenqueueRender(this);\n\t},\n\n\n\t/** Immediately perform a synchronous re-render of the component.\n  *\t@param {function} callback\t\tA function to be called after component is re-rendered.\n  *\t@private\n  */\n\tforceUpdate: function forceUpdate(callback) {\n\t\tif (callback) (this._renderCallbacks = this._renderCallbacks || []).push(callback);\n\t\trenderComponent(this, 2);\n\t},\n\n\n\t/** Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n  *\tVirtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n  *\t@param {object} props\t\tProps (eg: JSX attributes) received from parent element/component\n  *\t@param {object} state\t\tThe component's current state\n  *\t@param {object} context\t\tContext object (if a parent component has provided context)\n  *\t@returns VNode\n  */\n\trender: function render() {}\n});\n\n/** Render JSX into a `parent` Element.\n *\t@param {VNode} vnode\t\tA (JSX) VNode to render\n *\t@param {Element} parent\t\tDOM element to render into\n *\t@param {Element} [merge]\tAttempt to re-use an existing DOM tree rooted at `merge`\n *\t@public\n *\n *\t@example\n *\t// render a div into <body>:\n *\trender(<div id=\"hello\">hello!</div>, document.body);\n *\n *\t@example\n *\t// render a \"Thing\" component into #foo:\n *\tconst Thing = ({ name }) => <span>{ name }</span>;\n *\trender(<Thing name=\"one\" />, document.querySelector('#foo'));\n */\nfunction render(vnode, parent, merge) {\n  return diff(merge, vnode, {}, false, parent, false);\n}\n\nvar preact = {\n\th: h,\n\tcreateElement: h,\n\tcloneElement: cloneElement,\n\tComponent: Component,\n\trender: render,\n\trerender: rerender,\n\toptions: options\n};\n\nexport default preact;\nexport { h, h as createElement, cloneElement, Component, render, rerender, options };\n//# sourceMappingURL=preact.esm.js.map\n","!function(a,b){\"function\"==typeof define&&define.amd?define([],function(){return a.returnExportsGlobal=b()}):\"object\"==typeof exports?module.exports=b():a.ResizeSensor=b()}(this,function(){var a=function(){\"use strict\";function a(){this.q=[],this.add=function(a){this.q.push(a)};var a,b;this.call=function(){for(a=0,b=this.q.length;b>a;a++)this.q[a].call()}}function b(a,b){return a.currentStyle?a.currentStyle[b]:window.getComputedStyle?window.getComputedStyle(a,null).getPropertyValue(b):a.style[b]}function c(c,e){if(c.resizedAttached){if(c.resizedAttached)return void c.resizedAttached.add(e)}else c.resizedAttached=new a,c.resizedAttached.add(e);c.resizeSensor=document.createElement(\"div\"),c.resizeSensor.className=\"resize-sensor\";var f=\"position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden; opacity: 0;\",g=\"position: absolute; left: 0; top: 0; transition: 0s;\";c.resizeSensor.style.cssText=f,c.resizeSensor.innerHTML='<div class=\"resize-sensor-expand\" style=\"'+f+'\"><div style=\"'+g+'\"></div></div><div class=\"resize-sensor-shrink\" style=\"'+f+'\"><div style=\"'+g+' width: 200%; height: 200%\"></div></div>',c.appendChild(c.resizeSensor),\"static\"==b(c,\"position\")&&(c.style.position=\"relative\");var h=c.resizeSensor.childNodes[0],i=h.childNodes[0],j=c.resizeSensor.childNodes[1],k=function(){i.style.width=1e5+\"px\",i.style.height=1e5+\"px\",h.scrollLeft=1e5,h.scrollTop=1e5,j.scrollLeft=1e5,j.scrollTop=1e5};k();var l=!1,m=function(){c.resizedAttached&&(l&&(c.resizedAttached.call(),l=!1),d(m))};d(m);var n,o,p,q,r=function(){((p=c.offsetWidth)!=n||(q=c.offsetHeight)!=o)&&(l=!0,n=p,o=q),k()},s=function(a,b,c){a.attachEvent?a.attachEvent(\"on\"+b,c):a.addEventListener(b,c)};s(h,\"scroll\",r),s(j,\"scroll\",r)}var d=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(a){return window.setTimeout(a,20)},e=function(a,b){var d=this,e=Object.prototype.toString.call(a),f=d._isCollectionTyped=\"[object Array]\"===e||\"[object NodeList]\"===e||\"[object HTMLCollection]\"===e||\"undefined\"!=typeof jQuery&&a instanceof window.jQuery||\"undefined\"!=typeof Elements&&a instanceof window.Elements;if(d._element=a,f)for(var g=0,h=a.length;h>g;g++)c(a[g],b);else c(a,b)};return e.prototype.detach=function(){var a=this,b=a._isCollectionTyped,c=a._element;if(b)for(var d=0,f=c.length;f>d;d++)e.detach(c[d]);else e.detach(c)},e.detach=function(a){a.resizeSensor&&(a.removeChild(a.resizeSensor),delete a.resizeSensor,delete a.resizedAttached)},e}();return a});","// see https://tools.ietf.org/html/rfc1808\r\n\r\n/* jshint ignore:start */\r\n(function(root) { \r\n/* jshint ignore:end */\r\n\r\n  var URL_REGEX = /^((?:[a-zA-Z0-9+\\-.]+:)?)(\\/\\/[^\\/\\;?#]*)?(.*?)??(;.*?)?(\\?.*?)?(#.*?)?$/;\r\n  var FIRST_SEGMENT_REGEX = /^([^\\/;?#]*)(.*)$/;\r\n  var SLASH_DOT_REGEX = /(?:\\/|^)\\.(?=\\/)/g;\r\n  var SLASH_DOT_DOT_REGEX = /(?:\\/|^)\\.\\.\\/(?!\\.\\.\\/).*?(?=\\/)/g;\r\n\r\n  var URLToolkit = { // jshint ignore:line\r\n    // If opts.alwaysNormalize is true then the path will always be normalized even when it starts with / or //\r\n    // E.g\r\n    // With opts.alwaysNormalize = false (default, spec compliant)\r\n    // http://a.com/b/cd + /e/f/../g => http://a.com/e/f/../g\r\n    // With opts.alwaysNormalize = true (not spec compliant)\r\n    // http://a.com/b/cd + /e/f/../g => http://a.com/e/g\r\n    buildAbsoluteURL: function(baseURL, relativeURL, opts) {\r\n      opts = opts || {};\r\n      // remove any remaining space and CRLF\r\n      baseURL = baseURL.trim();\r\n      relativeURL = relativeURL.trim();\r\n      if (!relativeURL) {\r\n        // 2a) If the embedded URL is entirely empty, it inherits the\r\n        // entire base URL (i.e., is set equal to the base URL)\r\n        // and we are done.\r\n        if (!opts.alwaysNormalize) {\r\n          return baseURL;\r\n        }\r\n        var basePartsForNormalise = URLToolkit.parseURL(baseURL);\r\n        if (!basePartsForNormalise) {\r\n          throw new Error('Error trying to parse base URL.');\r\n        }\r\n        basePartsForNormalise.path = URLToolkit.normalizePath(basePartsForNormalise.path);\r\n        return URLToolkit.buildURLFromParts(basePartsForNormalise);\r\n      }\r\n      var relativeParts = URLToolkit.parseURL(relativeURL);\r\n      if (!relativeParts) {\r\n        throw new Error('Error trying to parse relative URL.');\r\n      }\r\n      if (relativeParts.scheme) {\r\n        // 2b) If the embedded URL starts with a scheme name, it is\r\n        // interpreted as an absolute URL and we are done.\r\n        if (!opts.alwaysNormalize) {\r\n          return relativeURL;\r\n        }\r\n        relativeParts.path = URLToolkit.normalizePath(relativeParts.path);\r\n        return URLToolkit.buildURLFromParts(relativeParts);\r\n      }\r\n      var baseParts = URLToolkit.parseURL(baseURL);\r\n      if (!baseParts) {\r\n        throw new Error('Error trying to parse base URL.');\r\n      }\r\n      if (!baseParts.netLoc && baseParts.path && baseParts.path[0] !== '/') {\r\n        // If netLoc missing and path doesn't start with '/', assume everthing before the first '/' is the netLoc\r\n        // This causes 'example.com/a' to be handled as '//example.com/a' instead of '/example.com/a'\r\n        var pathParts = FIRST_SEGMENT_REGEX.exec(baseParts.path);\r\n        baseParts.netLoc = pathParts[1];\r\n        baseParts.path = pathParts[2];\r\n      }\r\n      if (baseParts.netLoc && !baseParts.path) {\r\n        baseParts.path = '/';\r\n      }\r\n      var builtParts = {\r\n        // 2c) Otherwise, the embedded URL inherits the scheme of\r\n        // the base URL.\r\n        scheme: baseParts.scheme,\r\n        netLoc: relativeParts.netLoc,\r\n        path: null,\r\n        params: relativeParts.params,\r\n        query: relativeParts.query,\r\n        fragment: relativeParts.fragment\r\n      };\r\n      if (!relativeParts.netLoc) {\r\n        // 3) If the embedded URL's <net_loc> is non-empty, we skip to\r\n        // Step 7.  Otherwise, the embedded URL inherits the <net_loc>\r\n        // (if any) of the base URL.\r\n        builtParts.netLoc = baseParts.netLoc;\r\n        // 4) If the embedded URL path is preceded by a slash \"/\", the\r\n        // path is not relative and we skip to Step 7.\r\n        if (relativeParts.path[0] !== '/') {\r\n          if (!relativeParts.path) {\r\n            // 5) If the embedded URL path is empty (and not preceded by a\r\n            // slash), then the embedded URL inherits the base URL path\r\n            builtParts.path = baseParts.path;\r\n            // 5a) if the embedded URL's <params> is non-empty, we skip to\r\n            // step 7; otherwise, it inherits the <params> of the base\r\n            // URL (if any) and\r\n            if (!relativeParts.params) {\r\n              builtParts.params = baseParts.params;\r\n              // 5b) if the embedded URL's <query> is non-empty, we skip to\r\n              // step 7; otherwise, it inherits the <query> of the base\r\n              // URL (if any) and we skip to step 7.\r\n              if (!relativeParts.query) {\r\n                builtParts.query = baseParts.query;\r\n              }\r\n            }\r\n          } else {\r\n            // 6) The last segment of the base URL's path (anything\r\n            // following the rightmost slash \"/\", or the entire path if no\r\n            // slash is present) is removed and the embedded URL's path is\r\n            // appended in its place.\r\n            var baseURLPath = baseParts.path;\r\n            var newPath = baseURLPath.substring(0, baseURLPath.lastIndexOf('/') + 1) + relativeParts.path;\r\n            builtParts.path = URLToolkit.normalizePath(newPath);\r\n          }\r\n        }\r\n      }\r\n      if (builtParts.path === null) {\r\n        builtParts.path = opts.alwaysNormalize ? URLToolkit.normalizePath(relativeParts.path) : relativeParts.path;\r\n      }\r\n      return URLToolkit.buildURLFromParts(builtParts);\r\n    },\r\n    parseURL: function(url) {\r\n      var parts = URL_REGEX.exec(url);\r\n      if (!parts) {\r\n        return null;\r\n      }\r\n      return {\r\n        scheme: parts[1] || '',\r\n        netLoc: parts[2] || '',\r\n        path: parts[3] || '',\r\n        params: parts[4] || '',\r\n        query: parts[5] || '',\r\n        fragment: parts[6] || ''\r\n      };\r\n    },\r\n    normalizePath: function(path) {\r\n      // The following operations are\r\n      // then applied, in order, to the new path:\r\n      // 6a) All occurrences of \"./\", where \".\" is a complete path\r\n      // segment, are removed.\r\n      // 6b) If the path ends with \".\" as a complete path segment,\r\n      // that \".\" is removed.\r\n      path = path.split('').reverse().join('').replace(SLASH_DOT_REGEX, '');\r\n      // 6c) All occurrences of \"<segment>/../\", where <segment> is a\r\n      // complete path segment not equal to \"..\", are removed.\r\n      // Removal of these path segments is performed iteratively,\r\n      // removing the leftmost matching pattern on each iteration,\r\n      // until no matching pattern remains.\r\n      // 6d) If the path ends with \"<segment>/..\", where <segment> is a\r\n      // complete path segment not equal to \"..\", that\r\n      // \"<segment>/..\" is removed.\r\n      while (path.length !== (path = path.replace(SLASH_DOT_DOT_REGEX, '')).length) {} // jshint ignore:line\r\n      return path.split('').reverse().join('');\r\n    },\r\n    buildURLFromParts: function(parts) {\r\n      return parts.scheme + parts.netLoc + parts.path + parts.params + parts.query + parts.fragment;\r\n    }\r\n  };\r\n\r\n/* jshint ignore:start */\r\n  if(typeof exports === 'object' && typeof module === 'object')\r\n    module.exports = URLToolkit;\r\n  else if(typeof define === 'function' && define.amd)\r\n    define([], function() { return URLToolkit; });\r\n  else if(typeof exports === 'object')\r\n    exports[\"URLToolkit\"] = URLToolkit;\r\n  else\r\n    root[\"URLToolkit\"] = URLToolkit;\r\n})(this);\r\n/* jshint ignore:end */\r\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","function webpackBootstrapFunc (modules) {\n/******/  // The module cache\n/******/  var installedModules = {};\n\n/******/  // The require function\n/******/  function __webpack_require__(moduleId) {\n\n/******/    // Check if module is in cache\n/******/    if(installedModules[moduleId])\n/******/      return installedModules[moduleId].exports;\n\n/******/    // Create a new module (and put it into the cache)\n/******/    var module = installedModules[moduleId] = {\n/******/      i: moduleId,\n/******/      l: false,\n/******/      exports: {}\n/******/    };\n\n/******/    // Execute the module function\n/******/    modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/    // Flag the module as loaded\n/******/    module.l = true;\n\n/******/    // Return the exports of the module\n/******/    return module.exports;\n/******/  }\n\n/******/  // expose the modules object (__webpack_modules__)\n/******/  __webpack_require__.m = modules;\n\n/******/  // expose the module cache\n/******/  __webpack_require__.c = installedModules;\n\n/******/  // identity function for calling harmony imports with the correct context\n/******/  __webpack_require__.i = function(value) { return value; };\n\n/******/  // define getter function for harmony exports\n/******/  __webpack_require__.d = function(exports, name, getter) {\n/******/    if(!__webpack_require__.o(exports, name)) {\n/******/      Object.defineProperty(exports, name, {\n/******/        configurable: false,\n/******/        enumerable: true,\n/******/        get: getter\n/******/      });\n/******/    }\n/******/  };\n\n/******/  // define __esModule on exports\n/******/  __webpack_require__.r = function(exports) {\n/******/    Object.defineProperty(exports, '__esModule', { value: true });\n/******/  };\n\n/******/  // getDefaultExport function for compatibility with non-harmony modules\n/******/  __webpack_require__.n = function(module) {\n/******/    var getter = module && module.__esModule ?\n/******/      function getDefault() { return module['default']; } :\n/******/      function getModuleExports() { return module; };\n/******/    __webpack_require__.d(getter, 'a', getter);\n/******/    return getter;\n/******/  };\n\n/******/  // Object.prototype.hasOwnProperty.call\n/******/  __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n/******/  // __webpack_public_path__\n/******/  __webpack_require__.p = \"/\";\n\n/******/  // on error function for async loading\n/******/  __webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n  var f = __webpack_require__(__webpack_require__.s = ENTRY_MODULE)\n  return f.default || f // try to call default if defined to also support babel esmodule exports\n}\n\nvar moduleNameReqExp = '[\\\\.|\\\\-|\\\\+|\\\\w|\\/|@]+'\nvar dependencyRegExp = '\\\\((\\/\\\\*.*?\\\\*\\/)?\\s?.*?(' + moduleNameReqExp + ').*?\\\\)' // additional chars when output.pathinfo is true\n\n// http://stackoverflow.com/a/2593661/130442\nfunction quoteRegExp (str) {\n  return (str + '').replace(/[.?*+^$[\\]\\\\(){}|-]/g, '\\\\$&')\n}\n\nfunction isNumeric(n) {\n  return !isNaN(1 * n); // 1 * n converts integers, integers as string (\"123\"), 1e3 and \"1e3\" to integers and strings to NaN\n}\n\nfunction getModuleDependencies (sources, module, queueName) {\n  var retval = {}\n  retval[queueName] = []\n\n  var fnString = module.toString()\n  var wrapperSignature = fnString.match(/^function\\s?\\(\\w+,\\s*\\w+,\\s*(\\w+)\\)/)\n  if (!wrapperSignature) return retval\n  var webpackRequireName = wrapperSignature[1]\n\n  // main bundle deps\n  var re = new RegExp('(\\\\\\\\n|\\\\W)' + quoteRegExp(webpackRequireName) + dependencyRegExp, 'g')\n  var match\n  while ((match = re.exec(fnString))) {\n    if (match[3] === 'dll-reference') continue\n    retval[queueName].push(match[3])\n  }\n\n  // dll deps\n  re = new RegExp('\\\\(' + quoteRegExp(webpackRequireName) + '\\\\(\"(dll-reference\\\\s(' + moduleNameReqExp + '))\"\\\\)\\\\)' + dependencyRegExp, 'g')\n  while ((match = re.exec(fnString))) {\n    if (!sources[match[2]]) {\n      retval[queueName].push(match[1])\n      sources[match[2]] = __webpack_require__(match[1]).m\n    }\n    retval[match[2]] = retval[match[2]] || []\n    retval[match[2]].push(match[4])\n  }\n\n  // convert 1e3 back to 1000 - this can be important after uglify-js converted 1000 to 1e3\n  var keys = Object.keys(retval);\n  for (var i = 0; i < keys.length; i++) {\n    for (var j = 0; j < retval[keys[i]].length; j++) {\n      if (isNumeric(retval[keys[i]][j])) {\n        retval[keys[i]][j] = 1 * retval[keys[i]][j];\n      }\n    }\n  }\n\n  return retval\n}\n\nfunction hasValuesInQueues (queues) {\n  var keys = Object.keys(queues)\n  return keys.reduce(function (hasValues, key) {\n    return hasValues || queues[key].length > 0\n  }, false)\n}\n\nfunction getRequiredModules (sources, moduleId) {\n  var modulesQueue = {\n    main: [moduleId]\n  }\n  var requiredModules = {\n    main: []\n  }\n  var seenModules = {\n    main: {}\n  }\n\n  while (hasValuesInQueues(modulesQueue)) {\n    var queues = Object.keys(modulesQueue)\n    for (var i = 0; i < queues.length; i++) {\n      var queueName = queues[i]\n      var queue = modulesQueue[queueName]\n      var moduleToCheck = queue.pop()\n      seenModules[queueName] = seenModules[queueName] || {}\n      if (seenModules[queueName][moduleToCheck] || !sources[queueName][moduleToCheck]) continue\n      seenModules[queueName][moduleToCheck] = true\n      requiredModules[queueName] = requiredModules[queueName] || []\n      requiredModules[queueName].push(moduleToCheck)\n      var newModules = getModuleDependencies(sources, sources[queueName][moduleToCheck], queueName)\n      var newModulesKeys = Object.keys(newModules)\n      for (var j = 0; j < newModulesKeys.length; j++) {\n        modulesQueue[newModulesKeys[j]] = modulesQueue[newModulesKeys[j]] || []\n        modulesQueue[newModulesKeys[j]] = modulesQueue[newModulesKeys[j]].concat(newModules[newModulesKeys[j]])\n      }\n    }\n  }\n\n  return requiredModules\n}\n\nmodule.exports = function (moduleId, options) {\n  options = options || {}\n  var sources = {\n    main: __webpack_modules__\n  }\n\n  var requiredModules = options.all ? { main: Object.keys(sources.main) } : getRequiredModules(sources, moduleId)\n\n  var src = ''\n\n  Object.keys(requiredModules).filter(function (m) { return m !== 'main' }).forEach(function (module) {\n    var entryModule = 0\n    while (requiredModules[module][entryModule]) {\n      entryModule++\n    }\n    requiredModules[module].push(entryModule)\n    sources[module][entryModule] = '(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })'\n    src = src + 'var ' + module + ' = (' + webpackBootstrapFunc.toString().replace('ENTRY_MODULE', JSON.stringify(entryModule)) + ')({' + requiredModules[module].map(function (id) { return '' + JSON.stringify(id) + ': ' + sources[module][id].toString() }).join(',') + '});\\n'\n  })\n\n  src = src + 'new ((' + webpackBootstrapFunc.toString().replace('ENTRY_MODULE', JSON.stringify(moduleId)) + ')({' + requiredModules.main.map(function (id) { return '' + JSON.stringify(id) + ': ' + sources.main[id].toString() }).join(',') + '}))(self);'\n\n  var blob = new window.Blob([src], { type: 'text/javascript' })\n  if (options.bare) { return blob }\n\n  var URL = window.URL || window.webkitURL || window.mozURL || window.msURL\n\n  var workerUrl = URL.createObjectURL(blob)\n  var worker = new window.Worker(workerUrl)\n  worker.objectURL = workerUrl\n\n  return worker\n}\n","var bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            'function(require,module,exports){' + fn + '(self); }',\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        'function(require,module,exports){' +\n            // try to call default if defined to also support babel esmodule exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);' +\n        '}',\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n","'use strict';\r\n\r\nimport FactoryMaker from './core/FactoryMaker';\r\nimport EventBus from './core/EventBus';\r\nimport Events from './core/events';\r\nimport {\r\n  ErrorTypes\r\n} from './core/errors';\r\nimport Debug from './core/Debug';\r\n\r\nimport FetchLoader from './utils/fetch_loader';\r\nimport FragmentLoader from './loader/fragment_loader';\r\nimport PlaylistLoader from './loader/playlist_loader';\r\n\r\nimport TrackLoader from './loader/track_loader';\r\n\r\nimport PlaybackController from './controller/playback_controller';\r\nimport EMEController from './controller/eme_controller';\r\nimport AdsController from './controller/ads_controller';\r\n\r\nimport ParserController from './controller/parser_controller';\r\nimport LevelController from './controller/level_controller';\r\nimport BufferController from './controller/buffer_controller';\r\nimport StreamController from './controller/stream_controller';\r\nimport TextTrackController from './controller/texttrack_controller';\r\nimport ThumbnailController from './controller/thumbnail_controller';\r\n\r\nimport VideoPlayer from './videoplayer';\r\n\r\nimport CastSender from './cast/cast_sender';\r\n\r\n// Utils\r\nimport TimeRanges from './utils/timeRanges';\r\nimport CommonUtils from './utils/common_utils';\r\n\r\n// UI\r\nimport {\r\n  dom_initUI\r\n} from './ui_basic/js/ui_basic';\r\n\r\n// License\r\nimport LicenseController from './controller/license_controller';\r\n\r\n//////////////////////////////////////////////////////////////////////////////\r\nfunction Player(idContainer) {\r\n  let context_ = oldmtn; //{ flag: 'player' };\r\n  let playerContainer_ = document.getElementById(idContainer);\r\n\r\n  // Create internal basic UI elements first.\r\n  dom_initUI(playerContainer_);\r\n\r\n  let media_ = document.querySelector('.vop-video');\r\n  let adContainer_ = document.querySelector('.vop-ads-container');\r\n\r\n  let eventBus_ = EventBus(context_).getInstance();\r\n  let debug_ = Debug(context_).getInstance();\r\n  let licenseController_ = new LicenseController();\r\n\r\n  let playlistLoader_;\r\n  let textTrackLoader_;\r\n  let fragmentLoader_;\r\n\r\n  let bufferController_;\r\n  let emeController_;\r\n  let parserController_;\r\n  let levelController_;\r\n  let streamController_;\r\n  let playbackController_;\r\n  let textTrackController_;\r\n  let thumbnailController_;\r\n\r\n  // chromecast\r\n  let castSender_;\r\n  let flagCastConnected_ = false;\r\n\r\n  // ads\r\n  let adsEngine_;\r\n\r\n  // Autoplay reference\r\n  let autoplayAllowed_;\r\n  let autoplayRequiresMuted_;\r\n\r\n  // player state machine\r\n  let playerState_ = 'idle'; // 'idle', 'opening', 'opened', 'playing', 'paused', 'ended'\r\n\r\n  // open completed flag\r\n  let flagContentOpenComplete_ = false;\r\n  let flagAdOpenComplete_ = false;\r\n  let flagPlayedOnce_ = false;\r\n\r\n  function setup() {\r\n    // init internal configuration\r\n\r\n    context_.media = media_;\r\n  }\r\n\r\n  function init(cfg) {\r\n    context_.cfg = cfg;\r\n\r\n    initComponent();\r\n    addEventListeners();\r\n  }\r\n\r\n  function uninit() {}\r\n\r\n  function open(mediaCfg) {\r\n    debug_.log('Player, +open');\r\n\r\n    if (!licenseController_.checkUrl(document.domain)) {\r\n      eventBus_.trigger(Events.ERROR, {\r\n        type: ErrorTypes.LICENSE_ERROR\r\n      });\r\n      return false;\r\n    }\r\n\r\n    // preprocess the mediaCfg\r\n    mediaCfg.drm = mediaCfg.drm || {};\r\n\r\n    context_.mediaCfg = mediaCfg;\r\n\r\n    emeController_.setDrmInfo(mediaCfg);\r\n    // detect parser type\r\n    eventBus_.trigger(Events.FINDING_PARSER, {\r\n      url: mediaCfg.url\r\n    });\r\n\r\n    if (mediaCfg.tracks) {\r\n      // load subtitles tracks\r\n      for (let i = 0; i < mediaCfg.tracks.length; i++) {\r\n        let track = mediaCfg.tracks[i];\r\n        //\r\n        track.id = i.toString();\r\n        if (!track.lang) {\r\n          if (track.label) {\r\n            track.lang = track.label;\r\n          } else {\r\n            track.lang = track.label = 'texttrack_' + i.toString();\r\n          }\r\n        }\r\n        if (track.kind === 'subtitles') {\r\n          eventBus_.trigger(Events.TRACK_LOADING, {\r\n            track: track\r\n          });\r\n        }\r\n      }\r\n\r\n      // load thumbnail tracks\r\n      for (let i = 0; i < mediaCfg.tracks.length; i++) {\r\n        let track = mediaCfg.tracks[i];\r\n        if (track.kind === 'thumbnails') {\r\n          eventBus_.trigger(Events.THUMBNAIL_LOADING, {\r\n            track: track\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    if (adsEngine_) {\r\n      adsEngine_.requestAds();\r\n    } else {\r\n      flagAdOpenComplete_ = true;\r\n    }\r\n    flagPlayedOnce_ = false;\r\n    flagContentOpenComplete_ = false;\r\n\r\n    updateState('opening');\r\n  }\r\n\r\n  function close() {\r\n    // if (adsEngine_) {\r\n    //   adsEngine_.close();\r\n    // }\r\n    // if (streamController_) {\r\n    //   streamController_.stopLoad();\r\n    // }\r\n    // if (bufferController_) {\r\n    //   bufferController_.close();\r\n    // }\r\n    // if (playbackController_) {\r\n    //   playbackController_.close();\r\n    // }\r\n\r\n    // context_.mediaCfg = null;\r\n\r\n    updateState('idle');\r\n  }\r\n\r\n  function updateState(state) {\r\n    let oldState = playerState_;\r\n    let newState = state;\r\n\r\n    playerState_ = newState;\r\n    eventBus_.trigger(Events.STATE_CHANGE, {\r\n      oldState: oldState,\r\n      newState: newState\r\n    });\r\n  }\r\n\r\n  //////////////////////////////////////////////////////////////////////////////////\r\n  // API\r\n  function on(type, listener, scope) {\r\n    eventBus_.on(type, listener, scope);\r\n  }\r\n\r\n  function off(type, listener, scope) {\r\n    eventBus_.off(type, listener, scope);\r\n  }\r\n\r\n  function play() {\r\n    if (flagCastConnected_) {\r\n      castSender_.play();\r\n    } else {\r\n      if (!flagPlayedOnce_) {\r\n        if (adsEngine_) {\r\n          adsEngine_.playAd();\r\n        } else {\r\n          playbackController_.play();\r\n        }\r\n        flagPlayedOnce_ = true;\r\n      } else {\r\n        if (adsEngine_ && adsEngine_.isPlayingAd() && adsEngine_.isLinearAd()) {\r\n          adsEngine_.play();\r\n        } else {\r\n          playbackController_.play();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function pause() {\r\n    if (flagCastConnected_) {\r\n      castSender_.pause();\r\n    } else if (adsEngine_ && adsEngine_.isPlayingAd() && adsEngine_.isLinearAd()) {\r\n      adsEngine_.pause();\r\n    } else {\r\n      if (!playbackController_) {\r\n        return;\r\n      }\r\n      playbackController_.pause();\r\n    }\r\n  }\r\n\r\n  function isPaused() {\r\n    if (flagCastConnected_) {\r\n      return castSender_.isPaused();\r\n    } else {\r\n      if (adsEngine_ && adsEngine_.isPlayingAd() && adsEngine_.isLinearAd()) {\r\n        return adsEngine_.isPaused();\r\n      } else {\r\n        if (!playbackController_) {\r\n          return;\r\n        }\r\n        return playbackController_.isPaused();\r\n      }\r\n    }\r\n  }\r\n\r\n  function getPosition() {\r\n    if (flagCastConnected_) {\r\n      return castSender_.getPosition();\r\n    } else if (adsEngine_ && adsEngine_.isPlayingAd() && adsEngine_.isLinearAd()) {\r\n      return adsEngine_.getPosition();\r\n    } else {\r\n      if (!playbackController_) {\r\n        return;\r\n      }\r\n      return playbackController_.getPosition();\r\n    }\r\n  }\r\n\r\n  function getDuration() {\r\n    if (flagCastConnected_) {\r\n      return castSender_.getDuration();\r\n    } else if (adsEngine_ && adsEngine_.isPlayingAd() && adsEngine_.isLinearAd()) {\r\n      return adsEngine_.getDuration();\r\n    } else {\r\n      if (!playbackController_) {\r\n        return;\r\n      }\r\n      return playbackController_.getDuration();\r\n    }\r\n  }\r\n\r\n  function getSeekableRange() {\r\n    if (!playbackController_) {\r\n      return;\r\n    }\r\n    return playbackController_.getSeekableRange();\r\n  }\r\n\r\n  function getBufferedRanges() {\r\n    if (!playbackController_) {\r\n      return;\r\n    }\r\n    return playbackController_.getBufferedRanges();\r\n  }\r\n\r\n  function isEnded() {\r\n    if (adsEngine_ && adsEngine_.isPlayingAd() && adsEngine_.isLinearAd()) {} else {\r\n      if (!playbackController_) {\r\n        return;\r\n      }\r\n      return playbackController_.isEnded();\r\n    }\r\n  }\r\n\r\n  function mute() {\r\n    if (flagCastConnected_) {\r\n      castSender_.mute();\r\n    } else if (adsEngine_ && adsEngine_.isPlayingAd() && adsEngine_.isLinearAd()) {\r\n      adsEngine_.mute();\r\n    } else {\r\n      if (!playbackController_) {\r\n        return;\r\n      }\r\n      playbackController_.mute();\r\n    }\r\n  }\r\n\r\n  function unmute() {\r\n    if (flagCastConnected_) {\r\n      castSender_.unmute();\r\n    } else if (adsEngine_ && adsEngine_.isPlayingAd() && adsEngine_.isLinearAd()) {\r\n      adsEngine_.unmute();\r\n    } else {\r\n      if (!playbackController_) {\r\n        return;\r\n      }\r\n      playbackController_.unmute();\r\n    }\r\n  }\r\n\r\n  function isMuted() {\r\n    if (flagCastConnected_) {\r\n      return castSender_.isMuted();\r\n    } else if (adsEngine_ && adsEngine_.isPlayingAd() && adsEngine_.isLinearAd()) {\r\n      return adsEngine_.isMuted();\r\n    } else {\r\n      if (!playbackController_) {\r\n        return;\r\n      }\r\n      return playbackController_.isMuted();\r\n    }\r\n  }\r\n\r\n  function setVolume(volume) {\r\n    if (flagCastConnected_) {\r\n      castSender_.setVolume(volume);\r\n    } else if (adsEngine_ && adsEngine_.isPlayingAd() && adsEngine_.isLinearAd()) {\r\n      adsEngine_.setVolume(volume);\r\n    } else {\r\n      if (!playbackController_) {\r\n        return;\r\n      }\r\n      playbackController_.setVolume(volume);\r\n    }\r\n  }\r\n\r\n  function getVolume() {\r\n    if (flagCastConnected_) {\r\n      return castSender_.getVolume();\r\n    } else if (adsEngine_ && adsEngine_.isPlayingAd() && adsEngine_.isLinearAd()) {\r\n      return adsEngine_.getVolume();\r\n    } else {\r\n      if (!playbackController_) {\r\n        return;\r\n      }\r\n\r\n      return playbackController_.getVolume();\r\n    }\r\n  }\r\n\r\n  function setAudioPlaybackSpeed(speed) {\r\n    playbackController_.setAudioPlaybackSpeed(speed);\r\n  }\r\n\r\n  function setPosition(pos) {\r\n    if (flagCastConnected_) {\r\n      castSender_.setPosition(pos);\r\n    } else {\r\n      playbackController_.setPosition(pos);\r\n    }\r\n  }\r\n\r\n  function getWidth() {\r\n    return playbackController_.videoWidth();\r\n  }\r\n\r\n  function getHeight() {\r\n    return playbackController_.videoHeight();\r\n  }\r\n\r\n  function resize(width, height) {\r\n    if (adsEngine_) {\r\n      adsEngine_.resize(width, height);\r\n    }\r\n  }\r\n\r\n  // ads\r\n  function playAd() {\r\n    if (adsEngine_) {\r\n      adsEngine_.playAd();\r\n    }\r\n\r\n    // if (adsEngine_) {\r\n    //     adsEngine_.playAd();\r\n    // } else {\r\n\r\n    // }\r\n  }\r\n\r\n  // subtitles\r\n  function getSubtitleTracks() {\r\n    return textTrackController_.getSubtitleTracks();\r\n  }\r\n\r\n  function getCurrentSubtitleTrack() {\r\n    return textTrackController_.getCurrentSubtitleTrack();\r\n  }\r\n\r\n  function selectSubtitleTrack(id) {\r\n    textTrackController_.selectSubtitleTrack(id);\r\n  }\r\n\r\n  // thumbnail\r\n  function getThumbnail(time) {\r\n    if (thumbnailController_) {\r\n      return thumbnailController_.getThumbnail(time);\r\n    } else {\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  // chromecast\r\n  function castVideo() {\r\n    castSender_.requestSession();\r\n  }\r\n\r\n  function castStop() {\r\n    castSender_.stopSession();\r\n  }\r\n\r\n  function castInit(cfg) {\r\n    castSender_.init(cfg);\r\n  }\r\n\r\n  function castOpen(mediaCfg) {\r\n    castSender_.open(mediaCfg);\r\n  }\r\n\r\n  function castAdd() {\r\n    castSender_.add();\r\n  }\r\n\r\n  function castPlay() {\r\n    castSender_.play();\r\n  }\r\n\r\n  function castPause() {\r\n    castSender_.pause();\r\n  }\r\n\r\n  function castSetPosition(time) {\r\n    castSender_.setPosition(time);\r\n  }\r\n\r\n  function castTest() {\r\n    castSender_.test();\r\n  }\r\n\r\n  // airplay\r\n  function isAirplaySupported() {\r\n    if (window.WebKitPlaybackTargetAvailabilityEvent) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  function showPlaybackTargetPicker() {\r\n    if (isAirplaySupported()) {\r\n      let videoElement = media_;\r\n      videoElement.webkitShowPlaybackTargetPicker();\r\n    }\r\n  }\r\n\r\n  // pip\r\n  function isPipSupported() {\r\n    let videoElement = media_;\r\n    if (videoElement &&\r\n      videoElement.webkitSupportsPresentationMode &&\r\n      typeof videoElement.webkitSetPresentationMode === 'function') {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  function setPipPresentation(show) {\r\n    if (isPipSupported()) {\r\n      let videoElement = media_;\r\n      if (show && videoElement.webkitPresentationMode === 'inline') {\r\n        videoElement.webkitSetPresentationMode('picture-in-picture');\r\n      } else if (!show &&\r\n        videoElement.webkitPresentationMode === 'picture-in-picture') {\r\n        videoElement.webkitSetPresentationMode('inline');\r\n      }\r\n    }\r\n  }\r\n\r\n  // 1. If loading UI when player is playing, need sync UI state to player state.\r\n  function getState() {\r\n    return playerState_;\r\n  }\r\n\r\n  function isFullscreen() {\r\n    return document.fullscreenElement ||\r\n      document.msFullscreenElement ||\r\n      document.mozFullScreen ||\r\n      document.webkitIsFullScreen;\r\n  }\r\n\r\n  function getValidBufferPosition(currentPos) {\r\n    if (adsEngine_ && adsEngine_.isLinearAd() && adsEngine_.isPlayingAd()) {\r\n      return 0;\r\n    } else {\r\n      return playbackController_.getValidBufferPosition(currentPos);\r\n    }\r\n  }\r\n\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  // private functions\r\n  function initComponent() {\r\n    playlistLoader_ = PlaylistLoader(context_).getInstance();\r\n    textTrackLoader_ = TrackLoader(context_).getInstance();\r\n    fragmentLoader_ = FragmentLoader(context_).create();\r\n\r\n    playbackController_ = PlaybackController(context_).getInstance();\r\n    textTrackController_ = TextTrackController(context_).getInstance();\r\n    bufferController_ = BufferController(context_).getInstance();\r\n    emeController_ = EMEController(context_).getInstance();\r\n    parserController_ = ParserController(context_).getInstance();\r\n    levelController_ = LevelController(context_).getInstance();\r\n    streamController_ = StreamController(context_).getInstance();\r\n    thumbnailController_ = ThumbnailController(context_).getInstance();\r\n\r\n    // html5 video poster\r\n    if (context_.cfg.poster) {\r\n      media_.poster = context_.cfg.poster;\r\n    }\r\n    // ads\r\n    if (context_.cfg.advertising) {\r\n      adsEngine_ = AdsController(context_).getInstance(adContainer_, media_, context_.cfg.advertising);\r\n    }\r\n    // chromecast\r\n    if (window.cast && window.cast.__platform__) {\r\n      // receiver don't need new CastSender\r\n    } else {\r\n      if (context_.cfg.cast && context_.cfg.cast.applicationID) {\r\n        castSender_ = CastSender(context_).getInstance(context_.cfg.cast.applicationID);\r\n      }\r\n    }\r\n  }\r\n\r\n  function addEventListeners() {\r\n    // html5 event\r\n    eventBus_.on(Events.MEDIA_CANPLAY, onMediaCanPlay, {});\r\n    eventBus_.on(Events.MEDIA_ENDED, onMediaEnded, {});\r\n    eventBus_.on(Events.MEDIA_WAITING, onMediaWaiting, {});\r\n    eventBus_.on(Events.MEDIA_PLAYING, onMediaPlaying, {});\r\n    eventBus_.on(Events.MEDIA_PAUSED, onMediaPaused, {});\r\n\r\n    // controller events\r\n    eventBus_.on(Events.FOUND_PARSER, onFoundParser);\r\n    eventBus_.on(Events.MEDIA_ATTACHED, onMediaAttached);\r\n\r\n    // ads events\r\n    eventBus_.on(Events.AD_CONTENT_PAUSE_REQUESTED, onAdContentPauseRequested, {});\r\n    eventBus_.on(Events.AD_CONTENT_RESUME_REQUESTED, onAdContentResumeRequested, {});\r\n    eventBus_.on(Events.AD_LOADING_COMPLETE, onAdLoadingComplete, {});\r\n    eventBus_.on(Events.AD_PAUSED, onAdPaused, {});\r\n    eventBus_.on(Events.AD_RESUMED, onAdResumed, {});\r\n\r\n    // chromecast\r\n    eventBus_.on(Events.CAST_CONNECTED, onCastConnected);\r\n    eventBus_.on(Events.CAST_DISCONNECTED, onCastDisconnected);\r\n\r\n    // fullscreen listener\r\n    document.addEventListener('fullscreenchange', onFullScreenChange);\r\n    document.addEventListener('mozfullscreenchange', onFullScreenChange);\r\n    document.addEventListener('webkitfullscreenchange', onFullScreenChange);\r\n    document.addEventListener('msfullscreenchange', onFullScreenChange);\r\n    document.addEventListener('MSFullscreenChange', onFullScreenChange);\r\n  }\r\n\r\n  function removeEventListeners() {\r\n    // html5 event\r\n    eventBus_.off(Events.MEDIA_CANPLAY, onMediaCanPlay, {});\r\n    eventBus_.off(Events.MEDIA_ENDED, onMediaEnded, {});\r\n    eventBus_.off(Events.MEDIA_WAITING, onMediaWaiting, {});\r\n    eventBus_.off(Events.MEDIA_PLAYING, onMediaPlaying, {});\r\n    eventBus_.off(Events.MEDIA_PAUSED, onMediaPaused, {});\r\n\r\n    // controller events\r\n    eventBus_.off(Events.FOUND_PARSER, onFoundParser);\r\n    eventBus_.off(Events.MEDIA_ATTACHED, onMediaAttached);\r\n\r\n    // ads events\r\n    eventBus_.off(Events.AD_CONTENT_PAUSE_REQUESTED, onAdContentPauseRequested, {});\r\n    eventBus_.off(Events.AD_CONTENT_RESUME_REQUESTED, onAdContentResumeRequested, {});\r\n    eventBus_.off(Events.AD_LOADING_COMPLETE, onAdLoadingComplete, {});\r\n    eventBus_.off(Events.AD_PAUSED, onAdPaused, {});\r\n    eventBus_.off(Events.AD_RESUMED, onAdResumed, {});\r\n\r\n    document.removeEventListener('fullscreenchange', onFullScreenChange);\r\n    document.removeEventListener('mozfullscreenchange', onFullScreenChange);\r\n    document.removeEventListener('webkitfullscreenchange', onFullScreenChange);\r\n    document.removeEventListener('msfullscreenchange', onFullScreenChange);\r\n    document.removeEventListener('MSFullscreenChange', onFullScreenChange);\r\n  }\r\n\r\n  function onFullScreenChange() {\r\n    // we should not rely on clientWidth or clientHeight to set ad metrics when fullscreen change event triggered.\r\n    eventBus_.trigger(Events.FULLSCREEN_CHANGE);\r\n  }\r\n\r\n  //////////////////////////////////////////////////////////////////////////////////////////\r\n  // Begin -- internal events listener functions\r\n  function onMediaCanPlay() {\r\n    if (!flagContentOpenComplete_) {\r\n      flagContentOpenComplete_ = true;\r\n      processOpenComplete();\r\n    }\r\n  }\r\n\r\n  function onMediaEnded() {\r\n    updateState('ended');\r\n  }\r\n\r\n  function onMediaWaiting() {}\r\n\r\n  function onMediaPlaying() {\r\n    updateState('playing');\r\n  }\r\n\r\n  function onMediaPaused() {\r\n    updateState('paused');\r\n  }\r\n\r\n  function onFoundParser(data) {\r\n    let parser = data.parser;\r\n\r\n    context_.parser = parser;\r\n    switch (parser.type) {\r\n      case 'dash':\r\n      case 'hls':\r\n        eventBus_.trigger(Events.MEDIA_ATTACHING, {\r\n          media: media_\r\n        });\r\n        break;\r\n      case 'pd':\r\n        let vPlayer = VideoPlayer(context_).getInstance();\r\n        vPlayer.setSrc(context_.mediaCfg.url);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  function onMediaAttached() {\r\n    streamController_.startLoad();\r\n  }\r\n\r\n  function onAdContentPauseRequested() {\r\n    playbackController_.pause();\r\n  }\r\n\r\n  function onAdContentResumeRequested() {\r\n    if (!playbackController_.isEnded()) {\r\n      playbackController_.play();\r\n    }\r\n  }\r\n\r\n  function onAdLoadingComplete() {\r\n    flagAdOpenComplete_ = true;\r\n    processOpenComplete();\r\n  }\r\n\r\n  function onAdPaused() {\r\n    updateState('paused');\r\n  }\r\n\r\n  function onAdResumed() {\r\n    updateState('playing');\r\n  }\r\n\r\n  function onCastConnected() {\r\n    flagCastConnected_ = true;\r\n  }\r\n\r\n  function onCastDisconnected() {\r\n    flagCastConnected_ = false;\r\n  }\r\n  // End -- internal events listener functions\r\n\r\n  function processOpenComplete() {\r\n    if (flagContentOpenComplete_ && flagAdOpenComplete_) {\r\n      // Emit event to outer.\r\n      updateState('opened');\r\n\r\n      if (context_.cfg.autoplay) {\r\n        play();\r\n      }\r\n    }\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////////////\r\n  // Title: debug function here\r\n  function manualSchedule() {\r\n    streamController_.manualSchedule();\r\n  }\r\n\r\n  function test() {\r\n    eventBus_.trigger(Events.TEST_MSG);\r\n\r\n    // sample2\r\n    // let fetch1 = FetchLoader(context_).create();\r\n\r\n    // function sleep(numberMillis) {\r\n    //     var now = new Date();\r\n    //     var exitTime = now.getTime() + numberMillis;\r\n    //     while (true) {\r\n    //         now = new Date();\r\n    //         if (now.getTime() > exitTime)\r\n    //         return;\r\n    //     }\r\n    // }\r\n\r\n    // let request = {\r\n    //     url: 'http://localhost/2/hls/videoonly01/stream0.ts',\r\n    //     cbProgress: function (chunkBytes) {\r\n    //         console.log('cbProgress: ' + chunkBytes);\r\n    //         sleep(5000);  //5\r\n    //     },\r\n    //     cbSuccess: function (totalBytes) {\r\n    //         console.log('totalBytes: ' + totalBytes);\r\n    //     }\r\n    // };\r\n\r\n    // fetch1.load(request);\r\n  }\r\n\r\n  function test2() {}\r\n\r\n  function attribute() {\r\n    let media = media_;\r\n    debug_.log(`media.buffered : ${TimeRanges.toString(media.buffered)}`);\r\n    debug_.log(`media.seekable: ${TimeRanges.toString(media.seekable)}`);\r\n\r\n    bufferController_.setDuration(200);\r\n\r\n    let a = 2;\r\n    let b = a;\r\n  }\r\n\r\n  let instance = {\r\n    init: init,\r\n    uninit: uninit,\r\n    open: open,\r\n    close: close,\r\n    on: on,\r\n    off: off,\r\n    play: play,\r\n    pause: pause,\r\n    isPaused: isPaused,\r\n    getPosition: getPosition,\r\n    setPosition: setPosition,\r\n    getDuration: getDuration,\r\n    getSeekableRange: getSeekableRange,\r\n    getBufferedRanges: getBufferedRanges,\r\n    isEnded: isEnded,\r\n    mute: mute,\r\n    unmute: unmute,\r\n    isMuted: isMuted,\r\n    setVolume: setVolume,\r\n    getVolume: getVolume,\r\n    setAudioPlaybackSpeed: setAudioPlaybackSpeed,\r\n    // Resize\r\n    getWidth: getWidth,\r\n    getHeight: getHeight,\r\n    resize: resize,\r\n    isFullscreen: isFullscreen,\r\n    // buffer\r\n    getValidBufferPosition: getValidBufferPosition,\r\n    // ads\r\n    playAd: playAd,\r\n    // subtitles\r\n    getSubtitleTracks: getSubtitleTracks,\r\n    getCurrentSubtitleTrack: getCurrentSubtitleTrack,\r\n    selectSubtitleTrack: selectSubtitleTrack,\r\n    // thumbnail\r\n    getThumbnail: getThumbnail,\r\n    // chromecast\r\n    castVideo: castVideo,\r\n    castStop: castStop,\r\n    castInit: castInit,\r\n    castOpen: castOpen,\r\n    castAdd: castAdd,\r\n    castPlay: castPlay,\r\n    castPause: castPause,\r\n    castSetPosition: castSetPosition,\r\n    castTest: castTest,\r\n    // pip(Safari only)\r\n    setPipPresentation: setPipPresentation,\r\n    // airplay(Safari only)\r\n    showPlaybackTargetPicker: showPlaybackTargetPicker,\r\n    // state Machine\r\n    getState: getState,\r\n    // debug\r\n    manualSchedule: manualSchedule,\r\n    test: test,\r\n    test2: test2\r\n  };\r\n\r\n  setup();\r\n\r\n  return instance;\r\n};\r\n\r\nexport default Player;","'use strict';\n\nimport EventBus from '../core/EventBus';\nimport Events from '../core/events';\nimport Debug from '../core/Debug';\n\nimport CastUtils from './cast_utils';\nimport UITools from '../ui/js/ui_tools';\n\nfunction printLog(msg) {\n  console.log('CastReceiver: ' + msg);\n}\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\nfunction CastReceiver(elementId) {\n  printLog('receiver, constructor');\n\n  let context_ = {};\n  let eventBus_;\n  let debug_;\n\n  let elementId_ = elementId;\n  let mediaElement_ = null;\n  let receiverManager_ = null;\n  let genericBus_ = null;\n  let oldmtnBus_ = null;\n  let mediaManager_ = null;\n  let onLoadOrig_ = null;\n  let onGetStatusOrig_ = null;\n  let onMetadataLoadedOrig_ = null;\n  let onStopOrig_ = null;\n  let onLoadMetadataErrorOrig_ = null;\n  let onErrorOrig_ = null;\n  let evHandlers = {};\n  let player_ = null;\n  let isConnected_ = null;\n\n  let omPlayer_;\n  let omUIEngine_;\n\n  function setup() {\n    // init html5 reference\n    eventBus_ = EventBus(context_).getInstance();\n    debug_ = Debug(context_).getInstance();\n\n    cast.player.api.setLoggerLevel(cast.player.api.LoggerLevel.DEBUG);\n    cast.receiver.logger.setLevelValue(cast.receiver.LoggerLevel.DEBUG);\n\n    // Init CastReceiverManager\n    receiverManager_ = cast.receiver.CastReceiverManager.getInstance();\n    receiverManager_.onReady = onReady_;\n    receiverManager_.onSenderDisconnected = onSenderDisconnected_;\n    receiverManager_.onVisibilityChanged = onVisibilityChanged_;\n\n    // custom message bus\n    printLog('CastUtils.GENERIC_MESSAGE_NAMESPACE: ' + CastUtils.GENERIC_MESSAGE_NAMESPACE);\n    printLog('CastUtils.OLDMTN_MESSAGE_NAMESPACE: ' + CastUtils.OLDMTN_MESSAGE_NAMESPACE);\n\n    oldmtnBus_ = receiverManager_.getCastMessageBus(\n      CastUtils.OLDMTN_MESSAGE_NAMESPACE);\n    oldmtnBus_.onMessage = onOldmtnMessage_;\n\n    // // Init Video Element\n    // let v = document.getElementById(elementId_);\n    // mediaElement_ = v.querySelector('.h5p-video');\n    // // mediaElement_.addEventListener('timeupdate', onTimeupdate,\n    // //     false);\n\n    // // Init MediaManager\n    // mediaManager_ = new cast.receiver.MediaManager(mediaElement_);\n\n    // // The default GENERIC_MESSAGE_NAMESPACE should called after creating MediaManager. \n    // genericBus_ = receiverManager_.getCastMessageBus(\n    //         CastUtils.GENERIC_MESSAGE_NAMESPACE);\n    // genericBus_.onMessage = onGenericMessage_;\n\n    // onLoadOrig_ =\n    //     mediaManager_.onLoad.bind(mediaManager_);\n    // mediaManager_.onLoad = onLoad_;\n\n    // onGetStatusOrig_ =\n    //     mediaManager_.onGetStatus.bind(mediaManager_);\n    // mediaManager_.onGetStatus = onGetStatus_;\n\n    // onMetadataLoadedOrig_ =\n    //     mediaManager_.onMetadataLoaded.bind(mediaManager_);\n    // mediaManager_.onMetadataLoaded = onMetadataLoaded_;\n\n    // onStopOrig_ =\n    //     mediaManager_.onStop.bind(mediaManager_);\n    // mediaManager_.onStop = onStop_;\n\n    // onLoadMetadataErrorOrig_ =\n    //     mediaManager_.onLoadMetadataError.bind(mediaManager_);\n    // mediaManager_.onLoadMetadataError = onLoadMetadataError_;\n\n    // onErrorOrig_ = mediaManager_.onError.bind(mediaManager_);\n    // mediaManager_.onError = onError_;\n  }\n\n  function initPlayer() {\n    omPlayer_ = new oldmtn.Player(elementId_);\n    omUIEngine_ = new oldmtn.UIEngine(omPlayer_);\n    omUIEngine_.installSkin();\n\n    omPlayer_.on(Events.STATE_CHANGE, onStateChange);\n    omPlayer_.on(Events.MEDIA_TIMEUPDATE, onMediaTimeupdated);\n    omPlayer_.on(Events.MEDIA_PLAYING, onMediaPlaying);\n    omPlayer_.on(Events.MEDIA_PAUSED, onMediaPaused);\n    omPlayer_.on(Events.MEDIA_SEEKING, onMediaSeeking);\n    omPlayer_.on(Events.MEDIA_SEEKED, onMediaSeeked);\n    omPlayer_.on(Events.MEDIA_VOLUME_CHANGED, onMediaVolumeChanged);\n  }\n\n  //\n  function getMediaElement() {\n    return mediaElement_;\n  }\n\n  function getMediaManager() {\n    return mediaManager_;\n  }\n\n  function getPlayer() {\n    return player_;\n  }\n\n  function onReady_() {\n    printLog('onReady');\n    isConnected_ = true;\n  }\n\n  function onSenderDisconnected_(event) {\n    printLog('onSenderDisconnected');\n    // When the last or only sender is connected to a receiver,\n    // tapping Disconnect stops the app running on the receiver.\n    if (receiverManager_.getSenders().length === 0 &&\n      event.reason ===\n      cast.receiver.system.DisconnectReason.REQUESTED_BY_SENDER) {\n      receiverManager_.stop();\n    }\n  }\n\n  function onStateChange(e) {\n    let newState = e.newState;\n    if (newState === 'opened') {\n      e.position = omPlayer_.getPosition();\n      e.duration = omPlayer_.getDuration();\n      e.volume = omPlayer_.getVolume();\n      e.muted = omPlayer_.isMuted();\n      e.paused = omPlayer_.isPaused();\n    }\n    sendMessage_({\n      type: Events.STATE_CHANGE,\n      data: e\n    }, oldmtnBus_);\n  }\n\n  function onMediaTimeupdated() {\n    let position = omPlayer_.getPosition();\n    let duration = omPlayer_.getDuration();\n\n    printLog(`position: ${position}, duration: ${duration}`);\n    // send message to sender\n    sendMessage_({\n      type: Events.MEDIA_TIMEUPDATE,\n      data: {\n        position: position,\n        duration: duration\n      }\n    }, oldmtnBus_);\n  }\n\n  function onMediaPlaying() {\n    sendMessage_({\n      type: Events.MEDIA_PLAYING\n    }, oldmtnBus_);\n  }\n\n  function onMediaPaused() {\n    sendMessage_({\n      type: Events.MEDIA_PAUSED\n    }, oldmtnBus_);\n  }\n\n  function onMediaSeeking() {\n    let position = omPlayer_.getPosition();\n    let duration = omPlayer_.getDuration();\n\n    sendMessage_({\n      type: Events.MEDIA_SEEKING,\n      data: {\n        position: position,\n        duration: duration\n      }\n    }, oldmtnBus_);\n  }\n\n  function onMediaSeeked() {\n    let position = omPlayer_.getPosition();\n    let duration = omPlayer_.getDuration();\n\n    sendMessage_({\n      type: Events.MEDIA_SEEKED,\n      data: {\n        position: position,\n        duration: duration\n      }\n    }, oldmtnBus_);\n  }\n\n  function onMediaVolumeChanged() {\n    let muted = omPlayer_.isMuted();\n    let volume = omPlayer_.getVolume();\n    sendMessage_({\n      type: Events.MEDIA_VOLUME_CHANGED,\n      data: {\n        muted: muted,\n        volume: volume\n      }\n    }, oldmtnBus_);\n  }\n\n  function onSeekStart_() {\n    printLog('onSeekStart');\n  }\n\n  function onSeekEnd_() {\n    printLog('onSeekEnd');\n  }\n\n  function onVisibilityChanged_(event) {\n    printLog('onVisibilityChanged');\n    // if (!event.isVisible) {\n    //     mediaElement_.pause();\n    //     mediaManager_.broadcastStatus(false);\n    // }\n  }\n\n  function onGenericMessage_(event) {\n    printLog('+onGenericMessage_, type: ' + event.type + ', senderId: ' + event.senderId);\n    return;\n\n    // printLog('type: ' + event.data.type);\n    // printLog('requestId: ' + event.data.requestId);\n    // printLog('namespace: ' + event.namespace);\n    // printLog('senderId: ' + event.senderId);\n\n    // var message = CastUtils.deserialize(event.data);\n    // printLog('+onGenericMessage_: ' + message['type']);\n\n    // TODO(ismena): error message on duplicate request id from the same sender\n    //switch (message['type']) {\n    switch (event.data.type) {\n      case 'PLAY':\n        {\n          mediaElement_.play();\n        }\n        break;\n      case 'PAUSE':\n        {\n          mediaElement_.pause();\n        }\n        break;\n      case 'LOAD':\n        {\n          var mediaInfo = event.data.media;\n          var contentId = mediaInfo['contentId'];\n          var manifestUri = contentId;\n\n          // var mediaInfo = message['media'];\n          // var contentId = mediaInfo['contentId'];\n          // var currentTime = message['currentTime'];\n          // var manifestUri = contentId;\n          // sample\n          // contentId: \"http://10.2.72.104/7/hls/v8/gear1/test.m3u8\"\n          // contentType: \"application/dash+xml\"\n          // metadata: Object\n          // streamType: \"BUFFERED\"\n          // var protocolFunc = CastReceiver.getProtocolFunction_(mediaInfo);\n          // var host = new cast.player.api.Host({\n          //   'url': manifestUri,\n          //   'mediaElement': mediaElement_\n          // });\n          // player_ = new cast.player.api.Player(host);\n          // player_.load(protocolFunc(host));\n        }\n        break;\n      default:\n        break;\n    }\n  }\n\n  function onOldmtnMessage_(event) {\n    let message = CastUtils.deserialize(event.data);\n    let data = message.data;\n    printLog('onOldmtnMessage_, event.data: ' + event.data);\n    printLog('onOldmtnMessage_, message: ' + message);\n\n    if (message.cmdType === 'init') {\n      initPlayer(data);\n      //printLog('poster: ' + message.poster);\n      omPlayer_.init(data);\n    } else if (message.cmdType === 'open') {\n      omPlayer_.open(message);\n    } else if (message.cmdType === 'add') {\n      omPlayer_.manualSchedule();\n    } else if (message.cmdType === 'play') {\n      omPlayer_.play();\n    } else if (message.cmdType === 'pause') {\n      omPlayer_.pause();\n    } else if (message.cmdType === 'playAd') {\n      omPlayer_.playAd();\n    } else if (message.cmdType === 'setPosition') {\n      omPlayer_.setPosition(data.position);\n    } else if (message.cmdType === 'setVolume') {\n      omPlayer_.setVolume(data.volume);\n    } else if (message.cmdType === 'mute') {\n      omPlayer_.mute();\n    } else if (message.cmdType === 'unmute') {\n      omPlayer_.unmute();\n    } else if (message.cmdType === 'test') {\n      omPlayer_.test();\n      // uiEngine_ = new oldmtn.UIEngine(omPlayer_);\n      // uiEngine_.installSkin();\n      // let v = document.querySelector('.html5-video-player');\n      // UITools.removeClass(v, 'vop-autohide');\n    }\n    //oldmtnBus_.broadcast(\"abcd1234\");\n  }\n\n  function sendMessage_(message, bus, opt_senderId) {\n    // Cuts log spam when debugging the receiver UI in Chrome.\n    if (!isConnected_) {\n      return;\n    }\n\n    let serialized = CastUtils.serialize(message);\n    if (opt_senderId) {\n      bus.getCastChannel(opt_senderId).send(serialized);\n    } else {\n      bus.broadcast(serialized);\n    }\n  }\n\n  ////////////////////////////////////////////////////////////////////////////////////////\n  //\n  function onLoad_(event) {\n    printLog('onLoad_');\n\n    if (player_) {\n      player_.unload();\n      player_ = null;\n    }\n\n    var info = new cast.receiver.MediaManager.LoadInfo(event.data, event.senderId);\n\n    var url = info.message.media.contentId;\n    var protocolFunc = getProtocolFunction_(info.message.media);\n    var host = new cast.player.api.Host({\n      'url': url,\n      'mediaElement': mediaElement_\n    });\n    player_ = new cast.player.api.Player(host);\n    player_.load(protocolFunc(host));\n  };\n\n  function onGetStatus_(event) {\n    printLog('onGetStatus_', event);\n  }\n\n  function onMetadataLoaded_(info) {\n    var totalTime = mediaElement_.duration;\n\n    printLog('onMetadataLoaded, ' + 'total time: ' + totalTime);\n    onMetadataLoadedOrig_(info);\n  }\n\n  function onLoadMetadataError_(event) {\n    printLog('onLoadMetadataError_');\n    onLoadMetadataErrorOrig_(event);\n  }\n\n  ////////////////////////////////////////////////////////////////////////////////////////\n  // object function\n  function getProtocolFunction_(mediaInformation) {\n    var url = mediaInformation.contentId;\n    var type = mediaInformation.contentType || '';\n    var path = getPath_(url) || '';\n    if (getExtension_(path) === 'm3u8' ||\n      type === 'application/x-mpegurl' ||\n      type === 'application/vnd.apple.mpegurl') {\n      return cast.player.api.CreateHlsStreamingProtocol;\n    } else if (getExtension_(path) === 'mpd' ||\n      type === 'application/dash+xml') {\n      return cast.player.api.CreateDashStreamingProtocol;\n    } else if (path.indexOf('.ism') > -1 ||\n      type === 'application/vnd.ms-sstr+xml') {\n      return cast.player.api.CreateSmoothStreamingProtocol;\n    }\n    return null;\n  }\n\n  function formatDuration_(dur) {\n    dur = Math.floor(dur);\n\n    function digit(n) {\n      return ('00' + Math.round(n)).slice(-2);\n    }\n    var hr = Math.floor(dur / 3600);\n    var min = Math.floor(dur / 60) % 60;\n    var sec = dur % 60;\n    if (!hr) {\n      return digit(min) + ':' + digit(sec);\n    } else {\n      return digit(hr) + ':' + digit(min) + ':' + digit(sec);\n    }\n  }\n\n  /**\n   * Utility function to get the extension of a URL file path.\n   *\n   * @param {string} url the URL\n   * @return {string} the extension or \"\" if none\n   * @private\n   */\n  function getExtension_(url) {\n    var parts = url.split('.');\n    // Handle files with no extensions and hidden files with no extension\n    if (parts.length === 1 || (parts[0] === '' && parts.length === 2)) {\n      return '';\n    }\n    return parts.pop().toLowerCase();\n  }\n\n  /**\n   * Returns the URL path.\n   *\n   * @param {string} url The URL\n   * @return {string} The URL path.\n   * @private\n   */\n  function getPath_(url) {\n    var href = document.createElement('a');\n    href.href = url;\n    return href.pathname || '';\n  }\n\n  function start() {\n    receiverManager_.start();\n  }\n\n  function addEventListener(ev, cb) {\n    evHandlers[ev] = cb;\n  }\n\n  let instance = {\n    start: start,\n    addEventListener: addEventListener\n  };\n  setup();\n  return instance;\n}\n\nexport default CastReceiver;","'use strict';\n\nimport CastUtils from './cast_utils';\n\nimport FactoryMaker from '../core/FactoryMaker';\nimport EventBus from '../core/EventBus';\nimport Events from '../core/events';\nimport Debug from '../core/Debug';\n\n///////////////////////////////////////////////////////////////////////////////\n// RemotePlayerHandler\nfunction RemotePlayerHandler() {\n  function init(remotePlayer, remotePlayerController) {\n    remotePlayer = remotePlayer;\n    remotePlayerController = remotePlayerController;\n\n    remotePlayerController.addEventListener(\n      cast.framework.RemotePlayerEventType.IS_MUTED_CHANGED,\n      function() {\n        console.log('muted: ' + remotePlayer.isMuted);\n      });\n\n    remotePlayerController.addEventListener(\n      cast.framework.RemotePlayerEventType.VOLUME_LEVEL_CHANGED,\n      function() {\n        var newVolume = remotePlayer.volumeLevel;\n        console.log('newVolume is: ' + newVolume);\n      });\n  }\n\n  function play() {\n    if (remotePlayer.isPaused) {\n      remotePlayerController.playOrPause();\n    }\n  }\n\n  function pause() {\n    if (!remotePlayer.isPaused) {\n      remotePlayerController.playOrPause();\n    }\n  }\n\n  function setVolume(volume) {\n    remotePlayer.volumeLevel = volume;\n    remotePlayerController.setVolumeLevel();\n\n    // or\n    //session_.setVolume(1.0);\n  }\n\n  function getVolume() {\n    return remotePlayer.volumeLevel;\n  }\n\n  function seek(time) {\n    remotePlayer.currentTime = time;\n    remotePlayerController.seek();\n  }\n\n  function stop() {\n    remotePlayerController.stop();\n  }\n\n  let instance = {\n    init: init,\n    play: play,\n    pause: pause,\n    setVolume: setVolume,\n    getVolume: getVolume,\n    seek: seek,\n    stop: stop\n  };\n  return instance;\n};\n\n////////////////////////////////////////////////////////////////////////////////////\n// CastSender\nfunction CastSender(receiverAppId) {\n  let context_ = this.context;\n  let receiverAppId_ = receiverAppId;\n  let eventBus_ = EventBus(context_).getInstance();\n  let debug_ = Debug(context_).getInstance();\n\n  let remotePlayer = null;\n  let remotePlayerController = null;\n  let castContext_ = null;\n  let session_ = null;\n\n  let remotePlayerHandler = new RemotePlayerHandler();\n\n  // \n  let position_;\n  let duration_;\n  let paused_;\n  let muted_;\n  let volume_;\n\n  function setup() {\n    console.log('cast, setup');\n\n    var options = {};\n\n    // Set the receiver application ID to your own (created in the\n    // Google Cast Developer Console), or optionally\n    // use the chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID\n    options.receiverApplicationId = receiverAppId;\n\n    // Auto join policy can be one of the following three:\n    // ORIGIN_SCOPED - Auto connect from same appId and page origin\n    // TAB_AND_ORIGIN_SCOPED - Auto connect from same appId, page origin, and tab\n    // PAGE_SCOPED - No auto connect\n    //options.autoJoinPolicy = chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED;\n    castContext_ = cast.framework.CastContext.getInstance();\n    castContext_.setOptions(options);\n\n    castContext_.addEventListener(cast.framework.CastContextEventType.CAST_STATE_CHANGED,\n      function(e) {\n        //console.log('cast, cast state: ', e);\n      }\n    );\n\n    castContext_.addEventListener(\n      cast.framework.CastContextEventType.SESSION_STATE_CHANGED,\n      function(event) {\n        console.log('cast, sessionState: ' + event.sessionState);\n        switch (event.sessionState) {\n          case cast.framework.SessionState.SESSION_STARTED:\n          case cast.framework.SessionState.SESSION_RESUMED:\n            break;\n          case cast.framework.SessionState.SESSION_ENDED:\n            //console.log('CastContext: CastSession disconnected');\n            // Update locally as necessary\n            break;\n        }\n      });\n\n    remotePlayer = new cast.framework.RemotePlayer();\n    remotePlayerController = new cast.framework.RemotePlayerController(remotePlayer);\n    remotePlayerController.addEventListener(\n      cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED,\n      onConnectedChanged);\n    remotePlayerController.addEventListener(\n      cast.framework.RemotePlayerEventType.IS_MEDIA_LOADED_CHANGED,\n      onMediaLoadedChanged);\n\n    //\n    remotePlayerHandler.init(remotePlayer, remotePlayerController);\n  }\n\n  function onConnectedChanged() {\n    console.log('cast, +onConnectedChanged, remotePlayer.isConnected: ' + remotePlayer.isConnected);\n\n    session_ = cast.framework.CastContext.getInstance().getCurrentSession();\n    if (session_) {\n      // BD\n      let castDev = session_.getCastDevice();\n      // ED\n      session_.addMessageListener(CastUtils.OLDMTN_MESSAGE_NAMESPACE,\n        onMessageReceived_);\n    } else {\n      console.log('cast, session_ is null');\n    }\n\n    // Notify upper layer\n    if (remotePlayer.isConnected) {\n      eventBus_.trigger(Events.CAST_CONNECTED);\n    } else {\n      eventBus_.trigger(Events.CAST_DISCONNECTED);\n    }\n  }\n\n  function onMediaLoadedChanged() {\n    console.log('--onMediaLoadedChanged--');\n  }\n\n  function loadMedia_SuccessCb() {\n    console.log('--loadMedia_SuccessCb--');\n  }\n\n  function loadMedia_ErrorCb() {\n    console.log('--loadMedia_ErrorCb--');\n  }\n\n  function init(cfg) {\n    let msg = {\n      cmdType: 'init',\n      data: cfg\n    };\n    sendMessage_(msg);\n  }\n\n  function open(message) {\n    message.cmdType = 'open';\n    sendMessage_(message);\n  }\n\n  function add() {\n    let msg = {\n      'cmdType': 'add'\n    };\n    sendMessage_(msg);\n  }\n\n  function play() {\n    let msg = {\n      'cmdType': 'play'\n    };\n    sendMessage_(msg);\n  }\n\n  function pause() {\n    let msg = {\n      'cmdType': 'pause'\n    };\n    sendMessage_(msg);\n  }\n\n  function isPaused() {\n    return paused_;\n  }\n\n  function setPosition(pos) {\n    let msg = {\n      cmdType: 'setPosition',\n      data: {\n        position: pos\n      }\n    };\n    sendMessage_(msg);\n  }\n\n  function getPosition() {\n    return position_;\n  }\n\n  function getDuration() {\n    return duration_;\n  }\n\n  function setVolume(volume) {\n    let msg = {\n      cmdType: 'setVolume',\n      data: {\n        volume: volume\n      }\n    };\n    sendMessage_(msg);\n\n    // old\n    //remotePlayerHandler.setVolume(volume);\n  }\n\n  function getVolume() {\n    return volume_;\n  }\n\n  function mute() {\n    let msg = {\n      cmdType: 'mute'\n    };\n    sendMessage_(msg);\n  }\n\n  function unmute() {\n    let msg = {\n      cmdType: 'unmute'\n    };\n    sendMessage_(msg);\n  }\n\n  function isMuted() {\n    return muted_;\n  }\n\n  // Opens the cast selection UI, to allow user to start or stop session.\n  function requestSession() {\n    if (!castContext_) {\n      console.warn('cast, you should call init first.');\n      return;\n    }\n\n    castContext_.requestSession();\n  }\n\n  function endSession() {\n    if (!castContext_) {\n      return;\n    }\n\n    let castSession = castContext_.getCurrentSession();\n    // End the session and pass 'true' to indicate\n    // that receiver application should be stopped.\n    castSession.endSession(true);\n  }\n\n  var tmp = 1;\n\n  function test() {\n    //console.log('--test--');\n    session_.sendMessage(CastUtils.OLDMTN_MESSAGE_NAMESPACE,\n      tmp.toString(),\n      function() {}, // success callback\n      function() {}); // error callback\n    tmp++;\n    play();\n    // let msg = {\n    //   'cmdType': 'test'\n    // };\n    // sendMessage_(msg);\n  }\n\n  function loadMedia(url, type) {\n    console.log('+loadMedia');\n\n    if (cast && cast.framework && remotePlayer.isConnected) {\n      var mediaInfo = new chrome.cast.media.MediaInfo(url, type);\n\n      mediaInfo.metadata = new chrome.cast.media.GenericMediaMetadata();\n      mediaInfo.metadata.metadataType = chrome.cast.media.MetadataType.GENERIC;\n\n      var request = new chrome.cast.media.LoadRequest(mediaInfo);\n\n      // For cast to voReceiver\n      //request.customData = { drmInfoList: null };\n\n      session_.loadMedia(request, loadMedia_SuccessCb, loadMedia_ErrorCb);\n    } else {\n      remotePlayer = null;\n      remotePlayerController = null;\n    }\n\n    console.log('-loadMedia');\n  }\n\n  function onMessageReceived_(namespace, serialized) {\n    let message = CastUtils.deserialize(serialized);\n    let e = message.data || {};\n    e.from = 'chromecast';\n\n    console.log('receive msg, namespace: ' + namespace + ', serialized: ' + serialized + ', type: ' + message.type);\n    switch (message.type) {\n      case Events.STATE_CHANGE:\n        if (e.newState === 'opened') {\n          // do some initialization here\n          position_ = e.position;\n          duration_ = e.duration;\n          muted_ = e.muted;\n          volume_ = e.volume;\n          paused_ = e.paused;\n        }\n        //eventBus_.trigger(Events.STATE_CHANGE, e);\n        break;\n      case Events.MEDIA_TIMEUPDATE:\n        position_ = e.position;\n        duration_ = e.duration;\n        eventBus_.trigger(Events.MEDIA_TIMEUPDATE);\n        console.log(`timeupdate, ${message.data.position}/${message.data.duration}`);\n        break;\n      case Events.MEDIA_PLAYING:\n        paused_ = false;\n        eventBus_.trigger(Events.MEDIA_PLAYING);\n        break;\n      case Events.MEDIA_PAUSED:\n        paused_ = true;\n        eventBus_.trigger(Events.MEDIA_PAUSED);\n        break;\n      case Events.MEDIA_SEEKING:\n        position_ = e.position;\n        duration_ = e.duration;\n        eventBus_.trigger(Events.MEDIA_SEEKING);\n        break;\n      case Events.MEDIA_SEEKED:\n        position_ = e.position;\n        duration_ = e.duration;\n        eventBus_.trigger(Events.MEDIA_SEEKED);\n        break;\n      case Events.MEDIA_VOLUME_CHANGED:\n        muted_ = e.muted;\n        volume_ = e.volume;\n        eventBus_.trigger(Events.MEDIA_VOLUME_CHANGED);\n        break;\n      default:\n        break;\n    }\n  }\n\n  function old_play() {\n    remotePlayerHandler.play();\n  }\n\n  function old_pause() {\n    remotePlayerHandler.pause();\n  }\n\n  function addVolume() {\n    var volume = RemotePlayerHandler.getVolume() + 0.1;\n\n    remotePlayerHandler.setVolume(volume);\n  }\n\n  function delVolume(volume) {\n    var volume = RemotePlayerHandler.getVolume() - 0.1;\n    remotePlayerHandler.setVolume(volume);\n  }\n\n  function isConnected() {\n    return remotePlayer && remotePlayer.isConnected;\n  }\n\n  function seek(time) {\n    remotePlayerHandler.seek(parseFloat(time));\n  }\n\n  function stop() {\n    remotePlayerHandler.stop();\n  }\n\n  function attribute() {\n    console.log('remote player time: ' + remotePlayer.currentTime);\n    if (remotePlayer.savedPlayerState) {\n      console.log('remotePlayer.savedPlayerState.currentTime: ' + remotePlayer.savedPlayerState.currentTime);\n    }\n  }\n\n  function remoteCall_(targetName, methodName) {\n    var args = Array.prototype.slice.call(arguments, 2);\n    sendMessage_({\n      'type': 'call',\n      'targetName': targetName,\n      'methodName': methodName,\n      'args': args\n    });\n  }\n\n  function sendMessage_(message) {\n    var serialized = CastUtils.serialize(message);\n    console.log('send msg: ' + serialized);\n    // TODO: have never seen this fail.  When would it and how should we react?\n    session_.sendMessage(\n      CastUtils.OLDMTN_MESSAGE_NAMESPACE,\n      serialized,\n      function() {}, // success callback\n      function() {}); // error callback\n  }\n\n  let instance = {\n    // \n    requestSession: requestSession,\n    endSession: endSession,\n    init: init,\n    open: open,\n    add: add,\n    play: play,\n    pause: pause,\n    isPaused: isPaused,\n    setPosition: setPosition,\n    getPosition: getPosition,\n    getDuration: getDuration,\n    setVolume: setVolume,\n    getVolume: getVolume,\n    mute: mute,\n    unmute: unmute,\n    isMuted: isMuted,\n    test: test,\n    // old left\n    loadMedia: loadMedia,\n    stop: stop,\n    old_play: old_play,\n    old_pause: old_pause,\n    addVolume: addVolume,\n    delVolume: delVolume,\n    seek: seek,\n    attribute: attribute\n  };\n\n  setup();\n  return instance;\n};\n\nCastSender.__h5player_factory_name = 'CastSender';\nexport default FactoryMaker.getSingletonFactory(CastSender);","var CastUtils = function() {};\n\n////////////////////////////////////////////////////////////////////////\n// Begin CastUtils\nCastUtils.GENERIC_MESSAGE_NAMESPACE = 'urn:x-cast:com.google.cast.media';\nCastUtils.OLDMTN_MESSAGE_NAMESPACE = 'urn:x-cast:com.google.oldmtn.cast';\n\nCastUtils.simulateTimeRanges_ = function(obj) {\n  return {\n    length: obj.length,\n    // NOTE: a more complete simulation would throw when |i| was out of range,\n    // but for simplicity we will assume a well-behaved application that uses\n    // length instead of catch to stop iterating.\n    start: function(i) {\n      return obj.start[i];\n    },\n    end: function(i) {\n      return obj.end[i];\n    }\n  };\n};\n\nCastUtils.serialize = function(thing) {\n  return JSON.stringify(thing);\n};\n\nCastUtils.deserialize = function(str) {\n  return JSON.parse(str, function(key, value) {\n    if (value == 'NaN') {\n      return NaN;\n    } else if (value == '-Infinity') {\n      return -Infinity;\n    } else if (value == 'Infinity') {\n      return Infinity;\n    } else if (value && typeof value == 'object' &&\n      value['__type__'] == 'TimeRanges') {\n      // TimeRanges objects have been unpacked and sent as plain data.\n      // Simulate the original TimeRanges object.\n      return CastUtils.simulateTimeRanges_(value);\n    }\n    return value;\n  });\n};\n\n// End CastUtils\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\nexport default CastUtils;","export class Fragment {\n  constructor() {\n    this.type = null; // audio/video/pd\n    this.url = null; // https://abc.com/1.m4s\n\n    this.byteRangeStart = null;\n    this.byteRangeEnd = null;\n  }\n}\n\nexport class TrackInfo {\n  constructor() {\n    this.type = null; // audio/video/stream(ts)\n    this.rep = null; // dash only\n  }\n}\n\nexport class PeriodInfo {\n  constructor() {\n    this.url = null; // dash/hls/pd ulr\n    this.duration = null; // current stream total duration\n    this.tracks = []; // an array of TrackInfo\n  }\n}\n\n","import FactoryMaker from '../core/FactoryMaker';\nimport EventBus from '../core/EventBus';\nimport Events from '../core/events';\nimport Debug from '../core/Debug';\nimport CommonUtils from '../utils/common_utils';\n\nfunction formatAdsTimeOffset(offset) {\n  var hour = parseInt(offset / 3600);\n  var min = parseInt(parseInt((offset % 3600)) / 60);\n  var sec = parseInt(parseInt((offset % 3600)) % 60);\n\n  return hour.toString() + ':' + min.toString() + ':' + sec.toString() + '.000';\n}\n\nfunction getVMAPItem(breakId, offset, tag) {\n  var breakType = 'linear,nonlinear';\n  var breakId = breakId;\n  var timeOffset = formatAdsTimeOffset(offset);\n  var url = tag;\n\n  var item = '<vmap:AdBreak breakType=\"_type_\" breakId=\"_adbreakname_\" timeOffset=\"_offset_\"><vmap:AdSource allowMultipleAds=\"true\" followRedirects=\"true\" id=\"_adbreakname_-ad-1\"><vmap:AdTagURI><![CDATA[_url_]]></vmap:AdTagURI></vmap:AdSource></vmap:AdBreak>'.replace(/_type_/g, breakType).replace(/_adbreakname_/g, breakId).replace(/_offset_/g, timeOffset).replace(/_url_/g, url);\n  return item;\n}\n\nfunction AdsController(adContainer, media, advertising) {\n  let context_ = this.context;\n\n  let eventBus_ = EventBus(context_).getInstance();\n  let debug_ = Debug(context_).getInstance();\n  let adContainer_ = adContainer;\n  let media_ = media;\n  let advertising_ = advertising;\n\n  // IMA SDK Needs\n  let adDisplayContainer_ = null;\n  let adsLoader_ = null;\n  let adsManager_ = null;\n\n  //\n  let cuePoints_ = null;\n\n  //\n  let width_;\n  let height_;\n\n  // flag\n  let isPlayingAd_ = false;\n  let isLinearAd_ = false;\n  let isVpaidAd_ = false;\n  let isPaused_ = false;\n\n  let adsLoaded_ = false;\n  let contentInitialized_ = false;\n  let adWidth_ = 0;\n  let adHeight_ = 0;\n\n  let countdownTimer_ = null;\n  let duration_;\n  let position_;\n\n  let isMobilePlatform_ = CommonUtils.isMobilePlatform();\n\n  function setup() {\n    if (advertising_.vpaidmode) {\n      let mode = -1;\n      if (advertising_.vpaidmode === 'disabled') {\n        mode = google.ima.ImaSdkSettings.VpaidMode.DISABLED;\n      } else if (advertising_.vpaidmode === 'enabled') {\n        mode = google.ima.ImaSdkSettings.VpaidMode.ENABLED;\n      } else if (advertising_.vpaidmode === 'insecure') {\n        mode = google.ima.ImaSdkSettings.VpaidMode.INSECURE;\n      }\n      if (mode !== -1) {\n        google.ima.settings.setVpaidMode(mode);\n      }\n    }\n\n    if (advertising_.locale) {\n      google.ima.settings.setLocale(advertising_.locale);\n    }\n\n    adDisplayContainer_ =\n      new google.ima.AdDisplayContainer(\n        adContainer_,\n        media_,\n        null);\n    //advertising_.companions[0] ? advertising_.companions[0].div : null);\n\n    adsLoader_ = new google.ima.AdsLoader(adDisplayContainer_);\n    // Mobile Skippable Ads\n    // see: https://developers.google.com/interactive-media-ads/docs/sdks/html5/skippable-ads\n    adsLoader_.getSettings().setDisableCustomPlaybackForIOS10Plus(true);\n    adsLoader_.addEventListener(\n      google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,\n      onAdsManagerLoaded,\n      false,\n      this);\n    adsLoader_.addEventListener(\n      google.ima.AdErrorEvent.Type.AD_ERROR,\n      onAdError,\n      false,\n      this);\n\n    //\n    adsLoaded_ = false;\n    contentInitialized_ = false;\n    eventBus_.on(oldmtn.Events.MEDIA_LOADEDMETADATA, onMediaLoadedMetadata, this);\n    eventBus_.on(oldmtn.Events.MEDIA_ENDED, onMediaEnded, this);\n  }\n\n  function open() {\n    initialUserAction();\n    requestAds();\n  }\n\n  function close() {\n    stopAdTimer();\n    if (adsManager_) {\n      adsManager_.destroy();\n      adsManager_ = null;\n    }\n  }\n\n  function initialUserAction() {\n    // On iOS and Android devices, video playback must begin in a user action.\n    // AdDisplayContainer provides a initialize() API to be called at appropriate\n    // time.\n    // see: https://developers.google.com/interactive-media-ads/docs/sdks/html5/mobile_video\n    adDisplayContainer_.initialize();\n  }\n\n  function requestAds() {\n    width_ = adContainer_.parentNode.clientWidth;\n    height_ = adContainer_.parentNode.clientHeight;\n    debug_.log('width_: ' + width_ + ', height: ' + height_);\n    // var item = getVMAPItem('myAds', advertising_.offset, advertising_.tag);\n    // var ads = '<vmap:VMAP xmlns:vmap='http://www.iab.net/videosuite/vmap' version='1.0'>' + item + '</vmap:VMAP>'\n    // console.log('ads: ' + ads);\n\n    debug_.log('+request ads, advertising_.tag: ' + advertising_.tag);\n    var adsRequest = new google.ima.AdsRequest();\n    adsRequest.adTagUrl = advertising_.tag;\n    // Specify the linear and nonlinear slot sizes. This helps the SDK to\n    // select the correct creative if multiple are returned.\n    adsRequest.linearAdSlotWidth = width_;\n    adsRequest.linearAdSlotHeight = height_;\n    adsRequest.nonLinearAdSlotWidth = width_;\n    adsRequest.nonLinearAdSlotHeight = height_;\n\n    //adsRequest.setAdWillAutoPlay(autoplayAllowed_);\n    //adsRequest.setAdWillPlayMuted(autoplayRequiresMuted_);\n    //adsRequest.forceNonLinearFullSlot = advertising_.forceNonLinearFullSlot;\n\n    /*\n     * In some circumstances you may want to prevent the SDK from playing ad breaks until you're ready for them.\n     * In this scenario, you can disable automatic playback of ad breaks in favor of letting the SDK know when you're ready for an ad break to play.\n     * With this configuration, once the SDK has loaded an ad break, it will fire an AD_BREAK_READY event.\n     * When your player is ready for the ad break to start, you can call adsManager.start():\n     */\n    //adsLoader_.getSettings().setAutoPlayAdBreaks(false);\n\n    adsLoader_.requestAds(adsRequest);\n  }\n\n  // AdsController public functions\n  function playAd() {\n    // sometimes, requestAds may be caught an error, so we return here directly.\n    if (!adsManager_) {\n      return;\n    }\n\n    if (contentInitialized_ && adsLoaded_) {\n      try {\n        initialUserAction();\n        adsManager_.init(width_, height_, google.ima.ViewMode.NORMAL);\n        adsManager_.start();\n      } catch (adError) {\n        // An error may be thrown if there was a problem with the VAST response.\n      }\n    }\n  }\n\n  function isPaused() {\n    return isPaused_;\n  }\n\n  function isPlayingAd() {\n    return isPlayingAd_;\n  }\n\n  function isLinearAd() {\n    return isLinearAd_;\n  }\n\n  function isMuted() {\n    if (adsManager_.getVolume() === 0) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  function mute() {\n    adsManager_.setVolume(0);\n  }\n\n  function unmute() {\n    adsManager_.setVolume(1);\n  }\n\n  function getVolume() {\n    return adsManager_.getVolume();\n  }\n\n  function setVolume(volume) {\n    adsManager_.setVolume(volume);\n  }\n\n  function getPosition() {\n    return position_;\n  }\n\n  function getDuration() {\n    return duration_;\n  }\n\n  function play() {\n    if (adsManager_) {\n      adsManager_.resume();\n    }\n  }\n\n  function pause() {\n    if (adsManager_) {\n      adsManager_.pause();\n    }\n  }\n\n  function resize(width, height, fullscreen) {\n    if (adsManager_) {\n      width_ = width;\n      height_ = height;\n      adsManager_.resize(width_, height_, google.ima.ViewMode.FULLSCREEN);\n    }\n  }\n\n  ////////////////////////////////////////////////////////////////////////\n  function onAdsManagerLoaded(adsManagerLoadedEvent) {\n    debug_.log('+onAdsManagerLoaded');\n\n    let adsRenderingSettings = new google.ima.AdsRenderingSettings();\n    adsRenderingSettings.autoAlign = true;\n    if (advertising_.enablePreloading) {\n      adsRenderingSettings.enablePreloading = advertising_.enablePreloading;\n    }\n    adsRenderingSettings.restoreCustomPlaybackStateOnAdBreakComplete = true;\n    //adsRenderingSettings.useStyledLinearAds = true;\n    adsRenderingSettings.useStyledNonLinearAds = true;\n\n    adsManager_ = adsManagerLoadedEvent.getAdsManager(media_, adsRenderingSettings);\n\n    // Attach the pause/resume events.\n    // Handle errors.\n    adsManager_.addEventListener(\n      google.ima.AdErrorEvent.Type.AD_ERROR,\n      onAdError,\n      false,\n      this);\n    let events = [\n      // For non-auto ad breaks, listen for ad break ready\n      google.ima.AdEvent.Type.AD_BREAK_READY,\n      google.ima.AdEvent.Type.AD_METADATA,\n      google.ima.AdEvent.Type.ALL_ADS_COMPLETED,\n      google.ima.AdEvent.Type.CLICK,\n      google.ima.AdEvent.Type.COMPLETE,\n      google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,\n      google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,\n      google.ima.AdEvent.Type.DURATION_CHANGE,\n      google.ima.AdEvent.Type.FIRST_QUARTILE,\n      google.ima.AdEvent.Type.IMPRESSION,\n      google.ima.AdEvent.Type.INTERACTION,\n      google.ima.AdEvent.Type.LINEAR_CHANGED,\n      google.ima.AdEvent.Type.LOADED,\n      google.ima.AdEvent.Type.LOG,\n      google.ima.AdEvent.Type.MIDPOINT,\n      google.ima.AdEvent.Type.PAUSED,\n      google.ima.AdEvent.Type.RESUMED,\n      google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,\n      google.ima.AdEvent.Type.SKIPPED,\n      google.ima.AdEvent.Type.STARTED,\n      google.ima.AdEvent.Type.THIRD_QUARTILE,\n      google.ima.AdEvent.Type.USER_CLOSE,\n      google.ima.AdEvent.Type.VOLUME_CHANGED,\n      google.ima.AdEvent.Type.VOLUME_MUTED\n    ];\n    for (var index in events) {\n      adsManager_.addEventListener(\n        events[index],\n        onAdEvent,\n        false,\n        this);\n    }\n\n    adsLoaded_ = true;\n    if (contentInitialized_) {\n      debug_.log('playAd when contentInitialized_');\n      eventBus_.trigger(Events.AD_LOADING_COMPLETE);\n    }\n\n    debug_.log('-onAdsManagerLoaded');\n  }\n\n  function onAdError(adErrorEvent) {\n    debug_.log('--onAdEvent--: ' + adErrorEvent.getError().toString());\n    let err = adErrorEvent.getError();\n    // deserialize, getErrorCode, getInnerError, getMessage, getType, getVastErrorCode, serialize, toString\n    debug_.log('ad err: ', err);\n\n    let errCode = err.getErrorCode();\n    let errMsg = err.getMessage();\n\n    if (adsManager_) {\n      adsManager_.destroy();\n    }\n    //application_.resumeAfterAd();\n  }\n\n  function onAdEvent(adEvent) {\n    debug_.log('+onAdEvent: ' + adEvent.type);\n    let ad = adEvent.getAd();\n\n    switch (adEvent.type) {\n      case google.ima.AdEvent.Type.AD_BREAK_READY:\n        {\n          debug_.log('adEvent.o.adBreakTime: ' + adEvent.o.adBreakTime);\n        }\n        break;\n      case google.ima.AdEvent.Type.AD_METADATA:\n        {\n          // for (let i in adEvent) {\n          //     console.log('AD_METADATA: ' + i);\n          // }\n          cuePoints_ = adEvent.getAdCuePoints();\n          debug_.log('cue points: ' + cuePoints_.h.join(','));\n        }\n        break;\n      case google.ima.AdEvent.Type.CLICK:\n        {\n          //application_.adClicked();\n        }\n        break;\n      case google.ima.AdEvent.Type.COMPLETE:\n        {\n          // This event indicates the ad has finished - the video player\n          // can perform appropriate UI actions, such as removing the timer for\n          // remaining time detection.\n          processWhenAdComplete();\n        }\n        break;\n      case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:\n        {\n          eventBus_.trigger(Events.AD_CONTENT_PAUSE_REQUESTED);\n        }\n        break;\n      case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:\n        {\n          eventBus_.trigger(Events.AD_CONTENT_RESUME_REQUESTED);\n        }\n        break;\n      case google.ima.AdEvent.Type.DURATION_CHANGE:\n        {}\n        break;\n      case google.ima.AdEvent.Type.IMPRESSION:\n        {}\n        break;\n      case google.ima.AdEvent.Type.LINEAR_CHANGED:\n        {}\n        break;\n      case google.ima.AdEvent.Type.LOADED:\n        {\n          // This is the first event sent for an ad - it is possible to\n          // determine whether the ad is a video ad or an overlay.\n          if (!ad.isLinear()) {\n            // Position AdDisplayContainer correctly for overlay.\n            // Use ad.width and ad.height.\n          }\n        }\n        break;\n      case google.ima.AdEvent.Type.PAUSED:\n        {\n          isPaused_ = true;\n          eventBus_.trigger(Events.AD_PAUSED);\n        }\n        break;\n      case google.ima.AdEvent.Type.RESUMED:\n        {\n          isPaused_ = false;\n          eventBus_.trigger(Events.AD_RESUMED);\n        }\n        break;\n      case google.ima.AdEvent.Type.SKIPPED:\n        {\n          // for 'skippable ads', if we skip it, we won't receive COMPLETED event, but only receive SKIPPED event.\n          processWhenAdComplete();\n        }\n        break;\n      case google.ima.AdEvent.Type.STARTED:\n        {\n          // This event indicates the ad has started - the video player\n          // can adjust the UI, for example display a pause button and\n          // remaining time.\n          processWhenAdStart(ad);\n        }\n        break;\n      case google.ima.AdEvent.Type.THIRD_QUARTILE:\n        {}\n        break;\n      case google.ima.AdEvent.Type.USER_CLOSE:\n        {\n          if (isVpaidAd_ || isLinearAd_) {\n            processWhenAdComplete();\n          }\n        }\n        break;\n      case google.ima.AdEvent.Type.VOLUME_CHANGED:\n        {\n          debug_.log('ad VOLUME_CHANGED: ' + adsManager_.getVolume());\n          eventBus_.trigger(Events.AD_VOLUME_CHANGED);\n        }\n        break;\n      case google.ima.AdEvent.Type.VOLUME_MUTED:\n        {\n          debug_.log('ad VOLUME_MUTED: ' + adsManager_.getVolume());\n          eventBus_.trigger(Events.AD_VOLUME_CHANGED);\n        }\n        break;\n      default:\n        break;\n    }\n  }\n\n  function onMediaLoadedMetadata() {\n    // In some platform, content player & ad player could use a single video tag,\n    // and we just process content player 'metadata' event only, so cancel the listener.\n    eventBus_.off(oldmtn.Events.MEDIA_LOADEDMETADATA, onMediaLoadedMetadata, this);\n    debug_.log('+onMediaLoadedMetadata' + ', ' +\n      'contentInitialized_: ' + contentInitialized_ + ', ' +\n      'adsLoaded_: ' + adsLoaded_);\n    contentInitialized_ = true;\n    if (adsLoaded_) {\n      debug_.log('playAd when adsLoaded_');\n      eventBus_.trigger(Events.AD_LOADING_COMPLETE);\n      //playAd();\n    }\n    debug_.log('-onMediaLoadedMetadata');\n  }\n\n  function onMediaEnded() {\n    adsLoader_.contentComplete();\n  }\n\n  //\n  function startAdTimer() {\n    countdownTimer_ = setInterval(function() {\n      let timeRemaining = adsManager_.getRemainingTime();\n      // If the ad is not loaded yet or has finished playing, getRemainingTime would return -1.\n      if (timeRemaining === -1) {\n        return;\n      }\n\n      position_ = duration_ - timeRemaining;\n      // Update UI with timeRemaining\n      if (isPlayingAd_ && !isPaused_) {\n        //debug_.log('test, timeRemaining: ' + timeRemaining + ', position: ' + position_ + ', duration: ' + duration_);\n        eventBus_.trigger(Events.AD_TIMEUPDATE);\n      }\n    }, 300);\n  }\n\n  function stopAdTimer() {\n    if (countdownTimer_) {\n      clearInterval(countdownTimer_);\n      countdownTimer_ = null;\n    }\n  }\n\n  function processWhenAdStart(ad) {\n    //\n    isPlayingAd_ = true;\n    isLinearAd_ = ad.isLinear();\n\n    // How to know the ad is VPAID or not?\n    // Method1\n    // isVpaidAd_ = ad.g.vpaid;\n    // Method2\n    let apiFw = ad.getApiFramework();\n    isVpaidAd_ = (apiFw === 'VPAID') ? true : false;\n    position_ = 0;\n    duration_ = ad.getDuration();\n    adWidth_ = ad.getWidth();\n    adHeight_ = ad.getHeight();\n\n    eventBus_.trigger(Events.AD_STARTED, {\n      linear: isLinearAd_,\n      vpaid: isVpaidAd_,\n      width: adWidth_,\n      height: adHeight_\n    });\n    if (isLinearAd_) {\n      startAdTimer();\n      eventBus_.trigger(Events.AD_TIMEUPDATE);\n    } else {\n      eventBus_.trigger(Events.AD_CONTENT_RESUME_REQUESTED);\n    }\n\n    // report companion\n    let selectionCriteria = new google.ima.CompanionAdSelectionSettings();\n    selectionCriteria.resourceType = google.ima.CompanionAdSelectionSettings.ResourceType.STATIC;\n    selectionCriteria.creativeType = google.ima.CompanionAdSelectionSettings.CreativeType.IMAGE;\n    selectionCriteria.sizeCriteria = google.ima.CompanionAdSelectionSettings.SizeCriteria.IGNORE;\n\n    // Get a list of companion ads for an ad slot size and CompanionAdSelectionSettings\n    let companionAds = ad.getCompanionAds(width_, height_, selectionCriteria);\n    let companions = [];\n    for (let i = 0; i < companionAds.length; i++) {\n      let companionAd = companionAds[i];\n\n      let width = companionAd.getWidth();\n      let height = companionAd.getHeight();\n      let content = companionAd.getContent();\n      companions.push({\n        width: width,\n        height: height,\n        content: content\n      });\n\n      debug_.log(`companion[${i}], type:${companionAd.getContentType()} width:${companionAd.getWidth()}, height:${companionAd.getHeight()}`);\n    }\n    if (companions.length > 0) {\n      eventBus_.trigger(Events.AD_COMPANIONS, {\n        companions: companions\n      });\n    }\n  }\n\n  function processWhenAdComplete() {\n    //\n    isPlayingAd_ = false;\n    stopAdTimer();\n    position_ = duration_;\n    eventBus_.trigger(Events.AD_TIMEUPDATE);\n    eventBus_.trigger(Events.AD_COMPLETE);\n  }\n\n  //\n  function test() {\n    // playAd();\n\n    if (contentInitialized_ && adsLoaded_) {\n      try {\n        initialUserAction();\n        adsManager_.init(width_, height_, google.ima.ViewMode.NORMAL);\n        adsManager_.start();\n      } catch (adError) {\n        // An error may be thrown if there was a problem with the VAST response.\n      }\n    }\n  }\n\n  let instance = {\n    open: open,\n    close: close,\n    isPlayingAd: isPlayingAd,\n    isLinearAd: isLinearAd,\n    play: play,\n    pause: pause,\n    isPaused: isPaused,\n    mute: mute,\n    unmute: unmute,\n    isMuted: isMuted,\n    getVolume: getVolume,\n    setVolume: setVolume,\n    getPosition: getPosition,\n    getDuration: getDuration,\n    resize: resize,\n    requestAds: requestAds,\n    playAd: playAd,\n\n    //\n    test: test\n  };\n\n  setup();\n  return instance;\n}\n\nAdsController.__h5player_factory_name = 'AdsController';\nexport default FactoryMaker.getSingletonFactory(AdsController);","import FactoryMaker from '../core/FactoryMaker';\nimport EventBus from '../core/EventBus';\nimport Events from '../core/events';\nimport Debug from '../core/Debug';\n\nimport TimeRanges from '../utils/timeRanges';\n\nfunction BufferController() {\n  let context_ = this.context;\n\n  let eventBus_ = EventBus(context_).getInstance();\n  let debug_ = Debug(context_).getInstance();\n\n  let mediaSource_ = null;\n  let media_;\n  let sourceBuffer_ = {};\n\n  let streamInfo_;\n\n  let segments_ = null;\n  // flag\n  let appending_ = false;\n\n  function setup() {\n    eventBus_.on(Events.MEDIA_ATTACHING, onMediaAttaching);\n\n    eventBus_.on(Events.STREAM_UPDATED, onStreamUpdated);\n\n    eventBus_.on(Events.BUFFER_CODEC, onBufferCodec);\n    eventBus_.on(Events.BUFFER_APPENDING, onBufferAppending);\n    eventBus_.on(Events.BUFFER_EOS, onBufferEOS);\n\n    //\n    eventBus_.on(Events.TEST_MSG, onTestMsg);\n  }\n\n  function createMediaSource() {\n    debug_.log('BufferController, +createMediaSource');\n    //\n    var hasWebKit = ('WebKitMediaSource' in window);\n    var hasMediaSource = ('MediaSource' in window);\n\n    if (hasMediaSource) {\n      mediaSource_ = new MediaSource();\n      mediaSource_.addEventListener('sourceopen', onMediaSourceOpen, false);\n      mediaSource_.addEventListener('sourceended', onMediaSourceEnded, false);\n      mediaSource_.addEventListener('sourceclose', onMediaSourceClose, false);\n    } else if (hasWebKit) {\n      mediaSource_ = new WebKitMediaSource();\n      mediaSource_.addEventListener('webkitsourceopen', onMediaSourceOpen, false);\n    }\n\n    debug_.log('BufferController, -createMediaSource');\n\n    return mediaSource_;\n  }\n\n  function close() {\n    debug_.log('BufferController, +close');\n    if (sourceBuffer_.audio) {\n      mediaSource_.removeSourceBuffer(sourceBuffer_.audio);\n    }\n    if (sourceBuffer_.video) {\n      mediaSource_.removeSourceBuffer(sourceBuffer_.video);\n    }\n  }\n\n  function setDuration(value) {\n    if (mediaSource_.duration != value) {\n      mediaSource_.duration = value;\n    }\n\n    return mediaSource_.duration;\n  }\n\n  function signalEndOfStream() {\n    debug_.log('+signalEndOfStream');\n    mediaSource_.endOfStream();\n  }\n\n  function test() {}\n\n  function onMediaSourceOpen() {\n    debug_.log('+onMediaSourceOpen');\n\n    // once received, don't listen anymore to sourceopen event\n    mediaSource_.removeEventListener('sourceopen', onMediaSourceOpen);\n    mediaSource_.removeEventListener('webkitsourceopen', onMediaSourceOpen);\n\n    URL.revokeObjectURL(media_.src);\n    eventBus_.trigger(Events.MEDIA_ATTACHED, {});\n  }\n\n  function onMediaSourceEnded() {\n    debug_.log('+onMediaSourceEnded');\n  }\n\n  function onMediaSourceClose() {\n    debug_.log('+onMediaSourceClose');\n  }\n\n  function onStreamUpdated(e) {\n    streamInfo_ = e.streamInfo;\n  }\n\n  function onMediaAttaching(data) {\n    media_ = data.media;\n\n    let mediaSrc = createMediaSource();\n    let objURL = window.URL.createObjectURL(mediaSrc);\n    media_.src = objURL;\n  }\n\n  function onBufferCodec(data) {\n    let tracks = data;\n\n    if (tracks.audio) {\n      let mimeType = `${tracks.audio.container};codecs=${tracks.audio.codec}`;\n      let buffer = mediaSource_.addSourceBuffer(mimeType);\n      sourceBuffer_.audio = buffer;\n\n      buffer.addEventListener('updatestart', sourceBuffer_updatestart);\n      buffer.addEventListener('update', sourceBuffer_update);\n      buffer.addEventListener('updateend', sourceBuffer_updateend);\n      buffer.addEventListener('error', sourceBuffer_error);\n      buffer.addEventListener('abort', sourceBuffer_abort);\n    }\n    if (tracks.video) {\n      let mimeType = `${tracks.video.container};codecs=${tracks.video.codec}`;\n      let buffer = mediaSource_.addSourceBuffer(mimeType);\n      sourceBuffer_.video = buffer;\n\n      buffer.addEventListener('updatestart', sourceBuffer_updatestart);\n      buffer.addEventListener('update', sourceBuffer_update);\n      buffer.addEventListener('updateend', sourceBuffer_updateend);\n      buffer.addEventListener('error', sourceBuffer_error);\n      buffer.addEventListener('abort', sourceBuffer_abort);\n    }\n  }\n\n  function doAppending() {\n    if (appending_) {\n      // logger.log(`sb appending in progress`);\n      return;\n    }\n\n    if (segments_ && segments_.length) {\n      let segment = segments_.shift();\n      try {\n        let type = segment.type,\n          sb = sourceBuffer_[type];\n        if (sb) {\n          if (!sb.updating) {\n            appending_ = true;\n\n            // reset sourceBuffer ended flag before appending segment\n            sb.ended = false;\n            sb.appendBuffer(segment.data);\n          }\n        }\n      } catch (err) {\n        // in case any error occured while appending, put back segment in segments table\n        debug_.log(`error while trying to append buffer:${err.message}`);\n      }\n    }\n  }\n\n  function onBufferAppending(data) {\n    if (!segments_) {\n      segments_ = [data];\n    } else {\n      segments_.push(data);\n    }\n\n    doAppending();\n  }\n\n  function onBufferEOS() {\n    signalEndOfStream();\n  }\n\n  function onTestMsg() {\n    var media = context_.media;\n    // BD\n    // var a = sourceBuffer_.audio;\n    // var v = sourceBuffer_.video;\n    // if (a) {\n    //   debug_.log(`audio buffered: ${TimeRanges.toString(a.buffered)}`);\n    // }\n    // if (v) {\n    //   debug_.log(`video buffered: ${TimeRanges.toString(v.buffered)}`);\n    // }\n    // debug_.log(`media buffered: ${TimeRanges.toString(media.buffered)}`);\n    // ED\n  }\n\n  // Begin source buffer event\n  function sourceBuffer_updatestart() {\n    debug_.log('--sourceBuffer_updatestart--');\n  }\n\n  function sourceBuffer_update() {\n    debug_.log('--sourceBuffer_update--');\n  }\n\n  function sourceBuffer_updateend() {\n    debug_.log('+sourceBuffer_updateend');\n    appending_ = false;\n\n    let pending = segments_.length;\n    if (pending === 0) {\n      eventBus_.trigger(Events.BUFFER_APPENDED, { pending });\n    } else {\n      doAppending();\n    }\n\n    updateMediaElementDuration();\n  }\n\n  function sourceBuffer_error(e) {\n    debug_.log('+sourceBuffer_error', e);\n  }\n\n  function sourceBuffer_abort() {\n    debug_.log('+sourceBuffer_abort');\n  }\n  // End source buffer event\n\n  function updateMediaElementDuration() {\n    // can't set duration while a buffer is updating\n    for (let type in sourceBuffer_) {\n      if (sourceBuffer_[type].updating === true) {\n        return;\n      }\n    }\n\n    if (mediaSource_ && mediaSource_.duration !== streamInfo_.duration) {\n      //mediaSource_.duration = streamInfo_.duration;\n    }\n  }\n\n  let instance = {\n    createMediaSource: createMediaSource,\n    close: close,\n    setDuration: setDuration,\n    signalEndOfStream: signalEndOfStream,\n    test: test\n  };\n  setup();\n  return instance;\n};\n\nBufferController.__h5player_factory_name = 'BufferController';\nexport default FactoryMaker.getSingletonFactory(BufferController);","import FactoryMaker from '../core/FactoryMaker';\nimport EventBus from '../core/EventBus';\nimport Events from '../core/events';\nimport Debug from '../core/Debug';\n\nimport ProtectionKeyController from '../protection/controller/ProtectionKeyController';\nimport ProtectionModel_21Jan2015 from '../protection/models/ProtectionModel_21Jan2015';\nimport ProtectionModel_3Feb2014 from '../protection/models/ProtectionModel_3Feb2014';\n\nfunction EMEController() {\n  let context_ = this.context;\n  let eventBus_ = EventBus(context_).getInstance();\n  let debug_ = Debug(context_).getInstance();\n\n  let streamInfo_;\n  let protectionModel_ = null;\n  let protectionKeyController_ = ProtectionKeyController(context_).getInstance();\n\n  function setup() {\n    protectionModel_ = getProtectionModel();\n    protectionModel_.attachMedia(context_.media);\n\n    eventBus_.on(Events.BUFFER_CODEC, onBufferCodec);\n  }\n\n  function onBufferCodec(data) {\n    let tracks = data;\n    if (tracks.audio) {\n      streamInfo_.drm.audioCodec = `${tracks.audio.container};codecs=${tracks.audio.codec}`;\n    }\n    if (tracks.video) {\n      streamInfo_.drm.videoCodec = `${tracks.video.container};codecs=${tracks.video.codec}`;\n    }\n  }\n\n  function getProtectionModel() {\n    let media = context_.media;\n    if (media.onencrypted !== undefined &&\n      media.mediaKeys !== undefined &&\n      navigator.requestMediaKeySystemAccess !== undefined &&\n      typeof navigator.requestMediaKeySystemAccess === 'function') {\n      debug_.log('User Agent support ProtectionModel_21Jan2015');\n      return new ProtectionModel_21Jan2015();\n    } else {\n      debug_.log('User Agent support ProtectionModel_3Feb2014');\n      return new ProtectionModel_3Feb2014();\n    }\n  }\n\n  function setDrmInfo(info) {\n    streamInfo_ = info;\n\n    if (!info.drm || !info.drm.type) {\n      return;\n    }\n\n    let keySystem = protectionKeyController_.getKeySystemBySystemString(info.drm.type);\n    debug_.log('H5Player, request system tring: ' + keySystem.systemString);\n    protectionModel_.setKeySystem(keySystem);\n    protectionModel_.setDrmInfo(info);\n  }\n\n  let instance_ = {\n    setDrmInfo: setDrmInfo\n  };\n  setup();\n  return instance_;\n};\n\nEMEController.__h5player_factory_name = 'EMEController';\nexport default FactoryMaker.getSingletonFactory(EMEController);","import FactoryMaker from '../core/FactoryMaker';\r\nimport EventBus from '../core/EventBus';\r\nimport Events from '../core/events';\r\nimport Debug from '../core/Debug';\r\n\r\nfunction LevelController() {\r\n  let context_ = this.context;\r\n  let eventBus_ = EventBus(context_).getInstance();\r\n  let debug_ = Debug(context_).getInstance();\r\n\r\n  let streamInfo_;\r\n\r\n  function setup() {\r\n    eventBus_.on(Events.MANIFEST_PARSED, onManifestParsed);\r\n  }\r\n\r\n  function onManifestParsed(streamInfo) {\r\n    streamInfo_ = streamInfo;\r\n\r\n    eventBus_.trigger(Events.STREAM_UPDATED, {streamInfo: streamInfo_});\r\n  }\r\n\r\n  let instance_ = {\r\n  };\r\n  setup();\r\n  return instance_;\r\n}\r\n\r\nLevelController.__h5player_factory_name = 'LevelController';\r\nexport default FactoryMaker.getSingletonFactory(LevelController);\r\n\r\n","\n\n// From: https://stackoverflow.com/questions/21173734/extracting-top-level-and-second-level-domain-from-a-url-using-regex/21174423#21174423\nconst DOMAIN_REGEX = /[^.]*\\.[^.]{2,3}(?:\\.[^.]{2,3})?$/;\n// From: https://www.regular-expressions.info/ip.html\nconst IPADDRESS_REGEX = /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;\n\n\nclass LicenseController {\n  constructor(props) {\n    this.whitelist = [];\n  }\n\n  setWhitelist(whitelist) {\n    this.whitelist = whitelist;\n\n    // BD\n    // this.whitelist.forEach(function(value, index) {\n    //   console.log(`whitelist, index[${index}] = ${value}`);\n    // });\n    // ED\n  }\n\n  checkUrl(domain) {\n    let ret = false;\n    if (domain.toLowerCase() === 'localhost') {\n      ret = true;\n    } else if (this.whitelist.length > 0) {\n      // check ip address\n      let arrRegex = domain.match(IPADDRESS_REGEX);\n      //console.log(`check ip: ${domain} ==> ip: ${arrRegex}`);\n      if (arrRegex) {\n        for (let i = 0; i < this.whitelist.length; i++) {\n          if (arrRegex[0] === this.whitelist[i]) {\n            ret = true;\n            break;\n          }\n        }\n      } else {\n        // check domain\n        let arrRegex = domain.match(DOMAIN_REGEX);\n        //console.log(`check domain: ${domain} ==> domain: ${arrRegex}`);\n        if (arrRegex) {\n          for (let i = 0; i < this.whitelist.length; i++) {\n            if (arrRegex[0] === this.whitelist[i]) {\n              ret = true;\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    return ret;\n  }\n}\n\nexport default LicenseController;\n\n\n\n","import FactoryMaker from '../core/FactoryMaker';\r\nimport EventBus from '../core/EventBus';\r\nimport Events from '../core/events';\r\nimport Debug from '../core/Debug';\r\n\r\nimport DashParser from '../dash/dash_parser';\r\nimport HlsParser from '../hls/hls_parser';\r\nimport PDParser from '../pd/pd_parser';\r\n\r\nfunction ParserController() {\r\n  let context_ = this.context;\r\n  let eventBus_ = EventBus(context_).getInstance();\r\n  let debug_ = Debug(context_).getInstance();\r\n\r\n  function setup() {\r\n    eventBus_.on(Events.FINDING_PARSER, onFindingParser);\r\n  }\r\n\r\n  function onFindingParser(data) {\r\n    let url = data.url;\r\n\r\n    let parser = getParser(url);\r\n    eventBus_.trigger(Events.FOUND_PARSER, { parser });\r\n  }\r\n\r\n  function getParser(url) {\r\n    let parser = null;\r\n    let extension = url.split('.').pop();\r\n    if (extension === 'mpd') {\r\n      parser = DashParser(context_).getInstance();\r\n      parser.type = 'dash';\r\n    } else if (extension === 'm3u8') {\r\n      parser = HlsParser(context_).getInstance();\r\n      parser.type = 'hls';\r\n    } else if (extension === 'mp4') {\r\n      parser = PDParser(context_).getInstance();\r\n      parser.type = 'pd';\r\n    }\r\n\r\n    return parser;\r\n  }\r\n\r\n  let instance_ = {\r\n  };\r\n  setup();\r\n  return instance_;\r\n}\r\n\r\nParserController.__h5player_factory_name = 'ParserController';\r\nexport default FactoryMaker.getSingletonFactory(ParserController);\r\n\r\n\r\n\r\n\r\n\r\n","import FactoryMaker from '../core/FactoryMaker';\r\nimport EventBus from '../core/EventBus';\r\nimport Events from '../core/events';\r\nimport Debug from '../core/Debug';\r\n\r\nimport TimeRanges from '../utils/timeRanges';\r\nimport CommonUtils from '../utils/common_utils';\r\n\r\n/* During the loading process of an audio/video, the following events occur, in this order:\r\nloadstart\r\ndurationchange\r\nloadedmetadata\r\nloadeddata\r\nprogress\r\ncanplay\r\ncanplaythrough\r\n*/\r\n\r\nfunction PlaybackController() {\r\n  let context_ = this.context;\r\n  let eventBus_ = EventBus(context_).getInstance();\r\n  let debug_ = Debug(context_).getInstance();\r\n\r\n  let media_ = context_.media;\r\n  let cfg_ = context_.cfg;\r\n\r\n  // flag\r\n  let autoplayAllowed_;\r\n  let autoplayRequiresMuted_;\r\n\r\n  function setup() {\r\n    addEventListeners();\r\n  }\r\n\r\n  // Begin -- public functions\r\n  function detectAutoplay() {\r\n    debug_.log('+detectAutoplay: ' + cfg_.autoplay);\r\n    if (cfg_.autoplay) {\r\n      //media_.autoplay = true;\r\n      let playPromise = play(); // This is asynchronous!\r\n      if (playPromise !== undefined) {\r\n        // console.log('webkitAudioDecodedByteCount: ' + media_.webkitAudioDecodedByteCount);\r\n        // console.log('webkitVideoDecodedByteCount: ' + media_.webkitVideoDecodedByteCount);\r\n        // if (CommonUtils.isSafari()) {\r\n        //     console.log('audioTracks length: ' + media_.audioTracks.length);\r\n        // }\r\n\r\n        playPromise.then(onAutoplayWithSoundSuccess).catch(onAutoplayWithSoundFail);\r\n      }\r\n    }\r\n  }\r\n\r\n  function play() {\r\n    debug_.log('+Native video element request: play');\r\n    return media_.play();\r\n  }\r\n\r\n  function pause() {\r\n    debug_.log('+Native video element request: pause');\r\n    media_.pause();\r\n  }\r\n\r\n  function isPaused() {\r\n    return media_.paused;\r\n  }\r\n\r\n  function getPosition() {\r\n    return media_.currentTime;\r\n  }\r\n\r\n  function getDuration() {\r\n    return media_.duration;\r\n  }\r\n\r\n  function getSeekableRange() {\r\n    return media_.seekable;\r\n  }\r\n\r\n  function getBufferedRanges() {\r\n    return media_.buffered;\r\n  }\r\n\r\n  function setPosition(time) {\r\n    media_.currentTime = time;\r\n  }\r\n\r\n  function isSeeking() {\r\n    return media_.seeking;\r\n  }\r\n\r\n  function isEnded() {\r\n    return media_.ended;\r\n  }\r\n\r\n  function mute() {\r\n    media_.muted = true;\r\n  }\r\n\r\n  function unmute() {\r\n    media_.muted = false;\r\n  }\r\n\r\n  function isMuted() {\r\n    return media_.muted;\r\n  }\r\n\r\n  function setVolume(volume) {\r\n    media_.volume = volume;\r\n  }\r\n\r\n  function getVolume() {\r\n    return media_.volume;\r\n  }\r\n\r\n  function setAudioPlaybackSpeed(speed) {\r\n    media_.playbackRate = speed;\r\n  }\r\n\r\n  function videoWidth() {\r\n    return media_.videoWidth;\r\n  }\r\n\r\n  function videoHeight() {\r\n    return media_.videoHeight;\r\n  }\r\n  // End -- public functions\r\n\r\n  ///////////////////////////////////////////////////////////////////////////\r\n  // Begin autoplay policy\r\n  // see https://developers.google.com/interactive-media-ads/docs/sdks/html5/desktop-autoplay\r\n  function onMutedAutoplaySuccess() {\r\n    debug_.log('+onMutedAutoplaySuccess');\r\n    autoplayAllowed_ = true;\r\n    autoplayRequiresMuted_ = true;\r\n  }\r\n\r\n  function onMutedAutoplayFail() {\r\n    debug_.log('+onMutedAutoplayFail');\r\n    // Both muted and unmuted autoplay failed. Fall back to click to play.\r\n    autoplayAllowed_ = false;\r\n    autoplayRequiresMuted_ = false;\r\n\r\n    setVolume(1);\r\n    unmute();\r\n  }\r\n\r\n  function checkMutedAutoplaySupport() {\r\n    debug_.log('+checkMutedAutoplaySupport');\r\n    setVolume(0);\r\n    mute();\r\n    let playPromise = play();\r\n    if (playPromise !== undefined) {\r\n      playPromise.then(onMutedAutoplaySuccess).catch(onMutedAutoplayFail);\r\n    }\r\n  }\r\n\r\n  function onAutoplayWithSoundSuccess(info) {\r\n    // If we make it here, unmuted autoplay works.\r\n    debug_.log('+onAutoplayWithSoundSuccess');\r\n    autoplayAllowed_ = true;\r\n    autoplayRequiresMuted_ = false;\r\n  }\r\n\r\n  function onAutoplayWithSoundFail(err) {\r\n    // Unmuted autoplay failed. Now try muted autoplay.\r\n    debug_.log('+onAutoplayWithSoundFail, err: ', err);\r\n    autoplayAllowed_ = false;\r\n    if (cfg_.mutedAutoplay) {\r\n      checkMutedAutoplaySupport();\r\n    }\r\n  }\r\n  // End autoplay policy\r\n\r\n  // Begin - private function\r\n  function onMediaAudioAvailable() {\r\n    debug_.log('+Native video element event: audioavailable');\r\n  }\r\n\r\n  function onMediaAbort(e) {\r\n    debug_.log('+Native video element event: abort');\r\n  }\r\n\r\n  function onMediaCanplay() {\r\n    //The canplay event occurs when the browser can start playing the specified audio/video (when it has buffered enough to begin).\r\n    debug_.log('+Native video element event: canplay');\r\n    eventBus_.trigger(Events.MEDIA_CANPLAY);\r\n  }\r\n\r\n  function onMediaCanplayThrough() {\r\n    debug_.log('+Native video element event: canplaythrough');\r\n    let a = media_;\r\n    eventBus_.trigger(Events.MEDIA_CANPLAY_THROUGH);\r\n  }\r\n\r\n  function onMediaEncrypted() {\r\n    debug_.log('+Native video element event: encrypted');\r\n  }\r\n\r\n  function onMediaDurationChanged() {\r\n    // debug_.log('+Native video element event: durationchange' +\r\n    //     ', getPosition: ' + media_.getPosition +\r\n    //     ', duration: ' + media_.duration);\r\n    eventBus_.trigger(Events.MEDIA_DURATION_CHANGED);\r\n  }\r\n\r\n  function onMediaEnded() {\r\n    debug_.log('+Native video element event: ended');\r\n    eventBus_.trigger(Events.MEDIA_ENDED);\r\n  }\r\n\r\n  function onMediaError(e) {\r\n    let error;\r\n    if (e.target && e.target.error) {\r\n      error = e.target.error;\r\n    }\r\n    debug_.log(`+Native video element event: error, code:${error.code}, msg:${error.message}`);\r\n  }\r\n\r\n  function onMediaInterruptBegin() {\r\n    debug_.log('+Native video element event: interruptbegin');\r\n  }\r\n\r\n  function onMediaInterruptEnd() {\r\n    debug_.log('+Native video element event: interruptend');\r\n  }\r\n\r\n  function onMediaLoadedData() {\r\n    debug_.log('+Native video element event: loadeddata');\r\n\r\n    function hasAudio() {\r\n      if (typeof media_.webkitAudioDecodedByteCount !== 'undefined') {\r\n        // non-zero if video has audio track\r\n        if (media_.webkitAudioDecodedByteCount > 0) {\r\n          console.log('video has audio');\r\n        } else {\r\n          console.log('video doesn\\'t have audio');\r\n        }\r\n      } else if (typeof media_.mozHasAudio !== 'undefined') {\r\n        // true if video has audio track\r\n        if (media_.mozHasAudio) {\r\n          console.log('video has audio');\r\n        } else {\r\n          console.log('video doesn\\'t have audio');\r\n        }\r\n      } else {\r\n        console.log('can\\'t tell if video has audio');\r\n      }\r\n    }\r\n\r\n    //debug_.log('hasAudio: ' + hasAudio());\r\n    eventBus_.trigger(Events.MEDIA_LOADEDDATA);\r\n  }\r\n\r\n  function onMediaLoadedMetadata() {\r\n    debug_.log('+Native video element event: metadata' +\r\n      ', width: ' + media_.videoWidth +\r\n      ', height: ' + media_.videoHeight +\r\n      ', duration: ' + media_.duration);\r\n    let width = media_.videoWidth;\r\n    let height = media_.videoHeight;\r\n    eventBus_.trigger(Events.MEDIA_LOADEDMETADATA, {\r\n      width: width,\r\n      height: height\r\n    });\r\n  }\r\n\r\n  function onMediaLoadStart() {\r\n    debug_.log('+Native video element event: loadstart');\r\n  }\r\n\r\n  function onMediaPaused() {\r\n    debug_.log('+Native video element event: pause');\r\n    eventBus_.trigger(Events.MEDIA_PAUSED);\r\n  }\r\n\r\n  function onMediaPlay() {\r\n    debug_.log('+Native video element event: play');\r\n    eventBus_.trigger(Events.MEDIA_PLAY);\r\n  }\r\n\r\n  function onMediaPlaying() {\r\n    debug_.log('+Native video element event: playing');\r\n    eventBus_.trigger(Events.MEDIA_PLAYING);\r\n  }\r\n\r\n  function onMediaProgress(e) {\r\n    var progress = TimeRanges.toString(media_.buffered);\r\n\r\n    //debug_.log('+Native video element event: progress, ' + progress);\r\n  }\r\n\r\n  function onMediaReadyState(e) {\r\n    debug_.log('+Native video element event: readyState');\r\n  }\r\n\r\n  function onMediaSeeking() {\r\n    eventBus_.trigger(Events.MEDIA_SEEKING);\r\n  }\r\n\r\n  function onMediaSeeked() {\r\n    eventBus_.trigger(Events.MEDIA_SEEKED);\r\n  }\r\n\r\n  function onMediaSuspend() {\r\n    debug_.log('+Native video element event: suspend');\r\n  }\r\n\r\n  function onMediaTimeUpdated(e) {\r\n    eventBus_.trigger(Events.MEDIA_TIMEUPDATE);\r\n  }\r\n\r\n  function onMediaVolumeChanged() {\r\n    //debug_.log('+Native video element event: volumechange, muted: ' + media_.muted + ', volume: ' + media_.volume);\r\n    eventBus_.trigger(Events.MEDIA_VOLUME_CHANGED);\r\n  }\r\n\r\n  function onMediaWaiting() {\r\n    debug_.log('+Native video element event: waiting');\r\n    eventBus_.trigger(Events.MEDIA_WAITING);\r\n  }\r\n  // End\r\n\r\n  // public function\r\n  function addEventListeners() {\r\n    media_.addEventListener('mozaudioavailable', onMediaAudioAvailable);\r\n    media_.addEventListener('abort', onMediaAbort);\r\n    media_.addEventListener('canplay', onMediaCanplay);\r\n    media_.addEventListener('canplaythrough', onMediaCanplayThrough);\r\n    media_.addEventListener('durationchange', onMediaDurationChanged);\r\n    media_.addEventListener('encrypted', onMediaEncrypted);\r\n    media_.addEventListener('ended', onMediaEnded);\r\n    media_.addEventListener('error', onMediaError);\r\n    media_.addEventListener('interruptbegin', onMediaInterruptBegin);\r\n    media_.addEventListener('interruptend', onMediaInterruptEnd);\r\n    media_.addEventListener('loadeddata', onMediaLoadedData);\r\n    media_.addEventListener('loadedmetadata', onMediaLoadedMetadata);\r\n    media_.addEventListener('loadstart', onMediaLoadStart);\r\n    media_.addEventListener('pause', onMediaPaused);\r\n    media_.addEventListener('play', onMediaPlay);\r\n    media_.addEventListener('playing', onMediaPlaying);\r\n    media_.addEventListener('progress', onMediaProgress);\r\n    media_.addEventListener('readyState', onMediaReadyState);\r\n    media_.addEventListener('seeking', onMediaSeeking);\r\n    media_.addEventListener('seeked', onMediaSeeked);\r\n    media_.addEventListener('suspend', onMediaSuspend);\r\n    media_.addEventListener('timeupdate', onMediaTimeUpdated);\r\n    media_.addEventListener('volumechange', onMediaVolumeChanged);\r\n    media_.addEventListener('waiting', onMediaWaiting);\r\n  }\r\n\r\n  function removeEventsListeners() {\r\n    media_.removeEventListener('mozaudioavailable', onMediaAudioAvailable);\r\n    media_.removeEventListener('abort', onMediaAbort);\r\n    media_.removeEventListener('canplay', onMediaCanplay);\r\n    media_.removeEventListener('canplaythrough', onMediaCanplayThrough);\r\n    media_.removeEventListener('durationchange', onMediaDurationChanged);\r\n    media_.removeEventListener('encrypted', onMediaEncrypted);\r\n    media_.removeEventListener('ended', onMediaEnded);\r\n    media_.removeEventListener('error', onMediaError);\r\n    media_.removeEventListener('interruptbegin', onMediaInterruptBegin);\r\n    media_.removeEventListener('interruptend', onMediaInterruptEnd);\r\n    media_.removeEventListener('loadeddata', onMediaLoadedData);\r\n    media_.removeEventListener('loadedmetadata', onMediaLoadedMetadata);\r\n    media_.removeEventListener('loadstart', onMediaLoadStart);\r\n    media_.removeEventListener('pause', onMediaPaused);\r\n    media_.removeEventListener('play', onMediaPlay);\r\n    media_.removeEventListener('playing', onMediaPlaying);\r\n    media_.removeEventListener('progress', onMediaProgress);\r\n    media_.removeEventListener('readyState', onMediaReadyState);\r\n    media_.removeEventListener('seeking', onMediaSeeking);\r\n    media_.removeEventListener('seeked', onMediaSeeked);\r\n    media_.removeEventListener('suspend', onMediaSuspend);\r\n    media_.removeEventListener('timeupdate', onMediaTimeUpdated);\r\n    media_.removeEventListener('volumechange', onMediaVolumeChanged);\r\n    media_.removeEventListener('waiting', onMediaWaiting);\r\n  };\r\n\r\n  function setSrc(objURL) {\r\n    media_.src = objURL;\r\n  }\r\n\r\n  function getSrc() {\r\n    return media_.src;\r\n  }\r\n\r\n  function revokeSrc() {\r\n    URL.revokeObjectURL(media_.src);\r\n  }\r\n\r\n  function getValidBufferPosition(currentPos) {\r\n    let bufferedEnd;\r\n    for (let i = 0; i < media_.buffered.length; ++i) {\r\n      let start = media_.buffered.start(i);\r\n      let end = media_.buffered.end(i);\r\n\r\n      if (currentPos >= start && currentPos <= end) {\r\n        bufferedEnd = end;\r\n        break;\r\n      }\r\n    }\r\n\r\n    return bufferedEnd;\r\n  }\r\n\r\n  function close() {\r\n    debug_.log('+PlaybackController.js, close');\r\n    // Detach properly the MediaSource from the HTMLMediaElement as\r\n    // suggested in https://github.com/w3c/media-source/issues/53\r\n    if (media_) {\r\n      media_.removeAttribute('src');\r\n      media_.load();\r\n    }\r\n  }\r\n\r\n  let instance = {\r\n    detectAutoplay: detectAutoplay,\r\n    play: play,\r\n    pause: pause,\r\n    isPaused: isPaused,\r\n    getPosition: getPosition,\r\n    setPosition: setPosition,\r\n    getDuration: getDuration,\r\n    getSeekableRange: getSeekableRange,\r\n    getBufferedRanges: getBufferedRanges,\r\n    isSeeking: isSeeking,\r\n    isEnded: isEnded,\r\n    mute: mute,\r\n    unmute: unmute,\r\n    isMuted: isMuted,\r\n    setVolume: setVolume,\r\n    getVolume: getVolume,\r\n    setAudioPlaybackSpeed: setAudioPlaybackSpeed,\r\n    videoWidth: videoWidth,\r\n    videoHeight: videoHeight,\r\n\r\n    close: close,\r\n    setSrc: setSrc,\r\n    revokeSrc: revokeSrc,\r\n    getValidBufferPosition: getValidBufferPosition\r\n  };\r\n\r\n  setup();\r\n  return instance;\r\n}\r\n\r\nPlaybackController.__h5player_factory_name = 'PlaybackController';\r\nexport default FactoryMaker.getSingletonFactory(PlaybackController);","import FactoryMaker from '../core/FactoryMaker';\nimport EventBus from '../core/EventBus';\nimport Events from '../core/events';\nimport Debug from '../core/Debug';\n\nimport TimeRanges from '../utils/timeRanges';\n\nimport Demuxer from '../../third_party/hlsjs/src/demux/demuxer';\nimport {\n  hlsDefaultConfig\n} from '../../third_party/hlsjs/src/config';\n\nexport const State = {\n  STOPPED: 'STOPPED',\n  IDLE: 'IDLE',\n  KEY_LOADING: 'KEY_LOADING',\n  FRAG_LOADING: 'FRAG_LOADING',\n  FRAG_LOADING_WAITING_RETRY: 'FRAG_LOADING_WAITING_RETRY',\n  WAITING_LEVEL: 'WAITING_LEVEL',\n  PARSING: 'PARSING',\n  PARSED: 'PARSED',\n  BUFFER_FLUSHING: 'BUFFER_FLUSHING',\n  ENDED: 'ENDED',\n  ERROR: 'ERROR'\n};\n\nfunction StreamController() {\n  let context_ = this.context;\n  let eventBus_ = EventBus(context_).getInstance();\n  let debug_ = Debug(context_).getInstance();\n\n  let streamInfo_;\n\n  let hls_;\n  let demuxer_;\n\n  // flag\n  let startLoaded_;\n  let manualMode_ = false;\n  // state machine\n  let state_;\n\n  function setup() {\n    state_ = State.IDLE;\n\n    hls_ = eventBus_;\n    hls_.config = hlsDefaultConfig;\n    //hls_.config.enableWorker = true;\n\n    demuxer_ = new Demuxer(hls_, 'main');\n\n    eventBus_.on(Events.MANIFEST_PARSED, onManifestParsed);\n    eventBus_.on(Events.STREAM_UPDATED, onStreamUpdated);\n\n    eventBus_.on(Events.FRAG_LOADED, onFragLoaded);\n\n    eventBus_.on(Events.INIT_PTS_FOUND, onInitPtsFound, {});\n    eventBus_.on(Events.FRAG_PARSING_INIT_SEGMENT, onFragParsingInitSegment, {});\n    eventBus_.on(Events.FRAG_PARSING_DATA, onFragParsingData, {});\n    eventBus_.on(Events.FRAG_PARSED, onFragParsed, {});\n\n    eventBus_.on(Events.BUFFER_APPENDED, onBufferAppended);\n\n    //\n    eventBus_.on(Events.TEST_MSG, onTestMsg);\n  }\n\n  // tool functions\n  function getLevelDetails() {\n    let details = null;\n    for (let i = 0; i < streamInfo_.tracks.length; i++) {\n      let trackInfo = streamInfo_.tracks[i];\n      if (trackInfo.type === 'stream') {\n        details = trackInfo.levelDetails;\n        break;\n      }\n    }\n\n    return details;\n  }\n\n  // Begin events functions\n  function onManifestParsed() {\n  }\n\n  function onStreamUpdated(e) {\n    streamInfo_ = e.streamInfo;\n    tick();\n  }\n\n  function onTestMsg() {\n    tick();\n  }\n\n  function onFragLoaded(e) {\n    let frag = e.frag;\n    let data = frag.data;\n\n    debug_.log(`+onFragLoaded, SN:${frag.sn}, start:${frag.start}, duration:${frag.duration}`);\n    if (frag.sn === 'initSegment') {\n      frag.data = data;\n      state_ = State.IDLE;\n      tick();\n    } else {\n      state_ = State.PARSING;\n\n      let details = getLevelDetails();\n      let initSegmentData = details.initSegment ? details.initSegment.data : [];\n      demuxer_.push(data, initSegmentData, undefined, undefined, frag, streamInfo_.duration, true, undefined);\n    }\n  }\n\n  function onInitPtsFound(data) {\n    let a = 2;\n    let b = a;\n  }\n\n  function onFragParsingInitSegment(data) {\n    eventBus_.trigger(Events.BUFFER_CODEC, data.tracks);\n\n    debug_.log('+onFragParsingInitSegment');\n    for (let trackName in data.tracks) {\n      let track = data.tracks[trackName];\n      let initSegment = track.initSegment;\n      if (initSegment) {\n        eventBus_.trigger(Events.BUFFER_APPENDING, {\n          type: trackName,\n          content: 'initSegment',\n          data: initSegment\n        });\n      }\n    }\n  }\n\n  function onFragParsingData(data) {\n    // BD\n    let cnt = 0;\n    if (data.data1) {\n      cnt++;\n    }\n    if (data.data2) {\n      cnt++;\n    }\n    // ED\n\n    debug_.log(`+onFragParsingData, cnt:${cnt}`);\n    [data.data1, data.data2].forEach((buffer, index) => {\n      if (buffer) {\n        debug_.log(`push data, index:${index}`);\n        eventBus_.trigger(Events.BUFFER_APPENDING, {\n          type: data.type,\n          content: 'data',\n          data: buffer\n        });\n      }\n    });\n  }\n\n  function onFragParsed(data) {\n    debug_.log('+onFragParsed');\n    state_ = State.PARSED;\n  }\n\n  function onBufferAppended(e) {\n    let media = context_.media;\n    //debug_.log('main buffered: ' + TimeRanges.toString(media.buffered));\n    debug_.log(`+onBufferAppended, main buffered: ${TimeRanges.toString(media.buffered)}, duration:${media.duration}`);\n    if (state_ === State.PARSED && e.pending === 0) {\n      state_ = State.IDLE;\n      //tick();\n    }\n  }\n\n  // Begin internal functions\n  function _checkBuffer() {}\n\n  function _findFragment() {\n    let parser = context_.parser;\n    let frag = parser.getNextFragment();\n    return frag;\n  }\n\n  function tick() {\n    switch (state_) {\n      case State.IDLE:\n        {\n          let frag = _findFragment();\n          if (frag) {\n            eventBus_.trigger(Events.FRAG_LOADING, { frag });\n            state_ = State.FRAG_LOADING;\n          } else {\n            eventBus_.trigger(Events.BUFFER_EOS);\n          }\n        }\n        break;\n      case State.STOPPED:\n        break;\n    }\n\n    _checkBuffer();\n  }\n\n  function manualSchedule() {\n    tick();\n  }\n\n  function startLoad() {\n    eventBus_.trigger(Events.MANIFEST_LOADING, { url: context_.mediaCfg.url });\n  }\n\n  function stopLoad() {\n    state_ = State.STOPPED;\n  }\n\n  let instance_ = {\n    // for debug\n    manualSchedule: manualSchedule,\n    startLoad: startLoad,\n    stopLoad: stopLoad\n  };\n  setup();\n  return instance_;\n}\n\nStreamController.__h5player_factory_name = 'StreamController';\nexport default FactoryMaker.getSingletonFactory(StreamController);","import FactoryMaker from '../core/FactoryMaker';\r\nimport EventBus from '../core/EventBus';\r\nimport Events from '../core/events';\r\nimport Debug from '../core/Debug';\r\n\r\nimport commonUtil from '../utils/common_utils';\r\n\r\n// 20180705\r\n// \r\nlet Cue = window.WebKitDataCue || window.VTTCue || window.TextTrackCue;\r\n\r\nfunction TextTrackController() {\r\n  let context_ = this.context;\r\n\r\n  let media_ = context_.media;\r\n  let eventBus_ = EventBus(context_).getInstance();\r\n  let debug_ = Debug(context_).getInstance();\r\n\r\n  let currTrackId_ = '';\r\n  let textTracks_ = [];\r\n\r\n  function setup() {\r\n    eventBus_.on(Events.TRACK_LOADED, onTextTrackLoaded);\r\n  }\r\n\r\n  function onTextTrackLoaded(e) {\r\n    if (currTrackId_ === '') {\r\n      currTrackId_ = '0';\r\n    }\r\n    textTracks_.push(e.track);\r\n\r\n    eventBus_.trigger(Events.TRACK_ADDED, {\r\n      track: e.track,\r\n      currTrackId: currTrackId_\r\n    });\r\n  }\r\n\r\n  function onTextTrackLoaded_old(e) {\r\n    let cueData = e.cueData;\r\n    let kind = e.kind;\r\n    let label = e.label;\r\n    var textTrack = media_.addTextTrack(kind, label, label);\r\n    textTrack.mode = 'hidden';\r\n    textTrack.oncuechange = function(e) {\r\n      const activeCues = e.currentTarget.activeCues;\r\n      console.log('activeCues: ', activeCues[0]);\r\n\r\n      // Get the most recent start time. Cues are sorted by start time in ascending order by the browser\r\n      const startTime = activeCues[activeCues.length - 1].startTime;\r\n\r\n      let c = this;\r\n      let a = 2;\r\n      let b = a;\r\n    };\r\n\r\n    let trackId = (media_.textTracks.length - 1).toString();\r\n\r\n    for (let i = 0; i < cueData.length; i++) {\r\n      let item = cueData[i];\r\n      let data = {\r\n        trackId: trackId,\r\n        start: item.start,\r\n        end: item.end,\r\n        text: item.data,\r\n      };\r\n\r\n      let cue = createCue(data);\r\n      textTrack.addCue(cue);\r\n    }\r\n\r\n    let track = {\r\n      id: trackId,\r\n      lang: e.label,\r\n      label: e.label\r\n    };\r\n    textTracks_.push(track);\r\n\r\n    // set default\r\n    if (currTrackId_ === '') {\r\n      if (trackId === '0') {\r\n        currTrackId_ = trackId;\r\n        textTrack.mode = 'showing';\r\n      }\r\n    }\r\n\r\n    // Trigger text track found event.\r\n    eventBus_.trigger(Events.TRACK_ADDED, {\r\n      track: track,\r\n      currTrackId: currTrackId_\r\n    });\r\n  }\r\n\r\n  function createCue(data) {\r\n    function findTrackById(id) {\r\n      let ret;\r\n      for (let i = 0; i < media_.textTracks.length; i++) {\r\n        let track = media_.textTracks[i];\r\n        if (id === i.toString()) {\r\n          ret = track;\r\n        }\r\n      }\r\n      return ret;\r\n    }\r\n\r\n    let cue = new Cue(data.start, data.end, '');\r\n    cue.data = data;\r\n    // FIXME: Need to hide ttml render if you want to hide a texttrack while a cue is showing.\r\n    // IDEA: Create a series of div for each text track.\r\n    cue.onenter = function() {\r\n      let data = this.data;\r\n      console.log(`onenter, [${data.start}, ${data.end}] = ${data.text}`);\r\n    };\r\n    cue.onexit = function() {\r\n      let data = this.data;\r\n      console.log(`onexit, [${data.start}, ${data.end}] = ${data.text}`);\r\n    };\r\n\r\n    return cue;\r\n  }\r\n\r\n  function addTextTrack() {\r\n    // method1\r\n    // textTrack_ = media_.addTextTrack('subtitles', 'English', 'eng');\r\n    // textTrack_.mode = 'showing';\r\n    // for (let i = 0; i < 60; i++) {\r\n    //   let data = {\r\n    //     start: i,\r\n    //     end: i + 1,\r\n    //     text: 'current time: ' + i.toString()\r\n    //   }\r\n    //   let cue = createCue(data);\r\n    //   textTrack_.addCue(cue);\r\n    // }\r\n\r\n    //// method2\r\n    //let textTrack = document.createElement('track');\r\n    //textTrack.kind = 'subtitle';\r\n    //textTrack.label = 'English';\r\n    //textTrack.srclang = 'eng';\r\n    //media.appendChild(textTrack);\r\n\r\n    //textTrack = media.textTracks[0];\r\n    //textTrack.mode = 'showing';\r\n\r\n    // // BD\r\n    // console.log('begin add first cue');\r\n    // let cue = new Cue(10, 15, 'This is a placeholder text');\r\n    // textTrack.addCue(cue);\r\n    // console.log('after add first cue');\r\n\r\n    // clearCurrentCues(textTrack);\r\n\r\n    // console.log('begin add second cue');\r\n    // let cue1 = new Cue(0, 12, 'This is a placeholder text1');\r\n    // textTrack.addCue(cue1);\r\n    // console.log('after add second cue');\r\n\r\n    // let a = 2;\r\n    // let b = a;\r\n    // ED\r\n\r\n    return;\r\n\r\n    //\r\n    // let cue = new Cue(0, 100, 'This is a placeholder text');\r\n    // textTrack.addCue(cue);\r\n\r\n    // for (let i = 0; i <= 10; i ++) {\r\n    //  let cue = new Cue(i, i+1, 'current time: ' + i.toString());\r\n\r\n    //// test1\r\n    //let n = 5;\r\n    //if (i % n == 0) {\r\n    //  cue.align = \"start\"; \r\n    //} else if (i % n == 1) {\r\n    //  cue.align = \"center\";\r\n    //} else if (i % n == 2) {\r\n    //  cue.align = \"end\";\r\n    //} else if (i % n == 3) {\r\n    //  cue.align = \"left\";\r\n    //} else if (i % n == 4) {\r\n    //  cue.align = \"right\";\r\n    //}\r\n\r\n    // test2, text\r\n    //cue.lineAlign = \"start\";\r\n    //cue.line = i;\r\n\r\n    // test3\r\n    //cue.positionAlign = \"start\";\r\n    //cue.position = i*10;\r\n\r\n    // chrome\r\n    //cue.align = \"start\";\r\n    //cue.line = 0;\r\n    //cue.lineAlign = \"start\";\r\n    //cue.position = \"auto\";\r\n    //cue.size = 100;\r\n    //cue.snapToLines = false;\r\n\r\n    // firefox47\r\n    //cue.align = \"start\";\r\n    //cue.line = 0;\r\n    //cue.lineAlign = \"start\";\r\n    //cue.position = 10;\r\n    //cue.positionAlign = \"end\";\r\n    //cue.size = 100;\r\n    //cue.snapToLines = false;\r\n\r\n    // firefox53\r\n    //cue.position = 'auto';\r\n    //cue.positionAlign = 'center';\r\n\r\n    //  textTrack.addCue(cue);\r\n    //}\r\n  }\r\n\r\n  function getSubtitleTracks() {\r\n    return textTracks_;\r\n  }\r\n\r\n  /**\r\n   * @description Retuns undefined if current don't select any text track.\r\n   */\r\n  function getCurrentSubtitleTrack() {\r\n    let currTrack;\r\n    for (let i = 0; i < textTracks_.length; i++) {\r\n      let track = textTracks_[i];\r\n      if (track.id === currTrackId_) {\r\n        currTrack = track;\r\n      }\r\n    }\r\n    return currTrack;\r\n  }\r\n\r\n  function selectSubtitleTrack(id) {\r\n    currTrackId_ = id;\r\n\r\n    eventBus_.trigger(Events.TRACK_CHANGED, {\r\n      currTrackId: currTrackId_\r\n    });\r\n  }\r\n\r\n  let instance = {\r\n    getSubtitleTracks: getSubtitleTracks,\r\n    getCurrentSubtitleTrack: getCurrentSubtitleTrack,\r\n    selectSubtitleTrack: selectSubtitleTrack\r\n  };\r\n\r\n  setup();\r\n\r\n  return instance;\r\n}\r\n\r\nTextTrackController.__h5player_factory_name = 'TextTrackController';\r\nexport default FactoryMaker.getSingletonFactory(TextTrackController);","import FactoryMaker from '../core/FactoryMaker';\r\nimport EventBus from '../core/EventBus';\r\nimport Events from '../core/events';\r\nimport Debug from '../core/Debug';\r\n\r\nimport VTTParser from '../utils/VTTParser';\r\nimport StringUtils from '../utils/string_utils';\r\nimport XHRLoader from '../utils/xhr_loader';\r\n\r\nfunction ThumbnailController() {\r\n  let context_ = this.context;\r\n  let eventBus_ = EventBus(context_).getInstance();\r\n  let debug_ = Debug(context_).getInstance();\r\n\r\n  let xhrLoader_ = new XHRLoader();\r\n  let vttParser_ = VTTParser(context_).getInstance();\r\n\r\n  let track_;\r\n  let thumbnailsData_;\r\n\r\n  function setup() {\r\n    eventBus_.on(Events.THUMBNAIL_LOADING, onThumbnailLoading);\r\n  }\r\n\r\n  function onThumbnailLoading(data) {\r\n    track_ = data.track;\r\n\r\n    let request = {\r\n      url: track_.file\r\n    };\r\n    let callbacks = {\r\n      onSuccess: onRequestThumbnailSuccess\r\n    };\r\n    xhrLoader_.load(request, null, callbacks);\r\n  }\r\n\r\n  function onRequestThumbnailSuccess(buffer) {\r\n    function parseVttText(text, baseUrl) {\r\n      let thumbnailInfo = {};\r\n      let subText = null;\r\n      let index = text.indexOf('#');\r\n      if (index > 0) {\r\n        thumbnailInfo.url = text.slice(0, index);\r\n      } else {\r\n        thumbnailInfo.url = text;\r\n      }\r\n      if (thumbnailInfo.url.indexOf('://') < 0) {\r\n        if (baseUrl) {\r\n          if (baseUrl[baseUrl.length - 1] !== '/') {\r\n            thumbnailInfo.url = baseUrl + '/' + thumbnailInfo.url;\r\n          } else {\r\n            thumbnailInfo.url = baseUrl + thumbnailInfo.url;\r\n          }\r\n        }\r\n      }\r\n      index = text.indexOf('=');\r\n      if (index > 0) {\r\n        subText = (text.slice(index + 1)).split(',');\r\n        thumbnailInfo.x = subText[0] ? parseInt(subText[0]) : null;\r\n        thumbnailInfo.y = subText[1] ? parseInt(subText[1]) : null;\r\n        thumbnailInfo.w = subText[2] ? parseInt(subText[2]) : null;\r\n        thumbnailInfo.h = subText[3] ? parseInt(subText[3]) : null;\r\n      }\r\n      return thumbnailInfo;\r\n    }\r\n\r\n    let data = StringUtils.ab2str_v1(buffer);\r\n    thumbnailsData_ = vttParser_.parse(data);\r\n\r\n    let lastSlash = track_.file.lastIndexOf('/');\r\n    let baseUrl = track_.file.substring(0, lastSlash);\r\n    for (let i = 0; i < thumbnailsData_.length; i++) {\r\n      thumbnailsData_[i].data = parseVttText(thumbnailsData_[i].data, baseUrl);\r\n    }\r\n  }\r\n\r\n  function getThumbnail(time) {\r\n    if (!thumbnailsData_) {\r\n      return null;\r\n    }\r\n\r\n    for (let i in thumbnailsData_) {\r\n      let info = thumbnailsData_[i];\r\n      if (info.start <= time && time <= info.end) {\r\n        return info;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  let instance_ = {\r\n    getThumbnail: getThumbnail\r\n  };\r\n  setup();\r\n  return instance_;\r\n}\r\n\r\nThumbnailController.__h5player_factory_name = 'ThumbnailController';\r\nexport default FactoryMaker.getSingletonFactory(ThumbnailController);","/**\r\n * The copyright in this software is being made available under the BSD License,\r\n * included below. This software may be subject to other third party and contributor\r\n * rights, including patent rights, and no such rights are granted under this license.\r\n *\r\n * Copyright (c) 2013, Dash Industry Forum.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without modification,\r\n * are permitted provided that the following conditions are met:\r\n *  * Redistributions of source code must retain the above copyright notice, this\r\n *  list of conditions and the following disclaimer.\r\n *  * Redistributions in binary form must reproduce the above copyright notice,\r\n *  this list of conditions and the following disclaimer in the documentation and/or\r\n *  other materials provided with the distribution.\r\n *  * Neither the name of Dash Industry Forum nor the names of its\r\n *  contributors may be used to endorse or promote products derived from this software\r\n *  without specific prior written permission.\r\n *\r\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\r\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\r\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\r\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\r\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\r\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\r\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\r\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\r\n *  POSSIBILITY OF SUCH DAMAGE.\r\n */\r\nimport EventBus from './EventBus';\r\nimport Events from './events';\r\nimport FactoryMaker from './FactoryMaker';\r\n\r\nconst LOG_LEVEL_NONE = 0;\r\nconst LOG_LEVEL_FATAL = 1;\r\nconst LOG_LEVEL_ERROR = 2;\r\nconst LOG_LEVEL_WARNING = 3;\r\nconst LOG_LEVEL_INFO = 4;\r\nconst LOG_LEVEL_DEBUG = 5;\r\n\r\n/**\r\n * @module Debug\r\n */\r\nfunction Debug() {\r\n\r\n  let context = this.context;\r\n  let eventBus = EventBus(context).getInstance();\r\n\r\n  const logFn = [];\r\n\r\n  let instance,\r\n    logToBrowserConsole,\r\n    showLogTimestamp,\r\n    showCalleeName,\r\n    startTime;\r\n\r\n  function setup() {\r\n    logToBrowserConsole = true;\r\n    showLogTimestamp = true;\r\n    showCalleeName = true;\r\n    startTime = new Date().getTime();\r\n\r\n    if (typeof window !== 'undefined' && window.console) {\r\n      logFn[LOG_LEVEL_FATAL] = getLogFn(window.console.error);\r\n      logFn[LOG_LEVEL_ERROR] = getLogFn(window.console.error);\r\n      logFn[LOG_LEVEL_WARNING] = getLogFn(window.console.warn);\r\n      logFn[LOG_LEVEL_INFO] = getLogFn(window.console.info);\r\n      logFn[LOG_LEVEL_DEBUG] = getLogFn(window.console.debug);\r\n    }\r\n  }\r\n\r\n  function getLogFn(fn) {\r\n    if (fn && fn.bind) {\r\n      return fn.bind(window.console);\r\n    }\r\n    // if not define, return the default function for reporting logs\r\n    return window.console.log.bind(window.console);\r\n  }\r\n\r\n  /**\r\n   * Prepends a timestamp in milliseconds to each log message.\r\n   * @param {boolean} value Set to true if you want to see a timestamp in each log message.\r\n   * @default false\r\n   * @memberof module:Debug\r\n   * @instance\r\n   */\r\n  function setLogTimestampVisible(value) {\r\n    showLogTimestamp = value;\r\n  }\r\n  /**\r\n   * Prepends the callee object name, and media type if available, to each log message.\r\n   * @param {boolean} value Set to true if you want to see the callee object name and media type in each log message.\r\n   * @default false\r\n   * @memberof module:Debug\r\n   * @instance\r\n   */\r\n  function setCalleeNameVisible(value) {\r\n    showCalleeName = value;\r\n  }\r\n  /**\r\n   * Toggles logging to the browser's javascript console.  If you set to false you will still receive a log event with the same message.\r\n   * @param {boolean} value Set to false if you want to turn off logging to the browser's console.\r\n   * @default true\r\n   * @memberof module:Debug\r\n   * @instance\r\n   */\r\n  function setLogToBrowserConsole(value) {\r\n    logToBrowserConsole = value;\r\n  }\r\n  /**\r\n   * Use this method to get the state of logToBrowserConsole.\r\n   * @returns {boolean} The current value of logToBrowserConsole\r\n   * @memberof module:Debug\r\n   * @instance\r\n   */\r\n  function getLogToBrowserConsole() {\r\n    return logToBrowserConsole;\r\n  }\r\n\r\n  function fatal(...params) {\r\n    doLog(LOG_LEVEL_FATAL, ...params);\r\n  }\r\n\r\n  function error(...params) {\r\n    doLog(LOG_LEVEL_ERROR, ...params);\r\n  }\r\n\r\n  function warn(...params) {\r\n    doLog(LOG_LEVEL_WARNING, ...params);\r\n  }\r\n\r\n  function info(...params) {\r\n    doLog(LOG_LEVEL_INFO, ...params);\r\n  }\r\n\r\n  function debug(...params) {\r\n    doLog(LOG_LEVEL_DEBUG, ...params);\r\n  }\r\n\r\n  function log(...params) {\r\n    doLog(LOG_LEVEL_DEBUG, ...params);\r\n  }\r\n\r\n  /**\r\n   * This method will allow you send log messages to either the browser's console and/or dispatch an event to capture at the media player level.\r\n   * @param {...*} arguments The message you want to log. The Arguments object is supported for this method so you can send in comma separated logging items.\r\n   * @memberof module:Debug\r\n   * @instance\r\n   */\r\n  function doLog(level, ...params) {\r\n    let message = '';\r\n    let logTime = null;\r\n\r\n    if (showLogTimestamp) {\r\n      // old from dashjs\r\n      //logTime = new Date().getTime();\r\n      //message += '[' + (logTime - startTime) + ']';\r\n      // new by oldmtn\r\n      logTime = new Date();\r\n      message += '[' + ('0' + (logTime.getMonth() + 1)).slice(-2) + '-' +\r\n        ('0' + logTime.getDate()).slice(-2) + ' ' +\r\n        ('0' + logTime.getHours()).slice(-2) + ':' +\r\n        ('0' + logTime.getMinutes()).slice(-2) + ':' +\r\n        ('0' + logTime.getSeconds()).slice(-2) + '.' +\r\n        ('0' + logTime.getMilliseconds()).slice(-3) + ']';\r\n    }\r\n\r\n    if (showCalleeName && this && this.getClassName) {\r\n      message += '[' + this.getClassName() + ']';\r\n      if (this.getType) {\r\n        message += '[' + this.getType() + ']';\r\n      }\r\n    }\r\n\r\n    if (message.length > 0) {\r\n      message += ' ';\r\n    }\r\n\r\n    Array.apply(null, params).forEach(function(item) {\r\n      message += item + ' ';\r\n    });\r\n\r\n    if (logFn[level]) {\r\n      logFn[level](message);\r\n    }\r\n\r\n    eventBus.trigger(Events.LOG, {\r\n      message: message\r\n    });\r\n  }\r\n\r\n  instance = {\r\n    fatal: fatal,\r\n    error: error,\r\n    warn: warn,\r\n    info: info,\r\n    debug: debug,\r\n    log: log,\r\n    setLogTimestampVisible: setLogTimestampVisible,\r\n    setCalleeNameVisible: setCalleeNameVisible,\r\n    setLogToBrowserConsole: setLogToBrowserConsole,\r\n    getLogToBrowserConsole: getLogToBrowserConsole\r\n  };\r\n\r\n  setup();\r\n\r\n  return instance;\r\n}\r\n\r\nDebug.__h5player_factory_name = 'Debug';\r\nconst factory = FactoryMaker.getSingletonFactory(Debug);\r\nfactory.LOG_LEVEL_NONE = LOG_LEVEL_NONE;\r\nfactory.LOG_LEVEL_FATAL = LOG_LEVEL_FATAL;\r\nfactory.LOG_LEVEL_ERROR = LOG_LEVEL_ERROR;\r\nfactory.LOG_LEVEL_WARNING = LOG_LEVEL_WARNING;\r\nfactory.LOG_LEVEL_INFO = LOG_LEVEL_INFO;\r\nfactory.LOG_LEVEL_DEBUG = LOG_LEVEL_DEBUG;\r\nexport default factory;","/**\r\n * The copyright in this software is being made available under the BSD License,\r\n * included below. This software may be subject to other third party and contributor\r\n * rights, including patent rights, and no such rights are granted under this license.\r\n *\r\n * Copyright (c) 2013, Dash Industry Forum.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without modification,\r\n * are permitted provided that the following conditions are met:\r\n *  * Redistributions of source code must retain the above copyright notice, this\r\n *  list of conditions and the following disclaimer.\r\n *  * Redistributions in binary form must reproduce the above copyright notice,\r\n *  this list of conditions and the following disclaimer in the documentation and/or\r\n *  other materials provided with the distribution.\r\n *  * Neither the name of Dash Industry Forum nor the names of its\r\n *  contributors may be used to endorse or promote products derived from this software\r\n *  without specific prior written permission.\r\n *\r\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\r\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\r\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\r\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\r\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\r\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\r\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\r\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\r\n *  POSSIBILITY OF SUCH DAMAGE.\r\n */\r\nimport FactoryMaker from './FactoryMaker';\r\n\r\nconst EVENT_PRIORITY_LOW = 0;\r\nconst EVENT_PRIORITY_HIGH = 5000;\r\n\r\nfunction EventBus() {\r\n\r\n  let handlers = {};\r\n\r\n  function on(evType, listener, scope, priority = EVENT_PRIORITY_LOW) {\r\n\r\n    if (!evType) {\r\n      throw new Error('event evType cannot be null or undefined');\r\n    }\r\n    if (!listener || typeof(listener) !== 'function') {\r\n      throw new Error('listener must be a function: ' + listener);\r\n    }\r\n\r\n    if (getHandlerIdx(evType, listener, scope) >= 0) return;\r\n\r\n    handlers[evType] = handlers[evType] || [];\r\n\r\n    const handler = {\r\n      callback: listener,\r\n      scope: scope,\r\n      priority: priority\r\n    };\r\n\r\n    const inserted = handlers[evType].some((item, idx) => {\r\n      if (priority > item.priority) {\r\n        handlers[evType].splice(idx, 0, handler);\r\n        return true;\r\n      }\r\n    });\r\n\r\n    if (!inserted) {\r\n      handlers[evType].push(handler);\r\n    }\r\n  }\r\n\r\n  function off(evType, listener, scope) {\r\n    if (!evType || !listener || !handlers[evType]) return;\r\n    const idx = getHandlerIdx(evType, listener, scope);\r\n    if (idx < 0) return;\r\n    handlers[evType].splice(idx, 1);\r\n  }\r\n\r\n  function trigger(evType, payload) {\r\n    if (!evType || !handlers[evType]) return;\r\n\r\n    payload = payload || {};\r\n\r\n    if (payload.hasOwnProperty('evType')) throw new Error('\\'evType\\' is a reserved word for event dispatching');\r\n\r\n    payload.evType = evType;\r\n\r\n    handlers[evType].forEach(handler => handler.callback.call(handler.scope, payload));\r\n  }\r\n\r\n  function getHandlerIdx(evType, listener, scope) {\r\n\r\n    let idx = -1;\r\n\r\n    if (!handlers[evType]) return idx;\r\n\r\n    handlers[evType].some((item, index) => {\r\n      if (item.callback === listener && (!scope || scope === item.scope)) {\r\n        idx = index;\r\n        return true;\r\n      }\r\n    });\r\n    return idx;\r\n  }\r\n\r\n  function reset() {\r\n    handlers = {};\r\n  }\r\n\r\n  const instance = {\r\n    on: on,\r\n    off: off,\r\n    trigger: trigger,\r\n    reset: reset\r\n  };\r\n\r\n  return instance;\r\n}\r\n\r\nEventBus.__h5player_factory_name = 'EventBus';\r\nconst factory = FactoryMaker.getSingletonFactory(EventBus);\r\nfactory.EVENT_PRIORITY_LOW = EVENT_PRIORITY_LOW;\r\nfactory.EVENT_PRIORITY_HIGH = EVENT_PRIORITY_HIGH;\r\nexport default factory;","/**\r\n * The copyright in this software is being made available under the BSD License,\r\n * included below. This software may be subject to other third party and contributor\r\n * rights, including patent rights, and no such rights are granted under this license.\r\n *\r\n * Copyright (c) 2013, Dash Industry Forum.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without modification,\r\n * are permitted provided that the following conditions are met:\r\n *  * Redistributions of source code must retain the above copyright notice, this\r\n *  list of conditions and the following disclaimer.\r\n *  * Redistributions in binary form must reproduce the above copyright notice,\r\n *  this list of conditions and the following disclaimer in the documentation and/or\r\n *  other materials provided with the distribution.\r\n *  * Neither the name of Dash Industry Forum nor the names of its\r\n *  contributors may be used to endorse or promote products derived from this software\r\n *  without specific prior written permission.\r\n *\r\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\r\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\r\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\r\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\r\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\r\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\r\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\r\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\r\n *  POSSIBILITY OF SUCH DAMAGE.\r\n */\r\n/**\r\n * @module FactoryMaker\r\n */\r\nlet FactoryMaker = (function() {\r\n\r\n  let instance;\r\n  let extensions = [];\r\n  let singletonContexts = [];\r\n\r\n  function extend(name, childInstance, override, context) {\r\n    let extensionContext = getExtensionContext(context);\r\n    if (!extensionContext[name] && childInstance) {\r\n      extensionContext[name] = {\r\n        instance: childInstance,\r\n        override: override\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Use this method from your extended object.  this.factory is injected into your object.\r\n   * this.factory.getSingletonInstance(this.context, 'VideoModel')\r\n   * will return the video model for use in the extended object.\r\n   *\r\n   * @param {Object} context - injected into extended object as this.context\r\n   * @param {string} className - string name found in all dash.js objects\r\n   * with name __h5player_factory_name Will be at the bottom. Will be the same as the object's name.\r\n   * @returns {*} Context aware instance of specified singleton name.\r\n   * @memberof module:FactoryMaker\r\n   * @instance\r\n   */\r\n  function getSingletonInstance(context, className) {\r\n    for (let i in singletonContexts) {\r\n      let obj = singletonContexts[i];\r\n      if (obj.context === context && obj.name === className) {\r\n        return obj.instance;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Use this method to add an singleton instance to the system.  Useful for unit testing to mock objects etc.\r\n   *\r\n   * @param {Object} context\r\n   * @param {string} className\r\n   * @param {Object} instance\r\n   * @memberof module:FactoryMaker\r\n   * @instance\r\n   */\r\n  function setSingletonInstance(context, className, instance) {\r\n    for (let i in singletonContexts) {\r\n      let obj = singletonContexts[i];\r\n      if (obj.context === context && obj.name === className) {\r\n        singletonContexts[i].instance = instance;\r\n        return;\r\n      }\r\n    }\r\n    singletonContexts.push({\r\n      name: className,\r\n      context: context,\r\n      instance: instance\r\n    });\r\n  }\r\n\r\n  function getClassFactory(classConstructor) {\r\n    return function(context) {\r\n      if (context === undefined) {\r\n        context = {};\r\n      }\r\n\r\n      return {\r\n        create: function() {\r\n          return merge(classConstructor.__h5player_factory_name, classConstructor.apply({\r\n            context: context\r\n          }, arguments), context, arguments);\r\n        }\r\n      };\r\n    };\r\n  }\r\n\r\n  function getSingletonFactory(classConstructor) {\r\n    return function(context) {\r\n      let instance;\r\n      if (context === undefined) {\r\n        context = {};\r\n      }\r\n      return {\r\n        getInstance: function() {\r\n          // If we don't have an instance yet check for one on the context\r\n          if (!instance) {\r\n            instance = getSingletonInstance(context, classConstructor.__h5player_factory_name);\r\n          }\r\n          // If there's no instance on the context then create one\r\n          if (!instance) {\r\n            instance = merge(classConstructor.__h5player_factory_name, classConstructor.apply({\r\n              context: context\r\n            }, arguments), context, arguments);\r\n            singletonContexts.push({\r\n              name: classConstructor.__h5player_factory_name,\r\n              context: context,\r\n              instance: instance\r\n            });\r\n          }\r\n          return instance;\r\n        }\r\n      };\r\n    };\r\n  }\r\n\r\n  function merge(name, classConstructor, context, args) {\r\n    let extensionContext = getExtensionContext(context);\r\n    let extensionObject = extensionContext[name];\r\n    if (extensionObject) {\r\n      let extension = extensionObject.instance;\r\n      if (extensionObject.override) { //Override public methods in parent but keep parent.\r\n        extension = extension.apply({\r\n          context: context,\r\n          factory: instance,\r\n          parent: classConstructor\r\n        }, args);\r\n        for (const prop in extension) {\r\n          if (classConstructor.hasOwnProperty(prop)) {\r\n            classConstructor[prop] = extension[prop];\r\n          }\r\n        }\r\n      } else { //replace parent object completely with new object. Same as dijon.\r\n        return extension.apply({\r\n          context: context,\r\n          factory: instance\r\n        }, args);\r\n      }\r\n    }\r\n    return classConstructor;\r\n  }\r\n\r\n  function getExtensionContext(context) {\r\n    let extensionContext;\r\n    extensions.forEach(function(obj) {\r\n      if (obj === context) {\r\n        extensionContext = obj;\r\n      }\r\n    });\r\n    if (!extensionContext) {\r\n      extensionContext = extensions.push(context);\r\n    }\r\n    return extensionContext;\r\n  }\r\n\r\n  instance = {\r\n    extend: extend,\r\n    getSingletonInstance: getSingletonInstance,\r\n    setSingletonInstance: setSingletonInstance,\r\n    getSingletonFactory: getSingletonFactory,\r\n    getClassFactory: getClassFactory\r\n  };\r\n\r\n  return instance;\r\n\r\n}());\r\n\r\nexport default FactoryMaker;","export const ErrorTypes = {\r\n  // Identifier for a license error\r\n  LICENSE_ERROR: 'licenseError'\r\n};\r\n\r\nexport const ErrorDetails = {};","/**\r\n * @class\r\n *\r\n */\r\nclass CoreEvents {\r\n  /**\r\n   * @description Public facing external events to be used when developing a player that implements dash.js.\r\n   */\r\n  constructor() {\r\n    // media element events\r\n    this.MEDIA_CANPLAY = 'mediaCanPlay';\r\n    this.MEDIA_CANPLAY_THROUGH = 'mediaCanPlayThrough';\r\n    this.MEDIA_DURATION_CHANGED = 'mediaDurationChanged';\r\n    this.MEDIA_ENDED = 'mediaEnded';\r\n    this.MEDIA_LOADEDDATA = 'mediaLoadedData';\r\n    this.MEDIA_LOADEDMETADATA = 'mediaLoadedMetadata';\r\n    this.MEDIA_PAUSED = 'mediaPaused';\r\n    this.MEDIA_PLAY = 'mediaPlay';\r\n    this.MEDIA_PLAYING = 'mediaPlaying';\r\n    this.MEDIA_SEEKING = 'mediaSeeking';\r\n    this.MEDIA_SEEKED = 'mediaSeeked';\r\n    this.MEDIA_TIMEUPDATE = 'mediaTimeupdate';\r\n    this.MEDIA_VOLUME_CHANGED = 'mediaVolumeChanged';\r\n    this.MEDIA_WAITING = 'mediaWaiting';\r\n\r\n    // ads internal events\r\n    this.AD_ERROR = 'adError';\r\n    this.AD_STARTED = 'adStarted';\r\n    this.AD_COMPLETE = 'adComplete';\r\n    this.AD_PAUSED = 'adPaused';\r\n    this.AD_RESUMED = 'adResumed';\r\n    this.AD_CONTENT_PAUSE_REQUESTED = 'adContentPauseRequested';\r\n    this.AD_CONTENT_RESUME_REQUESTED = 'adContentResumeRequested';\r\n    this.AD_ADS_MANAGER_LOADED = 'adAdsManagerLoaded';\r\n    this.AD_TIMEUPDATE = 'adTimeUpdate';\r\n    this.AD_COMPANIONS = 'adCompanions';\r\n    this.AD_VOLUME_CHANGED = 'adVolumeChanged';\r\n    // ads custom events\r\n    this.AD_LOADING_COMPLETE = 'adLoadingComplete';\r\n\r\n    // DOM Events\r\n    this.FULLSCREEN_CHANGE = 'fullscreenChange';\r\n\r\n    // controller events\r\n    this.STATE_CHANGE = 'stateChange';\r\n\r\n    this.FINDING_PARSER = 'findingParser';\r\n    this.FOUND_PARSER = 'foundParser';\r\n    this.STREAM_UPDATED = 'streamUpdated'; // Loaded a stream has a specified bitrate.\r\n    // log event\r\n    this.LOG = 'log';\r\n    this.ERROR = 'error';\r\n    // thumbnail\r\n    this.THUMBNAIL_LOADING = 'thumbnailLoading';\r\n    // tracks(captions, thumbnails)\r\n    this.TRACK_LOADING = 'trackLoading';\r\n    this.TRACK_LOADED = 'trackLoaded';\r\n    this.TRACK_ADDED = 'trackAdded';\r\n    this.TRACK_CHANGED = 'trackChanged';\r\n    // chromecast\r\n    this.CAST_CONNECTED = 'castConnected';\r\n    this.CAST_DISCONNECTED = 'castDisconnected';\r\n\r\n    // Begin hls.js, for compatible hls.js\r\n    this.MANIFEST_LOADING = 'hlsManifestLoading';\r\n    this.MANIFEST_LOADED = 'hlsManifestLoaded';\r\n    this.MANIFEST_PARSED = 'hlsManifestParsed';\r\n    this.FRAG_LOADING = 'hlsFragLoading';\r\n    this.FRAG_LOADED = 'hlsFragLoaded';\r\n    this.INIT_PTS_FOUND = 'hlsInitPtsFound';\r\n    this.FRAG_PARSING_INIT_SEGMENT = 'hlsFragParsingInitSegment';\r\n    this.FRAG_PARSING_DATA = 'hlsFragParsingData';\r\n    this.FRAG_PARSED = 'hlsFragParsed';\r\n    this.BUFFER_CODEC = 'hlsBufferCodec';\r\n    this.BUFFER_APPENDING = 'hlsBufferAppending';\r\n    this.BUFFER_APPENDED = 'hlsBufferAppended';\r\n    this.BUFFER_EOS = 'hlsBufferEOS';\r\n    this.MEDIA_ATTACHING = 'hlsMediaAttaching';\r\n    this.MEDIA_ATTACHED = 'hlsMediaAttached';\r\n    // End hls.js\r\n\r\n    //\r\n    this.TEST_MSG = 'testMsg';\r\n  }\r\n}\r\n\r\nlet Events = new CoreEvents();\r\nexport default Events;","import FactoryMaker from '../core/FactoryMaker';\n// import Events from '../core/events';\n// import EventBus from '../core/EventBus';\n// import Debug from '../core/Debug';\n\n// import StringUtils from '../utils/string_utils';\n\n// // Begin from Dashjs\n// import X2JS from './dashjs/externals/xml2json';\n// import {\n//   replaceIDForTemplate,\n//   replaceTokenForTemplate\n// } from './dashjs/src/dash/utils/SegmentsUtils';\n\n// import StringMatcher from './dashjs/src/dash/parser/matchers/StringMatcher';\n// import DurationMatcher from './dashjs/src/dash/parser/matchers/DurationMatcher';\n// import DateTimeMatcher from './dashjs/src/dash/parser/matchers/DateTimeMatcher';\n// import NumericMatcher from './dashjs/src/dash/parser/matchers/NumericMatcher';\n// // End from Dashjs\n\n// import {\n//   Fragment,\n//   TrackInfo,\n//   PeriodInfo\n// } from '../common/common';\n\nfunction DashParser() {\n  //   let context_ = this.context;\n  //   let eventBus_ = EventBus(context_).getInstance();\n  //   let debug_ = Debug(context_).getInstance();\n\n  //   let xhrLoader_ = context_.loader(context_).create();\n  //   // parser reference variable\n  //   let matchers_;\n  //   let converter_;\n\n  //   // Begin dash manifest info\n  //   let streamInfo_;\n  //   let aRep_;\n  //   // End dash manifest info\n\n  //   let manifestUrl_;\n\n  //   // flag\n  //   let fragCurrent_;\n  //   let videoHeaderAdded_ = false;\n  //   let vSegmentNumber_ = 0;\n\n  //   let audioHeaderAdded_ = false;\n  //   let aSegmentNumber_ = 0;\n\n  //   let flagCurrSegmentType;\n\n  //   function setup() {\n  //     matchers_ = [\n  //       new DurationMatcher(),\n  //       new DateTimeMatcher(),\n  //       new NumericMatcher(),\n  //       new StringMatcher() // last in list to take precedence over NumericMatcher\n  //     ];\n\n  //     converter_ = new X2JS({\n  //       escapeMode: false,\n  //       attributePrefix: '',\n  //       arrayAccessForm: 'property',\n  //       emptyNodeForm: 'object',\n  //       stripWhitespaces: false,\n  //       enableToStringFunc: false,\n  //       ignoreRoot: true,\n  //       matchers: matchers_\n  //     });\n  //   }\n\n  //   function getRepresentation(manifest) {\n  //     function getSegmentDuration(segmentTemplate) {\n  //       let duration = segmentTemplate.duration;\n  //       if (segmentTemplate.timescale) {\n  //         duration = segmentTemplate.duration / segmentTemplate.timescale;\n  //       }\n\n  //       return duration;\n  //     }\n  //     //\n  //     let mediaPresentationDuration = manifest.mediaPresentationDuration;\n\n  //     streamInfo_ = new PeriodInfo();\n  //     streamInfo_.duration = mediaPresentationDuration;\n\n  //     let period = manifest.Period_asArray[0];\n  //     for (let i = 0; i < period.AdaptationSet_asArray.length; i++) {\n  //       let adaptationSet = period.AdaptationSet_asArray[i];\n  //       let segmentTemplate = adaptationSet.SegmentTemplate;\n  //       let representation = adaptationSet.Representation;\n\n  //       let cnt = mediaPresentationDuration / getSegmentDuration(segmentTemplate);\n  //       let remainder = mediaPresentationDuration % getSegmentDuration(segmentTemplate);\n\n  //       let track = new TrackInfo();\n  //       track.rep = adaptationSet.Representation;\n  //       track.segmentTemplate = adaptationSet.SegmentTemplate;\n  //       track.segmentCnt = parseInt(cnt) + (remainder > 0 ? 1 : 0);\n  //       track.endNumber = track.segmentCnt + segmentTemplate.startNumber;\n  //       //\n  //       if (representation.mimeType.indexOf('video') !== -1) {\n  //         track.type = 'video';\n  //         vSegmentNumber_ = parseInt(segmentTemplate.startNumber);\n  //       } else {\n  //         track.type = 'audio';\n  //         aSegmentNumber_ = parseInt(segmentTemplate.startNumber);\n  //       }\n\n  //       debug_.log(`${track.type} segment, start number:${segmentTemplate.startNumber}, cnt:${track.segmentCnt}`);\n\n  //       streamInfo_.tracks.push(track);\n  //     }\n\n  //     flagCurrSegmentType = 'video';\n  //   }\n\n  //   function loadManifest(url) {\n  //     manifestUrl_ = url;\n\n  //     videoHeaderAdded_ = false;\n  //     vSegmentNumber_ = 0;\n  //     audioHeaderAdded_ = false;\n  //     aSegmentNumber_ = 0;\n\n  //     function onSuccess(bytes) {\n  //       let content = StringUtils.ab2str_v1(bytes);\n  //       debug_.log('content: ' + content);\n\n  //       let manifest = converter_.xml_str2json(content);\n  //       getRepresentation(manifest);\n\n  //       eventBus_.trigger(Events.MANIFEST_PARSED);\n\n  //       eventBus_.trigger(Events.STREAM_UPDATED, streamInfo_);\n\n  //       // trigger buffer codec;\n  //       let tracks = {};\n  //       let vTrack = findTrackInfo('video');\n  //       if (vTrack) {\n  //         tracks.video = {};\n  //         tracks.video.container = 'video/mp4';\n  //         tracks.video.codec = vTrack.rep.codecs;\n  //       }\n  //       let aTrack = findTrackInfo('audio');\n  //       if (aTrack) {\n  //         tracks.audio = {};\n  //         tracks.audio.container = 'audio/mp4';\n  //         tracks.audio.codec = aTrack.rep.codecs;\n  //       }\n\n  //       eventBus_.trigger(Events.BUFFER_CODEC, tracks);\n  //     }\n\n  //     let request = {\n  //       url: manifestUrl_\n  //     };\n  //     let callbacks = {\n  //       onSuccess: onSuccess\n  //     }\n\n  //     xhrLoader_.load(request, null, callbacks);\n  //   }\n\n  //   function getFragmentInitialization(track) {\n  //     let initialization = replaceIDForTemplate(track.segmentTemplate.initialization, track.rep.id);\n\n  //     let url = require('url');\n  //     return url.resolve(manifestUrl_, initialization);\n  //   }\n\n  //   function getFragmentMedia(track, number) {\n  //     let media = replaceTokenForTemplate(track.segmentTemplate.media, 'Number', number);\n  //     media = replaceIDForTemplate(media, track.rep.id);\n\n  //     let url = require('url');\n  //     return url.resolve(manifestUrl_, media);\n  //   }\n\n  //   function getAudioFragment() {\n  //     let frag = null;\n  //     let audioTrack = findTrackInfo('audio');\n  //     if (audioTrack) {\n  //       if (audioHeaderAdded_ === false) {\n  //         frag = new Fragment();\n  //         frag.type = 'audio';\n  //         frag.url = getFragmentInitialization(audioTrack);\n  //         frag.content = 'initSegment';\n  //         audioHeaderAdded_ = true;\n  //       } else {\n  //         if (aSegmentNumber_ < audioTrack.endNumber) {\n  //           frag = new Fragment();\n  //           frag.type = 'audio';\n  //           frag.url = getFragmentMedia(audioTrack, aSegmentNumber_);\n  //           frag.content = 'data';\n  //           aSegmentNumber_++;\n  //         } else {\n  //           frag = null;\n  //         }\n  //       }\n  //     }\n  //     return frag;\n  //   }\n\n  //   function getVideoFragment() {\n  //     let frag = null;\n  //     let videoTrack = findTrackInfo('video');\n\n  //     if (videoTrack) {\n  //       if (videoHeaderAdded_ === false) {\n  //         frag = new Fragment();\n  //         frag.type = 'video';\n  //         frag.url = getFragmentInitialization(videoTrack);\n  //         frag.content = 'initSegment';\n  //         videoHeaderAdded_ = true;\n  //       } else {\n  //         if (vSegmentNumber_ < videoTrack.endNumber) {\n  //           frag = new Fragment();\n  //           frag.type = 'video';\n  //           frag.url = getFragmentMedia(videoTrack, vSegmentNumber_);\n  //           frag.content = 'data';\n  //           vSegmentNumber_++;\n  //         } else {\n  //           frag = null;\n  //         }\n  //       }\n  //     }\n  //     return frag;\n  //   }\n\n  //   function getNextFragment() {\n  //     fragCurrent_ = null;\n  //     do {\n  //       if (flagCurrSegmentType === 'video') {\n  //         fragCurrent_ = getVideoFragment();\n  //         if (fragCurrent_) {\n  //           flagCurrSegmentType = 'audio';\n  //         } else {\n  //           fragCurrent_ = getAudioFragment();\n  //         }\n  //       } else if (flagCurrSegmentType === 'audio') {\n  //         fragCurrent_ = getAudioFragment();\n  //         if (fragCurrent_) {\n  //           flagCurrSegmentType = 'video';\n  //         } else {\n  //           fragCurrent_ = getVideoFragment();\n  //         }\n  //       }\n  //     } while (false);\n\n  //     return fragCurrent_;\n  //   }\n\n  //   function onFragmentDownloaded(e) {\n  //     eventBus_.trigger(Events.BUFFER_APPENDING, {\n  //       type: e.type,\n  //       content: e.content,\n  //       data: e.data\n  //     });\n  //   }\n\n  //   function findTrackInfo(type) {\n  //     let ret = null;\n  //     for (let i = 0; i < streamInfo_.tracks.length; i++) {\n  //       let track = streamInfo_.tracks[i];\n  //       if (track.type === type) {\n  //         ret = track;\n  //         break;\n  //       }\n  //     }\n\n  //     return ret;\n  //   }\n\n  //   let instance_ = {\n  //     loadManifest: loadManifest,\n  //     getNextFragment: getNextFragment\n  //   };\n  //   setup();\n  //   return instance_;\n}\n\nDashParser.__h5player_factory_name = 'DashParser';\nexport default FactoryMaker.getSingletonFactory(DashParser);","/* $Date: 2007-06-12 18:02:31 $ */\n\n// from: http://bannister.us/weblog/2007/06/09/simple-base64-encodedecode-javascript/\n// Handles encode/decode of ASCII and Unicode strings.\n\nvar UTF8 = {};\nUTF8.encode = function(s) {\n  var u = [];\n  for (var i = 0; i < s.length; ++i) {\n    var c = s.charCodeAt(i);\n    if (c < 0x80) {\n      u.push(c);\n    } else if (c < 0x800) {\n      u.push(0xC0 | (c >> 6));\n      u.push(0x80 | (63 & c));\n    } else if (c < 0x10000) {\n      u.push(0xE0 | (c >> 12));\n      u.push(0x80 | (63 & (c >> 6)));\n      u.push(0x80 | (63 & c));\n    } else {\n      u.push(0xF0 | (c >> 18));\n      u.push(0x80 | (63 & (c >> 12)));\n      u.push(0x80 | (63 & (c >> 6)));\n      u.push(0x80 | (63 & c));\n    }\n  }\n  return u;\n};\nUTF8.decode = function(u) {\n  var a = [];\n  var i = 0;\n  while (i < u.length) {\n    var v = u[i++];\n    if (v < 0x80) {\n      // no need to mask byte\n    } else if (v < 0xE0) {\n      v = (31 & v) << 6;\n      v |= (63 & u[i++]);\n    } else if (v < 0xF0) {\n      v = (15 & v) << 12;\n      v |= (63 & u[i++]) << 6;\n      v |= (63 & u[i++]);\n    } else {\n      v = (7 & v) << 18;\n      v |= (63 & u[i++]) << 12;\n      v |= (63 & u[i++]) << 6;\n      v |= (63 & u[i++]);\n    }\n    a.push(String.fromCharCode(v));\n  }\n  return a.join('');\n};\n\nvar BASE64 = {};\n(function(T) {\n  var encodeArray = function(u) {\n    var i = 0;\n    var a = [];\n    var n = 0 | (u.length / 3);\n    while (0 < n--) {\n      var v = (u[i] << 16) + (u[i + 1] << 8) + u[i + 2];\n      i += 3;\n      a.push(T.charAt(63 & (v >> 18)));\n      a.push(T.charAt(63 & (v >> 12)));\n      a.push(T.charAt(63 & (v >> 6)));\n      a.push(T.charAt(63 & v));\n    }\n    if (2 == (u.length - i)) {\n      var v = (u[i] << 16) + (u[i + 1] << 8);\n      a.push(T.charAt(63 & (v >> 18)));\n      a.push(T.charAt(63 & (v >> 12)));\n      a.push(T.charAt(63 & (v >> 6)));\n      a.push('=');\n    } else if (1 == (u.length - i)) {\n      var v = (u[i] << 16);\n      a.push(T.charAt(63 & (v >> 18)));\n      a.push(T.charAt(63 & (v >> 12)));\n      a.push('==');\n    }\n    return a.join('');\n  };\n  var R = (function() {\n    var a = [];\n    for (var i = 0; i < T.length; ++i) {\n      a[T.charCodeAt(i)] = i;\n    }\n    a['='.charCodeAt(0)] = 0;\n    return a;\n  })();\n  var decodeArray = function(s) {\n    var i = 0;\n    var u = [];\n    var n = 0 | (s.length / 4);\n    while (0 < n--) {\n      var v = (R[s.charCodeAt(i)] << 18) + (R[s.charCodeAt(i + 1)] << 12) + (R[s.charCodeAt(i + 2)] << 6) + R[s.charCodeAt(i + 3)];\n      u.push(255 & (v >> 16));\n      u.push(255 & (v >> 8));\n      u.push(255 & v);\n      i += 4;\n    };\n    if (u) {\n      if ('=' == s.charAt(i - 2)) {\n        u.pop();\n        u.pop();\n      } else if ('=' == s.charAt(i - 1)) {\n        u.pop();\n      }\n    }\n    return u;\n  };\n  var ASCII = {};\n  ASCII.encode = function(s) {\n    var u = [];\n    for (var i = 0; i < s.length; ++i) {\n      u.push(s.charCodeAt(i));\n    }\n    return u;\n  };\n  ASCII.decode = function(u) {\n    for (var i = 0; i < s.length; ++i) {\n      a[i] = String.fromCharCode(a[i]);\n    }\n    return a.join('');\n  };\n  BASE64.decodeArray = function(s) {\n    var u = decodeArray(s);\n    return new Uint8Array(u);\n  };\n  BASE64.encodeASCII = function(s) {\n    var u = ASCII.encode(s);\n    return encodeArray(u);\n  };\n  BASE64.decodeASCII = function(s) {\n    var a = decodeArray(s);\n    return ASCII.decode(a);\n  };\n  BASE64.encode = function(s) {\n    var u = UTF8.encode(s);\n    return encodeArray(u);\n  };\n  BASE64.decode = function(s) {\n    var u = decodeArray(s);\n    return UTF8.decode(u);\n  };\n})('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/');\n\n/*The following polyfills are not used in dash.js but have caused multiplayer integration issues.\n Therefore commenting them out.\nif (undefined === btoa) {\n    var btoa = BASE64.encode;\n}\nif (undefined === atob) {\n    var atob = BASE64.decode;\n}\n*/\n\nif (typeof exports !== 'undefined') {\n  exports.decode = BASE64.decode;\n  exports.decodeArray = BASE64.decodeArray;\n}","//     Underscore.js 1.9.1\r\n//     http://underscorejs.org\r\n//     (c) 2009-2018 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\r\n//     Underscore may be freely distributed under the MIT license.\r\n\r\n(function() {\r\n\r\n  // Baseline setup\r\n  // --------------\r\n\r\n  // Establish the root object, `window` (`self`) in the browser, `global`\r\n  // on the server, or `this` in some virtual machines. We use `self`\r\n  // instead of `window` for `WebWorker` support.\r\n  var root = typeof self == 'object' && self.self === self && self ||\r\n            typeof global == 'object' && global.global === global && global ||\r\n            this ||\r\n            {};\r\n\r\n  // Save the previous value of the `_` variable.\r\n  var previousUnderscore = root._;\r\n\r\n  // Save bytes in the minified (but not gzipped) version:\r\n  var ArrayProto = Array.prototype, ObjProto = Object.prototype;\r\n  var SymbolProto = typeof Symbol !== 'undefined' ? Symbol.prototype : null;\r\n\r\n  // Create quick reference variables for speed access to core prototypes.\r\n  var push = ArrayProto.push,\r\n      slice = ArrayProto.slice,\r\n      toString = ObjProto.toString,\r\n      hasOwnProperty = ObjProto.hasOwnProperty;\r\n\r\n  // All **ECMAScript 5** native function implementations that we hope to use\r\n  // are declared here.\r\n  var nativeIsArray = Array.isArray,\r\n      nativeKeys = Object.keys,\r\n      nativeCreate = Object.create;\r\n\r\n  // Naked function reference for surrogate-prototype-swapping.\r\n  var Ctor = function(){};\r\n\r\n  // Create a safe reference to the Underscore object for use below.\r\n  var _ = function(obj) {\r\n    if (obj instanceof _) return obj;\r\n    if (!(this instanceof _)) return new _(obj);\r\n    this._wrapped = obj;\r\n  };\r\n\r\n  // Export the Underscore object for **Node.js**, with\r\n  // backwards-compatibility for their old module API. If we're in\r\n  // the browser, add `_` as a global object.\r\n  // (`nodeType` is checked to ensure that `module`\r\n  // and `exports` are not HTML elements.)\r\n  if (typeof exports != 'undefined' && !exports.nodeType) {\r\n    if (typeof module != 'undefined' && !module.nodeType && module.exports) {\r\n      exports = module.exports = _;\r\n    }\r\n    exports._ = _;\r\n  } else {\r\n    root._ = _;\r\n  }\r\n\r\n  // Current version.\r\n  _.VERSION = '1.9.1';\r\n\r\n  // Internal function that returns an efficient (for current engines) version\r\n  // of the passed-in callback, to be repeatedly applied in other Underscore\r\n  // functions.\r\n  var optimizeCb = function(func, context, argCount) {\r\n    if (context === void 0) return func;\r\n    switch (argCount == null ? 3 : argCount) {\r\n      case 1: return function(value) {\r\n        return func.call(context, value);\r\n      };\r\n      // The 2-argument case is omitted because were not using it.\r\n      case 3: return function(value, index, collection) {\r\n        return func.call(context, value, index, collection);\r\n      };\r\n      case 4: return function(accumulator, value, index, collection) {\r\n        return func.call(context, accumulator, value, index, collection);\r\n      };\r\n    }\r\n    return function() {\r\n      return func.apply(context, arguments);\r\n    };\r\n  };\r\n\r\n  var builtinIteratee;\r\n\r\n  // An internal function to generate callbacks that can be applied to each\r\n  // element in a collection, returning the desired result  either `identity`,\r\n  // an arbitrary callback, a property matcher, or a property accessor.\r\n  var cb = function(value, context, argCount) {\r\n    if (_.iteratee !== builtinIteratee) return _.iteratee(value, context);\r\n    if (value == null) return _.identity;\r\n    if (_.isFunction(value)) return optimizeCb(value, context, argCount);\r\n    if (_.isObject(value) && !_.isArray(value)) return _.matcher(value);\r\n    return _.property(value);\r\n  };\r\n\r\n  // External wrapper for our callback generator. Users may customize\r\n  // `_.iteratee` if they want additional predicate/iteratee shorthand styles.\r\n  // This abstraction hides the internal-only argCount argument.\r\n  _.iteratee = builtinIteratee = function(value, context) {\r\n    return cb(value, context, Infinity);\r\n  };\r\n\r\n  // Some functions take a variable number of arguments, or a few expected\r\n  // arguments at the beginning and then a variable number of values to operate\r\n  // on. This helper accumulates all remaining arguments past the functions\r\n  // argument length (or an explicit `startIndex`), into an array that becomes\r\n  // the last argument. Similar to ES6s \"rest parameter\".\r\n  var restArguments = function(func, startIndex) {\r\n    startIndex = startIndex == null ? func.length - 1 : +startIndex;\r\n    return function() {\r\n      var length = Math.max(arguments.length - startIndex, 0),\r\n          rest = Array(length),\r\n          index = 0;\r\n      for (; index < length; index++) {\r\n        rest[index] = arguments[index + startIndex];\r\n      }\r\n      switch (startIndex) {\r\n        case 0: return func.call(this, rest);\r\n        case 1: return func.call(this, arguments[0], rest);\r\n        case 2: return func.call(this, arguments[0], arguments[1], rest);\r\n      }\r\n      var args = Array(startIndex + 1);\r\n      for (index = 0; index < startIndex; index++) {\r\n        args[index] = arguments[index];\r\n      }\r\n      args[startIndex] = rest;\r\n      return func.apply(this, args);\r\n    };\r\n  };\r\n\r\n  // An internal function for creating a new object that inherits from another.\r\n  var baseCreate = function(prototype) {\r\n    if (!_.isObject(prototype)) return {};\r\n    if (nativeCreate) return nativeCreate(prototype);\r\n    Ctor.prototype = prototype;\r\n    var result = new Ctor;\r\n    Ctor.prototype = null;\r\n    return result;\r\n  };\r\n\r\n  var shallowProperty = function(key) {\r\n    return function(obj) {\r\n      return obj == null ? void 0 : obj[key];\r\n    };\r\n  };\r\n\r\n  var has = function(obj, path) {\r\n    return obj != null && hasOwnProperty.call(obj, path);\r\n  }\r\n\r\n  var deepGet = function(obj, path) {\r\n    var length = path.length;\r\n    for (var i = 0; i < length; i++) {\r\n      if (obj == null) return void 0;\r\n      obj = obj[path[i]];\r\n    }\r\n    return length ? obj : void 0;\r\n  };\r\n\r\n  // Helper for collection methods to determine whether a collection\r\n  // should be iterated as an array or as an object.\r\n  // Related: http://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength\r\n  // Avoids a very nasty iOS 8 JIT bug on ARM-64. #2094\r\n  var MAX_ARRAY_INDEX = Math.pow(2, 53) - 1;\r\n  var getLength = shallowProperty('length');\r\n  var isArrayLike = function(collection) {\r\n    var length = getLength(collection);\r\n    return typeof length == 'number' && length >= 0 && length <= MAX_ARRAY_INDEX;\r\n  };\r\n\r\n  // Collection Functions\r\n  // --------------------\r\n\r\n  // The cornerstone, an `each` implementation, aka `forEach`.\r\n  // Handles raw objects in addition to array-likes. Treats all\r\n  // sparse array-likes as if they were dense.\r\n  _.each = _.forEach = function(obj, iteratee, context) {\r\n    iteratee = optimizeCb(iteratee, context);\r\n    var i, length;\r\n    if (isArrayLike(obj)) {\r\n      for (i = 0, length = obj.length; i < length; i++) {\r\n        iteratee(obj[i], i, obj);\r\n      }\r\n    } else {\r\n      var keys = _.keys(obj);\r\n      for (i = 0, length = keys.length; i < length; i++) {\r\n        iteratee(obj[keys[i]], keys[i], obj);\r\n      }\r\n    }\r\n    return obj;\r\n  };\r\n\r\n  // Return the results of applying the iteratee to each element.\r\n  _.map = _.collect = function(obj, iteratee, context) {\r\n    iteratee = cb(iteratee, context);\r\n    var keys = !isArrayLike(obj) && _.keys(obj),\r\n        length = (keys || obj).length,\r\n        results = Array(length);\r\n    for (var index = 0; index < length; index++) {\r\n      var currentKey = keys ? keys[index] : index;\r\n      results[index] = iteratee(obj[currentKey], currentKey, obj);\r\n    }\r\n    return results;\r\n  };\r\n\r\n  // Create a reducing function iterating left or right.\r\n  var createReduce = function(dir) {\r\n    // Wrap code that reassigns argument variables in a separate function than\r\n    // the one that accesses `arguments.length` to avoid a perf hit. (#1991)\r\n    var reducer = function(obj, iteratee, memo, initial) {\r\n      var keys = !isArrayLike(obj) && _.keys(obj),\r\n          length = (keys || obj).length,\r\n          index = dir > 0 ? 0 : length - 1;\r\n      if (!initial) {\r\n        memo = obj[keys ? keys[index] : index];\r\n        index += dir;\r\n      }\r\n      for (; index >= 0 && index < length; index += dir) {\r\n        var currentKey = keys ? keys[index] : index;\r\n        memo = iteratee(memo, obj[currentKey], currentKey, obj);\r\n      }\r\n      return memo;\r\n    };\r\n\r\n    return function(obj, iteratee, memo, context) {\r\n      var initial = arguments.length >= 3;\r\n      return reducer(obj, optimizeCb(iteratee, context, 4), memo, initial);\r\n    };\r\n  };\r\n\r\n  // **Reduce** builds up a single result from a list of values, aka `inject`,\r\n  // or `foldl`.\r\n  _.reduce = _.foldl = _.inject = createReduce(1);\r\n\r\n  // The right-associative version of reduce, also known as `foldr`.\r\n  _.reduceRight = _.foldr = createReduce(-1);\r\n\r\n  // Return the first value which passes a truth test. Aliased as `detect`.\r\n  _.find = _.detect = function(obj, predicate, context) {\r\n    var keyFinder = isArrayLike(obj) ? _.findIndex : _.findKey;\r\n    var key = keyFinder(obj, predicate, context);\r\n    if (key !== void 0 && key !== -1) return obj[key];\r\n  };\r\n\r\n  // Return all the elements that pass a truth test.\r\n  // Aliased as `select`.\r\n  _.filter = _.select = function(obj, predicate, context) {\r\n    var results = [];\r\n    predicate = cb(predicate, context);\r\n    _.each(obj, function(value, index, list) {\r\n      if (predicate(value, index, list)) results.push(value);\r\n    });\r\n    return results;\r\n  };\r\n\r\n  // Return all the elements for which a truth test fails.\r\n  _.reject = function(obj, predicate, context) {\r\n    return _.filter(obj, _.negate(cb(predicate)), context);\r\n  };\r\n\r\n  // Determine whether all of the elements match a truth test.\r\n  // Aliased as `all`.\r\n  _.every = _.all = function(obj, predicate, context) {\r\n    predicate = cb(predicate, context);\r\n    var keys = !isArrayLike(obj) && _.keys(obj),\r\n        length = (keys || obj).length;\r\n    for (var index = 0; index < length; index++) {\r\n      var currentKey = keys ? keys[index] : index;\r\n      if (!predicate(obj[currentKey], currentKey, obj)) return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  // Determine if at least one element in the object matches a truth test.\r\n  // Aliased as `any`.\r\n  _.some = _.any = function(obj, predicate, context) {\r\n    predicate = cb(predicate, context);\r\n    var keys = !isArrayLike(obj) && _.keys(obj),\r\n        length = (keys || obj).length;\r\n    for (var index = 0; index < length; index++) {\r\n      var currentKey = keys ? keys[index] : index;\r\n      if (predicate(obj[currentKey], currentKey, obj)) return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  // Determine if the array or object contains a given item (using `===`).\r\n  // Aliased as `includes` and `include`.\r\n  _.contains = _.includes = _.include = function(obj, item, fromIndex, guard) {\r\n    if (!isArrayLike(obj)) obj = _.values(obj);\r\n    if (typeof fromIndex != 'number' || guard) fromIndex = 0;\r\n    return _.indexOf(obj, item, fromIndex) >= 0;\r\n  };\r\n\r\n  // Invoke a method (with arguments) on every item in a collection.\r\n  _.invoke = restArguments(function(obj, path, args) {\r\n    var contextPath, func;\r\n    if (_.isFunction(path)) {\r\n      func = path;\r\n    } else if (_.isArray(path)) {\r\n      contextPath = path.slice(0, -1);\r\n      path = path[path.length - 1];\r\n    }\r\n    return _.map(obj, function(context) {\r\n      var method = func;\r\n      if (!method) {\r\n        if (contextPath && contextPath.length) {\r\n          context = deepGet(context, contextPath);\r\n        }\r\n        if (context == null) return void 0;\r\n        method = context[path];\r\n      }\r\n      return method == null ? method : method.apply(context, args);\r\n    });\r\n  });\r\n\r\n  // Convenience version of a common use case of `map`: fetching a property.\r\n  _.pluck = function(obj, key) {\r\n    return _.map(obj, _.property(key));\r\n  };\r\n\r\n  // Convenience version of a common use case of `filter`: selecting only objects\r\n  // containing specific `key:value` pairs.\r\n  _.where = function(obj, attrs) {\r\n    return _.filter(obj, _.matcher(attrs));\r\n  };\r\n\r\n  // Convenience version of a common use case of `find`: getting the first object\r\n  // containing specific `key:value` pairs.\r\n  _.findWhere = function(obj, attrs) {\r\n    return _.find(obj, _.matcher(attrs));\r\n  };\r\n\r\n  // Return the maximum element (or element-based computation).\r\n  _.max = function(obj, iteratee, context) {\r\n    var result = -Infinity, lastComputed = -Infinity,\r\n        value, computed;\r\n    if (iteratee == null || typeof iteratee == 'number' && typeof obj[0] != 'object' && obj != null) {\r\n      obj = isArrayLike(obj) ? obj : _.values(obj);\r\n      for (var i = 0, length = obj.length; i < length; i++) {\r\n        value = obj[i];\r\n        if (value != null && value > result) {\r\n          result = value;\r\n        }\r\n      }\r\n    } else {\r\n      iteratee = cb(iteratee, context);\r\n      _.each(obj, function(v, index, list) {\r\n        computed = iteratee(v, index, list);\r\n        if (computed > lastComputed || computed === -Infinity && result === -Infinity) {\r\n          result = v;\r\n          lastComputed = computed;\r\n        }\r\n      });\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Return the minimum element (or element-based computation).\r\n  _.min = function(obj, iteratee, context) {\r\n    var result = Infinity, lastComputed = Infinity,\r\n        value, computed;\r\n    if (iteratee == null || typeof iteratee == 'number' && typeof obj[0] != 'object' && obj != null) {\r\n      obj = isArrayLike(obj) ? obj : _.values(obj);\r\n      for (var i = 0, length = obj.length; i < length; i++) {\r\n        value = obj[i];\r\n        if (value != null && value < result) {\r\n          result = value;\r\n        }\r\n      }\r\n    } else {\r\n      iteratee = cb(iteratee, context);\r\n      _.each(obj, function(v, index, list) {\r\n        computed = iteratee(v, index, list);\r\n        if (computed < lastComputed || computed === Infinity && result === Infinity) {\r\n          result = v;\r\n          lastComputed = computed;\r\n        }\r\n      });\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Shuffle a collection.\r\n  _.shuffle = function(obj) {\r\n    return _.sample(obj, Infinity);\r\n  };\r\n\r\n  // Sample **n** random values from a collection using the modern version of the\r\n  // [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/FisherYates_shuffle).\r\n  // If **n** is not specified, returns a single random element.\r\n  // The internal `guard` argument allows it to work with `map`.\r\n  _.sample = function(obj, n, guard) {\r\n    if (n == null || guard) {\r\n      if (!isArrayLike(obj)) obj = _.values(obj);\r\n      return obj[_.random(obj.length - 1)];\r\n    }\r\n    var sample = isArrayLike(obj) ? _.clone(obj) : _.values(obj);\r\n    var length = getLength(sample);\r\n    n = Math.max(Math.min(n, length), 0);\r\n    var last = length - 1;\r\n    for (var index = 0; index < n; index++) {\r\n      var rand = _.random(index, last);\r\n      var temp = sample[index];\r\n      sample[index] = sample[rand];\r\n      sample[rand] = temp;\r\n    }\r\n    return sample.slice(0, n);\r\n  };\r\n\r\n  // Sort the object's values by a criterion produced by an iteratee.\r\n  _.sortBy = function(obj, iteratee, context) {\r\n    var index = 0;\r\n    iteratee = cb(iteratee, context);\r\n    return _.pluck(_.map(obj, function(value, key, list) {\r\n      return {\r\n        value: value,\r\n        index: index++,\r\n        criteria: iteratee(value, key, list)\r\n      };\r\n    }).sort(function(left, right) {\r\n      var a = left.criteria;\r\n      var b = right.criteria;\r\n      if (a !== b) {\r\n        if (a > b || a === void 0) return 1;\r\n        if (a < b || b === void 0) return -1;\r\n      }\r\n      return left.index - right.index;\r\n    }), 'value');\r\n  };\r\n\r\n  // An internal function used for aggregate \"group by\" operations.\r\n  var group = function(behavior, partition) {\r\n    return function(obj, iteratee, context) {\r\n      var result = partition ? [[], []] : {};\r\n      iteratee = cb(iteratee, context);\r\n      _.each(obj, function(value, index) {\r\n        var key = iteratee(value, index, obj);\r\n        behavior(result, value, key);\r\n      });\r\n      return result;\r\n    };\r\n  };\r\n\r\n  // Groups the object's values by a criterion. Pass either a string attribute\r\n  // to group by, or a function that returns the criterion.\r\n  _.groupBy = group(function(result, value, key) {\r\n    if (has(result, key)) result[key].push(value); else result[key] = [value];\r\n  });\r\n\r\n  // Indexes the object's values by a criterion, similar to `groupBy`, but for\r\n  // when you know that your index values will be unique.\r\n  _.indexBy = group(function(result, value, key) {\r\n    result[key] = value;\r\n  });\r\n\r\n  // Counts instances of an object that group by a certain criterion. Pass\r\n  // either a string attribute to count by, or a function that returns the\r\n  // criterion.\r\n  _.countBy = group(function(result, value, key) {\r\n    if (has(result, key)) result[key]++; else result[key] = 1;\r\n  });\r\n\r\n  var reStrSymbol = /[^\\ud800-\\udfff]|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\ud800-\\udfff]/g;\r\n  // Safely create a real, live array from anything iterable.\r\n  _.toArray = function(obj) {\r\n    if (!obj) return [];\r\n    if (_.isArray(obj)) return slice.call(obj);\r\n    if (_.isString(obj)) {\r\n      // Keep surrogate pair characters together\r\n      return obj.match(reStrSymbol);\r\n    }\r\n    if (isArrayLike(obj)) return _.map(obj, _.identity);\r\n    return _.values(obj);\r\n  };\r\n\r\n  // Return the number of elements in an object.\r\n  _.size = function(obj) {\r\n    if (obj == null) return 0;\r\n    return isArrayLike(obj) ? obj.length : _.keys(obj).length;\r\n  };\r\n\r\n  // Split a collection into two arrays: one whose elements all satisfy the given\r\n  // predicate, and one whose elements all do not satisfy the predicate.\r\n  _.partition = group(function(result, value, pass) {\r\n    result[pass ? 0 : 1].push(value);\r\n  }, true);\r\n\r\n  // Array Functions\r\n  // ---------------\r\n\r\n  // Get the first element of an array. Passing **n** will return the first N\r\n  // values in the array. Aliased as `head` and `take`. The **guard** check\r\n  // allows it to work with `_.map`.\r\n  _.first = _.head = _.take = function(array, n, guard) {\r\n    if (array == null || array.length < 1) return n == null ? void 0 : [];\r\n    if (n == null || guard) return array[0];\r\n    return _.initial(array, array.length - n);\r\n  };\r\n\r\n  // Returns everything but the last entry of the array. Especially useful on\r\n  // the arguments object. Passing **n** will return all the values in\r\n  // the array, excluding the last N.\r\n  _.initial = function(array, n, guard) {\r\n    return slice.call(array, 0, Math.max(0, array.length - (n == null || guard ? 1 : n)));\r\n  };\r\n\r\n  // Get the last element of an array. Passing **n** will return the last N\r\n  // values in the array.\r\n  _.last = function(array, n, guard) {\r\n    if (array == null || array.length < 1) return n == null ? void 0 : [];\r\n    if (n == null || guard) return array[array.length - 1];\r\n    return _.rest(array, Math.max(0, array.length - n));\r\n  };\r\n\r\n  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.\r\n  // Especially useful on the arguments object. Passing an **n** will return\r\n  // the rest N values in the array.\r\n  _.rest = _.tail = _.drop = function(array, n, guard) {\r\n    return slice.call(array, n == null || guard ? 1 : n);\r\n  };\r\n\r\n  // Trim out all falsy values from an array.\r\n  _.compact = function(array) {\r\n    return _.filter(array, Boolean);\r\n  };\r\n\r\n  // Internal implementation of a recursive `flatten` function.\r\n  var flatten = function(input, shallow, strict, output) {\r\n    output = output || [];\r\n    var idx = output.length;\r\n    for (var i = 0, length = getLength(input); i < length; i++) {\r\n      var value = input[i];\r\n      if (isArrayLike(value) && (_.isArray(value) || _.isArguments(value))) {\r\n        // Flatten current level of array or arguments object.\r\n        if (shallow) {\r\n          var j = 0, len = value.length;\r\n          while (j < len) output[idx++] = value[j++];\r\n        } else {\r\n          flatten(value, shallow, strict, output);\r\n          idx = output.length;\r\n        }\r\n      } else if (!strict) {\r\n        output[idx++] = value;\r\n      }\r\n    }\r\n    return output;\r\n  };\r\n\r\n  // Flatten out an array, either recursively (by default), or just one level.\r\n  _.flatten = function(array, shallow) {\r\n    return flatten(array, shallow, false);\r\n  };\r\n\r\n  // Return a version of the array that does not contain the specified value(s).\r\n  _.without = restArguments(function(array, otherArrays) {\r\n    return _.difference(array, otherArrays);\r\n  });\r\n\r\n  // Produce a duplicate-free version of the array. If the array has already\r\n  // been sorted, you have the option of using a faster algorithm.\r\n  // The faster algorithm will not work with an iteratee if the iteratee\r\n  // is not a one-to-one function, so providing an iteratee will disable\r\n  // the faster algorithm.\r\n  // Aliased as `unique`.\r\n  _.uniq = _.unique = function(array, isSorted, iteratee, context) {\r\n    if (!_.isBoolean(isSorted)) {\r\n      context = iteratee;\r\n      iteratee = isSorted;\r\n      isSorted = false;\r\n    }\r\n    if (iteratee != null) iteratee = cb(iteratee, context);\r\n    var result = [];\r\n    var seen = [];\r\n    for (var i = 0, length = getLength(array); i < length; i++) {\r\n      var value = array[i],\r\n          computed = iteratee ? iteratee(value, i, array) : value;\r\n      if (isSorted && !iteratee) {\r\n        if (!i || seen !== computed) result.push(value);\r\n        seen = computed;\r\n      } else if (iteratee) {\r\n        if (!_.contains(seen, computed)) {\r\n          seen.push(computed);\r\n          result.push(value);\r\n        }\r\n      } else if (!_.contains(result, value)) {\r\n        result.push(value);\r\n      }\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Produce an array that contains the union: each distinct element from all of\r\n  // the passed-in arrays.\r\n  _.union = restArguments(function(arrays) {\r\n    return _.uniq(flatten(arrays, true, true));\r\n  });\r\n\r\n  // Produce an array that contains every item shared between all the\r\n  // passed-in arrays.\r\n  _.intersection = function(array) {\r\n    var result = [];\r\n    var argsLength = arguments.length;\r\n    for (var i = 0, length = getLength(array); i < length; i++) {\r\n      var item = array[i];\r\n      if (_.contains(result, item)) continue;\r\n      var j;\r\n      for (j = 1; j < argsLength; j++) {\r\n        if (!_.contains(arguments[j], item)) break;\r\n      }\r\n      if (j === argsLength) result.push(item);\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Take the difference between one array and a number of other arrays.\r\n  // Only the elements present in just the first array will remain.\r\n  _.difference = restArguments(function(array, rest) {\r\n    rest = flatten(rest, true, true);\r\n    return _.filter(array, function(value){\r\n      return !_.contains(rest, value);\r\n    });\r\n  });\r\n\r\n  // Complement of _.zip. Unzip accepts an array of arrays and groups\r\n  // each array's elements on shared indices.\r\n  _.unzip = function(array) {\r\n    var length = array && _.max(array, getLength).length || 0;\r\n    var result = Array(length);\r\n\r\n    for (var index = 0; index < length; index++) {\r\n      result[index] = _.pluck(array, index);\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Zip together multiple lists into a single array -- elements that share\r\n  // an index go together.\r\n  _.zip = restArguments(_.unzip);\r\n\r\n  // Converts lists into objects. Pass either a single array of `[key, value]`\r\n  // pairs, or two parallel arrays of the same length -- one of keys, and one of\r\n  // the corresponding values. Passing by pairs is the reverse of _.pairs.\r\n  _.object = function(list, values) {\r\n    var result = {};\r\n    for (var i = 0, length = getLength(list); i < length; i++) {\r\n      if (values) {\r\n        result[list[i]] = values[i];\r\n      } else {\r\n        result[list[i][0]] = list[i][1];\r\n      }\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Generator function to create the findIndex and findLastIndex functions.\r\n  var createPredicateIndexFinder = function(dir) {\r\n    return function(array, predicate, context) {\r\n      predicate = cb(predicate, context);\r\n      var length = getLength(array);\r\n      var index = dir > 0 ? 0 : length - 1;\r\n      for (; index >= 0 && index < length; index += dir) {\r\n        if (predicate(array[index], index, array)) return index;\r\n      }\r\n      return -1;\r\n    };\r\n  };\r\n\r\n  // Returns the first index on an array-like that passes a predicate test.\r\n  _.findIndex = createPredicateIndexFinder(1);\r\n  _.findLastIndex = createPredicateIndexFinder(-1);\r\n\r\n  // Use a comparator function to figure out the smallest index at which\r\n  // an object should be inserted so as to maintain order. Uses binary search.\r\n  _.sortedIndex = function(array, obj, iteratee, context) {\r\n    iteratee = cb(iteratee, context, 1);\r\n    var value = iteratee(obj);\r\n    var low = 0, high = getLength(array);\r\n    while (low < high) {\r\n      var mid = Math.floor((low + high) / 2);\r\n      if (iteratee(array[mid]) < value) low = mid + 1; else high = mid;\r\n    }\r\n    return low;\r\n  };\r\n\r\n  // Generator function to create the indexOf and lastIndexOf functions.\r\n  var createIndexFinder = function(dir, predicateFind, sortedIndex) {\r\n    return function(array, item, idx) {\r\n      var i = 0, length = getLength(array);\r\n      if (typeof idx == 'number') {\r\n        if (dir > 0) {\r\n          i = idx >= 0 ? idx : Math.max(idx + length, i);\r\n        } else {\r\n          length = idx >= 0 ? Math.min(idx + 1, length) : idx + length + 1;\r\n        }\r\n      } else if (sortedIndex && idx && length) {\r\n        idx = sortedIndex(array, item);\r\n        return array[idx] === item ? idx : -1;\r\n      }\r\n      if (item !== item) {\r\n        idx = predicateFind(slice.call(array, i, length), _.isNaN);\r\n        return idx >= 0 ? idx + i : -1;\r\n      }\r\n      for (idx = dir > 0 ? i : length - 1; idx >= 0 && idx < length; idx += dir) {\r\n        if (array[idx] === item) return idx;\r\n      }\r\n      return -1;\r\n    };\r\n  };\r\n\r\n  // Return the position of the first occurrence of an item in an array,\r\n  // or -1 if the item is not included in the array.\r\n  // If the array is large and already in sort order, pass `true`\r\n  // for **isSorted** to use binary search.\r\n  _.indexOf = createIndexFinder(1, _.findIndex, _.sortedIndex);\r\n  _.lastIndexOf = createIndexFinder(-1, _.findLastIndex);\r\n\r\n  // Generate an integer Array containing an arithmetic progression. A port of\r\n  // the native Python `range()` function. See\r\n  // [the Python documentation](http://docs.python.org/library/functions.html#range).\r\n  _.range = function(start, stop, step) {\r\n    if (stop == null) {\r\n      stop = start || 0;\r\n      start = 0;\r\n    }\r\n    if (!step) {\r\n      step = stop < start ? -1 : 1;\r\n    }\r\n\r\n    var length = Math.max(Math.ceil((stop - start) / step), 0);\r\n    var range = Array(length);\r\n\r\n    for (var idx = 0; idx < length; idx++, start += step) {\r\n      range[idx] = start;\r\n    }\r\n\r\n    return range;\r\n  };\r\n\r\n  // Chunk a single array into multiple arrays, each containing `count` or fewer\r\n  // items.\r\n  _.chunk = function(array, count) {\r\n    if (count == null || count < 1) return [];\r\n    var result = [];\r\n    var i = 0, length = array.length;\r\n    while (i < length) {\r\n      result.push(slice.call(array, i, i += count));\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Function (ahem) Functions\r\n  // ------------------\r\n\r\n  // Determines whether to execute a function as a constructor\r\n  // or a normal function with the provided arguments.\r\n  var executeBound = function(sourceFunc, boundFunc, context, callingContext, args) {\r\n    if (!(callingContext instanceof boundFunc)) return sourceFunc.apply(context, args);\r\n    var self = baseCreate(sourceFunc.prototype);\r\n    var result = sourceFunc.apply(self, args);\r\n    if (_.isObject(result)) return result;\r\n    return self;\r\n  };\r\n\r\n  // Create a function bound to a given object (assigning `this`, and arguments,\r\n  // optionally). Delegates to **ECMAScript 5**'s native `Function.bind` if\r\n  // available.\r\n  _.bind = restArguments(function(func, context, args) {\r\n    if (!_.isFunction(func)) throw new TypeError('Bind must be called on a function');\r\n    var bound = restArguments(function(callArgs) {\r\n      return executeBound(func, bound, context, this, args.concat(callArgs));\r\n    });\r\n    return bound;\r\n  });\r\n\r\n  // Partially apply a function by creating a version that has had some of its\r\n  // arguments pre-filled, without changing its dynamic `this` context. _ acts\r\n  // as a placeholder by default, allowing any combination of arguments to be\r\n  // pre-filled. Set `_.partial.placeholder` for a custom placeholder argument.\r\n  _.partial = restArguments(function(func, boundArgs) {\r\n    var placeholder = _.partial.placeholder;\r\n    var bound = function() {\r\n      var position = 0, length = boundArgs.length;\r\n      var args = Array(length);\r\n      for (var i = 0; i < length; i++) {\r\n        args[i] = boundArgs[i] === placeholder ? arguments[position++] : boundArgs[i];\r\n      }\r\n      while (position < arguments.length) args.push(arguments[position++]);\r\n      return executeBound(func, bound, this, this, args);\r\n    };\r\n    return bound;\r\n  });\r\n\r\n  _.partial.placeholder = _;\r\n\r\n  // Bind a number of an object's methods to that object. Remaining arguments\r\n  // are the method names to be bound. Useful for ensuring that all callbacks\r\n  // defined on an object belong to it.\r\n  _.bindAll = restArguments(function(obj, keys) {\r\n    keys = flatten(keys, false, false);\r\n    var index = keys.length;\r\n    if (index < 1) throw new Error('bindAll must be passed function names');\r\n    while (index--) {\r\n      var key = keys[index];\r\n      obj[key] = _.bind(obj[key], obj);\r\n    }\r\n  });\r\n\r\n  // Memoize an expensive function by storing its results.\r\n  _.memoize = function(func, hasher) {\r\n    var memoize = function(key) {\r\n      var cache = memoize.cache;\r\n      var address = '' + (hasher ? hasher.apply(this, arguments) : key);\r\n      if (!has(cache, address)) cache[address] = func.apply(this, arguments);\r\n      return cache[address];\r\n    };\r\n    memoize.cache = {};\r\n    return memoize;\r\n  };\r\n\r\n  // Delays a function for the given number of milliseconds, and then calls\r\n  // it with the arguments supplied.\r\n  _.delay = restArguments(function(func, wait, args) {\r\n    return setTimeout(function() {\r\n      return func.apply(null, args);\r\n    }, wait);\r\n  });\r\n\r\n  // Defers a function, scheduling it to run after the current call stack has\r\n  // cleared.\r\n  _.defer = _.partial(_.delay, _, 1);\r\n\r\n  // Returns a function, that, when invoked, will only be triggered at most once\r\n  // during a given window of time. Normally, the throttled function will run\r\n  // as much as it can, without ever going more than once per `wait` duration;\r\n  // but if you'd like to disable the execution on the leading edge, pass\r\n  // `{leading: false}`. To disable execution on the trailing edge, ditto.\r\n  _.throttle = function(func, wait, options) {\r\n    var timeout, context, args, result;\r\n    var previous = 0;\r\n    if (!options) options = {};\r\n\r\n    var later = function() {\r\n      previous = options.leading === false ? 0 : _.now();\r\n      timeout = null;\r\n      result = func.apply(context, args);\r\n      if (!timeout) context = args = null;\r\n    };\r\n\r\n    var throttled = function() {\r\n      var now = _.now();\r\n      if (!previous && options.leading === false) previous = now;\r\n      var remaining = wait - (now - previous);\r\n      context = this;\r\n      args = arguments;\r\n      if (remaining <= 0 || remaining > wait) {\r\n        if (timeout) {\r\n          clearTimeout(timeout);\r\n          timeout = null;\r\n        }\r\n        previous = now;\r\n        result = func.apply(context, args);\r\n        if (!timeout) context = args = null;\r\n      } else if (!timeout && options.trailing !== false) {\r\n        timeout = setTimeout(later, remaining);\r\n      }\r\n      return result;\r\n    };\r\n\r\n    throttled.cancel = function() {\r\n      clearTimeout(timeout);\r\n      previous = 0;\r\n      timeout = context = args = null;\r\n    };\r\n\r\n    return throttled;\r\n  };\r\n\r\n  // Returns a function, that, as long as it continues to be invoked, will not\r\n  // be triggered. The function will be called after it stops being called for\r\n  // N milliseconds. If `immediate` is passed, trigger the function on the\r\n  // leading edge, instead of the trailing.\r\n  _.debounce = function(func, wait, immediate) {\r\n    var timeout, result;\r\n\r\n    var later = function(context, args) {\r\n      timeout = null;\r\n      if (args) result = func.apply(context, args);\r\n    };\r\n\r\n    var debounced = restArguments(function(args) {\r\n      if (timeout) clearTimeout(timeout);\r\n      if (immediate) {\r\n        var callNow = !timeout;\r\n        timeout = setTimeout(later, wait);\r\n        if (callNow) result = func.apply(this, args);\r\n      } else {\r\n        timeout = _.delay(later, wait, this, args);\r\n      }\r\n\r\n      return result;\r\n    });\r\n\r\n    debounced.cancel = function() {\r\n      clearTimeout(timeout);\r\n      timeout = null;\r\n    };\r\n\r\n    return debounced;\r\n  };\r\n\r\n  // Returns the first function passed as an argument to the second,\r\n  // allowing you to adjust arguments, run code before and after, and\r\n  // conditionally execute the original function.\r\n  _.wrap = function(func, wrapper) {\r\n    return _.partial(wrapper, func);\r\n  };\r\n\r\n  // Returns a negated version of the passed-in predicate.\r\n  _.negate = function(predicate) {\r\n    return function() {\r\n      return !predicate.apply(this, arguments);\r\n    };\r\n  };\r\n\r\n  // Returns a function that is the composition of a list of functions, each\r\n  // consuming the return value of the function that follows.\r\n  _.compose = function() {\r\n    var args = arguments;\r\n    var start = args.length - 1;\r\n    return function() {\r\n      var i = start;\r\n      var result = args[start].apply(this, arguments);\r\n      while (i--) result = args[i].call(this, result);\r\n      return result;\r\n    };\r\n  };\r\n\r\n  // Returns a function that will only be executed on and after the Nth call.\r\n  _.after = function(times, func) {\r\n    return function() {\r\n      if (--times < 1) {\r\n        return func.apply(this, arguments);\r\n      }\r\n    };\r\n  };\r\n\r\n  // Returns a function that will only be executed up to (but not including) the Nth call.\r\n  _.before = function(times, func) {\r\n    var memo;\r\n    return function() {\r\n      if (--times > 0) {\r\n        memo = func.apply(this, arguments);\r\n      }\r\n      if (times <= 1) func = null;\r\n      return memo;\r\n    };\r\n  };\r\n\r\n  // Returns a function that will be executed at most one time, no matter how\r\n  // often you call it. Useful for lazy initialization.\r\n  _.once = _.partial(_.before, 2);\r\n\r\n  _.restArguments = restArguments;\r\n\r\n  // Object Functions\r\n  // ----------------\r\n\r\n  // Keys in IE < 9 that won't be iterated by `for key in ...` and thus missed.\r\n  var hasEnumBug = !{toString: null}.propertyIsEnumerable('toString');\r\n  var nonEnumerableProps = ['valueOf', 'isPrototypeOf', 'toString',\r\n    'propertyIsEnumerable', 'hasOwnProperty', 'toLocaleString'];\r\n\r\n  var collectNonEnumProps = function(obj, keys) {\r\n    var nonEnumIdx = nonEnumerableProps.length;\r\n    var constructor = obj.constructor;\r\n    var proto = _.isFunction(constructor) && constructor.prototype || ObjProto;\r\n\r\n    // Constructor is a special case.\r\n    var prop = 'constructor';\r\n    if (has(obj, prop) && !_.contains(keys, prop)) keys.push(prop);\r\n\r\n    while (nonEnumIdx--) {\r\n      prop = nonEnumerableProps[nonEnumIdx];\r\n      if (prop in obj && obj[prop] !== proto[prop] && !_.contains(keys, prop)) {\r\n        keys.push(prop);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Retrieve the names of an object's own properties.\r\n  // Delegates to **ECMAScript 5**'s native `Object.keys`.\r\n  _.keys = function(obj) {\r\n    if (!_.isObject(obj)) return [];\r\n    if (nativeKeys) return nativeKeys(obj);\r\n    var keys = [];\r\n    for (var key in obj) if (has(obj, key)) keys.push(key);\r\n    // Ahem, IE < 9.\r\n    if (hasEnumBug) collectNonEnumProps(obj, keys);\r\n    return keys;\r\n  };\r\n\r\n  // Retrieve all the property names of an object.\r\n  _.allKeys = function(obj) {\r\n    if (!_.isObject(obj)) return [];\r\n    var keys = [];\r\n    for (var key in obj) keys.push(key);\r\n    // Ahem, IE < 9.\r\n    if (hasEnumBug) collectNonEnumProps(obj, keys);\r\n    return keys;\r\n  };\r\n\r\n  // Retrieve the values of an object's properties.\r\n  _.values = function(obj) {\r\n    var keys = _.keys(obj);\r\n    var length = keys.length;\r\n    var values = Array(length);\r\n    for (var i = 0; i < length; i++) {\r\n      values[i] = obj[keys[i]];\r\n    }\r\n    return values;\r\n  };\r\n\r\n  // Returns the results of applying the iteratee to each element of the object.\r\n  // In contrast to _.map it returns an object.\r\n  _.mapObject = function(obj, iteratee, context) {\r\n    iteratee = cb(iteratee, context);\r\n    var keys = _.keys(obj),\r\n        length = keys.length,\r\n        results = {};\r\n    for (var index = 0; index < length; index++) {\r\n      var currentKey = keys[index];\r\n      results[currentKey] = iteratee(obj[currentKey], currentKey, obj);\r\n    }\r\n    return results;\r\n  };\r\n\r\n  // Convert an object into a list of `[key, value]` pairs.\r\n  // The opposite of _.object.\r\n  _.pairs = function(obj) {\r\n    var keys = _.keys(obj);\r\n    var length = keys.length;\r\n    var pairs = Array(length);\r\n    for (var i = 0; i < length; i++) {\r\n      pairs[i] = [keys[i], obj[keys[i]]];\r\n    }\r\n    return pairs;\r\n  };\r\n\r\n  // Invert the keys and values of an object. The values must be serializable.\r\n  _.invert = function(obj) {\r\n    var result = {};\r\n    var keys = _.keys(obj);\r\n    for (var i = 0, length = keys.length; i < length; i++) {\r\n      result[obj[keys[i]]] = keys[i];\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Return a sorted list of the function names available on the object.\r\n  // Aliased as `methods`.\r\n  _.functions = _.methods = function(obj) {\r\n    var names = [];\r\n    for (var key in obj) {\r\n      if (_.isFunction(obj[key])) names.push(key);\r\n    }\r\n    return names.sort();\r\n  };\r\n\r\n  // An internal function for creating assigner functions.\r\n  var createAssigner = function(keysFunc, defaults) {\r\n    return function(obj) {\r\n      var length = arguments.length;\r\n      if (defaults) obj = Object(obj);\r\n      if (length < 2 || obj == null) return obj;\r\n      for (var index = 1; index < length; index++) {\r\n        var source = arguments[index],\r\n            keys = keysFunc(source),\r\n            l = keys.length;\r\n        for (var i = 0; i < l; i++) {\r\n          var key = keys[i];\r\n          if (!defaults || obj[key] === void 0) obj[key] = source[key];\r\n        }\r\n      }\r\n      return obj;\r\n    };\r\n  };\r\n\r\n  // Extend a given object with all the properties in passed-in object(s).\r\n  _.extend = createAssigner(_.allKeys);\r\n\r\n  // Assigns a given object with all the own properties in the passed-in object(s).\r\n  // (https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)\r\n  _.extendOwn = _.assign = createAssigner(_.keys);\r\n\r\n  // Returns the first key on an object that passes a predicate test.\r\n  _.findKey = function(obj, predicate, context) {\r\n    predicate = cb(predicate, context);\r\n    var keys = _.keys(obj), key;\r\n    for (var i = 0, length = keys.length; i < length; i++) {\r\n      key = keys[i];\r\n      if (predicate(obj[key], key, obj)) return key;\r\n    }\r\n  };\r\n\r\n  // Internal pick helper function to determine if `obj` has key `key`.\r\n  var keyInObj = function(value, key, obj) {\r\n    return key in obj;\r\n  };\r\n\r\n  // Return a copy of the object only containing the whitelisted properties.\r\n  _.pick = restArguments(function(obj, keys) {\r\n    var result = {}, iteratee = keys[0];\r\n    if (obj == null) return result;\r\n    if (_.isFunction(iteratee)) {\r\n      if (keys.length > 1) iteratee = optimizeCb(iteratee, keys[1]);\r\n      keys = _.allKeys(obj);\r\n    } else {\r\n      iteratee = keyInObj;\r\n      keys = flatten(keys, false, false);\r\n      obj = Object(obj);\r\n    }\r\n    for (var i = 0, length = keys.length; i < length; i++) {\r\n      var key = keys[i];\r\n      var value = obj[key];\r\n      if (iteratee(value, key, obj)) result[key] = value;\r\n    }\r\n    return result;\r\n  });\r\n\r\n  // Return a copy of the object without the blacklisted properties.\r\n  _.omit = restArguments(function(obj, keys) {\r\n    var iteratee = keys[0], context;\r\n    if (_.isFunction(iteratee)) {\r\n      iteratee = _.negate(iteratee);\r\n      if (keys.length > 1) context = keys[1];\r\n    } else {\r\n      keys = _.map(flatten(keys, false, false), String);\r\n      iteratee = function(value, key) {\r\n        return !_.contains(keys, key);\r\n      };\r\n    }\r\n    return _.pick(obj, iteratee, context);\r\n  });\r\n\r\n  // Fill in a given object with default properties.\r\n  _.defaults = createAssigner(_.allKeys, true);\r\n\r\n  // Creates an object that inherits from the given prototype object.\r\n  // If additional properties are provided then they will be added to the\r\n  // created object.\r\n  _.create = function(prototype, props) {\r\n    var result = baseCreate(prototype);\r\n    if (props) _.extendOwn(result, props);\r\n    return result;\r\n  };\r\n\r\n  // Create a (shallow-cloned) duplicate of an object.\r\n  _.clone = function(obj) {\r\n    if (!_.isObject(obj)) return obj;\r\n    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);\r\n  };\r\n\r\n  // Invokes interceptor with the obj, and then returns obj.\r\n  // The primary purpose of this method is to \"tap into\" a method chain, in\r\n  // order to perform operations on intermediate results within the chain.\r\n  _.tap = function(obj, interceptor) {\r\n    interceptor(obj);\r\n    return obj;\r\n  };\r\n\r\n  // Returns whether an object has a given set of `key:value` pairs.\r\n  _.isMatch = function(object, attrs) {\r\n    var keys = _.keys(attrs), length = keys.length;\r\n    if (object == null) return !length;\r\n    var obj = Object(object);\r\n    for (var i = 0; i < length; i++) {\r\n      var key = keys[i];\r\n      if (attrs[key] !== obj[key] || !(key in obj)) return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n\r\n  // Internal recursive comparison function for `isEqual`.\r\n  var eq, deepEq;\r\n  eq = function(a, b, aStack, bStack) {\r\n    // Identical objects are equal. `0 === -0`, but they aren't identical.\r\n    // See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).\r\n    if (a === b) return a !== 0 || 1 / a === 1 / b;\r\n    // `null` or `undefined` only equal to itself (strict comparison).\r\n    if (a == null || b == null) return false;\r\n    // `NaN`s are equivalent, but non-reflexive.\r\n    if (a !== a) return b !== b;\r\n    // Exhaust primitive checks\r\n    var type = typeof a;\r\n    if (type !== 'function' && type !== 'object' && typeof b != 'object') return false;\r\n    return deepEq(a, b, aStack, bStack);\r\n  };\r\n\r\n  // Internal recursive comparison function for `isEqual`.\r\n  deepEq = function(a, b, aStack, bStack) {\r\n    // Unwrap any wrapped objects.\r\n    if (a instanceof _) a = a._wrapped;\r\n    if (b instanceof _) b = b._wrapped;\r\n    // Compare `[[Class]]` names.\r\n    var className = toString.call(a);\r\n    if (className !== toString.call(b)) return false;\r\n    switch (className) {\r\n      // Strings, numbers, regular expressions, dates, and booleans are compared by value.\r\n      case '[object RegExp]':\r\n      // RegExps are coerced to strings for comparison (Note: '' + /a/i === '/a/i')\r\n      case '[object String]':\r\n        // Primitives and their corresponding object wrappers are equivalent; thus, `\"5\"` is\r\n        // equivalent to `new String(\"5\")`.\r\n        return '' + a === '' + b;\r\n      case '[object Number]':\r\n        // `NaN`s are equivalent, but non-reflexive.\r\n        // Object(NaN) is equivalent to NaN.\r\n        if (+a !== +a) return +b !== +b;\r\n        // An `egal` comparison is performed for other numeric values.\r\n        return +a === 0 ? 1 / +a === 1 / b : +a === +b;\r\n      case '[object Date]':\r\n      case '[object Boolean]':\r\n        // Coerce dates and booleans to numeric primitive values. Dates are compared by their\r\n        // millisecond representations. Note that invalid dates with millisecond representations\r\n        // of `NaN` are not equivalent.\r\n        return +a === +b;\r\n      case '[object Symbol]':\r\n        return SymbolProto.valueOf.call(a) === SymbolProto.valueOf.call(b);\r\n    }\r\n\r\n    var areArrays = className === '[object Array]';\r\n    if (!areArrays) {\r\n      if (typeof a != 'object' || typeof b != 'object') return false;\r\n\r\n      // Objects with different constructors are not equivalent, but `Object`s or `Array`s\r\n      // from different frames are.\r\n      var aCtor = a.constructor, bCtor = b.constructor;\r\n      if (aCtor !== bCtor && !(_.isFunction(aCtor) && aCtor instanceof aCtor &&\r\n                               _.isFunction(bCtor) && bCtor instanceof bCtor)\r\n                          && ('constructor' in a && 'constructor' in b)) {\r\n        return false;\r\n      }\r\n    }\r\n    // Assume equality for cyclic structures. The algorithm for detecting cyclic\r\n    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.\r\n\r\n    // Initializing stack of traversed objects.\r\n    // It's done here since we only need them for objects and arrays comparison.\r\n    aStack = aStack || [];\r\n    bStack = bStack || [];\r\n    var length = aStack.length;\r\n    while (length--) {\r\n      // Linear search. Performance is inversely proportional to the number of\r\n      // unique nested structures.\r\n      if (aStack[length] === a) return bStack[length] === b;\r\n    }\r\n\r\n    // Add the first object to the stack of traversed objects.\r\n    aStack.push(a);\r\n    bStack.push(b);\r\n\r\n    // Recursively compare objects and arrays.\r\n    if (areArrays) {\r\n      // Compare array lengths to determine if a deep comparison is necessary.\r\n      length = a.length;\r\n      if (length !== b.length) return false;\r\n      // Deep compare the contents, ignoring non-numeric properties.\r\n      while (length--) {\r\n        if (!eq(a[length], b[length], aStack, bStack)) return false;\r\n      }\r\n    } else {\r\n      // Deep compare objects.\r\n      var keys = _.keys(a), key;\r\n      length = keys.length;\r\n      // Ensure that both objects contain the same number of properties before comparing deep equality.\r\n      if (_.keys(b).length !== length) return false;\r\n      while (length--) {\r\n        // Deep compare each member\r\n        key = keys[length];\r\n        if (!(has(b, key) && eq(a[key], b[key], aStack, bStack))) return false;\r\n      }\r\n    }\r\n    // Remove the first object from the stack of traversed objects.\r\n    aStack.pop();\r\n    bStack.pop();\r\n    return true;\r\n  };\r\n\r\n  // Perform a deep comparison to check if two objects are equal.\r\n  _.isEqual = function(a, b) {\r\n    return eq(a, b);\r\n  };\r\n\r\n  // Is a given array, string, or object empty?\r\n  // An \"empty\" object has no enumerable own-properties.\r\n  _.isEmpty = function(obj) {\r\n    if (obj == null) return true;\r\n    if (isArrayLike(obj) && (_.isArray(obj) || _.isString(obj) || _.isArguments(obj))) return obj.length === 0;\r\n    return _.keys(obj).length === 0;\r\n  };\r\n\r\n  // Is a given value a DOM element?\r\n  _.isElement = function(obj) {\r\n    return !!(obj && obj.nodeType === 1);\r\n  };\r\n\r\n  // Is a given value an array?\r\n  // Delegates to ECMA5's native Array.isArray\r\n  _.isArray = nativeIsArray || function(obj) {\r\n    return toString.call(obj) === '[object Array]';\r\n  };\r\n\r\n  // Is a given variable an object?\r\n  _.isObject = function(obj) {\r\n    var type = typeof obj;\r\n    return type === 'function' || type === 'object' && !!obj;\r\n  };\r\n\r\n  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp, isError, isMap, isWeakMap, isSet, isWeakSet.\r\n  _.each(['Arguments', 'Function', 'String', 'Number', 'Date', 'RegExp', 'Error', 'Symbol', 'Map', 'WeakMap', 'Set', 'WeakSet'], function(name) {\r\n    _['is' + name] = function(obj) {\r\n      return toString.call(obj) === '[object ' + name + ']';\r\n    };\r\n  });\r\n\r\n  // Define a fallback version of the method in browsers (ahem, IE < 9), where\r\n  // there isn't any inspectable \"Arguments\" type.\r\n  if (!_.isArguments(arguments)) {\r\n    _.isArguments = function(obj) {\r\n      return has(obj, 'callee');\r\n    };\r\n  }\r\n\r\n  // Optimize `isFunction` if appropriate. Work around some typeof bugs in old v8,\r\n  // IE 11 (#1621), Safari 8 (#1929), and PhantomJS (#2236).\r\n  var nodelist = root.document && root.document.childNodes;\r\n  if (typeof /./ != 'function' && typeof Int8Array != 'object' && typeof nodelist != 'function') {\r\n    _.isFunction = function(obj) {\r\n      return typeof obj == 'function' || false;\r\n    };\r\n  }\r\n\r\n  // Is a given object a finite number?\r\n  _.isFinite = function(obj) {\r\n    return !_.isSymbol(obj) && isFinite(obj) && !isNaN(parseFloat(obj));\r\n  };\r\n\r\n  // Is the given value `NaN`?\r\n  _.isNaN = function(obj) {\r\n    return _.isNumber(obj) && isNaN(obj);\r\n  };\r\n\r\n  // Is a given value a boolean?\r\n  _.isBoolean = function(obj) {\r\n    return obj === true || obj === false || toString.call(obj) === '[object Boolean]';\r\n  };\r\n\r\n  // Is a given value equal to null?\r\n  _.isNull = function(obj) {\r\n    return obj === null;\r\n  };\r\n\r\n  // Is a given variable undefined?\r\n  _.isUndefined = function(obj) {\r\n    return obj === void 0;\r\n  };\r\n\r\n  // Shortcut function for checking if an object has a given property directly\r\n  // on itself (in other words, not on a prototype).\r\n  _.has = function(obj, path) {\r\n    if (!_.isArray(path)) {\r\n      return has(obj, path);\r\n    }\r\n    var length = path.length;\r\n    for (var i = 0; i < length; i++) {\r\n      var key = path[i];\r\n      if (obj == null || !hasOwnProperty.call(obj, key)) {\r\n        return false;\r\n      }\r\n      obj = obj[key];\r\n    }\r\n    return !!length;\r\n  };\r\n\r\n  // Utility Functions\r\n  // -----------------\r\n\r\n  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its\r\n  // previous owner. Returns a reference to the Underscore object.\r\n  _.noConflict = function() {\r\n    root._ = previousUnderscore;\r\n    return this;\r\n  };\r\n\r\n  // Keep the identity function around for default iteratees.\r\n  _.identity = function(value) {\r\n    return value;\r\n  };\r\n\r\n  // Predicate-generating functions. Often useful outside of Underscore.\r\n  _.constant = function(value) {\r\n    return function() {\r\n      return value;\r\n    };\r\n  };\r\n\r\n  _.noop = function(){};\r\n\r\n  // Creates a function that, when passed an object, will traverse that objects\r\n  // properties down the given `path`, specified as an array of keys or indexes.\r\n  _.property = function(path) {\r\n    if (!_.isArray(path)) {\r\n      return shallowProperty(path);\r\n    }\r\n    return function(obj) {\r\n      return deepGet(obj, path);\r\n    };\r\n  };\r\n\r\n  // Generates a function for a given object that returns a given property.\r\n  _.propertyOf = function(obj) {\r\n    if (obj == null) {\r\n      return function(){};\r\n    }\r\n    return function(path) {\r\n      return !_.isArray(path) ? obj[path] : deepGet(obj, path);\r\n    };\r\n  };\r\n\r\n  // Returns a predicate for checking whether an object has a given set of\r\n  // `key:value` pairs.\r\n  _.matcher = _.matches = function(attrs) {\r\n    attrs = _.extendOwn({}, attrs);\r\n    return function(obj) {\r\n      return _.isMatch(obj, attrs);\r\n    };\r\n  };\r\n\r\n  // Run a function **n** times.\r\n  _.times = function(n, iteratee, context) {\r\n    var accum = Array(Math.max(0, n));\r\n    iteratee = optimizeCb(iteratee, context, 1);\r\n    for (var i = 0; i < n; i++) accum[i] = iteratee(i);\r\n    return accum;\r\n  };\r\n\r\n  // Return a random integer between min and max (inclusive).\r\n  _.random = function(min, max) {\r\n    if (max == null) {\r\n      max = min;\r\n      min = 0;\r\n    }\r\n    return min + Math.floor(Math.random() * (max - min + 1));\r\n  };\r\n\r\n  // A (possibly faster) way to get the current timestamp as an integer.\r\n  _.now = Date.now || function() {\r\n    return new Date().getTime();\r\n  };\r\n\r\n  // List of HTML entities for escaping.\r\n  var escapeMap = {\r\n    '&': '&amp;',\r\n    '<': '&lt;',\r\n    '>': '&gt;',\r\n    '\"': '&quot;',\r\n    \"'\": '&#x27;',\r\n    '`': '&#x60;'\r\n  };\r\n  var unescapeMap = _.invert(escapeMap);\r\n\r\n  // Functions for escaping and unescaping strings to/from HTML interpolation.\r\n  var createEscaper = function(map) {\r\n    var escaper = function(match) {\r\n      return map[match];\r\n    };\r\n    // Regexes for identifying a key that needs to be escaped.\r\n    var source = '(?:' + _.keys(map).join('|') + ')';\r\n    var testRegexp = RegExp(source);\r\n    var replaceRegexp = RegExp(source, 'g');\r\n    return function(string) {\r\n      string = string == null ? '' : '' + string;\r\n      return testRegexp.test(string) ? string.replace(replaceRegexp, escaper) : string;\r\n    };\r\n  };\r\n  _.escape = createEscaper(escapeMap);\r\n  _.unescape = createEscaper(unescapeMap);\r\n\r\n  // Traverses the children of `obj` along `path`. If a child is a function, it\r\n  // is invoked with its parent as context. Returns the value of the final\r\n  // child, or `fallback` if any child is undefined.\r\n  _.result = function(obj, path, fallback) {\r\n    if (!_.isArray(path)) path = [path];\r\n    var length = path.length;\r\n    if (!length) {\r\n      return _.isFunction(fallback) ? fallback.call(obj) : fallback;\r\n    }\r\n    for (var i = 0; i < length; i++) {\r\n      var prop = obj == null ? void 0 : obj[path[i]];\r\n      if (prop === void 0) {\r\n        prop = fallback;\r\n        i = length; // Ensure we don't continue iterating.\r\n      }\r\n      obj = _.isFunction(prop) ? prop.call(obj) : prop;\r\n    }\r\n    return obj;\r\n  };\r\n\r\n  // Generate a unique integer id (unique within the entire client session).\r\n  // Useful for temporary DOM ids.\r\n  var idCounter = 0;\r\n  _.uniqueId = function(prefix) {\r\n    var id = ++idCounter + '';\r\n    return prefix ? prefix + id : id;\r\n  };\r\n\r\n  // By default, Underscore uses ERB-style template delimiters, change the\r\n  // following template settings to use alternative delimiters.\r\n  _.templateSettings = {\r\n    evaluate: /<%([\\s\\S]+?)%>/g,\r\n    interpolate: /<%=([\\s\\S]+?)%>/g,\r\n    escape: /<%-([\\s\\S]+?)%>/g\r\n  };\r\n\r\n  // When customizing `templateSettings`, if you don't want to define an\r\n  // interpolation, evaluation or escaping regex, we need one that is\r\n  // guaranteed not to match.\r\n  var noMatch = /(.)^/;\r\n\r\n  // Certain characters need to be escaped so that they can be put into a\r\n  // string literal.\r\n  var escapes = {\r\n    \"'\": \"'\",\r\n    '\\\\': '\\\\',\r\n    '\\r': 'r',\r\n    '\\n': 'n',\r\n    '\\u2028': 'u2028',\r\n    '\\u2029': 'u2029'\r\n  };\r\n\r\n  var escapeRegExp = /\\\\|'|\\r|\\n|\\u2028|\\u2029/g;\r\n\r\n  var escapeChar = function(match) {\r\n    return '\\\\' + escapes[match];\r\n  };\r\n\r\n  // JavaScript micro-templating, similar to John Resig's implementation.\r\n  // Underscore templating handles arbitrary delimiters, preserves whitespace,\r\n  // and correctly escapes quotes within interpolated code.\r\n  // NB: `oldSettings` only exists for backwards compatibility.\r\n  _.template = function(text, settings, oldSettings) {\r\n    if (!settings && oldSettings) settings = oldSettings;\r\n    settings = _.defaults({}, settings, _.templateSettings);\r\n\r\n    // Combine delimiters into one regular expression via alternation.\r\n    var matcher = RegExp([\r\n      (settings.escape || noMatch).source,\r\n      (settings.interpolate || noMatch).source,\r\n      (settings.evaluate || noMatch).source\r\n    ].join('|') + '|$', 'g');\r\n\r\n    // Compile the template source, escaping string literals appropriately.\r\n    var index = 0;\r\n    var source = \"__p+='\";\r\n    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {\r\n      source += text.slice(index, offset).replace(escapeRegExp, escapeChar);\r\n      index = offset + match.length;\r\n\r\n      if (escape) {\r\n        source += \"'+\\n((__t=(\" + escape + \"))==null?'':_.escape(__t))+\\n'\";\r\n      } else if (interpolate) {\r\n        source += \"'+\\n((__t=(\" + interpolate + \"))==null?'':__t)+\\n'\";\r\n      } else if (evaluate) {\r\n        source += \"';\\n\" + evaluate + \"\\n__p+='\";\r\n      }\r\n\r\n      // Adobe VMs need the match returned to produce the correct offset.\r\n      return match;\r\n    });\r\n    source += \"';\\n\";\r\n\r\n    // If a variable is not specified, place data values in local scope.\r\n    if (!settings.variable) source = 'with(obj||{}){\\n' + source + '}\\n';\r\n\r\n    source = \"var __t,__p='',__j=Array.prototype.join,\" +\r\n      \"print=function(){__p+=__j.call(arguments,'');};\\n\" +\r\n      source + 'return __p;\\n';\r\n\r\n    var render;\r\n    try {\r\n      render = new Function(settings.variable || 'obj', '_', source);\r\n    } catch (e) {\r\n      e.source = source;\r\n      throw e;\r\n    }\r\n\r\n    var template = function(data) {\r\n      return render.call(this, data, _);\r\n    };\r\n\r\n    // Provide the compiled source as a convenience for precompilation.\r\n    var argument = settings.variable || 'obj';\r\n    template.source = 'function(' + argument + '){\\n' + source + '}';\r\n\r\n    return template;\r\n  };\r\n\r\n  // Add a \"chain\" function. Start chaining a wrapped Underscore object.\r\n  _.chain = function(obj) {\r\n    var instance = _(obj);\r\n    instance._chain = true;\r\n    return instance;\r\n  };\r\n\r\n  // OOP\r\n  // ---------------\r\n  // If Underscore is called as a function, it returns a wrapped object that\r\n  // can be used OO-style. This wrapper holds altered versions of all the\r\n  // underscore functions. Wrapped objects may be chained.\r\n\r\n  // Helper function to continue chaining intermediate results.\r\n  var chainResult = function(instance, obj) {\r\n    return instance._chain ? _(obj).chain() : obj;\r\n  };\r\n\r\n  // Add your own custom functions to the Underscore object.\r\n  _.mixin = function(obj) {\r\n    _.each(_.functions(obj), function(name) {\r\n      var func = _[name] = obj[name];\r\n      _.prototype[name] = function() {\r\n        var args = [this._wrapped];\r\n        push.apply(args, arguments);\r\n        return chainResult(this, func.apply(_, args));\r\n      };\r\n    });\r\n    return _;\r\n  };\r\n\r\n  // Add all of the Underscore functions to the wrapper object.\r\n  _.mixin(_);\r\n\r\n  // Add all mutator Array functions to the wrapper.\r\n  _.each(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {\r\n    var method = ArrayProto[name];\r\n    _.prototype[name] = function() {\r\n      var obj = this._wrapped;\r\n      method.apply(obj, arguments);\r\n      if ((name === 'shift' || name === 'splice') && obj.length === 0) delete obj[0];\r\n      return chainResult(this, obj);\r\n    };\r\n  });\r\n\r\n  // Add all accessor Array functions to the wrapper.\r\n  _.each(['concat', 'join', 'slice'], function(name) {\r\n    var method = ArrayProto[name];\r\n    _.prototype[name] = function() {\r\n      return chainResult(this, method.apply(this._wrapped, arguments));\r\n    };\r\n  });\r\n\r\n  // Extracts the result from a wrapped and chained object.\r\n  _.prototype.value = function() {\r\n    return this._wrapped;\r\n  };\r\n\r\n  // Provide unwrapping proxy for some methods used in engine operations\r\n  // such as arithmetic and JSON stringification.\r\n  _.prototype.valueOf = _.prototype.toJSON = _.prototype.value;\r\n\r\n  _.prototype.toString = function() {\r\n    return String(this._wrapped);\r\n  };\r\n\r\n  // AMD registration happens at the end for compatibility with AMD loaders\r\n  // that may not enforce next-turn semantics on modules. Even though general\r\n  // practice for AMD registration is to be anonymous, underscore registers\r\n  // as a named module because, like jQuery, it is a base library that is\r\n  // popular enough to be bundled in a third party lib, but not be part of\r\n  // an AMD load request. Those cases could generate an error when an\r\n  // anonymous define() is called outside of a loader request.\r\n  if (typeof define == 'function' && define.amd) {\r\n    define('underscore', [], function() {\r\n      return _;\r\n    });\r\n  }\r\n}());","import FactoryMaker from '../core/FactoryMaker';\nimport EventBus from '../core/EventBus';\nimport Events from '../core/events';\nimport Debug from '../core/Debug';\n\nimport StringUtils from '../utils/string_utils';\n\nimport {\n  Fragment,\n  TrackInfo,\n  PeriodInfo\n} from '../common/common';\n\nimport M3U8Parser from '../../third_party/hlsjs/src/loader/m3u8-parser';\n\nfunction HlsParser() {\n  let context_ = this.context;\n  let eventBus_ = EventBus(context_).getInstance();\n  let debug_ = Debug(context_).getInstance();\n\n  let streamInfo_;\n\n  // hls\n  let currentSN_;\n  let fragCurrent_;\n\n  function setup() {\n    eventBus_.on(Events.MANIFEST_LOADED, onManifestLoaded);\n  }\n\n  // event callbacks\n  function onManifestLoaded(data) {\n    let content = StringUtils.ab2str_v1(data.bytes);\n    let url = data.url;\n    debug_.log('content: ' + content);\n\n    currentSN_ = 0;\n\n    let track = new TrackInfo();\n    track.type = 'stream';\n    track.levelDetails = M3U8Parser.parseLevelPlaylist(content, url, 0, 'main');\n\n    streamInfo_ = new PeriodInfo();\n    streamInfo_.duration = track.levelDetails.totalduration;\n    streamInfo_.tracks.push(track);\n\n    eventBus_.trigger(Events.MANIFEST_PARSED, streamInfo_);\n  }\n\n  // public functions\n  function getType() {\n    return 'hls';\n  }\n\n  function getNextFragment() {\n    for (let i = 0; i < streamInfo_.tracks.length; i++) {\n      let trackInfo = streamInfo_.tracks[i];\n      if (trackInfo.type === 'stream') {\n        // get initSegment first\n        if (trackInfo.levelDetails.initSegment && !trackInfo.levelDetails.initSegment.data) {\n          fragCurrent_ = trackInfo.levelDetails.initSegment;\n        } else {\n          if (currentSN_ === trackInfo.levelDetails.fragments.length) {\n            fragCurrent_ = null;\n          } else {\n            fragCurrent_ = trackInfo.levelDetails.fragments[currentSN_];\n            currentSN_++;\n          }\n        }\n        break;\n      }\n    }\n\n    return fragCurrent_;\n  }\n\n  let instance_ = {\n    getType: getType,\n    getNextFragment: getNextFragment\n  };\n  setup();\n  return instance_;\n}\n\nHlsParser.__h5player_factory_name = 'HlsParser';\nexport default FactoryMaker.getSingletonFactory(HlsParser);","import Events from './core/events';\r\nimport { ErrorTypes } from './core/errors';\r\nimport CommonUtils from './utils/common_utils';\r\nimport Player from './Player';\r\nimport CastReceiver from './cast/cast_receiver';\r\n\r\nimport UIEngine from './ui/js/ui_engine';\r\n\r\n// Shove both of these into the global scope\r\nvar context = (typeof window !== 'undefined' && window) || global;\r\n\r\nvar oldmtn = context.oldmtn;\r\nif (!oldmtn) {\r\n  oldmtn = context.oldmtn = {};\r\n}\r\n\r\noldmtn.Player = Player;\r\noldmtn.Events = Events;\r\noldmtn.ErrorTypes = ErrorTypes;\r\noldmtn.CastReceiver = CastReceiver;\r\n\r\noldmtn.CommonUtils = CommonUtils;\r\n\r\noldmtn.UIEngine = UIEngine;\r\n\r\n/////////////////////////////////////////////////////////////////////////\r\n\r\nexport default oldmtn;\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import FactoryMaker from '../core/FactoryMaker';\r\nimport EventBus from '../core/EventBus';\r\nimport Events from '../core/events';\r\nimport Debug from '../core/Debug';\r\n\r\nimport XHRLoader from '../utils/xhr_loader';\r\n\r\nfunction FragmentLoader() {\r\n  let context_ = this.context;\r\n  let eventBus_ = EventBus(context_).getInstance();\r\n  let debug_ = Debug(context_).getInstance();\r\n\r\n  let xhrLoader_ = new XHRLoader();\r\n  \r\n  let request_;\r\n  function setup() {\r\n    eventBus_.on(Events.FRAG_LOADING, onFragLoading);\r\n  }\r\n\r\n  function onFragLoading(e) {\r\n    let frag = e.frag;\r\n    request_ = {\r\n      frag: frag,\r\n      url: frag.url,\r\n      rangeStart: frag.byteRangeStartOffset,\r\n      rangeEnd: frag.byteRangeEndOffset\r\n    };\r\n    let callbacks = {\r\n      onSuccess: loadsuccess\r\n    };\r\n\r\n    debug_.log(`+onFragLoading, ${request_.url}, [${request_.rangeStart}, ${request_.rangeEnd}], sn:${request_.frag.sn}`);\r\n    xhrLoader_.load(request_, null, callbacks);\r\n  }\r\n\r\n  function loadsuccess(payload) {\r\n    let frag = request_.frag;\r\n    frag.data = payload;\r\n    eventBus_.trigger(Events.FRAG_LOADED, { frag });\r\n  }\r\n\r\n  let instance_ = {\r\n  };\r\n\r\n  setup();\r\n  return instance_;\r\n}\r\n\r\nFragmentLoader.__h5player_factory_name = 'FragmentLoader';\r\nexport default FactoryMaker.getClassFactory(FragmentLoader);","import FactoryMaker from '../core/FactoryMaker';\r\nimport EventBus from '../core/EventBus';\r\nimport Events from '../core/events';\r\nimport Debug from '../core/Debug';\r\n\r\nimport StringUtils from '../utils/string_utils';\r\nimport XHRLoader from '../utils/xhr_loader';\r\n\r\nfunction PlaylistLoader() {\r\n  let context_ = this.context;\r\n  let eventBus_ = EventBus(context_).getInstance();\r\n  let debug_ = Debug(context_).getInstance();\r\n\r\n  let xhrLoader_ = new XHRLoader();\r\n  let request_;\r\n\r\n  function setup() {\r\n    eventBus_.on(Events.MANIFEST_LOADING, onManifestLoading);\r\n  }\r\n\r\n  function onManifestLoading(data) {\r\n    request_ = {\r\n      url: data.url\r\n    };\r\n    let callbacks = {\r\n      onSuccess: loadsuccess\r\n    };\r\n\r\n    xhrLoader_.load(request_, null, callbacks);\r\n  }\r\n\r\n  function loadsuccess(bytes) {\r\n    eventBus_.trigger(Events.MANIFEST_LOADED, { bytes: bytes, url: request_.url });\r\n  }\r\n\r\n  let instance_ = {\r\n  };\r\n  setup();\r\n  return instance_;\r\n}\r\n\r\nPlaylistLoader.__h5player_factory_name = 'PlaylistLoader';\r\nexport default FactoryMaker.getSingletonFactory(PlaylistLoader);\r\n","import FactoryMaker from '../core/FactoryMaker';\nimport EventBus from '../core/EventBus';\nimport Events from '../core/events';\nimport Debug from '../core/Debug';\n\nimport VTTParser from '../utils/VTTParser';\nimport StringUtils from '../utils/string_utils';\n\nimport { ajax } from '../utils/ajax';\n\nfunction TrackLoader() {\n  let context_ = this.context;\n  let eventBus_ = EventBus(context_).getInstance();\n  let debug_ = Debug(context_).getInstance();\n\n  let vttParser_ = VTTParser(context_).getInstance();\n\n  function setup() {\n    eventBus_.on(Events.TRACK_LOADING, onTrackLoading);\n  }\n\n  function onTrackLoading(data) {\n    let track_ = data.track;\n\n    function successHandler(xhr) {\n      let data = xhr.responseText;\n      let cueData = vttParser_.parse(data);\n      track_.data = cueData;\n\n      eventBus_.trigger(Events.TRACK_LOADED, { track: track_ });\n    }\n\n    function errorHandler(xhr) {\n    }\n\n    ajax(track_.file, successHandler, errorHandler);\n  }\n\n  let instance_ = {\n  };\n\n  setup();\n  return instance_;\n}\n\nTrackLoader.__h5player_factory_name = 'TrackLoader';\nexport default FactoryMaker.getSingletonFactory(TrackLoader);\n\n\n\n","import FactoryMaker from '../core/FactoryMaker';\r\nimport Events from '../core/events';\r\nimport EventBus from '../core/EventBus';\r\nimport Debug from '../core/Debug';\r\n\r\nimport {\r\n  Fragment,\r\n  TrackInfo,\r\n  PeriodInfo\r\n} from '../common/common';\r\n\r\nfunction PDParser() {\r\n  let context_ = this.context;\r\n  let eventBus_ = EventBus(context_).getInstance();\r\n  let debug_ = Debug(context_).getInstance();\r\n\r\n  let streamInfo_;\r\n  let flagGotFragment = false;\r\n\r\n  function getType() {\r\n    return 'pd';\r\n  }\r\n\r\n  function loadManifest(url) {\r\n    streamInfo_ = new PeriodInfo();\r\n    streamInfo_.url = url;\r\n    eventBus_.trigger(Events.MANIFEST_PARSED);\r\n  }\r\n\r\n  function getNextFragment() {\r\n    if (!flagGotFragment) {\r\n      flagGotFragment = true;\r\n      let frag = {};\r\n      frag.type = 'pd';\r\n      frag.url = streamInfo_.url;\r\n      return frag;\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  let instance = {\r\n    getType: getType,\r\n    loadManifest: loadManifest,\r\n    getNextFragment: getNextFragment\r\n  };\r\n  return instance;\r\n}\r\n\r\nPDParser.__h5player_factory_name = 'PDParser';\r\nexport default FactoryMaker.getSingletonFactory(PDParser);","import FactoryMaker from '../../core/FactoryMaker';\n\nimport KeySystemClearKey from './../drm/KeySystemClearKey';\nimport KeySystemWidevine from './../drm/KeySystemWidevine';\nimport KeySystemPlayReady from './../drm/KeySystemPlayReady';\nimport KeySystemCCPlayReady from './../drm/KeySystemCCPlayReady';\n\nfunction ProtectionKeyController() {\n  let context_ = this.context;\n\n  let instance_;\n  let keySystems_;\n\n  function initialize() {\n    keySystems_ = [];\n\n    var keySystem;\n\n    // ClearKey\n    keySystem = KeySystemClearKey(context_).getInstance();\n    keySystems_.push(keySystem);\n\n    // PlayReady\n    keySystem = KeySystemPlayReady(context_).getInstance();\n    keySystems_.push(keySystem);\n\n    // Widevine\n    keySystem = KeySystemWidevine(context_).getInstance();\n    keySystems_.push(keySystem);\n\n    // Chromecast PlayReady\n    keySystem = KeySystemCCPlayReady(context_).getInstance();\n    keySystems_.push(keySystem);\n  }\n\n  function getKeySystems() {\n    return keySystems;\n  }\n\n  function getKeySystemBySystemString(systemString) {\n    if (window.cast && window.cast.__platform__) {\n      if (systemString === 'com.microsoft.playready') {\n        systemString = 'com.chromecast.playready';\n      }\n    }\n\n    for (var i = 0; i < keySystems_.length; i++) {\n      if (keySystems_[i].systemString === systemString) {\n        return keySystems_[i];\n      }\n    }\n    return null;\n  }\n\n  instance_ = {\n    getKeySystems: getKeySystems,\n    getKeySystemBySystemString: getKeySystemBySystemString\n  };\n\n  initialize();\n  return instance_;\n}\n\nProtectionKeyController.__h5player_factory_name = 'ProtectionKeyController';\nexport default FactoryMaker.getSingletonFactory(ProtectionKeyController);","/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\n\n/**\n * Microsoft PlayReady DRM\n *\n * @class\n * @implements KeySystem\n */\nimport CommonEncryption from '../vo/CommonEncryption';\nimport Error from '../../utils/Error';\n\nimport FactoryMaker from '../../core/FactoryMaker';\nimport BASE64 from '../../externals/base64';\n\nconst uuid = '9a04f079-9840-4286-ab92-e65be0885f95';\nconst systemString = 'com.chromecast.playready';\nconst schemeIdURI = 'urn:uuid:' + uuid;\n\nfunction KeySystemCCPlayReady() {\n\n  let instance_;\n  let messageFormat = 'utf16';\n\n  function getRequestHeadersFromMessage(message) {\n    var headers = {};\n    headers['Content-Type'] = 'text/xml; charset=utf-8';\n    headers['SOAPAction'] = 'http://schemas.microsoft.com/DRM/2007/03/protocols/AcquireLicense';\n    return headers;\n  }\n\n  function getLicenseRequestFromMessage(message) {\n    console.log('DRM: cc, getLicenseRequestFromMessage');\n    return new Uint8Array(message);\n  }\n\n  function getLicenseServerURLFromInitData(initData) {\n    if (initData) {\n      var data = new DataView(initData);\n      var numRecords = data.getUint16(4, true);\n      var offset = 6;\n      var parser = new DOMParser();\n\n      for (var i = 0; i < numRecords; i++) {\n        // Parse the PlayReady Record header\n        var recordType = data.getUint16(offset, true);\n        offset += 2;\n        var recordLength = data.getUint16(offset, true);\n        offset += 2;\n        if (recordType !== 0x0001) {\n          offset += recordLength;\n          // VO BEGIN - https://sh.visualon.com/node/64225\n          if (offset >= data.byteLength - 2) {\n            return null;\n          }\n          // VO END\n          continue;\n        }\n\n        var recordData = initData.slice(offset, offset + recordLength);\n        var record = String.fromCharCode.apply(null, new Uint16Array(recordData));\n        var xmlDoc = parser.parseFromString(record, 'application/xml');\n\n        // First try <LA_URL>\n        if (xmlDoc.getElementsByTagName('LA_URL')[0]) {\n          var laURL = xmlDoc.getElementsByTagName('LA_URL')[0].childNodes[0].nodeValue;\n          if (laURL) {\n            return laURL;\n          }\n        }\n\n        // Optionally, try <LUI_URL>\n        if (xmlDoc.getElementsByTagName('LUI_URL')[0]) {\n          var luiurl = xmlDoc.getElementsByTagName('LUI_URL')[0].childNodes[0].nodeValue;\n          if (luiurl) {\n            return luiurl;\n          }\n        }\n      }\n    }\n\n    return null;\n  }\n\n  function getInitData(cpData) {\n    // * desc@ getInitData\n    // *   generate PSSH data from PROHeader defined in MPD file\n    // *   PSSH format:\n    // *   size (4)\n    // *   box type(PSSH) (8)\n    // *   Protection SystemID (16)\n    // *   protection system data size (4) - length of decoded PROHeader\n    // *   decoded PROHeader data from MPD file\n    var PSSHBoxType = new Uint8Array([0x70, 0x73, 0x73, 0x68, 0x00, 0x00, 0x00, 0x00]); //'PSSH' 8 bytes\n    var playreadySystemID = new Uint8Array([0x9a, 0x04, 0xf0, 0x79, 0x98, 0x40, 0x42, 0x86, 0xab, 0x92, 0xe6, 0x5b, 0xe0, 0x88, 0x5f, 0x95]);\n\n    var byteCursor = 0;\n    var uint8arraydecodedPROHeader = null;\n\n    var PROSize,\n      PSSHSize,\n      PSSHBoxBuffer,\n      PSSHBox,\n      PSSHData;\n\n    // Handle common encryption PSSH\n    if ('pssh' in cpData) {\n      return CommonEncryption.parseInitDataFromContentProtection(cpData);\n    }\n    // Handle native MS PlayReady ContentProtection elements\n    if ('pro' in cpData) {\n      uint8arraydecodedPROHeader = BASE64.decodeArray(cpData.pro.__text);\n    } else if ('prheader' in cpData) {\n      uint8arraydecodedPROHeader = BASE64.decodeArray(cpData.prheader.__text);\n    } else {\n      return null;\n    }\n\n    PROSize = uint8arraydecodedPROHeader.length;\n    PSSHSize = 0x4 + PSSHBoxType.length + playreadySystemID.length + 0x4 + PROSize;\n\n    PSSHBoxBuffer = new ArrayBuffer(PSSHSize);\n\n    PSSHBox = new Uint8Array(PSSHBoxBuffer);\n    PSSHData = new DataView(PSSHBoxBuffer);\n\n    PSSHData.setUint32(byteCursor, PSSHSize);\n    byteCursor += 0x4;\n\n    PSSHBox.set(PSSHBoxType, byteCursor);\n    byteCursor += PSSHBoxType.length;\n\n    PSSHBox.set(playreadySystemID, byteCursor);\n    byteCursor += playreadySystemID.length;\n\n    PSSHData.setUint32(byteCursor, PROSize);\n    byteCursor += 0x4;\n\n    PSSHBox.set(uint8arraydecodedPROHeader, byteCursor);\n    byteCursor += PROSize;\n\n    return PSSHBox.buffer;\n  }\n\n  /**\n   * It seems that some PlayReady implementations return their XML-based CDM\n   * messages using UTF16, while others return them as UTF8.  Use this function\n   * to modify the message format to expect when parsing CDM messages.\n   *\n   * @param {string} format the expected message format.  Either \"utf8\" or \"utf16\".\n   * @throws {Error} Specified message format is not one of \"utf8\" or \"utf16\"\n   */\n  function setPlayReadyMessageFormat(format) {\n    if (format !== 'utf8' && format !== 'utf16') {\n      throw new Error('Illegal PlayReady message format! -- ' + format);\n    }\n    messageFormat = format;\n  }\n\n  instance_ = {\n    uuid: uuid,\n    schemeIdURI: schemeIdURI,\n    systemString: systemString,\n    getInitData: getInitData,\n    getRequestHeadersFromMessage: getRequestHeadersFromMessage,\n    getLicenseRequestFromMessage: getLicenseRequestFromMessage,\n    getLicenseServerURLFromInitData: getLicenseServerURLFromInitData,\n    setPlayReadyMessageFormat: setPlayReadyMessageFormat\n  };\n\n  return instance_;\n}\n\nKeySystemCCPlayReady.__h5player_factory_name = 'KeySystemCCPlayReady';\nexport default FactoryMaker.getSingletonFactory(KeySystemCCPlayReady);","/**\r\n * The copyright in this software is being made available under the BSD License,\r\n * included below. This software may be subject to other third party and contributor\r\n * rights, including patent rights, and no such rights are granted under this license.\r\n *\r\n * Copyright (c) 2013, Dash Industry Forum.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without modification,\r\n * are permitted provided that the following conditions are met:\r\n *  * Redistributions of source code must retain the above copyright notice, this\r\n *  list of conditions and the following disclaimer.\r\n *  * Redistributions in binary form must reproduce the above copyright notice,\r\n *  this list of conditions and the following disclaimer in the documentation and/or\r\n *  other materials provided with the distribution.\r\n *  * Neither the name of Dash Industry Forum nor the names of its\r\n *  contributors may be used to endorse or promote products derived from this software\r\n *  without specific prior written permission.\r\n *\r\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\r\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\r\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\r\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\r\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\r\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\r\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\r\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\r\n *  POSSIBILITY OF SUCH DAMAGE.\r\n */\r\n\r\nimport FactoryMaker from '../../core/FactoryMaker';\r\n\r\nconst uuid = '1077efec-c0b2-4d02-ace3-3c1e52e2fb4b';\r\nconst systemString = 'org.w3.clearkey';\r\nconst schemeIdURI = 'urn:uuid:' + uuid;\r\n\r\nfunction KeySystemClearKey() {\r\n\r\n  let instance;\r\n  /**\r\n   * Returns desired clearkeys (as specified in the CDM message) from protection data\r\n   *\r\n   * @param {ProtectionData} protectionData the protection data\r\n   * @param {ArrayBuffer} message the ClearKey CDM message\r\n   * @returns {ClearKeyKeySet} the key set or null if none found\r\n   * @throws {Error} if a keyID specified in the CDM message was not found in the\r\n   * protection data\r\n   * @memberof KeySystemClearKey\r\n   */\r\n  function getClearKeysFromProtectionData(protectionData, message) {\r\n    var clearkeySet = null;\r\n    // if (protectionData) {\r\n    //     // ClearKey is the only system that does not require a license server URL, so we\r\n    //     // handle it here when keys are specified in protection data\r\n    //     var jsonMsg = JSON.parse(String.fromCharCode.apply(null, new Uint8Array(message)));\r\n    //     var keyPairs = [];\r\n    //     for (var i = 0; i < jsonMsg.kids.length; i++) {\r\n    //         var clearkeyID = jsonMsg.kids[i];\r\n    //         var clearkey = (protectionData.clearkeys.hasOwnProperty(clearkeyID)) ? protectionData.clearkeys[clearkeyID] : null;\r\n    //         if (!clearkey) {\r\n    //             throw new Error('DRM: ClearKey keyID (' + clearkeyID + ') is not known!');\r\n    //         }\r\n    //         // KeyIDs from CDM are not base64 padded.  Keys may or may not be padded\r\n    //         keyPairs.push(new KeyPair(clearkeyID, clearkey));\r\n    //     }\r\n    //     clearkeySet = new ClearKeyKeySet(keyPairs);\r\n    // }\r\n    return clearkeySet;\r\n  }\r\n\r\n  function getInitData(cp) {\r\n    return CommonEncryption.parseInitDataFromContentProtection(cp);\r\n  }\r\n\r\n  function getRequestHeadersFromMessage( /*message*/ ) {\r\n    return null;\r\n  }\r\n\r\n  function getLicenseRequestFromMessage(message) {\r\n    return new Uint8Array(message);\r\n  }\r\n\r\n  function getLicenseServerURLFromInitData( /*initData*/ ) {\r\n    return null;\r\n  }\r\n\r\n  instance = {\r\n    uuid: uuid,\r\n    schemeIdURI: schemeIdURI,\r\n    systemString: systemString,\r\n    getInitData: getInitData,\r\n    getRequestHeadersFromMessage: getRequestHeadersFromMessage,\r\n    getLicenseRequestFromMessage: getLicenseRequestFromMessage,\r\n    getLicenseServerURLFromInitData: getLicenseServerURLFromInitData,\r\n    getClearKeysFromProtectionData: getClearKeysFromProtectionData\r\n  };\r\n\r\n  return instance;\r\n}\r\n\r\nKeySystemClearKey.__h5player_factory_name = 'KeySystemClearKey';\r\nexport default FactoryMaker.getSingletonFactory(KeySystemClearKey);","/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\n\n/**\n * Microsoft PlayReady DRM\n *\n * @class\n * @implements KeySystem\n */\nimport CommonEncryption from '../vo/CommonEncryption';\nimport Error from '../../utils/Error';\n\nimport FactoryMaker from '../../core/FactoryMaker';\nimport BASE64 from '../../externals/base64';\n\nconst uuid = '9a04f079-9840-4286-ab92-e65be0885f95';\nconst systemString = 'com.microsoft.playready';\nconst schemeIdURI = 'urn:uuid:' + uuid;\n\nfunction KeySystemPlayReady() {\n\n  let instance_;\n  let messageFormat = 'utf16';\n\n  function getRequestHeadersFromMessage(message) {\n    var msg,\n      xmlDoc;\n    var headers = {};\n    var parser = new DOMParser();\n    var dataview = (messageFormat === 'utf16') ? new Uint16Array(message) : new Uint8Array(message);\n\n    msg = String.fromCharCode.apply(null, dataview);\n    xmlDoc = parser.parseFromString(msg, 'application/xml');\n\n    var headerNameList = xmlDoc.getElementsByTagName('name');\n    var headerValueList = xmlDoc.getElementsByTagName('value');\n    for (var i = 0; i < headerNameList.length; i++) {\n      headers[headerNameList[i].childNodes[0].nodeValue] = headerValueList[i].childNodes[0].nodeValue;\n    }\n    // some versions of the PlayReady CDM return 'Content' instead of 'Content-Type'.\n    // this is NOT w3c conform and license servers may reject the request!\n    // -> rename it to proper w3c definition!\n    if (headers.hasOwnProperty('Content')) {\n      headers['Content-Type'] = headers.Content;\n      delete headers.Content;\n    }\n    return headers;\n  }\n\n  function getLicenseRequestFromMessage(message) {\n    var msg,\n      xmlDoc;\n    var licenseRequest = null;\n    var parser = new DOMParser();\n    var dataview = (messageFormat === 'utf16') ? new Uint16Array(message) : new Uint8Array(message);\n\n    msg = String.fromCharCode.apply(null, dataview);\n    xmlDoc = parser.parseFromString(msg, 'application/xml');\n\n    if (xmlDoc.getElementsByTagName('Challenge')[0]) {\n      var Challenge = xmlDoc.getElementsByTagName('Challenge')[0].childNodes[0].nodeValue;\n      if (Challenge) {\n        licenseRequest = BASE64.decode(Challenge);\n      }\n    }\n    return licenseRequest;\n  }\n\n  function getLicenseServerURLFromInitData(initData) {\n    if (initData) {\n      var data = new DataView(initData);\n      var numRecords = data.getUint16(4, true);\n      var offset = 6;\n      var parser = new DOMParser();\n\n      for (var i = 0; i < numRecords; i++) {\n        // Parse the PlayReady Record header\n        var recordType = data.getUint16(offset, true);\n        offset += 2;\n        var recordLength = data.getUint16(offset, true);\n        offset += 2;\n        if (recordType !== 0x0001) {\n          offset += recordLength;\n          // VO BEGIN - https://sh.visualon.com/node/64225\n          if (offset >= data.byteLength - 2) {\n            return null;\n          }\n          // VO END\n          continue;\n        }\n\n        var recordData = initData.slice(offset, offset + recordLength);\n        var record = String.fromCharCode.apply(null, new Uint16Array(recordData));\n        var xmlDoc = parser.parseFromString(record, 'application/xml');\n\n        // First try <LA_URL>\n        if (xmlDoc.getElementsByTagName('LA_URL')[0]) {\n          var laURL = xmlDoc.getElementsByTagName('LA_URL')[0].childNodes[0].nodeValue;\n          if (laURL) {\n            return laURL;\n          }\n        }\n\n        // Optionally, try <LUI_URL>\n        if (xmlDoc.getElementsByTagName('LUI_URL')[0]) {\n          var luiurl = xmlDoc.getElementsByTagName('LUI_URL')[0].childNodes[0].nodeValue;\n          if (luiurl) {\n            return luiurl;\n          }\n        }\n      }\n    }\n\n    return null;\n  }\n\n  function getInitData(cpData) {\n    // * desc@ getInitData\n    // *   generate PSSH data from PROHeader defined in MPD file\n    // *   PSSH format:\n    // *   size (4)\n    // *   box type(PSSH) (8)\n    // *   Protection SystemID (16)\n    // *   protection system data size (4) - length of decoded PROHeader\n    // *   decoded PROHeader data from MPD file\n    var PSSHBoxType = new Uint8Array([0x70, 0x73, 0x73, 0x68, 0x00, 0x00, 0x00, 0x00]); //'PSSH' 8 bytes\n    var playreadySystemID = new Uint8Array([0x9a, 0x04, 0xf0, 0x79, 0x98, 0x40, 0x42, 0x86, 0xab, 0x92, 0xe6, 0x5b, 0xe0, 0x88, 0x5f, 0x95]);\n\n    var byteCursor = 0;\n    var uint8arraydecodedPROHeader = null;\n\n    var PROSize,\n      PSSHSize,\n      PSSHBoxBuffer,\n      PSSHBox,\n      PSSHData;\n\n    // Handle common encryption PSSH\n    if ('pssh' in cpData) {\n      return CommonEncryption.parseInitDataFromContentProtection(cpData);\n    }\n    // Handle native MS PlayReady ContentProtection elements\n    if ('pro' in cpData) {\n      uint8arraydecodedPROHeader = BASE64.decodeArray(cpData.pro.__text);\n    } else if ('prheader' in cpData) {\n      uint8arraydecodedPROHeader = BASE64.decodeArray(cpData.prheader.__text);\n    } else {\n      return null;\n    }\n\n    PROSize = uint8arraydecodedPROHeader.length;\n    PSSHSize = 0x4 + PSSHBoxType.length + playreadySystemID.length + 0x4 + PROSize;\n\n    PSSHBoxBuffer = new ArrayBuffer(PSSHSize);\n\n    PSSHBox = new Uint8Array(PSSHBoxBuffer);\n    PSSHData = new DataView(PSSHBoxBuffer);\n\n    PSSHData.setUint32(byteCursor, PSSHSize);\n    byteCursor += 0x4;\n\n    PSSHBox.set(PSSHBoxType, byteCursor);\n    byteCursor += PSSHBoxType.length;\n\n    PSSHBox.set(playreadySystemID, byteCursor);\n    byteCursor += playreadySystemID.length;\n\n    PSSHData.setUint32(byteCursor, PROSize);\n    byteCursor += 0x4;\n\n    PSSHBox.set(uint8arraydecodedPROHeader, byteCursor);\n    byteCursor += PROSize;\n\n    return PSSHBox.buffer;\n  }\n\n  /**\n   * It seems that some PlayReady implementations return their XML-based CDM\n   * messages using UTF16, while others return them as UTF8.  Use this function\n   * to modify the message format to expect when parsing CDM messages.\n   *\n   * @param {string} format the expected message format.  Either \"utf8\" or \"utf16\".\n   * @throws {Error} Specified message format is not one of \"utf8\" or \"utf16\"\n   */\n  function setPlayReadyMessageFormat(format) {\n    if (format !== 'utf8' && format !== 'utf16') {\n      throw new Error('Illegal PlayReady message format! -- ' + format);\n    }\n    messageFormat = format;\n  }\n\n  instance_ = {\n    uuid: uuid,\n    schemeIdURI: schemeIdURI,\n    systemString: systemString,\n    getInitData: getInitData,\n    getRequestHeadersFromMessage: getRequestHeadersFromMessage,\n    getLicenseRequestFromMessage: getLicenseRequestFromMessage,\n    getLicenseServerURLFromInitData: getLicenseServerURLFromInitData,\n    setPlayReadyMessageFormat: setPlayReadyMessageFormat\n  };\n\n  return instance_;\n}\n\nKeySystemPlayReady.__h5player_factory_name = 'KeySystemPlayReady';\nexport default FactoryMaker.getSingletonFactory(KeySystemPlayReady);","import CommonEncryption from '../vo/CommonEncryption';\r\nimport FactoryMaker from '../../core/FactoryMaker';\r\n\r\nconst uuid = 'edef8ba9-79d6-4ace-a3c8-27dcd51d21ed';\r\nconst systemString = 'com.widevine.alpha';\r\nconst schemeIdURI = 'urn:uuid:' + uuid;\r\n\r\nfunction KeySystemWidevine() {\r\n\r\n  let instance_;\r\n\r\n  function getInitData(cp) {\r\n    return CommonEncryption.parseInitDataFromContentProtection(cp);\r\n  }\r\n\r\n  function getRequestHeadersFromMessage( /*message*/ ) {\r\n    return null;\r\n  }\r\n\r\n  function getLicenseRequestFromMessage(message) {\r\n    return new Uint8Array(message);\r\n  }\r\n\r\n  function getLicenseServerURLFromInitData( /*initData*/ ) {\r\n    return null;\r\n  }\r\n\r\n  instance_ = {\r\n    uuid: uuid,\r\n    schemeIdURI: schemeIdURI,\r\n    systemString: systemString,\r\n    getInitData: getInitData,\r\n    getRequestHeadersFromMessage: getRequestHeadersFromMessage,\r\n    getLicenseRequestFromMessage: getLicenseRequestFromMessage,\r\n    getLicenseServerURLFromInitData: getLicenseServerURLFromInitData,\r\n  };\r\n\r\n  return instance_;\r\n}\r\n\r\nKeySystemWidevine.__h5player_factory_name = 'KeySystemWidevine';\r\nexport default FactoryMaker.getSingletonFactory(KeySystemWidevine);","import FactoryMaker from '../../core/FactoryMaker';\r\nimport StringUtils from '../../utils/string_utils';\r\nimport CommonEncryption from '../vo/CommonEncryption';\r\nimport MediaCapability from '../vo/MediaCapability';\r\nimport KeySystemConfiguration from '../vo/KeySystemConfiguration';\r\n\r\nimport KeySystemWidevine from '../drm/KeySystemWidevine';\r\n\r\n// This takes the place of a license server.\r\n// kids is an array of base64-encoded key IDs\r\n// keys is an array of base64-encoded keys\r\nfunction generateLicense(message, key) {\r\n  // Parse the clearkey license request.\r\n  var request = JSON.parse(new TextDecoder().decode(message));\r\n  // We only know one key, so there should only be one key ID.\r\n  // A real license server could easily serve multiple keys.\r\n  console.assert(request.kids.length === 1);\r\n\r\n  var keyObj = {\r\n    kty: 'oct',\r\n    //alg: 'A128KW',\r\n    kid: request.kids[0],\r\n    k: StringUtils.u8arrToB64(key)\r\n  };\r\n  return new TextEncoder().encode(JSON.stringify({\r\n    keys: [keyObj]\r\n  }));\r\n}\r\n\r\nfunction dumpKSConfig(ksString, ksConfig) {\r\n  console.log('H5Player, requestMediaKeySystemAccess, keySystem_ = ' + ksString);\r\n  console.log('H5Player, requestMediaKeySystemAccess, config, initDataTypes: ' + ksConfig.initDataTypes[0]);\r\n  console.log('H5Player, requestMediaKeySystemAccess, config, distinctiveIdentifier: ' + ksConfig.distinctiveIdentifier);\r\n  console.log('H5Player, requestMediaKeySystemAccess, config, persistentState: ' + ksConfig.persistentState);\r\n  console.log('H5Player, requestMediaKeySystemAccess, config, sessionTypes: ' + ksConfig.sessionTypes[0]);\r\n  console.log('H5Player, requestMediaKeySystemAccess, config, videoCapabilities[0].contentType: ' + ksConfig.videoCapabilities[0].contentType);\r\n  console.log('H5Player, requestMediaKeySystemAccess, config, videoCapabilities[0].robustness: ' + ksConfig.videoCapabilities[0].robustness);\r\n\r\n  // liteH5Player.debug.js:3558 H5Player, requestMediaKeySystemAccess, keySystem_ = com.chromecast.playready\r\n  // liteH5Player.debug.js:3559 H5Player, requestMediaKeySystemAccess, config, initDataTypes: cenc\r\n  // liteH5Player.debug.js:3560 H5Player, requestMediaKeySystemAccess, config, distinctiveIdentifier: optional\r\n  // liteH5Player.debug.js:3561 H5Player, requestMediaKeySystemAccess, config, persistentState: optional\r\n  // liteH5Player.debug.js:3562 H5Player, requestMediaKeySystemAccess, config, sessionTypes: temporary\r\n  // liteH5Player.debug.js:3563 H5Player, requestMediaKeySystemAccess, config, videoCapabilities[0].contentType: video/mp4; codecs=\"avc1.42C014\"\r\n  // liteH5Player.debug.js:3564 H5Player, requestMediaKeySystemAccess, config, videoCapabilities[0].robustness: \r\n\r\n  // shaka-player.compiled.debug.js:100 DRM: queryMediaKeys_, keySystem: com.chromecast.playready\r\n  // shaka-player.compiled.debug.js:100 DRM: queryMediaKeys_, videoCapabilities = [object Object]\r\n  // shaka-player.compiled.debug.js:100 DRM: queryMediaKeys_, distinctiveIdentifier = optional\r\n  // shaka-player.compiled.debug.js:100 DRM: queryMediaKeys_, persistentState = optional\r\n  // shaka-player.compiled.debug.js:100 DRM: queryMediaKeys_, sessionTypes = temporary\r\n  // shaka-player.compiled.debug.js:100 DRM: queryMediaKeys_, label = com.chromecast.playready\r\n  // shaka-player.compiled.debug.js:100 DRM: queryMediaKeys_, drmInfos = [object Object]\r\n  // shaka-player.compiled.debug.js:100 DRM: queryMediaKeys_, videoCapabilities[0].contentType video/mp4; codecs=\"avc1.42C014\"\r\n  // shaka-player.compiled.debug.js:100 DRM: queryMediaKeys_, videoCapabilities[0].robustness \r\n\r\n  // for (var i in ksConfig) {\r\n  //     console.log('H5Player, ' + i + ' = ' + ksConfig[i]);\r\n  // }\r\n}\r\n\r\n/**\r\n * Most recent EME implementation\r\n *\r\n * Implemented by Google Chrome v36+ (Windows, OSX, Linux), Edge\r\n */\r\nfunction ProtectionModel_21Jan2015() {\r\n  let media_ = null;\r\n\r\n  let initDataType_ = null;\r\n  let initData_ = null;\r\n  let keySystem_ = null;\r\n  let session_ = null;\r\n  let streamInfo_ = null;\r\n\r\n  let promiseAction_ = null;\r\n\r\n  function attachMedia(media) {\r\n    media_ = media;\r\n    media_.addEventListener('encrypted', onNeedKey, false);\r\n  }\r\n\r\n  function detachMedia() {\r\n    if (media_) {\r\n      media_.removeEventListener('encrypted', onNeedKey, false);\r\n      media_ = null;\r\n    }\r\n  }\r\n\r\n  function setKeySystem(keySystem) {\r\n    keySystem_ = keySystem;\r\n  }\r\n\r\n  // ev.initData: it is pssh data hidden in mp4 pssh box\r\n  function onNeedKey(ev) {\r\n    console.log('onNeedKey, initDataType: ' + ev.initDataType);\r\n    console.log('onNeedKey, initData length: ' + ev.initData.byteLength);\r\n    console.log('onNeedKey, initData', StringUtils.ab2str_v1(ev.initData));\r\n\r\n    // \r\n    if (streamInfo_.drm.initDataType && streamInfo_.drm.initData) {\r\n      initDataType_ = streamInfo_.drm.initDataType;\r\n      initData_ = streamInfo_.drm.initData;\r\n    } else {\r\n      initDataType_ = ev.initDataType;\r\n      initData_ = ev.initData;\r\n    }\r\n\r\n    // BD\r\n    var pssh = CommonEncryption.parsePSSHList(ev.initData);\r\n    let a1 = StringUtils.ab2str_v1(pssh['edef8ba9-79d6-4ace-a3c8-27dcd51d21ed']);\r\n    let a2 = StringUtils.ab2str_v1(pssh['9a04f079-9840-4286-ab92-e65be0885f95']);\r\n    console.log('DRM, a1: ' + a1);\r\n    console.log('DRM, a2: ' + a2);\r\n    // ED\r\n\r\n    if (!promiseAction_) {\r\n      promiseAction_ = requestKeySystemAccess();\r\n    }\r\n  }\r\n\r\n  function onSessionMessage(ev) {\r\n    console.log('message event: ', ev);\r\n    // If you had a license server, you would make an asynchronous XMLHttpRequest\r\n    // with event.message as the body.  The response from the server, as a\r\n    // Uint8Array, would then be passed to session.update().\r\n    // Instead, we will generate the license synchronously on the client, using\r\n    // the hard-coded KEY at the top.\r\n\r\n    console.log('session message, length: ' + ev.message.byteLength);\r\n    console.log('session message, data:', StringUtils.ab2str_v1(ev.message));\r\n\r\n    // Determine license server URL\r\n    let laUrl = streamInfo_.drm.laUrl;\r\n\r\n    if (!laUrl) {\r\n      console.log('DRM: no license url');\r\n\r\n      if (streamInfo_.drm.type === 'org.w3.clearkey') {\r\n        let license = generateLicense(event.message, streamInfo_.drm.key);\r\n        console.log('license: ', license);\r\n        let session = ev.target;\r\n        session.update(license);\r\n      }\r\n\r\n      return;\r\n    }\r\n    //\r\n    // All remaining key system scenarios require a request to a remote license server\r\n    let xhr = new XMLHttpRequest();\r\n\r\n    xhr.open('POST', laUrl, true);\r\n    xhr.responseType = 'arraybuffer';\r\n    xhr.timeout = 0;\r\n    xhr.withCredentials = false;\r\n\r\n    console.log('DRM: open method: POST');\r\n    console.log('DRM: timeout: ' + xhr.timeout);\r\n    console.log('DRM: withCredentials: ' + xhr.withCredentials);\r\n    console.log('DRM: message: ' + StringUtils.ab2str_v1(ev.message));\r\n    xhr.onload = function(event) {\r\n      if (this.status == 200) {\r\n        let data = this.response;\r\n\r\n        console.log('DRM: request response length: ' + data.byteLength);\r\n        session_.update(new Uint8Array(this.response));\r\n      }\r\n    };\r\n    xhr.onabort = function() {\r\n      console.log('license request abort');\r\n    };\r\n    xhr.onerror = function() {\r\n      console.log('license request error');\r\n    };\r\n\r\n    // BD\r\n    var updateHeaders = function(headers) {\r\n      var key;\r\n      if (headers) {\r\n        for (key in headers) {\r\n          console.log('DRM: key: ' + key + ', value: ' + headers[key]);\r\n          xhr.setRequestHeader(key, headers[key]);\r\n        }\r\n      }\r\n    };\r\n\r\n    updateHeaders(streamInfo_.drm.headers);\r\n    // ED\r\n\r\n    //xhr.setRequestHeader('Content-Type', 'text/xml; charset=utf-8');\r\n    //xhr.setRequestHeader('SOAPAction', '\\\"http://schemas.microsoft.com/DRM/2007/03/protocols/AcquireLicense\\\"');\r\n    let body = keySystem_.getLicenseRequestFromMessage(ev.message);\r\n    console.log('body: ', body);\r\n    xhr.send(body);\r\n  }\r\n\r\n  function onSessionChange(ev) {\r\n    let a = 2;\r\n    let b = a;\r\n  }\r\n\r\n  function setDrmInfo(streamInfo) {\r\n    console.log('--setDrmInfo in 21Jan2015--');\r\n    streamInfo_ = streamInfo;\r\n  }\r\n\r\n  function requestKeySystemAccess() {\r\n    let audioCapabilities = [];\r\n    let videoCapabilities = [];\r\n    let robustnessLevel = ''; // SW_SECURE_CRYPTO\r\n    if (streamInfo_.drm.audioCodec) {\r\n      audioCapabilities.push(new MediaCapability(streamInfo_.drm.audioCodec, robustnessLevel));\r\n    }\r\n    if (streamInfo_.drm.videoCodec) {\r\n      videoCapabilities.push(new MediaCapability(streamInfo_.drm.videoCodec, robustnessLevel));\r\n    }\r\n\r\n    let ksConfig = new KeySystemConfiguration(\r\n      audioCapabilities, videoCapabilities, 'optional', 'optional', ['temporary']);\r\n\r\n    let configs_ = [];\r\n    configs_.push(ksConfig);\r\n\r\n    // BD\r\n    //dumpKSConfig(keySystem_.systemString, ksConfig);\r\n    // ED\r\n\r\n    return navigator.requestMediaKeySystemAccess(keySystem_.systemString, configs_)\r\n      .then(function(keySystemAccess) {\r\n        console.log('H5Player, requestMediaKeySystemAccess is ok');\r\n        return keySystemAccess.createMediaKeys();\r\n      })\r\n      .then(function(mediaKeys) {\r\n        console.log('H5Player, createMediaKeys is ok, mediaKeys: ' + mediaKeys);\r\n        let ret = media_.setMediaKeys(mediaKeys);\r\n        return ret;\r\n      })\r\n      .then(function() {\r\n        // create session\r\n        let mediaKeys = media_.mediaKeys;\r\n        session_ = mediaKeys.createSession('temporary');\r\n        session_.addEventListener('message', onSessionMessage, false);\r\n        session_.addEventListener('keystatuseschange', onSessionChange, false);\r\n        session_.generateRequest(initDataType_, initData_).then(function() {\r\n          console.log('generateRequest is ok');\r\n        }).catch(function(error) {\r\n          console.error('generateRequest failed at: ', error);\r\n        });\r\n      }).catch(function(error) {\r\n        console.error('Failed to set up MediaKeys', error);\r\n      });\r\n  }\r\n\r\n  let instance_ = {\r\n    attachMedia: attachMedia,\r\n    detachMedia: detachMedia,\r\n    setKeySystem: setKeySystem,\r\n    setDrmInfo: setDrmInfo\r\n  };\r\n  return instance_;\r\n}\r\n\r\nexport default ProtectionModel_21Jan2015;","import FactoryMaker from '../../core/FactoryMaker';\r\nimport StringUtils from '../../utils/string_utils';\r\n\r\nimport MediaCapability from '../vo/MediaCapability';\r\nimport KeySystemConfiguration from '../vo/KeySystemConfiguration';\r\nimport KSUtils from '../vo/KSUtils';\r\nimport CommonEncryption from '../vo/CommonEncryption';\r\nimport BASE64 from '../../externals/base64';\r\n\r\nimport KeySystemPlayReady from '../drm/KeySystemPlayReady';\r\n\r\n/**\r\n * Most recent EME implementation\r\n *\r\n * Implemented by IE11\r\n */\r\nfunction ProtectionModel_3Feb2014(media) {\r\n  let context_ = this.context;\r\n  let media_ = null;\r\n  let streamInfo_ = null;\r\n  let session_ = null;\r\n  let keySystem_ = null;\r\n  let mediaKeys_ = null;\r\n\r\n  function attachMedia(media) {\r\n    media_ = media;\r\n\r\n    media_.addEventListener('msneedkey', onNeedKey);\r\n  }\r\n\r\n  function detachMedia() {\r\n    if (media_) {\r\n      media_.addEventListener('msneedkey', onNeedKey);\r\n    }\r\n  }\r\n\r\n  function setKeySystem(keySystem) {\r\n    keySystem_ = keySystem;\r\n  }\r\n\r\n  function setDrmInfo(streamInfo) {\r\n    streamInfo_ = streamInfo;\r\n  }\r\n\r\n  function onNeedKey(ev) {\r\n    let initDataType = 'cenc';\r\n    // Some browsers return initData as Uint8Array (IE), some as ArrayBuffer (Chrome).\r\n    // Convert to ArrayBuffer\r\n    var abInitData = ev.initData;\r\n    if (ArrayBuffer.isView(abInitData)) {\r\n      abInitData = abInitData.buffer;\r\n    }\r\n\r\n    let pssh = CommonEncryption.parsePSSHList(abInitData);\r\n    let uuid = KSUtils.GetKSUUID(streamInfo_.drm.type);\r\n\r\n    let actualInitData = pssh[uuid];\r\n\r\n    // select key system\r\n    if (media_.readyState >= 1) {\r\n      mediaKeys_ = new window.MSMediaKeys(keySystem_.systemString);\r\n      media_.msSetMediaKeys(mediaKeys_);\r\n\r\n      session_ = mediaKeys_.createSession(streamInfo.drm.videoCodec, new Uint8Array(abInitData));\r\n      session_.addEventListener('mskeyerror', onSessionError);\r\n      session_.addEventListener('mskeymessage', onSessionMessage);\r\n      session_.addEventListener('mskeyadded', onSessionAdded);\r\n      session_.addEventListener('mskeyclose', onSessionClose);\r\n    }\r\n  }\r\n\r\n  function onSessionError(ev) {}\r\n\r\n  function onSessionMessage(ev) {\r\n    console.log('DRM: Key Message');\r\n\r\n    let abMessage = ev.message;\r\n    if (ArrayBuffer.isView(abMessage)) {\r\n      abMessage = abMessage.buffer;\r\n    }\r\n\r\n    // license request here\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open('POST', streamInfo_.drm.laUrl, true);\r\n    xhr.responseType = 'arraybuffer';\r\n    xhr.onload = function() {\r\n      if (this.status === 200) {\r\n        session_.update(new Uint8Array(this.response));\r\n      }\r\n    };\r\n    xhr.onabort = function() {\r\n      console.log('DRM: xhr abort');\r\n    };\r\n    xhr.onerror = function() {\r\n      console.log('DRM: xhr error');\r\n    };\r\n\r\n    // \r\n    let headers = keySystem_.getRequestHeadersFromMessage(abMessage);\r\n    for (let key in headers) {\r\n      if ('authorization' === key.toLowerCase()) {\r\n        xhr.withCredentials = true;\r\n      }\r\n      xhr.setRequestHeader(key, headers[key]);\r\n    }\r\n\r\n    xhr.send(keySystem_.getLicenseRequestFromMessage(abMessage));\r\n  }\r\n\r\n  function onSessionAdded(ev) {\r\n    console.log('DRM: Key added');\r\n  }\r\n\r\n  function onSessionClose(ev) {\r\n\r\n  }\r\n\r\n  function requestKeySystemAccess() {\r\n    let ksString = KSUtils.GetKSString(streamInfo_.drm.type);\r\n\r\n    let audioCapabilities = [];\r\n    let videoCapabilities = [];\r\n    let robustnessLevel = '';\r\n    if (streamInfo_.drm.audioCodec) {\r\n      audioCapabilities.push(new MediaCapability(streamInfo_.drm.audioCodec, robustnessLevel));\r\n    }\r\n    if (streamInfo_.drm.videoCodec) {\r\n      videoCapabilities.push(new MediaCapability(streamInfo_.drm.videoCodec, robustnessLevel));\r\n    }\r\n\r\n    let ksConfig = new KeySystemConfiguration(\r\n      audioCapabilities, videoCapabilities, 'optional', 'optional', ['temporary']);\r\n\r\n    let configs_ = [];\r\n    configs_.push(ksConfig);\r\n\r\n    // check is supported?\r\n    for (let configIdx = 0; configIdx < configs_.length; configIdx++) {\r\n      let videos = configs_[configIdx].videoCapabilities;\r\n\r\n      // Look for supported video container/codecs\r\n      if (videos && videos.length !== 0) {\r\n        for (let videoIdx = 0; videoIdx < videos.length; videoIdx++) {\r\n          if (window['MSMediaKeys'].isTypeSupported(ksString, videos[videoIdx].contentType)) {\r\n\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // \r\n    selectKeySystem(ksString);\r\n  }\r\n\r\n  function selectKeySystem(ksString) {\r\n    let mediaKeys = new window['MSMediaKeys'](ksString);\r\n\r\n    if (media_.readyState >= 1) {\r\n      media_.msSetMediaKeys(mediaKeys);\r\n    }\r\n  }\r\n\r\n  function createKeySession(initData) {}\r\n\r\n  let instance_ = {\r\n    attachMedia: attachMedia,\r\n    detachMedia: detachMedia,\r\n    setKeySystem: setKeySystem,\r\n    setDrmInfo: setDrmInfo\r\n  };\r\n  return instance_;\r\n}\r\n\r\nexport default ProtectionModel_3Feb2014;","/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport BASE64 from '../../externals/base64';\n\nclass CommonEncryption {\n  /**\n   * Find and return the ContentProtection element in the given array\n   * that indicates support for MPEG Common Encryption\n   *\n   * @param {Array} cpArray array of content protection elements\n   * @returns {Object|null} the Common Encryption content protection element or\n   * null if one was not found\n   */\n  static findCencContentProtection(cpArray) {\n    var retVal = null;\n    for (var i = 0; i < cpArray.length; ++i) {\n      var cp = cpArray[i];\n      if (cp.schemeIdUri.toLowerCase() === 'urn:mpeg:dash:mp4protection:2011' &&\n        cp.value.toLowerCase() === 'cenc')\n        retVal = cp;\n    }\n    return retVal;\n  }\n\n  /**\n   * Returns just the data portion of a single PSSH\n   *\n   * @param {ArrayBuffer} pssh - the PSSH\n   * @return {ArrayBuffer} data portion of the PSSH\n   */\n  static getPSSHData(pssh) {\n    var offset = 8; // Box size and type fields\n    var view = new DataView(pssh);\n\n    // Read version\n    var version = view.getUint8(offset);\n\n    offset += 20; // Version (1), flags (3), system ID (16)\n\n    if (version > 0) {\n      offset += 4 + (16 * view.getUint32(offset)); // Key ID count (4) and All key IDs (16*count)\n    }\n\n    offset += 4; // Data size\n    return pssh.slice(offset);\n  }\n\n  /**\n   * Returns the PSSH associated with the given key system from the concatenated\n   * list of PSSH boxes in the given initData\n   *\n   * @param {KeySystem} keySystem the desired\n   * key system\n   * @param {ArrayBuffer} initData 'cenc' initialization data.  Concatenated list of PSSH.\n   * @returns {ArrayBuffer|null} The PSSH box data corresponding to the given key system, null if not found\n   * or null if a valid association could not be found.\n   */\n  static getPSSHForKeySystem(keySystem, initData) {\n    var psshList = CommonEncryption.parsePSSHList(initData);\n    if (psshList.hasOwnProperty(keySystem.uuid.toLowerCase())) {\n      return psshList[keySystem.uuid.toLowerCase()];\n    }\n    return null;\n  }\n\n  /**\n   * Parse a standard common encryption PSSH which contains a simple\n   * base64-encoding of the init data\n   *\n   * @param {Object} cpData the ContentProtection element\n   * @returns {ArrayBuffer|null} the init data or null if not found\n   */\n  static parseInitDataFromContentProtection(cpData) {\n    if ('pssh' in cpData) {\n      return BASE64.decodeArray(cpData.pssh.__text).buffer;\n    }\n    return null;\n  }\n\n  /**\n   * Parses list of PSSH boxes into keysystem-specific PSSH data\n   *\n   * @param {ArrayBuffer} data - the concatenated list of PSSH boxes as provided by\n   * CDM as initialization data when CommonEncryption content is detected\n   * @returns {Object|Array} an object that has a property named according to each of\n   * the detected key system UUIDs (e.g. 00000000-0000-0000-0000-0000000000)\n   * and a ArrayBuffer (the entire PSSH box) as the property value\n   */\n  // you can refer https://www.w3.org/TR/eme-initdata-cenc/ for more detail.\n  static parsePSSHList(data) {\n\n    if (data === null)\n      return [];\n\n    var dv = new DataView(data);\n    var done = false;\n    var pssh = {};\n\n    // TODO: Need to check every data read for end of buffer\n    var byteCursor = 0;\n    while (!done) {\n\n      var size,\n        nextBox,\n        version,\n        systemID,\n        psshDataSize;\n      var boxStart = byteCursor;\n\n      if (byteCursor >= dv.buffer.byteLength)\n        break;\n\n      /* Box size */\n      size = dv.getUint32(byteCursor);\n      nextBox = byteCursor + size;\n      byteCursor += 4;\n\n      /* Verify PSSH */\n      if (dv.getUint32(byteCursor) !== 0x70737368) {\n        byteCursor = nextBox;\n        continue;\n      }\n      byteCursor += 4;\n\n      /* Version must be 0 or 1 */\n      version = dv.getUint8(byteCursor);\n      if (version !== 0 && version !== 1) {\n        byteCursor = nextBox;\n        continue;\n      }\n      byteCursor++;\n\n      byteCursor += 3; /* skip flags */\n\n      // 16-byte UUID/SystemID\n      systemID = '';\n      var i, val;\n      for (i = 0; i < 4; i++) {\n        val = dv.getUint8(byteCursor + i).toString(16);\n        systemID += (val.length === 1) ? '0' + val : val;\n      }\n      byteCursor += 4;\n      systemID += '-';\n      for (i = 0; i < 2; i++) {\n        val = dv.getUint8(byteCursor + i).toString(16);\n        systemID += (val.length === 1) ? '0' + val : val;\n      }\n      byteCursor += 2;\n      systemID += '-';\n      for (i = 0; i < 2; i++) {\n        val = dv.getUint8(byteCursor + i).toString(16);\n        systemID += (val.length === 1) ? '0' + val : val;\n      }\n      byteCursor += 2;\n      systemID += '-';\n      for (i = 0; i < 2; i++) {\n        val = dv.getUint8(byteCursor + i).toString(16);\n        systemID += (val.length === 1) ? '0' + val : val;\n      }\n      byteCursor += 2;\n      systemID += '-';\n      for (i = 0; i < 6; i++) {\n        val = dv.getUint8(byteCursor + i).toString(16);\n        systemID += (val.length === 1) ? '0' + val : val;\n      }\n      byteCursor += 6;\n\n      systemID = systemID.toLowerCase();\n\n      /* PSSH Data Size */\n      psshDataSize = dv.getUint32(byteCursor);\n      byteCursor += 4;\n\n      /* PSSH Data */\n      pssh[systemID] = dv.buffer.slice(boxStart, nextBox);\n      byteCursor = nextBox;\n    }\n\n    return pssh;\n  }\n}\n\nexport default CommonEncryption;","const KSUtils = {\n  GetKSString: function(drmType) {\n    if (drmType === 'widevine') {\n      return 'com.widevine.alpha';\n    } else if (drmType === 'playready') {\n      return 'com.microsoft.playready';\n    } else if (drmType === 'chromecast.playready') {\n      return 'com.chromecast.playready';\n    }\n  },\n\n  GetKSUUID: function(drmType) {\n    if (drmType === 'widevine') {\n      return 'edef8ba9-79d6-4ace-a3c8-27dcd51d21ed';\n    } else if (drmType === 'playready') {\n      return '9a04f079-9840-4286-ab92-e65be0885f95';\n    } else if (drmType === 'chromecast.playready') {\n      return '9a04f079-9840-4286-ab92-e65be0885f95';\n    }\n  }\n};\n\nmodule.exports = KSUtils;","/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\n\n/**\n * @classdesc Represents a set of configurations that describe the capabilities desired for\n *  support by a given CDM\n * @ignore\n */\nclass KeySystemConfiguration {\n  /**\n   * @param {Array.<MediaCapability>} audioCapabilities array of\n   * desired audio capabilities.  Higher preference capabilities should be placed earlier\n   * in the array.\n   * @param {Array.<MediaCapability>} videoCapabilities array of\n   * desired video capabilities.  Higher preference capabilities should be placed earlier\n   * in the array.\n   * @param {string} distinctiveIdentifier desired use of distinctive identifiers.\n   * One of \"required\", \"optional\", or \"not-allowed\"\n   * @param {string} persistentState desired support for persistent storage of\n   * key systems.  One of \"required\", \"optional\", or \"not-allowed\"\n   * @param {Array.<string>} sessionTypes List of session types that must\n   * be supported by the key system\n   * @class\n   */\n  constructor(audioCapabilities, videoCapabilities, distinctiveIdentifier, persistentState, sessionTypes) {\n    // new\n    //this.initDataTypes = [ 'keyids' ];\n    this.initDataTypes = ['cenc'];\n\n    if (audioCapabilities && audioCapabilities.length) {\n      this.audioCapabilities = audioCapabilities;\n    }\n    if (videoCapabilities && videoCapabilities.length) {\n      this.videoCapabilities = videoCapabilities;\n    }\n    this.distinctiveIdentifier = distinctiveIdentifier;\n    this.persistentState = persistentState;\n    this.sessionTypes = sessionTypes;\n  }\n}\n\nexport default KeySystemConfiguration;","/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\n/**\n * @classdesc A media capability\n * @ignore\n */\nclass MediaCapability {\n  /**\n   * @param {string} contentType MIME type and codecs (RFC6386)\n   * @param {string} robustness\n   * @class\n   * @ignore\n   */\n  constructor(contentType, robustness) {\n    this.contentType = contentType;\n    this.robustness = robustness;\n  }\n}\n\nexport default MediaCapability;","module.exports = __webpack_public_path__ + \"./assets/img/logo.png\";","// extracted by mini-css-extract-plugin","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport UITools from '../ui_tools';\r\nimport Events from '../events';\r\nimport ID from '../id';\r\nimport CONSTS from '../consts';\r\n\r\nclass UIAdsContainer {\r\n  constructor(props) {\r\n    this.props = props;\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n\r\n    this.vopAdContainer = document.querySelector('.vop-ads-container');\r\n    this.onAdContainerMouseDown = this.onAdContainerMouseDown.bind(this);\r\n    this.vopAdContainer.addEventListener('mousedown', this.onAdContainerMouseDown);\r\n\r\n    //\r\n    this.onAdStarted = this.onAdStarted.bind(this);\r\n    this.onAdComplete = this.onAdComplete.bind(this);\r\n    this.player.on(oldmtn.Events.AD_STARTED, this.onAdStarted);\r\n    this.player.on(oldmtn.Events.AD_COMPLETE, this.onAdComplete);\r\n  }\r\n\r\n  onAdStarted(e) {\r\n    // BD\r\n    let videos = document.getElementsByTagName('video');\r\n    myPrintLog('onAdStarted, linear: ' + e.linear + ', videos length: ' + videos.length);\r\n    // ED\r\n\r\n    if (!this.vopPlayer) {\r\n      this.vopPlayer = document.querySelector('.html5-video-player');\r\n    }\r\n\r\n    this.flagAdStarted = true;\r\n    this.flagIsLinearAd = e.linear;\r\n    this.flagIsVpaidAd = e.vpaid;\r\n\r\n    // update control bar ui\r\n    if (this.flagIsVpaidAd) {\r\n      this.vopAdContainer.style.zIndex = '3';\r\n    } else {\r\n      if (this.flagIsLinearAd) {\r\n        this.vopAdContainer.style.zIndex = '1';\r\n      } else {\r\n        let adDstWidth = this.vopPlayer.clientWidth;\r\n        let adDstHeight = e.height + 10;\r\n        this.player.resize(adDstWidth, e.height + 5);\r\n        this.vopAdContainer.style.bottom = CONSTS.BOTTOM_BAR_HEIGHT.toString() + 'px';\r\n        //this.vopAdContainer.style.width = adDstWidth.toString() + 'px';\r\n        this.vopAdContainer.style.height = adDstHeight.toString() + 'px';\r\n        this.vopAdContainer.style.zIndex = '1';\r\n\r\n        // Consider ad height.\r\n        //this.updateCaptionOverlay();\r\n      }\r\n    }\r\n  }\r\n\r\n  onAdComplete(e) {\r\n    myPrintLog('onAdComplete, linear: ' + this.flagIsLinearAd);\r\n    this.flagAdStarted = false;\r\n\r\n    if (this.flagIsVpaidAd) {\r\n      this.vopAdContainer.style.zIndex = 'auto';\r\n    } else {\r\n      if (this.flagIsLinearAd) {\r\n        this.vopAdContainer.style.zIndex = 'auto';\r\n      } else {\r\n        this.vopAdContainer.style.zIndex = 'auto';\r\n      }\r\n    }\r\n  }\r\n\r\n  onAdContainerMouseDown(e) {\r\n    // If ad is playing, it will overlay on the top of 'html5-video-player',\r\n    // when click on ad, we should stop this event transfer to its parent.\r\n    if (this.flagAdStarted) {\r\n      e.stopPropagation();\r\n    }\r\n  }\r\n}\r\n\r\nexport default UIAdsContainer;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport UITools from '../ui_tools';\r\n\r\nclass UIAirplayToggleButton extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.vopAirplayButton = document.querySelector('.vop-airplay-button');\r\n\r\n    this.onAdStarted = this.onAdStarted.bind(this);\r\n    this.onAdComplete = this.onAdComplete.bind(this);\r\n    this.player.on(oldmtn.Events.AD_STARTED, this.onAdStarted);\r\n    this.player.on(oldmtn.Events.AD_COMPLETE, this.onAdComplete);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.player.off(oldmtn.Events.AD_STARTED, this.onAdStarted);\r\n    this.player.off(oldmtn.Events.AD_COMPLETE, this.onAdComplete);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <button className={'vop-button vop-airplay-button'} title='airplay'\r\n        onClick={this.onUICmdAirplay.bind(this)}>\r\n      </button>\r\n    );\r\n  }\r\n\r\n  onUICmdAirplay() {\r\n    this.player.showPlaybackTargetPicker();\r\n  }\r\n\r\n  onAdStarted(e) {\r\n    this.flagAdStarted = true;\r\n    this.flagIsLinearAd = e.linear;\r\n    this.flagIsVpaidAd = e.vpaid;\r\n\r\n    if (this.flagAdStarted && this.flagIsLinearAd) {\r\n      this.vopAirplayButton.style.display = 'none';\r\n    } else {\r\n      this.vopAirplayButton.style.display = 'inline-block';\r\n    }\r\n  }\r\n\r\n  onAdComplete() {\r\n    this.vopAirplayButton.style.display = 'inline-block';\r\n  }\r\n}\r\n\r\nexport default UIAirplayToggleButton;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\nimport Events from '../events';\r\nimport ID from '../id';\r\n\r\nclass UIAudioTrackMenu extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n    this.evEmitter = this.main.evEmitter;\r\n\r\n    this.onMenuBackClick_ = this.onMenuBackClick.bind(this);\r\n    this.onMenuItemClick_ = this.onMenuItemClick.bind(this);\r\n    this.onMenuItemBlur_ = this.onMenuItemBlur.bind(this);\r\n\r\n    this.onPopupMenuChange = this.onPopupMenuChange.bind(this);\r\n    this.evEmitter.on(Events.POPUPMENU_CHANGE, this.onPopupMenuChange);\r\n\r\n    this.audioTrackData = {\r\n      audioTrackList: [{\r\n        id: '1',\r\n        lang: 'English'\r\n      }, {\r\n        id: '2',\r\n        lang: 'French'\r\n      }, {\r\n        id: '3',\r\n        lang: 'Chinese'\r\n      }, {\r\n        id: '4',\r\n        lang: 'Dutch'\r\n      }, {\r\n        id: '5',\r\n        lang: 'Spanish'\r\n      }, {\r\n        id: '6',\r\n        lang: 'Korean'\r\n      }],\r\n      currAudioTrackId: '1'\r\n    };\r\n    this.state = {\r\n      audioTrackData: this.audioTrackData\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.vopAudioTrackMenu = document.querySelector('.vop-audio-track-menu');\r\n  }\r\n\r\n  render() {\r\n    console.log('UIAudioTrackMenu, render');\r\n\r\n    const {\r\n      audioTrackData\r\n    } = this.state;\r\n\r\n    const menuitems = audioTrackData.audioTrackList.map((item, index) =>\r\n      <div key={index} className=\"vop-menuitem\" role=\"menuitemradio\"\r\n        aria-checked={audioTrackData.currAudioTrackId === item.id}\r\n        data-id={item.id} onClick={this.onMenuItemClick_}\r\n        tabIndex=\"0\" onBlur={this.onMenuItemBlur_}>\r\n        <div className=\"vop-menuitem-label\">\r\n          <span>{ item.lang }</span>\r\n        </div>\r\n      </div>\r\n    );\r\n\r\n    return (\r\n      <div className=\"vop-audio-track-menu\" style=\"display: none;\">\r\n        <div className=\"vop-panel-header\">\r\n          <button className=\"vop-panel-title\" onClick={this.onMenuBackClick_}>AudioTrack</button>\r\n        </div>\r\n        <div className=\"vop-panel-menu\">\r\n          { menuitems }\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onMenuBackClick(e) {\r\n    this.main.settingMenuUIData.currMenu = 'settings_menu';\r\n    this.evEmitter.emit(Events.POPUPMENU_CHANGE, {\r\n      menu: this.main.settingMenuUIData.currMenu\r\n    });\r\n  }\r\n\r\n  onMenuItemClick(e) {\r\n    let nextFocus = e.currentTarget;\r\n    this.audioTrackData.currAudioTrackId = nextFocus.dataset.id;\r\n    this.setState({\r\n      audioTrackData: this.audioTrackData\r\n    });\r\n  }\r\n\r\n  onMenuItemBlur(e) {\r\n    if (this.main.settingMenuUIData.currMenu !== 'fcc_menu') {\r\n      return;\r\n    }\r\n    this.main.onAudioTrackMenuItemBlur(e);\r\n  }\r\n\r\n  onPopupMenuChange(e) {\r\n    if (e.menu === 'audio_track_menu') {\r\n      this.vopAudioTrackMenu.style.display = 'block';\r\n      let v = this.vopAudioTrackMenu.querySelector('.vop-menuitem');\r\n      if (v) {\r\n        v.focus();\r\n      }\r\n    } else {\r\n      this.vopAudioTrackMenu.style.display = 'none';\r\n    }\r\n  }\r\n}\r\n\r\nexport default UIAudioTrackMenu;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport UIProgressBar from './ui_progress_bar';\r\nimport UIControlBar from './ui_control_bar';\r\n\r\nclass UIBottomBar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"vop-bottom-bar\"\r\n        onMouseDown={this.onUICmdControlBarMouseDown.bind(this)}>\r\n        <UIProgressBar main={this.main} />\r\n        <UIControlBar main={this.main} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onUICmdControlBarMouseDown(e) {\r\n    e.stopPropagation();\r\n  }\r\n}\r\n\r\nexport default UIBottomBar;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport UITools from '../ui_tools';\r\n\r\nclass UIBufferingOverlay extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n\r\n    this.onMediaPlaying = this.onMediaPlaying.bind(this);\r\n    this.onMediaWaiting = this.onMediaWaiting.bind(this);\r\n\r\n    this.player.on(oldmtn.Events.MEDIA_WAITING, this.onMediaWaiting);\r\n    this.player.on(oldmtn.Events.MEDIA_PLAYING, this.onMediaPlaying);\r\n  }\r\n\r\n  componentDidMount() {}\r\n\r\n  componentWillUnmount() {}\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"vop-spinner\">\r\n        <div className=\"vop-spinner-container\">\r\n          <div className=\"vop-spinner-rotator\">\r\n            <div className=\"vop-spinner-left\">\r\n              <div className=\"vop-spinner-circle\">\r\n              </div>\r\n            </div>\r\n            <div className=\"vop-spinner-right\">\r\n              <div className=\"vop-spinner-circle\">\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onMediaWaiting() {\r\n    if (!this.vopPlayer) {\r\n      this.vopPlayer = document.querySelector('.html5-video-player');\r\n    }\r\n    UITools.addClass(this.vopPlayer, 'vop-buffering');\r\n  }\r\n\r\n  onMediaPlaying() {\r\n    if (!this.vopPlayer) {\r\n      this.vopPlayer = document.querySelector('.html5-video-player');\r\n    }\r\n    UITools.removeClass(this.vopPlayer, 'vop-buffering');\r\n  }\r\n}\r\n\r\nexport default UIBufferingOverlay;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport Events from '../events';\r\nimport CONSTS from '../consts';\r\n\r\nimport {\r\n  identity,\r\n  difference,\r\n  isNumber,\r\n  isFinite,\r\n  filter\r\n} from '../../../externals/underscore';\r\n\r\nclass UICaptionOverlay extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n    this.evEmitter = this.main.evEmitter;\r\n\r\n    this.onTrackAdded = this.onTrackAdded.bind(this);\r\n    this.onTrackChanged = this.onTrackChanged.bind(this);\r\n    this.player.on(oldmtn.Events.TRACK_ADDED, this.onTrackAdded);\r\n    this.player.on(oldmtn.Events.TRACK_CHANGED, this.onTrackChanged);\r\n\r\n    this.onMediaTimeupdated = this.onMediaTimeupdated.bind(this);\r\n    this.player.on(oldmtn.Events.MEDIA_TIMEUPDATE, this.onMediaTimeupdated);\r\n\r\n    this.onAutoHideChange = this.onAutoHideChange.bind(this);\r\n    this.evEmitter.on(Events.AUTOHIDE_CHANGE, this.onAutoHideChange);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.vopCaptionOverlay = document.querySelector('.vop-caption-overlay');\r\n  }\r\n\r\n  render() {\r\n    let captionStyle = {};\r\n    captionStyle.backgroundColor = 'yellow';\r\n    captionStyle.color = 'red';\r\n\r\n    // line-height: normal;\r\n    // text-align: center;\r\n\r\n    return (\r\n      <div className=\"vop-caption-overlay\" style={captionStyle}>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onMediaTimeupdated(e) {\r\n    let pos = this.player.getPosition();\r\n\r\n    let cues = [];\r\n    if (this.textTrack_) {\r\n      cues = this.getCurrentCues(this.textTrack_.data, pos);\r\n    }\r\n\r\n    this.updateCurrentCues(cues);\r\n    this.renderCues();\r\n  }\r\n\r\n  onAutoHideChange(e) {\r\n    const height = CONSTS.BOTTOM_BAR_HEIGHT;\r\n    if (e.autohide) {\r\n      this.vopCaptionOverlay.style.bottom = '0px';\r\n    } else {\r\n      this.vopCaptionOverlay.style.bottom = height.toString() + 'px';\r\n    }\r\n  }\r\n\r\n  onTrackAdded(e) {\r\n    if (this.currTrackId_ !== e.currTrackId) {\r\n      this.currTrackId_ = e.currTrackId;\r\n      this.textTrack_ = e.track;\r\n    }\r\n  }\r\n\r\n  onTrackChanged(e) {\r\n    if (this.currTrackId_ !== e.currTrackId) {\r\n      this.currTrackId_ = e.currTrackId;\r\n      this.textTrack_ = this.player.getCurrentSubtitleTrack();\r\n    }\r\n  }\r\n\r\n  // Tools\r\n  getCurrentCues(allCues, pos) {\r\n    return filter(allCues, function(cue) {\r\n      return pos >= (cue.start) && (!cue.end || pos <= cue.end);\r\n    });\r\n  }\r\n\r\n  updateCurrentCues(cues) {\r\n    // Render with vtt.js if there are cues, clear if there are none\r\n    if (!cues.length) {\r\n      this.currentCues_ = [];\r\n    } else if (difference(cues, this.currentCues_).length) {\r\n      this.currentCues_ = cues;\r\n    }\r\n  }\r\n\r\n  renderCues() {\r\n    if (this.currentCues_.length > 0) {\r\n      const cue = this.currentCues_[0];\r\n      this.vopCaptionOverlay.innerText = cue.data;\r\n    } else {\r\n      this.vopCaptionOverlay.innerText = '';\r\n    }\r\n  }\r\n}\r\n\r\nexport default UICaptionOverlay;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nclass UIChromecastOverlay extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n\r\n    this.onCastConnected = this.onCastConnected.bind(this);\r\n    this.onCastDisconnected = this.onCastDisconnected.bind(this);\r\n    this.player.on(oldmtn.Events.CAST_CONNECTED, this.onCastConnected);\r\n    this.player.on(oldmtn.Events.CAST_DISCONNECTED, this.onCastDisconnected);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className='vop-chromecast-overlay'>\r\n        <div className='vop-chromecast-status'>\r\n          <div className='vop-chromecast-status-icon'></div>\r\n          <div className='vop-chromecast-status-info'>Playing on</div>\r\n          <div className='vop-chromecast-status-title'>Joseph TV(2nd Gen)</div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onCastConnected() {\r\n    if (!this.vopPlayer) {\r\n      this.vopPlayer = document.querySelector('.html5-video-player');\r\n    }\r\n\r\n    UITools.addClass(this.vopPlayer, 'vop-chromecast-connected');\r\n  }\r\n\r\n  onCastDisconnected() {\r\n    if (!this.vopPlayer) {\r\n      this.vopPlayer = document.querySelector('.html5-video-player');\r\n    }\r\n\r\n    UITools.removeClass(this.vopPlayer, 'vop-chromecast-connected');\r\n  }\r\n\r\n}\r\n\r\nexport default UIChromecastOverlay;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport UITools from '../ui_tools';\r\n\r\nclass UIChromecastToggleButton extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n  }\r\n\r\n  render() {\r\n    let btnStyle = {};\r\n    if (this.main.flagAdStarted && this.main.flagIsLinearAd) {\r\n      btnStyle.display = 'none';\r\n    } else {\r\n      btnStyle.display = 'inline-block';\r\n    }\r\n\r\n    return (\r\n      <button className={'vop-button vop-cast-button'} title='chromecast'\r\n        onClick={this.onUIComponentClick.bind(this)}\r\n        onMouseMove={this.onUIComponentMouseMove.bind(this)}\r\n        style={btnStyle}>\r\n      </button>\r\n    );\r\n  }\r\n\r\n  onUIComponentClick() {\r\n    this.player.castVideo();\r\n  }\r\n\r\n  onUIComponentMouseMove(e) {\r\n    this.main.onControlMouseMove(e);\r\n  }\r\n}\r\n\r\nexport default UIChromecastToggleButton;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport UIPlayToggleButton from './ui_play_toggle_button';\r\nimport UIVolumeToggleButton from './ui_volume_toggle_button';\r\nimport UIVolumeBar from './ui_volume_bar';\r\nimport UITimeLabel from './ui_time_label';\r\n\r\nimport UIPipToggleButton from './ui_pip_toggle_button';\r\nimport UIAirplayToggleButton from './ui_airplay_toggle_button';\r\nimport UIChromecastToggleButton from './ui_chromecast_toggle_button';\r\nimport UISubtitlesToggleButton from './ui_subtitles_toggle_button';\r\nimport UISettingsToggleButton from './ui_settings_toggle_button';\r\nimport UIFullscreenToggleButton from './ui_fullscreen_toggle_button';\r\n\r\nimport UIProgressBar from './ui_progress_bar';\r\n\r\nclass UIControlBar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"vop-control-bar\">\r\n        <UIPlayToggleButton main={this.main} />\r\n        <UIVolumeToggleButton main={this.main} />\r\n        <UIVolumeBar main={this.main} />\r\n        <UITimeLabel main={this.main} />\r\n        <div className=\"vop-spacer\"></div>\r\n        <UIPipToggleButton main={this.main} />\r\n        <UIAirplayToggleButton main={this.main} />\r\n        <UIChromecastToggleButton main={this.main} />\r\n        <UISubtitlesToggleButton main={this.main} />\r\n        <UISettingsToggleButton main={this.main} />\r\n        <UIFullscreenToggleButton main={this.main} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default UIControlBar;","import { h, Component } from 'preact';\n\nimport Events from '../events';\nimport { ErrorTypes } from '../../../core/errors';\n\nimport UITools from '../ui_tools';\n\nimport UITvNoiseCanvas from './ui_tvnoise_canvas';\n\nclass UIErrorMsgOverlay extends Component {\n  constructor(props) {\n    super(props);\n    this.main = this.props.main;\n    this.player = this.main.player;\n\n    this.onError = this.onError.bind(this);\n    this.player.on(oldmtn.Events.ERROR, this.onError);\n  }\n\n  componentDidMount() {\n    this.vopErrorMsgOverlay = document.querySelector('.vop-error-msg-overlay');\n    this.vopTvNoiseCanvas = document.querySelector('.vop-tvnoise-canvas');\n    this.vopErrorMsgText = document.querySelector('.vop-error-msg-text');\n\n    this.tvNoiseCanvas = new UITvNoiseCanvas({element: this.vopTvNoiseCanvas});\n  }\n\n  render() {\n    return (\n      <div className={'vop-error-msg-overlay'}>\n        <canvas className={'vop-tvnoise-canvas'}></canvas>\n        <span className={'vop-error-msg-text'}></span>\n      </div>\n    );\n  }\n\n  onError(e) {\n    if (e.type === ErrorTypes.LICENSE_ERROR) {\n      this.vopErrorMsgText.innerHTML = '<strong>License Error<\\/strong><br\\/>Could not find license.';\n      this.vopErrorMsgOverlay.style.display = 'block';\n\n      let canvasWidth = this.vopErrorMsgOverlay.clientWidth;\n      let canvasHeight = this.vopErrorMsgOverlay.clientHeight;\n      this.tvNoiseCanvas.start({width: canvasWidth, height: canvasHeight});\n    }\n  }\n}\n\nexport default UIErrorMsgOverlay;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport Events from '../events';\r\nimport ID from '../id';\r\n\r\nclass UIFccMenu extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.evEmitter = this.main.evEmitter;\r\n\r\n    this.onMenuBackClick_ = this.onMenuBackClick.bind(this);\r\n    this.onMenuItemClick_ = this.onMenuItemClick.bind(this);\r\n    this.onMenuItemBlur_ = this.onMenuItemBlur.bind(this);\r\n\r\n    this.onPopupMenuChange = this.onPopupMenuChange.bind(this);\r\n    this.onFccPropertyValueChange = this.onFccPropertyValueChange.bind(this);\r\n    this.evEmitter.on(Events.POPUPMENU_CHANGE, this.onPopupMenuChange);\r\n    this.evEmitter.on(Events.FCC_PROPERTY_VALUE_CHANGE, this.onFccPropertyValueChange);\r\n\r\n    this.fccData = {\r\n      currFccPropertyName: 'background_color', // only valid when currMenu is 'fcc_property_menu'.\r\n      isEnableFCC: true,\r\n      fccPropertyList: [{\r\n        // white/black(default)/red/green/blue/yellow/magenta/cyan\r\n        name: 'background_color',\r\n        values: ['white', 'black', 'red', 'green', 'blue', 'yellow', 'magenta', 'cyan'],\r\n        currValue: 'black'\r\n      }, {\r\n        name: 'background_opacity',\r\n        values: ['0%', '25%', '50%', '75%', '100%'],\r\n        currValue: '100%'\r\n      }, {\r\n        // white/black(default)/red/green/blue/yellow/magenta/cyan\r\n        name: 'font_color',\r\n        values: ['white', 'black', 'red', 'green', 'blue', 'yellow', 'magenta', 'cyan'],\r\n        currValue: 'black'\r\n      }, {\r\n        name: 'font_opacity',\r\n        values: ['0%', '25%', '50%', '75%', '100%'],\r\n        currValue: '100%'\r\n      }, {\r\n        // Arial(default)/Courier/Times New Roman/Helvetica/Dom/Coronet/Gothic\r\n        name: 'font_family',\r\n        values: ['Arial', 'Courier', 'Times New Roman', 'Helvetica', 'Dom', 'Coronet', 'Gothic'],\r\n        currValue: 'Arial'\r\n      }, {\r\n        // none/dropshadow/raised(default)/depressed/uniform\r\n        name: 'font_edge_type',\r\n        values: ['none', 'leftDropShadow', 'rightDropShadow', 'raised', 'depressed', 'uniform'],\r\n        currValue: 'none'\r\n      }, {\r\n        // white/black/red/green/blue(default)/yellow/magenta/cyan\r\n        name: 'font_edge_color',\r\n        values: ['white', 'black', 'red', 'green', 'blue', 'yellow', 'magenta', 'cyan'],\r\n        currValue: 'black'\r\n      }, {\r\n        name: 'font_edge_opacity',\r\n        values: ['0%', '25%', '50%', '75%', '100%'],\r\n        currValue: '100%'\r\n      }, {\r\n        name: 'font_size',\r\n        values: ['50%', '75%', '100%', '150%', '200%', '300%', '400%'],\r\n        currValue: '100%'\r\n      }, {\r\n        name: 'font_bold',\r\n        values: ['true', 'false'],\r\n        currValue: 'false'\r\n      }, {\r\n        name: 'font_underline',\r\n        values: ['true', 'false'],\r\n        currValue: 'false'\r\n      }, {\r\n        name: 'font_italic',\r\n        values: ['true', 'false'],\r\n        currValue: 'false'\r\n      }, {\r\n        // white/black/red/green/blue(default)/yellow/magenta/cyan\r\n        name: 'window_color',\r\n        values: ['white', 'black', 'red', 'green', 'blue', 'yellow', 'magenta', 'cyan'],\r\n        currValue: 'green'\r\n      }, {\r\n        name: 'window_color_opacity',\r\n        values: ['0%', '25%', '50%', '75%', '100%'],\r\n        currValue: '50%'\r\n      }, {\r\n        name: 'bounding_box',\r\n        values: ['Left', 'Top', 'Right', 'Bottom'],\r\n        currValue: 'Left'\r\n      }, {\r\n        name: 'horizontal_position',\r\n        values: ['left', 'center', 'right'],\r\n        currValue: 'left'\r\n      }, {\r\n        name: 'vertical_position',\r\n        values: ['top', 'middle', 'bottom'],\r\n        currValue: 'top'\r\n      }]\r\n    };\r\n    this.state = {\r\n      fccData: this.fccData\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.vopFccMenu = document.querySelector('.vop-fcc-menu');\r\n  }\r\n\r\n  render() {\r\n    myPrintLog('+render, UIFccMenu: ' + this.main.settingMenuUIData.currMenu);\r\n    const {\r\n      fccData\r\n    } = this.state;\r\n\r\n    const menuitems = fccData.fccPropertyList.map((item, index) =>\r\n      <div key={index} className=\"vop-menuitem\" role=\"menuitem\" aria-haspopup=\"true\"\r\n        data-id={item.name} onClick={this.onMenuItemClick_}\r\n        tabIndex=\"0\" onBlur={this.onMenuItemBlur_}>\r\n        <div className=\"vop-menuitem-label\">\r\n          <span>{ item.name }</span>\r\n        </div>\r\n        <div className=\"vop-menuitem-content\">\r\n          <span>{ item.currValue }</span>\r\n        </div>\r\n      </div>\r\n    );\r\n\r\n    return (\r\n      <div className=\"vop-fcc-menu\" style=\"display: none;\">\r\n        <div className=\"vop-panel-header\">\r\n          <button className=\"vop-panel-title\" onClick={this.onMenuBackClick_}>Fcc</button>\r\n        </div>\r\n        <div className=\"vop-panel-menu\">\r\n          { menuitems }\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onMenuBackClick(e) {\r\n    this.main.settingMenuUIData.currMenu = 'settings_menu';\r\n    this.evEmitter.emit(Events.POPUPMENU_CHANGE, {\r\n      menu: this.main.settingMenuUIData.currMenu\r\n    });\r\n  }\r\n\r\n  onMenuItemClick(e) {\r\n    myPrintLog('+onFccMenuItemClick, e.currentTarget.dataset.id: ' + e.currentTarget.dataset.id);\r\n\r\n    this.main.settingMenuUIData.currMenu = 'fcc_property_menu';\r\n\r\n    let currFccPropertyName = e.currentTarget.dataset.id;\r\n    let fccProperty;\r\n    for (let i = 0; i < this.fccData.fccPropertyList.length; i++) {\r\n      fccProperty = this.fccData.fccPropertyList[i];\r\n      if (currFccPropertyName === fccProperty.name) {\r\n        break;\r\n      }\r\n    }\r\n    this.evEmitter.emit(Events.POPUPMENU_CHANGE, {\r\n      menu: this.main.settingMenuUIData.currMenu,\r\n      fccProperty: fccProperty\r\n    });\r\n  }\r\n\r\n  onMenuItemBlur(e) {\r\n    if (this.main.settingMenuUIData.currMenu !== 'fcc_menu') {\r\n      return;\r\n    }\r\n    this.main.onFccMenuItemBlur(e);\r\n  }\r\n\r\n  onPopupMenuChange(e) {\r\n    if (e.menu === 'fcc_menu') {\r\n      this.vopFccMenu.style.display = 'block';\r\n      let v = this.vopFccMenu.querySelector('.vop-menuitem');\r\n      if (v) {\r\n        v.focus();\r\n      }\r\n    } else {\r\n      this.vopFccMenu.style.display = 'none';\r\n    }\r\n  }\r\n\r\n  onFccPropertyValueChange(e) {\r\n    let fccProperty = e.fccProperty;\r\n    for (let i = 0; i < this.fccData.fccPropertyList.length; i++) {\r\n      let tmpFccProperty = this.fccData.fccPropertyList[i];\r\n      if (tmpFccProperty.name === fccProperty.name) {\r\n        this.fccData.fccPropertyList[i] = fccProperty;\r\n        this.setState({\r\n          fccData: this.fccData\r\n        });\r\n        break;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default UIFccMenu;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport Events from '../events';\r\nimport ID from '../id';\r\n\r\nclass UIFccPropertyMenu extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n    this.evEmitter = this.main.evEmitter;\r\n\r\n    this.onMenuBackClick_ = this.onMenuBackClick.bind(this);\r\n    this.onMenuItemClick_ = this.onMenuItemClick.bind(this);\r\n    this.onMenuItemBlur_ = this.onMenuItemBlur.bind(this);\r\n\r\n    this.onPopupMenuChange = this.onPopupMenuChange.bind(this);\r\n    this.evEmitter.on(Events.POPUPMENU_CHANGE, this.onPopupMenuChange);\r\n\r\n    this.fccProperty = null;\r\n    this.state = {\r\n      fccProperty: this.fccProperty\r\n    };\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    let v = document.querySelector('.vop-fcc-property-menu');\r\n    if (v) {\r\n      let item = v.querySelector('.vop-menuitem');\r\n      if (item) {\r\n        item.focus();\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      fccProperty\r\n    } = this.state;\r\n\r\n    if (fccProperty) {\r\n      const menuitems = fccProperty.values.map((value, index) =>\r\n        <div key={index} className=\"vop-menuitem\" role=\"menuitemradio\"\r\n          aria-checked={fccProperty.currValue === value}\r\n          onClick={this.onMenuItemClick_} data-id={value}\r\n          tabIndex=\"0\" onBlur={this.onMenuItemBlur_}>\r\n          <div className=\"vop-menuitem-label\">\r\n            <span>{ value }</span>\r\n          </div>\r\n        </div>\r\n      );\r\n\r\n      return (\r\n        <div className=\"vop-fcc-property-menu\">\r\n          <div className=\"vop-panel-header\">\r\n            <button className=\"vop-panel-title\" onClick={this.onMenuBackClick_}>Fcc</button>\r\n          </div>\r\n          <div className=\"vop-panel-menu\">\r\n            { menuitems }\r\n          </div>\r\n        </div>\r\n      );\r\n    } else {\r\n      return (<div></div>);\r\n    }\r\n  }\r\n\r\n  onMenuBackClick(e) {\r\n    this.main.settingMenuUIData.currMenu = 'fcc_menu';\r\n    this.evEmitter.emit(Events.POPUPMENU_CHANGE, {\r\n      menu: this.main.settingMenuUIData.currMenu\r\n    });\r\n  }\r\n\r\n  onMenuItemClick(e) {\r\n    let currValue = e.currentTarget.dataset.id;\r\n    this.fccProperty.currValue = currValue;\r\n    this.setState({\r\n      fccProperty: this.fccProperty\r\n    });\r\n\r\n    this.evEmitter.emit(Events.FCC_PROPERTY_VALUE_CHANGE, {\r\n      fccProperty: this.fccProperty\r\n    });\r\n  }\r\n\r\n  onMenuItemBlur(e) {\r\n    if (this.main.settingMenuUIData.currMenu !== 'fcc_property_menu') {\r\n      return;\r\n    }\r\n\r\n    let prevFocus = e.target;\r\n    let nextFocus = e.relatedTarget;\r\n\r\n    if (nextFocus) {\r\n      if (nextFocus.dataset.id === ID.SETTINGS_BUTTON) {\r\n        // means we click 'setting' button, do nothing here, onUICmdSettings will handle for us.\r\n      } else {\r\n        if (prevFocus) {\r\n          if (-1 === prevFocus.className.indexOf('vop-menuitem')) {\r\n            // means click another item, do nothing here, on***ItemClick will handle for us.\r\n          } else {}\r\n        } else {}\r\n      }\r\n    } else {\r\n      this.main.settingMenuUIData.currMenu = 'none';\r\n      this.evEmitter.emit(Events.POPUPMENU_CHANGE, {\r\n        menu: this.main.settingMenuUIData.currMenu\r\n      });\r\n    }\r\n  }\r\n\r\n  onPopupMenuChange(e) {\r\n    if (e.menu === 'fcc_property_menu') {\r\n      this.fccProperty = e.fccProperty;\r\n    } else {\r\n      this.fccProperty = null;\r\n    }\r\n    this.setState({\r\n      fccProperty: this.fccProperty\r\n    });\r\n  }\r\n}\r\n\r\nexport default UIFccPropertyMenu;","import {\r\n  h\r\n} from 'preact';\r\nimport Preact from 'preact';\r\n\r\nimport UITools from '../ui_tools';\r\n\r\nclass UIFullscreenToggleButton extends Preact.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.vopFullscreenBtn = document.querySelector('.vop-fullscreen-button');\r\n\r\n    this.onFullscreenChanged = this.onFullscreenChanged.bind(this);\r\n    this.player.on(oldmtn.Events.FULLSCREEN_CHANGE, this.onFullscreenChanged);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.player.off(oldmtn.Events.FULLSCREEN_CHANGE, this.onFullscreenChanged);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <button className=\"vop-button vop-fullscreen-button icon-on\" title=\"fullscreen\"\r\n        onClick={this.onUICmdFullscreen.bind(this)}\r\n        onMouseMove={this.onControlMouseMove.bind(this)}>\r\n      </button>\r\n    );\r\n  }\r\n\r\n  onUICmdFullscreen() {\r\n    myPrintLog('+onBtnFullscreen');\r\n    if (this.player.isFullscreen()) {\r\n      UITools.leaveFullscreen();\r\n    } else {\r\n      let v = this.main.playerContainer;\r\n      UITools.enterFullscreen(v);\r\n    }\r\n  }\r\n\r\n  onControlMouseMove(e) {\r\n    this.main.onControlMouseMove(e);\r\n  }\r\n\r\n  onFullscreenChanged() {\r\n    let flagIsFullscreen = this.player.isFullscreen();\r\n    myPrintLog('fullscreen changed, ret: ' + flagIsFullscreen + ', width: ' + window.screen.width + ', height: ' + window.screen.height);\r\n\r\n    if (flagIsFullscreen) {\r\n      UITools.removeClass(this.vopFullscreenBtn, 'icon-on');\r\n      UITools.addClass(this.vopFullscreenBtn, 'icon-off');\r\n    } else {\r\n      UITools.removeClass(this.vopFullscreenBtn, 'icon-off');\r\n      UITools.addClass(this.vopFullscreenBtn, 'icon-on');\r\n    }\r\n  }\r\n}\r\n\r\nexport default UIFullscreenToggleButton;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nclass UIGradientBottom extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"vop-gradient-bottom\">\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default UIGradientBottom;","import {\r\n  h\r\n} from 'preact';\r\nimport Preact from 'preact';\r\n\r\nimport UITools from '../ui_tools';\r\n\r\nclass UIHugeButtonOverlay extends Preact.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.uiGiantButton = document.querySelector('.vop-huge-button');\r\n    this.uiGiantBtnContainer = document.querySelector('.vop-huge-button-container');\r\n\r\n    this.onMediaPlay = this.onMediaPlay.bind(this);\r\n    this.onMediaPaused = this.onMediaPaused.bind(this);\r\n    this.player.on(oldmtn.Events.MEDIA_PLAY, this.onMediaPlay);\r\n    this.player.on(oldmtn.Events.MEDIA_PAUSED, this.onMediaPaused);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.player.off(oldmtn.Events.MEDIA_PLAY, this.onMediaPlay);\r\n    this.player.off(oldmtn.Events.MEDIA_PAUSED, this.onMediaPaused);\r\n  }\r\n\r\n  render() {\r\n    //myPrintLog('UIHugeButtonOverlay, this.main.playerState: ' + this.main.playerState);\r\n\r\n    let style = {};\r\n    switch (this.main.playerState) {\r\n      case 'idle':\r\n      case 'opened':\r\n      case 'ended':\r\n        style.display = 'none';\r\n        break;\r\n      case 'playing':\r\n      case 'paused':\r\n        break;\r\n    }\r\n\r\n    return (\r\n      <div className=\"vop-huge-button-container\"\r\n        style={style}\r\n        onAnimationEnd={this.onGiantAnimationEnd.bind(this)}>\r\n        <div className=\"vop-huge-button\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onGiantAnimationEnd(e) {\r\n    this.uiGiantBtnContainer.style.display = 'none';\r\n  }\r\n\r\n  onMediaPlay() {\r\n    this.updateGiantPlayBtnUI(false);\r\n  }\r\n\r\n  onMediaPaused() {\r\n    this.updateGiantPlayBtnUI(true);\r\n  }\r\n\r\n  updateGiantPlayBtnUI(paused) {\r\n    if (this.uiGiantButton) {\r\n      UITools.removeClass(this.uiGiantButton, 'vop-style-play-giant');\r\n      UITools.removeClass(this.uiGiantButton, 'vop-style-pause-giant');\r\n      if (paused) {\r\n        UITools.addClass(this.uiGiantButton, 'vop-style-pause-giant');\r\n      } else {\r\n        UITools.addClass(this.uiGiantButton, 'vop-style-play-giant');\r\n      }\r\n      this.uiGiantBtnContainer.style.display = 'block';\r\n    }\r\n  }\r\n}\r\n\r\nexport default UIHugeButtonOverlay;","import {\r\n  h\r\n} from 'preact';\r\nimport Preact from 'preact';\r\n\r\nimport '../../assets/img/logo.png';\r\n\r\nclass UILogoOverlay extends Preact.Component {\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"vop-logo-container\"\r\n        onClick={this.onLogoClick.bind(this)}\r\n        onMouseDown={this.onLogoMouseDown.bind(this)}>\r\n        <a href=\"http://localhost/1/LiteH5Player/samples/simple.html\" target=\"_Blank\">\r\n          <img src=\"./assets/img/logo.png\"></img>\r\n        </a>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onLogoClick(e) {\r\n    e.stopPropagation();\r\n  }\r\n\r\n  onLogoMouseDown(e) {\r\n    e.stopPropagation();\r\n  }\r\n}\r\n\r\nexport default UILogoOverlay;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport UITools from '../ui_tools';\r\n\r\nclass UIPipToggleButton extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n    this.pipMode = false;\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.vopPipButton = document.querySelector('.vop-pip-button');\r\n\r\n    this.onAdStarted = this.onAdStarted.bind(this);\r\n    this.onAdComplete = this.onAdComplete.bind(this);\r\n    this.player.on(oldmtn.Events.AD_STARTED, this.onAdStarted);\r\n    this.player.on(oldmtn.Events.AD_COMPLETE, this.onAdComplete);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.player.off(oldmtn.Events.AD_STARTED, this.onAdStarted);\r\n    this.player.off(oldmtn.Events.AD_COMPLETE, this.onAdComplete);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <button className={'vop-button vop-pip-button'} title='picture in picture'\r\n        onClick={this.onUICmdPip.bind(this)}>\r\n      </button>\r\n    );\r\n  }\r\n\r\n  onUICmdPip() {\r\n    this.pipMode = !this.pipMode;\r\n    this.player.setPipPresentation(this.pipMode);\r\n  }\r\n\r\n  onAdStarted(e) {\r\n    this.flagAdStarted = true;\r\n    this.flagIsLinearAd = e.linear;\r\n    this.flagIsVpaidAd = e.vpaid;\r\n\r\n    if (this.flagAdStarted && this.flagIsLinearAd) {\r\n      this.vopPipButton.style.display = 'none';\r\n    } else {\r\n      this.vopPipButton.style.display = 'inline-block';\r\n    }\r\n  }\r\n\r\n  onAdComplete() {\r\n    this.vopPipButton.style.display = 'inline-block';\r\n  }\r\n}\r\n\r\nexport default UIPipToggleButton;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nclass UIPlayOverlay extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.main = this.props.main;\r\n  }\r\n\r\n  componentDidMount() {}\r\n\r\n  componentWillUnmount() {}\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"vop-play-overlay-container\">\r\n        <div className=\"vop-play-overlay\" onClick={this.onPlayOverlayClick.bind(this)}>\r\n        </div>\r\n      </div>\r\n    );\r\n\r\n    // let ret = (<div></div>);\r\n    // let retUI = (\r\n    //   <div className=\"vop-play-overlay-container\">\r\n    //     <div className=\"vop-play-overlay\" onClick={this.onPlayOverlayClick.bind(this)}>\r\n    //     </div>\r\n    //   </div>\r\n    // );\r\n\r\n    // switch(this.main.playerState) {\r\n    //   case 'opened':\r\n    //   if (this.main.flagAdStarted && this.main.flagIsLinearAd) {\r\n    //   } else {\r\n    //     ret = retUI;\r\n    //   }\r\n    //   break;\r\n    //   case 'ended':\r\n    //   ret = retUI;\r\n    //   break;\r\n    // }\r\n\r\n    // return ret;\r\n  }\r\n\r\n  onPlayOverlayClick() {\r\n    this.main.player.play();\r\n  }\r\n}\r\n\r\nexport default UIPlayOverlay;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nclass UIPlayToggleButton extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n  }\r\n\r\n  componentDidMount() {}\r\n\r\n  componentWillUnmount() {}\r\n\r\n  render() {\r\n    return (\r\n      <button className={'vop-button vop-play-button'} title=\"play\"\r\n        onClick={this.onUICmdPlay.bind(this)}\r\n        onMouseMove={this.onControlMouseMove.bind(this)}>\r\n      </button>\r\n    );\r\n  }\r\n\r\n  onUICmdPlay() {\r\n    this.main.onUICmdPlay();\r\n  }\r\n\r\n  onControlMouseMove(e) {\r\n    this.main.onControlMouseMove(e);\r\n  }\r\n}\r\n\r\nexport default UIPlayToggleButton;","import {\r\n  h\r\n} from 'preact';\r\nimport Preact from 'preact';\r\n\r\nimport UISubtitlesMenu from './ui_subtitles_menu';\r\nimport UISettingsMenu from './ui_settings_menu';\r\nimport UIQualityMenu from './ui_quality_menu';\r\nimport UIAudioTrackMenu from './ui_audio_track_menu';\r\nimport UIFccMenu from './ui_fcc_menu';\r\nimport UIFccPropertyMenu from './ui_fcc_property_menu';\r\nimport UIXSpeedMenu from './ui_xspeed_menu';\r\n\r\nclass UIPopupMenu extends Preact.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"vop-popup vop-popup-menu\"\r\n        onMouseDown={this.onPopupMenuMouseDown.bind(this)}>\r\n        <div className=\"vop-panel\">\r\n          <UISubtitlesMenu main={this.main} />\r\n          <UISettingsMenu main={this.main} />\r\n          <UIQualityMenu main={this.main} />\r\n          <UIAudioTrackMenu main={this.main} />\r\n          <UIFccMenu main={this.main} />\r\n          <UIFccPropertyMenu main={this.main} />\r\n          <UIXSpeedMenu main={this.main} />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onPopupMenuMouseDown(e) {\r\n    // Don't route 'click' event from panel to its parent div\r\n    e.stopPropagation();\r\n  }\r\n}\r\n\r\nexport default UIPopupMenu;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\nimport Events from '../events';\r\nimport UITools from '../ui_tools';\r\n\r\nclass UIProgressBar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n    this.evEmitter = this.main.evEmitter;\r\n\r\n    // flags reference variable of progress bar\r\n    this.progressBarContext;\r\n    this.progressBarMoveContext = {\r\n      movePos: 0\r\n    };\r\n    this.flagThumbnailMode = false;\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.vopProgressBar = document.querySelector('.vop-progress-bar');\r\n    this.vopLoadProgress = document.querySelector('.vop-load-progress');\r\n    this.vopPlayProgress = document.querySelector('.vop-play-progress');\r\n    this.vopHoverProgress = document.querySelector('.vop-hover-progress');\r\n    this.vopScrubberContainer = document.querySelector('.vop-scrubber-container');\r\n\r\n    this.onProgressBarMouseDown_ = this.onProgressBarMouseDown.bind(this);\r\n    this.onProgressBarMouseMove_ = this.onProgressBarMouseMove.bind(this);\r\n    this.onProgressBarMouseLeave_ = this.onProgressBarMouseLeave.bind(this);\r\n    \r\n    this.vopProgressBar.addEventListener('mousedown', this.onProgressBarMouseDown_);\r\n    this.vopProgressBar.addEventListener('mousemove', this.onProgressBarMouseMove_);\r\n    this.vopProgressBar.addEventListener('mouseleave', this.onProgressBarMouseLeave_);\r\n\r\n    this.onMediaDurationChanged = this.onMediaDurationChanged.bind(this);\r\n    this.onMediaTimeupdated = this.onMediaTimeupdated.bind(this);\r\n    this.onMediaSeeked = this.onMediaSeeked.bind(this);\r\n    this.onAdTimeUpdate = this.onAdTimeUpdate.bind(this);\r\n\r\n    this.player.on(oldmtn.Events.MEDIA_DURATION_CHANGED, this.onMediaDurationChanged);\r\n    this.player.on(oldmtn.Events.MEDIA_TIMEUPDATE, this.onMediaTimeupdated);\r\n    this.player.on(oldmtn.Events.MEDIA_SEEKED, this.onMediaSeeked);\r\n    this.player.on(oldmtn.Events.AD_TIMEUPDATE, this.onAdTimeUpdate);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.vopProgressBar.removeEventListener('mousedown', this.onProgressBarMouseDown_);\r\n    this.vopProgressBar.removeEventListener('mousemove', this.onProgressBarMouseMove_);\r\n    this.vopProgressBar.removeEventListener('mouseleave', this.onProgressBarMouseLeave_);\r\n\r\n    this.player.off(oldmtn.Events.MEDIA_DURATION_CHANGED, this.onMediaDurationChanged);\r\n    this.player.off(oldmtn.Events.MEDIA_TIMEUPDATE, this.onMediaTimeupdated);\r\n    this.player.off(oldmtn.Events.MEDIA_SEEKED, this.onMediaSeeked);\r\n    this.player.off(oldmtn.Events.AD_TIMEUPDATE, this.onAdTimeUpdate);\r\n  }\r\n\r\n  render() {\r\n    let endStyle = {\r\n      loadProgressTransform: '',\r\n      playProgressTransform: '',\r\n      scrubberContainerTransform: '',\r\n      uiPosition: 0\r\n    };\r\n\r\n    switch (this.main.playerState) {\r\n      case 'ended':\r\n        let position = this.player.getPosition();\r\n        let duration = this.player.getDuration();\r\n        if (this.progressBarContext) {\r\n          this.progressBarContext.movePos = position;\r\n        }\r\n        endStyle = this.getProgressBarUIStyle(position, duration);\r\n        break;\r\n    }\r\n\r\n    return (\r\n      <div className='vop-progress-bar'>\r\n        <div className='vop-progress-list'>\r\n          <div className={'vop-load-progress' + ' ' + endStyle.loadProgressTransform} ></div>\r\n          <div className={'vop-hover-progress'}></div>\r\n          <div className={'vop-play-progress' + ' ' + endStyle.playProgressTransform}></div>\r\n        </div>\r\n        <div className={'vop-scrubber-container' + ' ' + endStyle.scrubberContainerTransform}></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onMediaDurationChanged() {\r\n    let position = this.player.getPosition();\r\n    let duration = this.player.getDuration();\r\n    this.updateProgressBarUI(position, duration);\r\n  }\r\n\r\n  onMediaTimeupdated() {\r\n    //myPrintLog('+onMediaTimeupdated, position: ' + this.player.getPosition() + ', duration: ' + this.player.getDuration());\r\n\r\n    // Sometime, the timeupdate will trigger after we mouse down on the progress bar,\r\n    // in this situation, we won't update progress bar ui.\r\n    if (this.progressBarContext) {\r\n      // do nothing\r\n    } else {\r\n      //this.progressBarContext.movePos = this.player.getPosition();\r\n      let position = this.player.getPosition();\r\n      let duration = this.player.getDuration();\r\n      this.updateProgressBarUI(position, duration);\r\n      this.updateProgressBarHoverUI();\r\n    }\r\n  }\r\n\r\n  onMediaSeeked() {\r\n    myPrintLog('+onMediaSeeked, pos: ' + this.player.getPosition() +\r\n      ', paused: ' + this.player.isPaused() +\r\n      ', ended: ' + this.player.isEnded());\r\n\r\n    if (this.progressBarContext) {\r\n      if (!this.progressBarContext.pausedBeforeMousedown || this.progressBarContext.endedBeforeMousedown) {\r\n        this.player.play();\r\n      }\r\n      this.progressBarContext = null;\r\n    }\r\n  }\r\n\r\n  onAdTimeUpdate() {\r\n    let position = this.player.getPosition();\r\n    let duration = this.player.getDuration();\r\n    //myPrintLog('ad position: ' + position + ', duration: ' + duration);\r\n    this.updateProgressBarUI(position, duration);\r\n  }\r\n\r\n  onProgressBarMouseDown(e) {\r\n    this.captureProgressBarMouseEvents();\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    this.progressBarContext = {};\r\n    this.progressBarContext.pausedBeforeMousedown = this.player.isPaused();\r\n    this.progressBarContext.endedBeforeMousedown = this.player.isEnded();\r\n    this.progressBarContext.posBeforeMousedown = this.player.getPosition();\r\n    this.flagThumbnailMode = false;\r\n    this.progressBarContext.timer = setTimeout(function() {\r\n      this.doEnterThumbnailMode();\r\n    }.bind(this), 200);\r\n\r\n    // update progress bar ui\r\n    this.progressBarContext.movePos = this.getProgressMovePosition(e);\r\n    let position = this.player.getPosition();\r\n    let duration = this.player.getDuration();\r\n    this.updateProgressBarUI(position, duration);\r\n    this.updateProgressBarHoverUI();\r\n  }\r\n\r\n  onProgressBarMouseMove(e) {\r\n    //myPrintLog('+onProgressBarMouseMove, clientX: ' + e.clientX + ', clientY: ' + e.clientY);\r\n    e.stopPropagation();\r\n    this.main.removeAutohideAction();\r\n\r\n    // if mouse down, just return\r\n    if (this.progressBarContext ||\r\n      this.main.settingMenuUIData.currMenu !== 'none') {\r\n      return;\r\n    }\r\n\r\n    // update progress bar ui\r\n    let movePos = this.getProgressMovePosition(e);\r\n    this.progressBarMoveContext.movePos = movePos;\r\n    this.updateProgressBarHoverUI();\r\n\r\n    // \r\n    this.evEmitter.emit(Events.PROGRESSBAR_MOUSEMOVE, {\r\n      movePos: movePos\r\n    });\r\n    this.vopScrubberContainer.style.display = 'block';\r\n  }\r\n\r\n  onProgressBarMouseLeave(e) {\r\n    myPrintLog('+onProgressBarMouseLeave');\r\n    this.evEmitter.emit(Events.PROGRESSBAR_MOUSELEAVE);\r\n    this.vopScrubberContainer.style.display = 'none';\r\n  }\r\n\r\n  captureProgressBarMouseEvents() {\r\n    this.newProgressBarMouseMove = this.docProgressBarMouseMove.bind(this);\r\n    this.newProgressBarMouseUp = this.docProgressBarMouseUp.bind(this);\r\n\r\n    document.addEventListener('mousemove', this.newProgressBarMouseMove, true);\r\n    document.addEventListener('mouseup', this.newProgressBarMouseUp, true);\r\n    // Don't process mouse move/leave event when mouse is down, since we delegate it to document mouse move/up event.\r\n    this.vopProgressBar.removeEventListener('mousemove', this.onProgressBarMouseMove_);\r\n    this.vopProgressBar.removeEventListener('mouseleave', this.onProgressBarMouseLeave_);\r\n  }\r\n\r\n  releaseProgressBarMouseEvents() {\r\n    document.removeEventListener('mousemove', this.newProgressBarMouseMove, true);\r\n    document.removeEventListener('mouseup', this.newProgressBarMouseUp, true);\r\n\r\n    this.vopProgressBar.addEventListener('mousemove', this.onProgressBarMouseMove_);\r\n    this.vopProgressBar.addEventListener('mouseleave', this.onProgressBarMouseLeave_);\r\n  }\r\n\r\n  docProgressBarMouseMove(e) {\r\n    myPrintLog('+docProgressBarMouseMove');\r\n\r\n    let movePos = this.getProgressMovePosition(e);\r\n    if (this.progressBarContext.movePos === movePos) {\r\n      return;\r\n    }\r\n\r\n    this.doEnterThumbnailMode();\r\n    this.doProcessThumbnailMove();\r\n\r\n    this.progressBarContext.movePos = movePos;\r\n    let position = this.player.getPosition();\r\n    let duration = this.player.getDuration();\r\n    this.updateProgressBarUI(position, duration);\r\n    this.updateProgressBarHoverUI();\r\n\r\n    this.evEmitter.emit(Events.PROGRESSBAR_MOUSEMOVE, {\r\n      movePos: movePos\r\n    });\r\n    this.vopScrubberContainer.style.display = 'block';\r\n  }\r\n\r\n  docProgressBarMouseUp(e) {\r\n    //myPrintLog('+docProgressBarMouseUp');\r\n    e.preventDefault();\r\n    this.releaseProgressBarMouseEvents();\r\n\r\n    if (this.flagThumbnailMode) {\r\n      // thumbnail mode click event\r\n      this.doProcessThumbnailUp();\r\n    } else {\r\n      // plain click event\r\n      if (this.progressBarContext.timer) {\r\n        // it's quick click, don't need to pause\r\n        clearTimeout(this.progressBarContext.timer);\r\n        this.progressBarContext.timer = null;\r\n      }\r\n    }\r\n\r\n    // update ui first\r\n    this.progressBarContext.movePos = this.getProgressMovePosition(e);\r\n    let position = this.player.getPosition();\r\n    let duration = this.player.getDuration();\r\n    this.updateProgressBarUI(position, duration);\r\n    this.updateProgressBarHoverUI();\r\n\r\n    //\r\n    this.evEmitter.emit(Events.PROGRESSBAR_MOUSELEAVE);\r\n    if (!UITools.isPtInElement({x: e.clientX, y: e.clientY}, this.vopProgressBar)) {\r\n      this.vopScrubberContainer.style.display = 'none';\r\n    }\r\n\r\n    // player seeking\r\n    if (this.progressBarContext.posBeforeMousedown != this.progressBarContext.movePos) {\r\n      this.player.setPosition(this.progressBarContext.movePos);\r\n    } else {\r\n      this.progressBarContext = null;\r\n    }\r\n  }\r\n\r\n  doEnterThumbnailMode() {\r\n    myPrintLog('+doEnterThumbnailMode');\r\n    if (!this.flagThumbnailMode) {\r\n      // need to pause content first before starting a seek operation.\r\n      if (!this.progressBarContext.pausedBeforeMousedown) {\r\n        this.player.pause();\r\n      }\r\n\r\n      this.progressBarContext.timer = null;\r\n      this.flagThumbnailMode = true;\r\n    }\r\n  }\r\n\r\n  doProcessThumbnailMove() {\r\n    // for further action, you can add thumbnail popup here.\r\n  }\r\n\r\n  doProcessThumbnailUp() {\r\n    // for further action, you can add thumbnail ended event here.\r\n  }\r\n\r\n  getProgressMovePosition(e) {\r\n    // part - input\r\n    let rect = this.vopProgressBar.getBoundingClientRect();\r\n\r\n    // part - logic process\r\n    let offsetX = e.clientX - rect.left;\r\n    if (offsetX < 0) {\r\n      offsetX = 0;\r\n    } else if (offsetX > rect.width) {\r\n      offsetX = rect.width;\r\n    }\r\n\r\n    // update time progress scrubber button\r\n    let duration = this.player.getDuration();\r\n    return (offsetX / rect.width) * duration;\r\n  }\r\n\r\n  getProgressBarUIStyle(position, duration) {\r\n    // part - logic process\r\n    let uiPosition = 0;\r\n    let loadProgressTransform = '';\r\n    let playProgressTransform = '';\r\n    let scrubberContainerTransform = '';\r\n\r\n    let isLive = (duration === Infinity) ? true : false;\r\n    if (isLive) {\r\n      let seekable = this.player.getSeekableRange();\r\n      let buffered = this.player.getBufferedRanges();\r\n      //myPrintLog('seekable: ' + oldmtn.CommonUtils.TimeRangesToString(seekable) + ', buffered: ' + oldmtn.CommonUtils.TimeRangesToString(buffered));\r\n    } else {\r\n      let uiBufferedPos;\r\n      if (this.progressBarContext) {\r\n        uiPosition = this.progressBarContext.movePos;\r\n      } else {\r\n        uiPosition = position;\r\n      }\r\n\r\n      // part - output, update ui\r\n      // update time progress bar\r\n      uiBufferedPos = this.player.getValidBufferPosition(uiPosition);\r\n      loadProgressTransform = 'scaleX(' + uiBufferedPos / duration + ')';\r\n      playProgressTransform = 'scaleX(' + uiPosition / duration + ')';\r\n\r\n      // update time progress scrubber button\r\n      scrubberContainerTransform = 'translateX(' + ((uiPosition / duration) * this.vopProgressBar.clientWidth).toString() + 'px)';\r\n    }\r\n\r\n    let ret = {\r\n      loadProgressTransform: loadProgressTransform,\r\n      playProgressTransform: playProgressTransform,\r\n      scrubberContainerTransform: scrubberContainerTransform,\r\n      uiPosition: uiPosition\r\n    };\r\n\r\n    return ret;\r\n  }\r\n\r\n  updateProgressBarUI(position, duration) {\r\n    // part - input\r\n    let ret = this.getProgressBarUIStyle(position, duration);\r\n\r\n    // part - logic process\r\n    let isLive = (duration === Infinity) ? true : false;\r\n    if (isLive) {} else {\r\n      this.vopLoadProgress.style.transform = ret.loadProgressTransform;\r\n      this.vopPlayProgress.style.transform = ret.playProgressTransform;\r\n\r\n      // update time progress scrubber button\r\n      this.vopScrubberContainer.style.transform = ret.scrubberContainerTransform;\r\n    }\r\n  }\r\n\r\n  updateProgressBarHoverUI() {\r\n    let position = this.player.getPosition();\r\n    let duration = this.player.getDuration();\r\n\r\n    let movePos = 0;\r\n    if (this.progressBarContext) {\r\n      //myPrintLog('test0703, this.progressBarContext.movePos: ' + this.progressBarContext.movePos);\r\n    }\r\n    //myPrintLog('test0703, this.progressBarMoveContext.movePos: ' + this.progressBarMoveContext.movePos);\r\n    if (this.progressBarContext) {\r\n      movePos = this.progressBarContext.movePos;\r\n    } else if (this.progressBarMoveContext) {\r\n      movePos = this.progressBarMoveContext.movePos;\r\n    }\r\n    //myPrintLog('test0703, movePost: ' + movePos);\r\n    if (movePos <= position) {\r\n      this.vopHoverProgress.style.transform = 'scaleX(0)';\r\n    } else {\r\n      let rect = this.vopProgressBar.getBoundingClientRect();\r\n      let offsetX = (position / duration) * rect.width;\r\n      this.vopHoverProgress.style.left = offsetX + 'px';\r\n      this.vopHoverProgress.style.transform = 'scaleX(' + (movePos - position) / duration + ')';\r\n    }\r\n  }\r\n}\r\n\r\nexport default UIProgressBar;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport Events from '../events';\r\nimport ID from '../id';\r\n\r\nclass UIQualityMenu extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n    this.evEmitter = this.main.evEmitter;\r\n\r\n    this.onMenuBackClick_ = this.onMenuBackClick.bind(this);\r\n    this.onMenuItemClick_ = this.onMenuItemClick.bind(this);\r\n    this.onMenuItemBlur_ = this.onMenuItemBlur.bind(this);\r\n\r\n    this.onPopupMenuChange = this.onPopupMenuChange.bind(this);\r\n    this.evEmitter.on(Events.POPUPMENU_CHANGE, this.onPopupMenuChange);\r\n\r\n    this.qualityData = { // quality settings menu\r\n      qualityList: [{\r\n        id: '6',\r\n        bitrate: '1080p'\r\n      }, {\r\n        id: '5',\r\n        bitrate: '720p'\r\n      }, {\r\n        id: '4',\r\n        bitrate: '480p'\r\n      }, {\r\n        id: '3',\r\n        bitrate: '360p'\r\n      }, {\r\n        id: '2',\r\n        bitrate: '240p'\r\n      }, {\r\n        id: '1',\r\n        bitrate: '144p'\r\n      }, {\r\n        id: '-1',\r\n        bitrate: 'Auto'\r\n      }],\r\n      isQualityAuto: true,\r\n      currQualityId: '2'\r\n    };\r\n    this.state = {\r\n      qualityData: this.qualityData\r\n    };\r\n  }\r\n\r\n  componentDidMount(e) {\r\n    this.vopQualityMenu = document.querySelector('.vop-quality-menu');\r\n  }\r\n\r\n  render() {\r\n    console.log('UIQualityMenu, render');\r\n\r\n    const {\r\n      qualityData\r\n    } = this.state;\r\n\r\n    const menuitems = qualityData.qualityList.map((item, index) =>\r\n      <div key={index} className=\"vop-menuitem\" role=\"menuitemradio\"\r\n        aria-checked={qualityData.currQualityId === item.id}\r\n        data-id={item.id} onClick={this.onMenuItemClick_}\r\n        tabIndex=\"0\" onBlur={this.onMenuItemBlur_}>\r\n        <div className=\"vop-menuitem-label\">\r\n          <span>{ item.bitrate }</span>\r\n        </div>\r\n      </div>\r\n    );\r\n\r\n    return (\r\n      <div className=\"vop-quality-menu\" style=\"display:none;\">\r\n        <div className=\"vop-panel-header\">\r\n          <button className=\"vop-panel-title\" onClick={this.onMenuBackClick_}>Quality</button>\r\n        </div>\r\n        <div className=\"vop-panel-menu\">\r\n          { menuitems }\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onMenuBackClick(e) {\r\n    this.main.settingMenuUIData.currMenu = 'settings_menu';\r\n    this.evEmitter.emit(Events.POPUPMENU_CHANGE, {\r\n      menu: this.main.settingMenuUIData.currMenu\r\n    });\r\n  }\r\n\r\n  onMenuItemClick(e) {\r\n    myPrintLog('+onQualityMenuItemClick, this.settingMenuUIData.currMenu: ' + this.main.settingMenuUIData.currMenu +\r\n      ', text: ' + e.target.innerText);\r\n    let nextFocus = e.currentTarget;\r\n\r\n    this.qualityData.currQualityId = nextFocus.dataset.id;\r\n    this.setState({\r\n      qualityData: this.qualityData\r\n    });\r\n  }\r\n\r\n  onMenuItemBlur(e) {\r\n    if (this.main.settingMenuUIData.currMenu !== 'quality_menu') {\r\n      return;\r\n    }\r\n\r\n    this.main.onQualityMenuItemBlur(e);\r\n  }\r\n\r\n  onPopupMenuChange(e) {\r\n    if (e.menu === 'quality_menu') {\r\n      this.vopQualityMenu.style.display = 'block';\r\n      let v = this.vopQualityMenu.querySelector('.vop-menuitem');\r\n      if (v) {\r\n        v.focus();\r\n      }\r\n    } else {\r\n      this.vopQualityMenu.style.display = 'none';\r\n    }\r\n  }\r\n}\r\n\r\nexport default UIQualityMenu;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\nimport Events from '../events';\r\nimport ID from '../id';\r\n\r\nclass UISettingsMenu extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n    this.evEmitter = this.main.evEmitter;\r\n\r\n    this.onMenuItemClick_ = this.onMenuItemClick.bind(this);\r\n    this.onMenuItemBlur_ = this.onMenuItemBlur.bind(this);\r\n\r\n    this.onPopupMenuChange = this.onPopupMenuChange.bind(this);\r\n    this.evEmitter.on(Events.POPUPMENU_CHANGE, this.onPopupMenuChange);\r\n\r\n    this.SETTINGS_DATA = {\r\n      settingsList: [{\r\n        id: ID.MENUITEM_QUALITY,\r\n        text: 'Quality'\r\n      }, {\r\n        id: ID.MENUITEM_AUDIO_TRACK,\r\n        text: 'Language'\r\n      }, {\r\n        id: ID.MENUITEM_FCC,\r\n        text: 'Subtitle'\r\n      }, {\r\n        id: ID.MENUITEM_XSPEED,\r\n        text: 'XSpeed'\r\n      }]\r\n    };\r\n\r\n    this.settingsData = {};\r\n    this.state = {\r\n      settingsData: this.settingsData\r\n    };\r\n\r\n    //\r\n    this.menuStyle = {\r\n      display: 'none'\r\n    };\r\n  }\r\n\r\n  componentDidMount(e) {}\r\n\r\n  componentDidUpdate(e) {\r\n    if (!this.vopSettingsMenu) {\r\n      this.vopSettingsMenu = document.querySelector('.vop-settings-menu');\r\n    }\r\n    let item = this.vopSettingsMenu.querySelector('.vop-menuitem');\r\n    if (item) {\r\n      item.focus();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    //myPrintLog(`UISettingsMenu, render, ${this.main.settingMenuUIData.currMenu}`);\r\n    const {\r\n      settingsData\r\n    } = this.state;\r\n\r\n    let menuitems = [];\r\n    if (settingsData.settingsList) {\r\n      menuitems = settingsData.settingsList.map(function(item, index) {\r\n        let currValue = '';\r\n        return (\r\n          <div key={index} className=\"vop-menuitem\" role=\"menuitem\" aria-haspopup=\"true\"\r\n            data-id={item.id} onClick={this.onMenuItemClick_}\r\n            tabIndex=\"0\" onBlur={this.onMenuItemBlur_}>\r\n            <div className=\"vop-menuitem-label\">\r\n              { item.text }\r\n            </div>\r\n            <div className=\"vop-menuitem-content\">\r\n              <span className=\"vop-menuitem-content-text\">{currValue}</span>\r\n            </div>\r\n          </div>\r\n        );\r\n      }.bind(this));\r\n    }\r\n\r\n    return (\r\n      <div className=\"vop-settings-menu\"\r\n        style={this.menuStyle}>\r\n        <div className=\"vop-panel-menu\">\r\n          { menuitems }\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onMenuItemClick(e) {\r\n    myPrintLog('+onMainMenuItemClick, ' +\r\n      ' this.settingMenuUIData.currMenu: ' + this.main.settingMenuUIData.currMenu +\r\n      ', text: ' + e.target.innerText);\r\n    let nextFocus = e.currentTarget;\r\n\r\n    myPrintLog('id: ' + nextFocus.dataset.id);\r\n    let menu;\r\n    switch (nextFocus.dataset.id) {\r\n      case ID.MENUITEM_QUALITY:\r\n        menu = 'quality_menu';\r\n        break;\r\n      case ID.MENUITEM_AUDIO_TRACK:\r\n        menu = 'audio_track_menu';\r\n        break;\r\n      case ID.MENUITEM_FCC:\r\n        menu = 'fcc_menu';\r\n        break;\r\n      case ID.MENUITEM_XSPEED:\r\n        menu = 'xspeed_menu';\r\n      default:\r\n        break;\r\n    }\r\n\r\n    this.main.settingMenuUIData.currMenu = menu;\r\n    this.evEmitter.emit(Events.POPUPMENU_CHANGE, {\r\n      menu: this.main.settingMenuUIData.currMenu\r\n    });\r\n  }\r\n\r\n  onMenuItemBlur(e) {\r\n    if (this.main.settingMenuUIData.currMenu !== 'settings_menu') {\r\n      return;\r\n    }\r\n    let text = '';\r\n    if (e.relatedTarget) {\r\n      text = ', text: ' + e.relatedTarget.innerText;\r\n    }\r\n\r\n    myPrintLog('+onMainMenuItemBlur, this.settingMenuUIData.currMenu: ' + this.main.settingMenuUIData.currMenu + text);\r\n\r\n    let prevFocus = e.target;\r\n    let nextFocus = e.relatedTarget;\r\n\r\n    if (nextFocus) {\r\n      if (nextFocus.dataset.id === ID.SETTINGS_BUTTON) {\r\n        // means we click 'setting' button, do nothing here, onUICmdSettings will handle for us.\r\n      } else {\r\n        if (prevFocus) {\r\n          if (-1 === prevFocus.className.indexOf('vop-menuitem')) {\r\n            // means click another item, do nothing here, on***ItemClick will handle for us.\r\n          } else {}\r\n        } else {}\r\n      }\r\n    } else {\r\n      this.main.settingMenuUIData.currMenu = 'none';\r\n      this.evEmitter.emit(Events.POPUPMENU_CHANGE, {\r\n        menu: this.main.settingMenuUIData.currMenu\r\n      });\r\n    }\r\n  }\r\n\r\n  onPopupMenuChange(e) {\r\n    if (e.menu === 'settings_menu') {\r\n      this.settingsData = Object.assign({}, this.SETTINGS_DATA);\r\n\r\n      // Filter some menu items that don't need to show.\r\n      let tracks = this.player.getSubtitleTracks();\r\n\r\n      if (tracks.length === 0) {\r\n        for (let i = 0; i < this.settingsData.settingsList.length; i++) {\r\n          let item = this.settingsData.settingsList[i];\r\n          if (item.id === '3') {\r\n            this.settingsData.settingsList.splice(i, 1);\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      this.menuStyle = {\r\n        display: 'block'\r\n      };\r\n\r\n      // Display popup menu ui\r\n      this.setState({\r\n        settingsData: this.settingsData\r\n      });\r\n    } else {\r\n      this.menuStyle = {\r\n        display: 'none'\r\n      };\r\n      this.settingsData = {};\r\n      this.setState({\r\n        settingsData: this.settingsData\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nexport default UISettingsMenu;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport UITools from '../ui_tools';\r\n\r\nimport Events from '../events';\r\nimport ID from '../id';\r\n\r\nclass UISettingsToggleButton extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n    this.evEmitter = this.main.evEmitter;\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.vopSettingsButton = document.querySelector('.vop-settings-button');\r\n\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <button data-id={ID.SETTINGS_BUTTON} className=\"vop-button vop-settings-button\" title=\"settings\"\r\n        onClick={this.onUICmdSettings.bind(this)}\r\n        onMouseMove={this.onControlMouseMove.bind(this)}>\r\n      </button>\r\n    );\r\n  }\r\n\r\n  onUICmdSettings() {\r\n    if (this.main.settingMenuUIData.currMenu === 'subtitles_menu') {\r\n      this.main.settingMenuUIData.currMenu = 'settings_menu';\r\n    } else {\r\n      if (this.main.settingMenuUIData.currMenu !== 'none') {\r\n        this.main.settingMenuUIData.currMenu = 'none';\r\n      } else {\r\n        this.main.settingMenuUIData.currMenu = 'settings_menu';\r\n      }\r\n    }\r\n    this.evEmitter.emit(Events.POPUPMENU_CHANGE, {\r\n      menu: this.main.settingMenuUIData.currMenu\r\n    });\r\n  }\r\n\r\n  onControlMouseMove(e) {\r\n    e.stopPropagation();\r\n    this.main.removeAutohideAction();\r\n  }\r\n}\r\n\r\nexport default UISettingsToggleButton;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport Events from '../events';\r\nimport ID from '../id';\r\n\r\nclass UISubtitlesMenu extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n    this.evEmitter = this.main.evEmitter;\r\n\r\n    this.onMenuItemClick_ = this.onMenuItemClick.bind(this);\r\n    this.onMenuItemBlur_ = this.onMenuItemBlur.bind(this);\r\n\r\n    this.onTrackAdded = this.onTrackAdded.bind(this);\r\n    this.player.on(oldmtn.Events.TRACK_ADDED, this.onTrackAdded);\r\n    //\r\n    this.onPopupMenuChange = this.onPopupMenuChange.bind(this);\r\n    this.evEmitter.on(Events.POPUPMENU_CHANGE, this.onPopupMenuChange);\r\n\r\n    // this.textTracksData = {\r\n    //   // subtitle menu\r\n    //   tracks: [{\r\n    //     id: '1',\r\n    //     lang: 'English'\r\n    //   }, {\r\n    //     id: '2',\r\n    //     lang: 'French'\r\n    //   }, {\r\n    //     id: '3',\r\n    //     lang: 'Chinese'\r\n    //   }, {\r\n    //     id: '4',\r\n    //     lang: 'Dutch'\r\n    //   }, {\r\n    //     id: '5',\r\n    //     lang: 'Spanish'\r\n    //   }, {\r\n    //     id: '6',\r\n    //     lang: 'Korean'\r\n    //   }, {\r\n    //     id: '7',\r\n    //     lang: 'Thai'\r\n    //   }],\r\n    //   currTrackId: '2'\r\n    // }\r\n    this.textTracksData = {\r\n      tracks: [],\r\n      currTrackId: ''\r\n    };\r\n    this.state = {\r\n      textTracksData: this.textTracksData\r\n    };\r\n  }\r\n\r\n  componentDidMount(e) {\r\n    this.vopSubtitlesMenu = document.querySelector('.vop-subtitles-menu');\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      textTracksData\r\n    } = this.state;\r\n\r\n    const menuitems = textTracksData.tracks.map((item, index) =>\r\n      <div key={index} className=\"vop-menuitem\" role=\"menuitem\"\r\n        aria-checked={textTracksData.currTrackId === item.id ? 'true' : 'false'}\r\n        data-id={item.id} onClick={this.onMenuItemClick_}\r\n        tabIndex=\"0\" onBlur={this.onMenuItemBlur_}>\r\n        <div className=\"vop-menuitem-label\">\r\n          { item.lang }\r\n        </div>\r\n        <div className=\"vop-menuitem-content\">\r\n          <div className=\"vop-menuitem-toggle-checkbox\">\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n\r\n    return (\r\n      <div className=\"vop-subtitles-menu\" style=\"display: none;\">\r\n        <div className=\"vop-panel-menu\">\r\n          { menuitems }\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onMenuBackClick() {\r\n    myPrintLog('+onMenuBack');\r\n    this.main.onSubtitleMenuBack();\r\n  }\r\n\r\n  onMenuItemClick(e) {\r\n    myPrintLog('+onMenuItemClick');\r\n    e.stopPropagation();\r\n\r\n    let id = e.currentTarget.dataset.id;\r\n    if (this.textTracksData.currTrackId === id) {\r\n      this.textTracksData.currTrackId = '';\r\n    } else {\r\n      this.textTracksData.currTrackId = id;\r\n    }\r\n    this.setState({\r\n      textTracksData: this.textTracksData\r\n    });\r\n\r\n    // apply changes to player instance\r\n    this.player.selectSubtitleTrack(this.textTracksData.currTrackId);\r\n  }\r\n\r\n  onMenuItemBlur(e) {\r\n    myPrintLog('+onMenuItemBlur');\r\n    if (this.main.settingMenuUIData.currMenu !== 'subtitles_menu') {\r\n      return;\r\n    }\r\n\r\n    if (e.relatedTarget) {\r\n      if (e.relatedTarget.dataset.id === ID.SUBTITLES_BUTTON) {\r\n        if (this.main.settingMenuUIData.currMenu === 'settings_menu') {\r\n          // do nothing\r\n        }\r\n      }\r\n    } else {\r\n      this.main.settingMenuUIData.currMenu = 'none';\r\n      this.evEmitter.emit(Events.POPUPMENU_CHANGE, {\r\n        menu: this.main.settingMenuUIData.currMenu\r\n      });\r\n    }\r\n  }\r\n\r\n  onPopupMenuChange(e) {\r\n    if (e.menu === 'subtitles_menu') {\r\n      this.vopSubtitlesMenu.style.display = 'block';\r\n      let v = this.vopSubtitlesMenu.querySelector('.vop-menuitem');\r\n      if (v) {\r\n        v.focus();\r\n      }\r\n    } else {\r\n      this.vopSubtitlesMenu.style.display = 'none';\r\n    }\r\n  }\r\n\r\n  onTrackAdded(e) {\r\n    let track = e.track;\r\n    let currTrackId = e.currTrackId;\r\n\r\n    this.textTracksData.tracks.push(track);\r\n    this.textTracksData.currTrackId = currTrackId;\r\n    this.setState({\r\n      textTracksData: this.textTracksData\r\n    });\r\n  }\r\n}\r\n\r\nexport default UISubtitlesMenu;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport Events from '../events';\r\nimport ID from '../id';\r\n\r\nclass UISubtitlesToggleButton extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n    this.evEmitter = this.main.evEmitter;\r\n\r\n    this.onAdStarted = this.onAdStarted.bind(this);\r\n    this.onAdComplete = this.onAdComplete.bind(this);\r\n    this.player.on(oldmtn.Events.AD_STARTED, this.onAdStarted);\r\n    this.player.on(oldmtn.Events.AD_COMPLETE, this.onAdComplete);\r\n\r\n    this.onTrackAdded = this.onTrackAdded.bind(this);\r\n    this.player.on(oldmtn.Events.TRACK_ADDED, this.onTrackAdded);\r\n  }\r\n\r\n  componentDidMount() {}\r\n\r\n  componentWillUnmount() {\r\n    this.player.off(oldmtn.Events.AD_STARTED, this.onAdStarted);\r\n    this.player.off(oldmtn.Events.AD_COMPLETE, this.onAdComplete);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <button data-id={ID.SUBTITLES_BUTTON}\r\n        className=\"vop-button vop-subtitles-button\"\r\n        style=\"display: none;\"\r\n        title=\"subtitles\"\r\n        onClick={this.onUICmdSubtitles.bind(this)}\r\n        onMouseMove={this.onControlMouseMove.bind(this)}>\r\n      </button>\r\n    );\r\n  }\r\n\r\n  onUICmdSubtitles() {\r\n    if (this.main.settingMenuUIData.currMenu !== 'subtitles_menu') {\r\n      this.main.settingMenuUIData.currMenu = 'subtitles_menu';\r\n    } else {\r\n      this.main.settingMenuUIData.currMenu = 'none';\r\n    }\r\n    this.evEmitter.emit(Events.POPUPMENU_CHANGE, {\r\n      menu: this.main.settingMenuUIData.currMenu\r\n    });\r\n  }\r\n\r\n  onControlMouseMove(e) {\r\n    e.stopPropagation();\r\n    this.main.removeAutohideAction();\r\n  }\r\n\r\n  onAdStarted(e) {\r\n    this.flagAdStarted = true;\r\n    this.flagIsLinearAd = e.linear;\r\n    this.flagIsVpaidAd = e.vpaid;\r\n\r\n    if (this.flagAdStarted && this.flagIsLinearAd) {\r\n      this.vopSubtitlesButton.style.display = 'none';\r\n    } else {\r\n      this.vopSubtitlesButton.style.display = 'inline-block';\r\n    }\r\n  }\r\n\r\n  onAdComplete() {\r\n    this.vopSubtitlesButton.style.display = 'inline-block';\r\n  }\r\n\r\n  onTrackAdded(e) {\r\n    if (!this.vopSubtitlesButton) {\r\n      this.vopSubtitlesButton = document.querySelector('.vop-subtitles-button');\r\n    }\r\n    this.vopSubtitlesButton.style.display = 'block';\r\n  }\r\n}\r\n\r\nexport default UISubtitlesToggleButton;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\nimport UITools from '../ui_tools';\r\n\r\nclass UITimeLabel extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.vopTimeLabel = document.querySelector('.vop-time-text');\r\n\r\n    this.onMediaTimeupdated = this.onMediaTimeupdated.bind(this);\r\n\r\n    this.player.on(oldmtn.Events.MEDIA_TIMEUPDATE, this.onMediaTimeupdated);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.player.off(oldmtn.Events.MEDIA_TIMEUPDATE, this.onMediaTimeupdated);\r\n  }\r\n\r\n  render() {\r\n    let position = this.player.getPosition();\r\n    let duration = this.player.getDuration();\r\n    let timeText = '00:00/00:00';\r\n    switch (this.main.playerState) {\r\n      case 'idle':\r\n      case 'opened':\r\n      case 'playing':\r\n      case 'paused':\r\n      case 'ended':\r\n        timeText = this.getTimeDisplay(position, duration);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n\r\n    return (\r\n      <div className=\"vop-time-display\">\r\n        <span className=\"vop-time-text\">{timeText}</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onMediaTimeupdated() {\r\n    let position = this.player.getPosition();\r\n    let duration = this.player.getDuration();\r\n    this.updateTimeDisplay(position, duration);\r\n  }\r\n\r\n  getTimeDisplay(position, duration) {\r\n    let isLive = (duration === Infinity) ? true : false;\r\n\r\n    let timeText = '';\r\n    if (isLive) {\r\n      // update time display label\r\n      timeText = 'Live';\r\n    } else {\r\n      // update time display label\r\n      let c = oldmtn.CommonUtils.timeToString(position);\r\n      let d = oldmtn.CommonUtils.timeToString(duration);\r\n      timeText = c + '/' + d;\r\n    }\r\n\r\n    return timeText;\r\n  }\r\n\r\n  updateTimeDisplay(position, duration) {\r\n    let text = this.getTimeDisplay(position, duration);\r\n    if (text === 'Live') {\r\n      UITools.addClass(this.vopTimeLabel, 'vop-time-text-live');\r\n    } else {\r\n      UITools.removeClass(this.vopTimeLabel, 'vop-time-text-live');\r\n    }\r\n    this.vopTimeLabel.innerText = text;\r\n  }\r\n}\r\n\r\nexport default UITimeLabel;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nclass UITitleBar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n  }\r\n\r\n  render() {\r\n    // let title = '';\r\n    // let description = '';\r\n    // let title = 'Sintel';\r\n    // let description = 'A woman, Sintel, is attacked while traveling through a wintry mountainside. After defeating her attacker and taking his spear, she finds refuge in a shaman\\'s hut...';\r\n    let title = 'Big Buck Bunny';\r\n    let description = 'Tired of being picked on by Frankie the squirrel and his band of puny forest creatures, JC the bunny finally decides to fight back.';\r\n\r\n    return (\r\n      <div className='vop-titlebar'>\r\n        <span className='vop-titlebar-title'>{title}</span>\r\n        <span className='vop-titlebar-description'>{description}</span>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default UITitleBar;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\nimport Events from '../events';\r\nimport UITools from '../ui_tools';\r\n\r\n// Functionality:\r\n// 1. show tooltip thumbnail;\r\n// 2. show current duration;\r\n\r\n// Needs:\r\n// 1. player instance;\r\n// 2. player current position;\r\n\r\nclass UIToolTip extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n    this.evEmitter = this.main.evEmitter;\r\n  }\r\n\r\n  componentDidMount(e) {\r\n    this.vopTooltip = document.querySelector('.vop-tooltip');\r\n    this.vopTooltipBg = document.querySelector('.vop-tooltip-bg');\r\n    this.vopTooltipText = document.querySelector('.vop-tooltip-text');\r\n\r\n    // UI Events\r\n    this.onProgressBarMouseMove_ = this.onProgressBarMouseMove.bind(this);\r\n    this.onProgressBarMouseLeave_ = this.onProgressBarMouseLeave.bind(this);\r\n    this.evEmitter.on(Events.PROGRESSBAR_MOUSEMOVE, this.onProgressBarMouseMove_);\r\n    this.evEmitter.on(Events.PROGRESSBAR_MOUSELEAVE, this.onProgressBarMouseLeave_);\r\n  }\r\n\r\n\r\n  componentWillUnmount() {\r\n    this.evEmitter.off(Events.PROGRESSBAR_MOUSEMOVE, this.onProgressBarMouseMove_);\r\n    this.evEmitter.off(Events.PROGRESSBAR_MOUSELEAVE, this.onProgressBarMouseLeave_);\r\n  }\r\n\r\n  render() {\r\n    //myPrintLog('UIToolTip, render');\r\n\r\n    return (\r\n      <div className=\"vop-tooltip\">\r\n        <div className=\"vop-tooltip-bg\"></div>\r\n        <div className=\"vop-tooltip-text-wrapper\">\r\n          <span className=\"vop-tooltip-text\"></span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  updateTooltipUI(show, currMovePos) {\r\n    if (!show) {\r\n      this.vopTooltip.style.display = 'none';\r\n      return;\r\n    }\r\n\r\n    if (!this.vopProgressBar) {\r\n      this.vopProgressBar = document.querySelector('.vop-progress-bar');\r\n    }\r\n\r\n    let thumbnail = this.player.getThumbnail(currMovePos);\r\n\r\n    function getTooltipOffsetX(currMovePos, tooltipWidth) {\r\n      // part - input\r\n      // bounding client rect can return the progress bar's rect relative to current page.\r\n      let rect = this.vopProgressBar.getBoundingClientRect();\r\n      let leftMin = 12 + this.vopProgressBar.offsetLeft;\r\n      let rightMax = leftMin + rect.width;\r\n\r\n      let duration = this.player.getDuration();\r\n\r\n      let currPosWidth = (currMovePos / duration) * rect.width;\r\n      let tooltipLeft_RelativeToVideo = leftMin + currPosWidth - tooltipWidth / 2;\r\n      let tooltipRight_RelativeToVideo = leftMin + currPosWidth + tooltipWidth / 2;\r\n\r\n      if (tooltipLeft_RelativeToVideo < leftMin) {\r\n        tooltipLeft_RelativeToVideo = leftMin;\r\n      } else if (tooltipRight_RelativeToVideo > rightMax) {\r\n        tooltipLeft_RelativeToVideo = rightMax - tooltipWidth;\r\n      }\r\n\r\n      //myPrintLog('tooltipLeft_RelativeToVideo: ' + tooltipLeft_RelativeToVideo);\r\n\r\n      return tooltipLeft_RelativeToVideo;\r\n    }\r\n\r\n    if (thumbnail) {\r\n      UITools.addClass(this.vopTooltip, 'vop-tooltip-preview');\r\n      //myPrintLog('thumbnail info: ', thumbnail);\r\n      let isSprite = (thumbnail.data.w && thumbnail.data.h);\r\n      if (isSprite) {\r\n        this.vopTooltipBg.style.width = thumbnail.data.w.toString() + 'px';\r\n        this.vopTooltipBg.style.height = thumbnail.data.h.toString() + 'px';\r\n        this.vopTooltipBg.style.background = 'url(' + thumbnail.data.url + ')' +\r\n          ' -' + thumbnail.data.x.toString() + 'px' +\r\n          ' -' + thumbnail.data.y.toString() + 'px';\r\n      } else {\r\n        this.vopTooltipBg.style.width = '158px';\r\n        this.vopTooltipBg.style.height = '90px';\r\n        this.vopTooltipBg.style.background = 'url(' + thumbnail.data.url + ') no-repeat';\r\n        this.vopTooltipBg.style.backgroundSize = '100% 100%';\r\n      }\r\n    } else {\r\n      UITools.removeClass(this.vopTooltip, 'vop-tooltip-preview');\r\n    }\r\n\r\n    // update tooltip offset\r\n    let strTime = oldmtn.CommonUtils.timeToString(currMovePos);\r\n    this.vopTooltipText.innerText = strTime;\r\n\r\n    // calculate metrics first\r\n    // A very large offset to hide tooltip.\r\n    this.vopTooltip.style.left = '10000px';\r\n    this.vopTooltip.style.display = 'block';\r\n\r\n    // set the correct offset of tooltip.\r\n    let offsetX = getTooltipOffsetX.call(this, currMovePos, this.vopTooltip.clientWidth);\r\n    this.vopTooltip.style.left = offsetX.toString() + 'px';\r\n  }\r\n\r\n  onProgressBarMouseMove(e) {\r\n    this.updateTooltipUI(true, e.movePos);\r\n  }\r\n\r\n  onProgressBarMouseLeave() {\r\n    this.updateTooltipUI(false);\r\n  }\r\n}\r\n\r\nexport default UIToolTip;","class UITvNoiseCanvas {\n  constructor(props) {\n    this.props = props;\n\n    //\n    this.canvasElement = this.props.element;\n    this.canvasContext;\n    this.canvasWidth;\n    this.canvasHeight;\n    this.interferenceHeight = 50;\n        this.lastFrameUpdate = 0;\n        this.frameInterval = 60;\n        this.useAnimationFrame = !!window.requestAnimationFrame;\n        this.noiseAnimationWindowPos;\n        this.frameUpdateHandlerId;\n\n        this.renderFrame_ = this.renderFrame.bind(this);\n    }\n\n    start(v) {\n        this.canvasWidth = v.width;\n        this.canvasHeight = v.height;\n\n        this.canvasContext = this.canvasElement.getContext('2d');\n        this.noiseAnimationWindowPos = -this.canvasHeight;\n        this.lastFrameUpdate = 0;\n\n        this.canvasElement.style.width = this.canvasWidth.toString() + 'px';\n        this.canvasElement.style.height = this.canvasHeight.toString() + 'px';\n\n        this.renderFrame_();\n    }\n\n    stop() {\n        if (this.useAnimationFrame) {\n            cancelAnimationFrame(this.frameUpdateHandlerId);\n        } else {\n            clearTimeout(this.frameUpdateHandlerId);\n        }\n    }\n\n    renderFrame() {\n        // This code has been copied from the player controls.js and simplified\n\n        if (this.lastFrameUpdate + this.frameInterval > new Date().getTime()) {\n            // It's too early to render the next frame\n            this.scheduleNextRender();\n            return;\n        }\n\n        let currentPixelOffset;\n        // let this.canvasWidth = this.canvasWidth;\n        // let this.canvasHeight = this.canvasHeight;\n\n        // Create texture\n        let noiseImage = this.canvasContext.createImageData(this.canvasWidth, this.canvasHeight);\n\n        // Fill texture with noise\n        for (let y = 0; y < this.canvasHeight; y++) {\n            for (let x = 0; x < this.canvasWidth; x++) {\n                currentPixelOffset = (this.canvasWidth * y * 4) + x * 4;\n                noiseImage.data[currentPixelOffset] = Math.random() * 255;\n                if (y < this.noiseAnimationWindowPos || y > this.noiseAnimationWindowPos + this.interferenceHeight) {\n                    noiseImage.data[currentPixelOffset] *= 0.85;\n                }\n                noiseImage.data[currentPixelOffset + 1] = noiseImage.data[currentPixelOffset];\n                noiseImage.data[currentPixelOffset + 2] = noiseImage.data[currentPixelOffset];\n                noiseImage.data[currentPixelOffset + 3] = 50;\n            }\n        }\n\n        // Put texture onto canvas\n        this.canvasContext.putImageData(noiseImage, 0, 0);\n\n        this.lastFrameUpdate = new Date().getTime();\n        this.noiseAnimationWindowPos += 0;\n        if (this.noiseAnimationWindowPos > this.canvasHeight) {\n            this.noiseAnimationWindowPos = -this.canvasHeight;\n        }\n\n        this.scheduleNextRender();\n    }\n\n    scheduleNextRender() {\n        if (this.useAnimationFrame) {\n            this.frameUpdateHandlerId = window.requestAnimationFrame(this.renderFrame_);\n        } else {\n            this.frameUpdateHandlerId = setTimeout(this.renderFrame_, this.frameInterval);\n        }\n    }\n};\n\nexport default UITvNoiseCanvas;","import {\r\n  h\r\n} from 'preact';\r\nimport Preact from 'preact';\r\n\r\nimport UITools from '../ui_tools';\r\n\r\nclass UIVolumeBar extends Preact.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n\r\n    //\r\n    this.colorList_volume = ['#ccc', 'rgba(192,192,192,0.3)'];\r\n    this.vopVolumeSliderWidth = 52;\r\n    this.vopVolumeSliderHandleWidth = 10;\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.vopVolumeSlider = document.querySelector('.vop-volume-slider');\r\n    this.vopVolumeSliderHandle = document.querySelector('.vop-volume-slider-handle');\r\n\r\n    this.vopVolumeButton = document.querySelector('.vop-volume-button');\r\n\r\n    //\r\n    this.onMediaVolumeChanged = this.onMediaVolumeChanged.bind(this);\r\n    this.player.on(oldmtn.Events.MEDIA_VOLUME_CHANGED, this.onMediaVolumeChanged);\r\n    this.player.on(oldmtn.Events.AD_VOLUME_CHANGED, this.onMediaVolumeChanged);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.player.off(oldmtn.Events.MEDIA_VOLUME_CHANGED, this.onMediaVolumeChanged);\r\n    this.player.off(oldmtn.Events.AD_VOLUME_CHANGED, this.onMediaVolumeChanged);\r\n  }\r\n\r\n  render() {\r\n    let info = this.getVolumeInfo();\r\n    let background = UITools.genGradientColor(info.uiVolumeList, this.colorList_volume);\r\n    let left = info.uiVolumeHandleLeft;\r\n\r\n    return (\r\n      <div className=\"vop-volume-panel\" onMouseMove={this.onVolumeBarMouseMove.bind(this)}\r\n        style={{display: 'inline-block'}}>\r\n        <div className=\"vop-volume-slider\" style={{background: background}}\r\n          onMouseDown={this.onVolumeSliderMouseDown.bind(this)}>\r\n          <div className=\"vop-volume-slider-handle\" style={{left: left}}>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getVolumeInfo() {\r\n    let muted = this.player.isMuted();\r\n    let volume = this.player.getVolume();\r\n\r\n    // Process\r\n    let uiVolumeList;\r\n    let uiVolumeHandleLeft;\r\n\r\n    if (volume === 0 || muted) {\r\n      uiVolumeList = [0, 1];\r\n      uiVolumeHandleLeft = '0px';\r\n    } else {\r\n      uiVolumeList = [volume, 1];\r\n\r\n      let vLeft = (volume / 1) * this.vopVolumeSliderWidth;\r\n      if (vLeft + this.vopVolumeSliderHandleWidth > this.vopVolumeSliderWidth) {\r\n        vLeft = this.vopVolumeSliderWidth - this.vopVolumeSliderHandleWidth;\r\n      }\r\n\r\n      uiVolumeHandleLeft = vLeft.toString() + 'px';\r\n    }\r\n\r\n    return {\r\n      uiVolumeList: uiVolumeList,\r\n      uiVolumeHandleLeft: uiVolumeHandleLeft\r\n    };\r\n  }\r\n\r\n  onMediaVolumeChanged() {\r\n    let info = this.getVolumeInfo();\r\n\r\n    // update volume slider background\r\n    this.vopVolumeSlider.style.background = UITools.genGradientColor(info.uiVolumeList, this.colorList_volume);\r\n    // update volume slider handle\r\n    this.vopVolumeSliderHandle.style.left = info.uiVolumeHandleLeft;\r\n  }\r\n\r\n  onVolumeSliderMouseDown(e) {\r\n    myPrintLog('+onVolumeSliderMouseDown');\r\n    this.captureVolumeSliderMouseEvents();\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    this.flagVolumeSliderMousedown = true;\r\n\r\n    this.docVolumeSliderMousemove(e);\r\n\r\n    this.main.onVolumeBarMouseDown(e);\r\n  }\r\n\r\n  docVolumeSliderMousemove(e) {\r\n    let valueVolumeMovePosition = this.getVolumeMovePosition(e);\r\n\r\n    let muted = this.player.isMuted();\r\n    let volume = valueVolumeMovePosition;\r\n    if (volume === 0) {\r\n      // do nothing\r\n    } else {\r\n      if (muted === true) {\r\n        this.player.unmute();\r\n      }\r\n\r\n      muted = false;\r\n    }\r\n\r\n    this.player.setVolume(valueVolumeMovePosition);\r\n  }\r\n\r\n  docVolumeSliderMouseup(e) {\r\n    myPrintLog('+docVolumeSliderMouseup');\r\n    this.releaseVolumeSliderMouseEvents();\r\n    e.preventDefault();\r\n\r\n    this.flagVolumeSliderMousedown = false;\r\n\r\n    this.main.onVolumeBarMouseUp(e);\r\n  }\r\n\r\n  captureVolumeSliderMouseEvents() {\r\n    this.newVolumeSliderMousemove = this.docVolumeSliderMousemove.bind(this);\r\n    this.newVolumeSliderMouseup = this.docVolumeSliderMouseup.bind(this);\r\n\r\n    document.addEventListener('mousemove', this.newVolumeSliderMousemove, true);\r\n    document.addEventListener('mouseup', this.newVolumeSliderMouseup, true);\r\n  }\r\n\r\n  releaseVolumeSliderMouseEvents() {\r\n    document.removeEventListener('mousemove', this.newVolumeSliderMousemove, true);\r\n    document.removeEventListener('mouseup', this.newVolumeSliderMouseup, true);\r\n  }\r\n\r\n  getVolumeMovePosition(e) {\r\n    // part - input\r\n    let rect = this.vopVolumeSlider.getBoundingClientRect();\r\n\r\n    // part - logic process\r\n    let offsetX = e.clientX - rect.left;\r\n    if (offsetX < 0) {\r\n      offsetX = 0;\r\n    } else if (offsetX + this.vopVolumeSliderHandleWidth > rect.width) {\r\n      offsetX = rect.width;\r\n    }\r\n\r\n    // update time progress scrubber button\r\n    let valueVolumeMovePosition = (offsetX / rect.width) * 1.0;\r\n    return valueVolumeMovePosition;\r\n  }\r\n\r\n  onVolumeBarMouseMove(e) {\r\n    this.main.onControlMouseMove(e);\r\n  }\r\n}\r\n\r\nexport default UIVolumeBar;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport UITools from '../ui_tools';\r\n\r\nclass UIVolumeToggleButton extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n\r\n    this.vopVolumeBtnStyle = 'icon-up';\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.vopVolumeBtn = document.querySelector('.vop-volume-button');\r\n\r\n    //\r\n    this.onMediaVolumeChanged = this.onMediaVolumeChanged.bind(this);\r\n    this.player.on(oldmtn.Events.MEDIA_VOLUME_CHANGED, this.onMediaVolumeChanged);\r\n    this.player.on(oldmtn.Events.AD_VOLUME_CHANGED, this.onMediaVolumeChanged);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.player.off(oldmtn.Events.MEDIA_VOLUME_CHANGED, this.onMediaVolumeChanged);\r\n    this.player.off(oldmtn.Events.AD_VOLUME_CHANGED, this.onMediaVolumeChanged);\r\n  }\r\n\r\n  render() {\r\n    this.vopVolumeBtnStyle = this.getNewVolumeBtnStyle();\r\n\r\n    return (\r\n      <button className={'vop-button vop-volume-button' + ' ' + this.vopVolumeBtnStyle} title='mute'\r\n        onClick={this.onUICmdVolume.bind(this)}\r\n        onMouseMove={this.onControlMouseMove.bind(this)}>\r\n      </button>\r\n    );\r\n  }\r\n\r\n  getNewVolumeBtnStyle() {\r\n    let newVolumeBtnStyle = '';\r\n\r\n    let muted = this.player.isMuted();\r\n    let volume = this.player.getVolume();\r\n    if (volume === 0 || muted) {\r\n      newVolumeBtnStyle = 'icon-off';\r\n    } else {\r\n      if (volume >= 0.5) {\r\n        newVolumeBtnStyle = 'icon-up';\r\n      } else {\r\n        newVolumeBtnStyle = 'icon-down';\r\n      }\r\n    }\r\n\r\n    return newVolumeBtnStyle;\r\n  }\r\n\r\n  onMediaVolumeChanged() {\r\n    let oldVolumeBtnStyle = this.vopVolumeBtnStyle;\r\n    this.vopVolumeBtnStyle = this.getNewVolumeBtnStyle();\r\n\r\n    // update volume button\r\n    UITools.removeClass(this.vopVolumeBtn, oldVolumeBtnStyle);\r\n    UITools.addClass(this.vopVolumeBtn, this.vopVolumeBtnStyle);\r\n  }\r\n\r\n  onUICmdVolume() {\r\n    let muted = this.player.isMuted();\r\n    let volume = this.player.getVolume();\r\n\r\n    if (volume === 0) {\r\n      if (muted) {\r\n        this.player.unmute();\r\n        muted = false;\r\n      }\r\n\r\n      // If the this.player is muted, and volume is 0,\r\n      // in this situation, we will restore volume to 0.2\r\n      volume = 0.1;\r\n      this.player.setVolume(volume);\r\n    } else {\r\n      if (muted) {\r\n        this.player.unmute();\r\n        muted = false;\r\n      } else {\r\n        this.player.mute();\r\n        muted = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  onControlMouseMove(e) {\r\n    this.main.onControlMouseMove(e);\r\n  }\r\n}\r\n\r\nexport default UIVolumeToggleButton;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\nimport Events from '../events';\r\nimport ID from '../id';\r\n\r\nclass UIXSpeedMenu extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.main = this.props.main;\r\n    this.player = this.main.player;\r\n    this.evEmitter = this.main.evEmitter;\r\n\r\n    this.onMenuBackClick_ = this.onMenuBackClick.bind(this);\r\n    this.onMenuItemClick_ = this.onMenuItemClick.bind(this);\r\n    this.onMenuItemBlur_ = this.onMenuItemBlur.bind(this);\r\n\r\n    this.onPopupMenuChange = this.onPopupMenuChange.bind(this);\r\n    this.evEmitter.on(Events.POPUPMENU_CHANGE, this.onPopupMenuChange);\r\n\r\n    this.xspeedData = {\r\n      currSpeedId: '3',\r\n      xspeedList: [{\r\n        id: '1',\r\n        value: 0.25\r\n      }, {\r\n        id: '2',\r\n        value: 0.5\r\n      }, {\r\n        id: '3',\r\n        value: 1.0\r\n      }, {\r\n        id: '4',\r\n        value: 1.5\r\n      }, {\r\n        id: '5',\r\n        value: 2.0\r\n      }]\r\n    };\r\n    this.state = {\r\n      xspeedData: this.xspeedData\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.vopXSpeedMenu = document.querySelector('.vop-xspeed-menu');\r\n  }\r\n\r\n  render() {\r\n    console.log('UIXSpeedMenu, render');\r\n\r\n    const {\r\n      xspeedData\r\n    } = this.state;\r\n\r\n    const menuitems = xspeedData.xspeedList.map((item, index) =>\r\n      <div key={index} className=\"vop-menuitem\" role=\"menuitemradio\"\r\n        aria-checked={xspeedData.currSpeedId === item.id}\r\n        data-id={item.id} onClick={this.onMenuItemClick_}\r\n        tabIndex=\"0\" onBlur={this.onMenuItemBlur_}>\r\n        <div className=\"vop-menuitem-label\">\r\n          <span>{ item.value }</span>\r\n        </div>\r\n      </div>\r\n    );\r\n\r\n    return (\r\n      <div className=\"vop-xspeed-menu\" style=\"display:none;\">\r\n        <div className=\"vop-panel-header\">\r\n          <button className=\"vop-panel-title\" onClick={this.onMenuBackClick_}>XSpeed</button>\r\n        </div>\r\n        <div className=\"vop-panel-menu\">\r\n          { menuitems }\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onMenuBackClick(e) {\r\n    this.main.settingMenuUIData.currMenu = 'settings_menu';\r\n    this.evEmitter.emit(Events.POPUPMENU_CHANGE, {\r\n      menu: this.main.settingMenuUIData.currMenu\r\n    });\r\n  }\r\n\r\n  onMenuItemClick(e) {\r\n    myPrintLog('+onXSpeedMenuItemClick');\r\n    let nextFocus = e.currentTarget;\r\n\r\n    this.xspeedData.currSpeedId = nextFocus.dataset.id;\r\n    this.setState({\r\n      xspeedData: this.xspeedData\r\n    });\r\n\r\n    // Change Player X-Speed\r\n    function getXSpeedValue(id) {\r\n      let value = '';\r\n      for (let i = 0; i < this.xspeedData.xspeedList.length; i++) {\r\n        let item = this.xspeedData.xspeedList[i];\r\n        if (item.id === id) {\r\n          value = item.value;\r\n          break;\r\n        }\r\n      }\r\n\r\n      return value;\r\n    }\r\n    let value = getXSpeedValue.call(this, this.xspeedData.currSpeedId);\r\n    this.player.setAudioPlaybackSpeed(parseFloat(value));\r\n\r\n    // old\r\n    //this.main.onXSpeedMenuItemClick(e);\r\n  }\r\n\r\n  onMenuItemBlur(e) {\r\n    if (this.main.settingMenuUIData.currMenu !== 'xspeed_menu') {\r\n      return;\r\n    }\r\n    this.main.onXSpeedMenuItemBlur(e);\r\n  }\r\n\r\n  onPopupMenuChange(e) {\r\n    if (e.menu === 'xspeed_menu') {\r\n      this.vopXSpeedMenu.style.display = 'block';\r\n      let v = this.vopXSpeedMenu.querySelector('.vop-menuitem');\r\n      if (v) {\r\n        v.focus();\r\n      }\r\n    } else {\r\n      this.vopXSpeedMenu.style.display = 'none';\r\n    }\r\n  }\r\n}\r\n\r\nexport default UIXSpeedMenu;","// Defines reference constant variable.\r\nvar CONSTS = {\r\n  BOTTOM_BAR_HEIGHT: 41\r\n};\r\n\r\nexport default CONSTS;","\r\n// Defines UI reference events.\r\nvar Events = {\r\n  PROGRESSBAR_MOUSEMOVE: 'progressbar_mousemove',\r\n  PROGRESSBAR_MOUSELEAVE: 'progressbar_mouseleave',\r\n\r\n  POPUPMENU_CHANGE: 'popupmenu_change',\r\n  FCC_PROPERTY_VALUE_CHANGE: 'fcc_property_value_change',\r\n\r\n  AUTOHIDE_CHANGE: 'autohide_change'\r\n};\r\n\r\nexport default Events;\r\n\r\n","\n\n// Defines components id here.\nvar ID = {\n  SUBTITLES_BUTTON: 'subtitles_button',\n  SETTINGS_BUTTON: 'settings_button',\n\n  // Settings Menu Item ID\n  MENUITEM_QUALITY: '1',\n  MENUITEM_AUDIO_TRACK: '2',\n  MENUITEM_FCC: '3',\n  MENUITEM_XSPEED: '4'\n};\n\n\n\n\nexport default ID;\n\n","import { h, render } from 'preact';\r\nimport UISkinYoutube from './ui_skin_youtube';\r\n\r\nwindow.myPrintLog = function(msg, level) {\r\n  if (printLog) {\r\n    printLog(msg, level);\r\n  }\r\n};\r\n\r\nclass UIEngine {\r\n  constructor(player) {\r\n    this.player = player;\r\n    this.h5VideoPlayer_ = document.querySelector('.html5-video-player');\r\n  }\r\n\r\n  installSkin() {\r\n    this.skinContainerYb_ = document.querySelector('.vop-skin-default');\r\n    if (!this.skinContainerYb_) {\r\n      this.skinContainerYb_ = document.createElement('div');\r\n      this.skinContainerYb_.setAttribute('class', 'vop-skin-default');\r\n      this.h5VideoPlayer_.appendChild(this.skinContainerYb_);\r\n    }\r\n\r\n    let root;\r\n    this.uiPlayer_ = render(<UISkinYoutube player={this.player} cbLog={this.cbLog} />, this.skinContainerYb_, root);\r\n  }\r\n\r\n  uninstallSkin() {\r\n    render(null, this.skinContainerYb_, this.uiPlayer_);\r\n  }\r\n}\r\n\r\nexport default UIEngine;","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\n\r\nimport ResizeSensor from 'resize-sensor';\r\n\r\nimport '../css/ui_skin_youtube.scss';\r\n\r\nimport UITools from './ui_tools';\r\nimport Events from './events';\r\nimport {\r\n  ErrorTypes\r\n} from '../../core/errors';\r\n\r\nimport UITitleBar from './components/ui_title_bar';\r\nimport UIPopupMenu from './components/ui_popup_menu';\r\n\r\nimport UIGradientBottom from './components/ui_gradient_bottom';\r\nimport UIBottomBar from './components/ui_bottom_bar';\r\n\r\nimport UICaptionOverlay from './components/ui_caption_overlay';\r\nimport UIHugeButtonOverlay from './components/ui_hugebutton_overlay';\r\nimport UIBufferingOverlay from './components/ui_buffering_overlay';\r\nimport UILogoOverlay from './components/ui_logo_overlay';\r\nimport UIPlayOverlay from './components/ui_play_overlay';\r\nimport UIErrorMsgOverlay from './components/ui_error_msg_overlay';\r\nimport UIChromecastOverlay from './components/ui_chromecast_overlay';\r\nimport UIToolTip from './components/ui_tooltip';\r\n\r\nimport UIAdsContainer from './components/ui_ads_container';\r\n\r\nimport EventEmitter from 'events';\r\n\r\n// 1. Render all components from React.\r\n// 2. Just change css in 'html5-player-video' to control components visiblity.\r\n// 3. \r\nclass UISkinYoutube extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.initVariable();\r\n    this.player = props.player;\r\n    this.evEmitter = new EventEmitter();\r\n\r\n    this.adsContainer = new UIAdsContainer({\r\n      main: this\r\n    });\r\n  }\r\n\r\n  componentWillMount() {\r\n    myPrintLog('UISkinYoutube, +componentWillMount');\r\n  }\r\n\r\n  componentDidMount() {\r\n    myPrintLog('UISkinYoutube, +componentDidMount');\r\n\r\n    this.initUIElements();\r\n    this.initUIElementsStyles();\r\n    this.initUIEventListeners();\r\n    this.initPlayerListeners();\r\n\r\n    this.syncPlayerStateToUI();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    myPrintLog('+componentWillUnmount');\r\n    this.uninitUIEventListeners();\r\n    this.uninitPlayerListeners();\r\n\r\n    this.removeAutohideAction();\r\n    // Since we want to use ads-container to show ad, if we add 'controls' attribute to video element,\r\n    // it the video control will never shown, because ads-container is on top of it.\r\n    //this.vopVideo.setAttribute('controls', 'true');\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className='vop-skin-youtube'>\r\n        <UIChromecastOverlay main={this} />\r\n        <UITitleBar main={this} />\r\n        <UILogoOverlay />\r\n        <UICaptionOverlay main={this} />\r\n        <UIPopupMenu main={this} />\r\n        <UIToolTip main={this} />\r\n        <UIGradientBottom main={this} />\r\n        <UIBottomBar main={this} />\r\n        <UIBufferingOverlay main={this} />\r\n        <UIHugeButtonOverlay main={this} />\r\n        <UIPlayOverlay main={this} />\r\n        <UIErrorMsgOverlay main={this} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////////\r\n  initVariable() {\r\n    this.player = null;\r\n    this.playerState = '';\r\n    this.ratio = 0.5625;\r\n\r\n    // UI Controls\r\n    this.vopPlayer = null;\r\n    this.vopBottomBar = null;\r\n\r\n    // UI Data\r\n    this.metaWidth;\r\n    this.metaHeight;\r\n\r\n    // flag\r\n    this.timerHideControlBar;\r\n\r\n    // menu context\r\n    this.settingMenuUIData = {\r\n      currMenu: 'none', // none, settings_menu, quality_menu, audio_track_menu, fcc_menu, fcc_property_menu, subtitles_menu, xspeed_menu\r\n\r\n      // main setting menu\r\n      // quality settings menu\r\n      currQualityId: '2',\r\n\r\n      // audio track settings menu\r\n      currAudioTrackId: '1',\r\n\r\n      // FCC settings menu\r\n      currFccPropertyName: 'background_color', // only valid when currMenu is 'fcc_property_menu'.\r\n      isEnableFCC: true,\r\n\r\n      // X-Speed\r\n      currSpeedId: '3'\r\n    };\r\n\r\n    // reference variable of ad\r\n    this.flagAdStarted = false;\r\n    this.flagIsLinearAd = false;\r\n\r\n    //\r\n    this.onStateChange = this.onStateChange.bind(this);\r\n\r\n    this.onMediaLoadedMetaData = this.onMediaLoadedMetaData.bind(this);\r\n\r\n    this.onLog = this.onLog.bind(this);\r\n\r\n    // ad callback event\r\n    this.onAdStarted = this.onAdStarted.bind(this);\r\n    this.onAdComplete = this.onAdComplete.bind(this);\r\n    this.onAdCompanions = this.onAdCompanions.bind(this);\r\n\r\n    //\r\n    this.onResizeSensorCb = this.onResizeSensorCb.bind(this);\r\n  }\r\n\r\n  // Title: init part\r\n  initUIElements() {\r\n    this.playerContainer = document.getElementById('player-container');\r\n    this.vopPlayer = document.querySelector('.html5-video-player');\r\n\r\n    this.vopBottomBar = document.querySelector('.vop-bottom-bar');\r\n\r\n    this.vopCaptionOverlay = document.querySelector('.vop-caption-overlay');\r\n\r\n    //\r\n    this.vopVideo = document.querySelector('.vop-video');\r\n    this.vopVideo.removeAttribute('controls');\r\n  }\r\n\r\n  initUIElementsStyles() {\r\n    // Can add ui style config here.\r\n    //this.vopPlayProgress.style.backgroundColor = '#FA12FF';\r\n  }\r\n\r\n  initUIEventListeners() {\r\n    this.onPlayerMouseEnter = this.onPlayerMouseEnter.bind(this);\r\n    this.onPlayerMouseLeave = this.onPlayerMouseLeave.bind(this);\r\n    this.onPlayerMouseMove = this.onPlayerMouseMove.bind(this);\r\n    this.onPlayerMouseDown = this.onPlayerMouseDown.bind(this);\r\n    this.onPlayerMouseUp = this.onPlayerMouseUp.bind(this);\r\n\r\n    this.vopPlayer.addEventListener('mouseenter', this.onPlayerMouseEnter);\r\n    this.vopPlayer.addEventListener('mouseleave', this.onPlayerMouseLeave);\r\n    this.vopPlayer.addEventListener('mousemove', this.onPlayerMouseMove);\r\n    this.vopPlayer.addEventListener('mousedown', this.onPlayerMouseDown);\r\n    this.vopPlayer.addEventListener('mouseup', this.onPlayerMouseUp);\r\n\r\n    // resize listener\r\n    //if (window.ResizeObserver) {\r\n    if (false) {\r\n      function onPlayerSize(entries) {\r\n        for (let i = 0; i < entries.length; i++) {\r\n          let entry = entries[i];\r\n          const cr = entry.contentRect;\r\n          const cWidth = entry.target.clientWidth;\r\n          const cHeight = entry.target.clientHeight;\r\n\r\n          this.player.resize(cWidth, cHeight);\r\n        }\r\n      }\r\n      let ro = new ResizeObserver(onPlayerSize.bind(this));\r\n\r\n      // Observer one or multiple elements\r\n      ro.observe(this.vopPlayer);\r\n    } else {\r\n      this.playerResizeSensor_ = new ResizeSensor(this.playerContainer, this.onResizeSensorCb);\r\n    }\r\n  }\r\n\r\n  uninitUIEventListeners() {\r\n    this.vopPlayer.removeEventListener('mouseenter', this.onPlayerMouseEnter);\r\n    this.vopPlayer.removeEventListener('mouseleave', this.onPlayerMouseLeave);\r\n    this.vopPlayer.removeEventListener('mousemove', this.onPlayerMouseMove);\r\n    this.vopPlayer.removeEventListener('mousedown', this.onPlayerMouseDown);\r\n    this.vopPlayer.removeEventListener('mouseup', this.onPlayerMouseUp);\r\n\r\n    this.playerResizeSensor_ = null;\r\n  }\r\n\r\n  initPlayerListeners() {\r\n    this.player.on(oldmtn.Events.STATE_CHANGE, this.onStateChange);\r\n\r\n    this.player.on(oldmtn.Events.MEDIA_LOADEDMETADATA, this.onMediaLoadedMetaData);\r\n\r\n    this.player.on(oldmtn.Events.LOG, this.onLog);\r\n    this.player.on(oldmtn.Events.ERROR, this.onError);\r\n\r\n    // ad callback event\r\n    this.player.on(oldmtn.Events.AD_STARTED, this.onAdStarted);\r\n    this.player.on(oldmtn.Events.AD_COMPLETE, this.onAdComplete);\r\n    this.player.on(oldmtn.Events.AD_COMPANIONS, this.onAdCompanions);\r\n  }\r\n\r\n  uninitPlayerListeners() {\r\n    this.player.off(oldmtn.Events.STATE_CHANGE, this.onStateChange);\r\n\r\n    this.player.off(oldmtn.Events.MEDIA_LOADEDMETADATA, this.onMediaLoadedMetaData);\r\n\r\n    // log\r\n    this.player.off(oldmtn.Events.LOG, this.onLog);\r\n    this.player.off(oldmtn.Events.ERROR, this.onError);\r\n\r\n    // ad callback event\r\n    this.player.off(oldmtn.Events.AD_STARTED, this.onAdStarted);\r\n    this.player.off(oldmtn.Events.AD_COMPLETE, this.onAdComplete);\r\n    this.player.off(oldmtn.Events.AD_COMPANIONS, this.onAdCompanions);\r\n  }\r\n\r\n  playerOpen(mediaCfg) {\r\n    this.player.open(mediaCfg);\r\n  }\r\n\r\n  playerClose() {\r\n    myPrintLog('+onBtnClose');\r\n    this.player.close();\r\n    this.updateUIStateMachine('closed');\r\n  }\r\n\r\n  playerRequestAds() {\r\n    this.player.playAd();\r\n  }\r\n\r\n  onBtnInit() {\r\n    this.player.init(cfg_);\r\n  }\r\n\r\n  onBtnUninit() {\r\n    this.player.uninit(cfg_);\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////////////\r\n  // Title: UI reference functions\r\n  onResizeSensorCb(e) {\r\n    // PlayerContainer's width change, need to update its height\r\n    // and player's metrics.\r\n    let dstWidth = 0;\r\n    let dstHeight = 0;\r\n    if (this.player.isFullscreen()) {\r\n      dstWidth = this.playerContainer.clientWidth;\r\n      dstHeight = this.playerContainer.clientHeight;\r\n    } else {\r\n      if (this.playerContainer.clientWidth > 720) {\r\n        dstWidth = 720;\r\n      } else {\r\n        dstWidth = this.playerContainer.clientWidth;\r\n      }\r\n      dstHeight = dstWidth * this.ratio;\r\n    }\r\n\r\n    this.playerContainer.style.height = dstHeight.toString() + 'px';\r\n\r\n    this.vopPlayer.style.width = dstWidth.toString() + 'px';\r\n    this.vopPlayer.style.height = dstHeight.toString() + 'px';\r\n\r\n    if (this.isPlayerActive()) {\r\n      //h5Player.style.marginLeft = h5Player.style.marginRight = 'auto';\r\n      this.player.resize(dstWidth, dstHeight);\r\n\r\n      myPrintLog(('ResizeSensor, dstWidth: ' + dstWidth + ', dstHeight: ' + dstHeight));\r\n      let position = this.player.getPosition();\r\n      let duration = this.player.getDuration();\r\n      //this.updateProgressBarUI(position, duration);\r\n    }\r\n  }\r\n\r\n  // This function is mainly focus on:\r\n  // 1. Record the player state, and refect it to UI\r\n  updateUIStateMachine(state) {\r\n    myPrintLog('updateUIStateMachine, state: ' + state);\r\n\r\n    //\r\n    UITools.removeClass(this.vopPlayer, 'vop-player-' + this.playerState);\r\n    UITools.addClass(this.vopPlayer, 'vop-player-' + state);\r\n\r\n    // Update all child components.\r\n    this.playerState = state;\r\n\r\n    if (this.playerState === 'opening') {\r\n      UITools.addClass(this.vopPlayer, 'vop-buffering');\r\n    } else if (this.playerState === 'opened') {\r\n      UITools.removeClass(this.vopPlayer, 'vop-buffering');\r\n    }\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////////////\r\n  // Title: Tool function\r\n  updateCaptionOverlay() {\r\n    let adDstHeight = 0;\r\n    let controlBarHeight = 0;\r\n    if (this.flagAdStarted && !this.flagIsLinearAd) {\r\n      adDstHeight = this.vopAdContainer.clientHeight;\r\n      controlBarHeight = this.vopBottomBar.clientHeight;\r\n    } else {\r\n      if (!UITools.hasClass(this.vopPlayer, 'vop-autohide')) {\r\n        controlBarHeight = this.vopBottomBar.clientHeight;\r\n      }\r\n    }\r\n\r\n    let height = adDstHeight + controlBarHeight;\r\n    this.vopCaptionOverlay.style.bottom = height.toString() + 'px';\r\n  }\r\n\r\n  addAutohideAction() {\r\n    UITools.addClass(this.vopPlayer, 'vop-autohide');\r\n    this.evEmitter.emit(Events.AUTOHIDE_CHANGE, {\r\n      autohide: true\r\n    });\r\n  }\r\n\r\n  removeAutohideAction() {\r\n    UITools.removeClass(this.vopPlayer, 'vop-autohide');\r\n    if (this.timerHideControlBar) {\r\n      clearTimeout(this.timerHideControlBar);\r\n      this.timerHideControlBar = null;\r\n    }\r\n    this.evEmitter.emit(Events.AUTOHIDE_CHANGE, {\r\n      autohide: false\r\n    });\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  onPlayerMouseEnter(e) {\r\n    if (this.playerState !== 'playing') {\r\n      return;\r\n    }\r\n    // When mouse enter any elements in 'vop-skin-youtube', it needs to remove the 'vop-autohide' attribute.\r\n    //myPrintLog('+onPlayerMouseEnter, element: ' + e.target.className);\r\n    this.removeAutohideAction();\r\n  }\r\n\r\n  onPlayerMouseMove(e) {\r\n    //let element_name = (e && e.target) ? e.target.className : 'null';\r\n    //myPrintLog('+onPlayerMouseMove, element: ' + element_name);\r\n    if (this.playerState !== 'playing') {\r\n      return;\r\n    }\r\n\r\n    this.removeAutohideAction();\r\n    this.timerHideControlBar = setTimeout(function() {\r\n      //myPrintLog('Call onPlayerMouseLeave at timerHideControlBar callback.');\r\n      this.onPlayerMouseLeave();\r\n    }.bind(this), 3000);\r\n  }\r\n\r\n  onPlayerMouseLeave(e) {\r\n    //myPrintLog('+onPlayerMouseLeave');\r\n    if (this.playerState !== 'playing') {\r\n      return;\r\n    }\r\n\r\n    let paused = this.player.isPaused();\r\n    let fullscreen = this.player.isFullscreen();\r\n    if (!paused &&\r\n      !this.progressBarContext &&\r\n      !this.flagVolumeSliderMousedown &&\r\n      !fullscreen) {\r\n      this.addAutohideAction();\r\n    }\r\n  }\r\n\r\n  onPlayerMouseDown(e) {\r\n    //myPrintLog('+onPlayerMouseDown');\r\n    // If playerState is 'opened', let ui_play_overlay components handle play action.\r\n    if (this.playerState === 'opened') {\r\n      return;\r\n    }\r\n\r\n    this.flagPlayerMouseDown = true;\r\n  }\r\n\r\n  onPlayerMouseUp(e) {\r\n    //myPrintLog('+onPlayerMouseUp');\r\n    if (this.flagPlayerMouseDown) {\r\n      this.flagPlayerMouseDown = false;\r\n      this.onUICmdPlay();\r\n    }\r\n  }\r\n\r\n  // browser & UI callback functions\r\n  onUICmdPlay() {\r\n    // Get current play/pause state from UI.\r\n    let currPaused = this.player.isPaused();\r\n    let currEnded = this.player.isEnded();\r\n\r\n    let newPaused;\r\n    // Compute new play/pause state and apply it to player.\r\n    if (currEnded) {\r\n      // call play method when video is ended will trigger 'seeking' event and the target position is 0.\r\n      newPaused = false;\r\n    } else {\r\n      // execute ui cmd\r\n      if (currPaused) {\r\n        newPaused = false;\r\n      } else {\r\n        newPaused = true;\r\n      }\r\n    }\r\n\r\n    if (newPaused) {\r\n      this.player.pause();\r\n    } else {\r\n      this.player.play();\r\n    }\r\n  }\r\n\r\n  onVolumeBarMouseDown(e) {\r\n    this.flagVolumeSliderMousedown = true;\r\n  }\r\n\r\n  onVolumeBarMouseUp(e) {\r\n    this.flagVolumeSliderMousedown = false;\r\n\r\n    let pt = {\r\n      x: e.clientX,\r\n      y: e.clientY\r\n    };\r\n    if (UITools.isPtInElement(pt, this.vopPlayer)) {\r\n      if (UITools.isPtInElement(pt, this.vopBottomBar)) {\r\n        // do nothing\r\n        this.removeAutohideAction();\r\n      } else {\r\n        this.onPlayerMouseMove();\r\n      }\r\n    } else {\r\n      this.onPlayerMouseMove();\r\n    }\r\n  }\r\n\r\n  onControlMouseMove(e) {\r\n    e.stopPropagation();\r\n    this.removeAutohideAction();\r\n  }\r\n\r\n  onBtnManualSchedule() {\r\n    this.player.manualSchedule();\r\n  }\r\n\r\n  onBtnInitAD() {\r\n    this.player.test();\r\n  }\r\n\r\n  onBtnDelAll() {\r\n    this.player.dellAll();\r\n  }\r\n\r\n  onBtnStop() {\r\n    this.player.close();\r\n    this.player = null;\r\n  }\r\n\r\n  ////////////////////////////////////////////////////////////////////////////////////\r\n  // this.player event callback\r\n  onStateChange(e) {\r\n    let newState = e.newState;\r\n    this.updateUIStateMachine(newState);\r\n  }\r\n\r\n  onMediaLoadedMetaData(e) {\r\n    // update external div's height only.\r\n    this.metaWidth = e.width;\r\n    this.metaHeight = e.height;\r\n\r\n    this.ratio = (this.metaHeight / this.metaWidth);\r\n\r\n    let v = this.playerContainer;\r\n    let dstWidth = v.clientWidth;\r\n    let dstHeight = dstWidth * this.ratio;\r\n\r\n    //this.playerContainer.style.width = dstWidth.toString() + 'px';\r\n    this.playerContainer.style.height = dstHeight.toString() + 'px';\r\n    this.vopPlayer.style.width = dstWidth.toString() + 'px';\r\n    this.vopPlayer.style.height = dstHeight.toString() + 'px';\r\n    this.player.resize(dstWidth, dstHeight);\r\n  }\r\n\r\n  onLog(e) {\r\n    printLogUI(e.message);\r\n  }\r\n\r\n  onError(e) {\r\n    if (e.type === ErrorTypes.LICENSE_ERROR) {\r\n      console.log('--ErrorTypes.LICENSE_ERROR--');\r\n    }\r\n  }\r\n\r\n  onAdStarted(e) {\r\n    this.updateUIStateMachine('playing');\r\n\r\n    // Hide all popup menu.\r\n    this.settingMenuUIData.currMenu = 'none';\r\n  }\r\n\r\n  onAdComplete() {}\r\n\r\n  onAdCompanions(e) {\r\n    let v = document.getElementById('idCompanionAd');\r\n    for (let i = 0; i < e.companions.length; i++) {\r\n      let companion = e.companions[i];\r\n      if (v.clientWidth === companion.width && v.clientHeight === companion.height) {\r\n        v.innerHTML = companion.content;\r\n      }\r\n    }\r\n  }\r\n\r\n  /////////////////////////////////////////////////////////////////////////\r\n  // Title: Sub Components Callbacks\r\n  onQualityMenuItemBlur(e) {\r\n    myPrintLog('+onQualityMenuItemBlur');\r\n    let nextFocus = e.relatedTarget;\r\n    if (nextFocus) {\r\n      myPrintLog('className: ' + nextFocus.className);\r\n      if (nextFocus.className.indexOf('vop-panel-title') !== -1 ||\r\n        nextFocus.className.indexOf('vop-menuitem') !== -1 ||\r\n        nextFocus.className.indexOf('vop-settings-button') !== -1) {\r\n        // click on quality menu, do nothing\r\n        // click on settings menu, do nothing, since onUICmdSettings will do it for us.\r\n      } else {\r\n        this.settingMenuUIData.currMenu = 'none';\r\n        this.evEmitter.emit(Events.POPUPMENU_CHANGE, {\r\n          menu: this.settingMenuUIData.currMenu\r\n        });\r\n      }\r\n    } else {\r\n      this.settingMenuUIData.currMenu = 'none';\r\n      this.evEmitter.emit(Events.POPUPMENU_CHANGE, {\r\n        menu: this.settingMenuUIData.currMenu\r\n      });\r\n    }\r\n  }\r\n\r\n  onAudioTrackMenuItemBlur(e) {\r\n    this.onQualityMenuItemBlur(e);\r\n  }\r\n\r\n  onFccMenuItemBlur(e) {\r\n    this.onQualityMenuItemBlur(e);\r\n  }\r\n\r\n  onXSpeedMenuItemBlur(e) {\r\n    this.onQualityMenuItemBlur(e);\r\n  }\r\n\r\n  // When data changed, needs to update UI.\r\n\r\n  // When the skin installed, needs to update UI\r\n  syncPlayerStateToUI() {\r\n    let state = this.player.getState();\r\n    this.updateUIStateMachine(state);\r\n  }\r\n\r\n  isPlayerActive() {\r\n    let currState = this.player.getState();\r\n    if (this.player && currState !== 'idle' && currState !== 'inited') {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n}\r\n\r\nexport default UISkinYoutube;","var UITools = {};\r\n\r\nUITools.enterFullscreen = function(v) {\r\n  // Try to enter fullscreen mode in the browser\r\n  let requestFullscreen =\r\n    v.requestFullscreen ||\r\n    v.requestFullScreen ||\r\n    v.webkitRequestFullscreen ||\r\n    v.webkitRequestFullScreen ||\r\n    v.mozRequestFullscreen ||\r\n    v.mozRequestFullScreen ||\r\n    v.msRequestFullscreen ||\r\n    v.msRequestFullScreen;\r\n\r\n  requestFullscreen.call(v);\r\n};\r\n\r\nUITools.leaveFullscreen = function() {\r\n  let cancelFullscreen =\r\n    document.exitFullscreen ||\r\n    document.exitFullScreen ||\r\n    document.webkitCancelFullScreen ||\r\n    document.mozCancelFullScreen ||\r\n    document.msExitFullscreen ||\r\n    document.msExitFullscreen;\r\n  if (cancelFullscreen) {\r\n    cancelFullscreen.call(document);\r\n  }\r\n};\r\n\r\nUITools.hasClass = function(elements, cName) {\r\n  return !!elements.className.match(new RegExp('(\\\\s|^)' + cName + '(\\\\s|$)'));\r\n};\r\n\r\nUITools.addClass = function(elements, cName) {\r\n  if (!UITools.hasClass(elements, cName)) {\r\n    elements.className = (elements.className + ' ' + cName).trim();\r\n  }\r\n};\r\n\r\nUITools.removeClass = function(elements, cName) {\r\n  if (UITools.hasClass(elements, cName)) {\r\n    elements.className = (elements.className.replace(new RegExp('(\\\\s|^)' + cName + '(\\\\s|$)'), ' ')).trim();\r\n  }\r\n};\r\n\r\nUITools.genGradientColor = function(posList, colorList) {\r\n  let totalRange = posList[posList.length - 1];\r\n\r\n  let gradient = ['to right'];\r\n  for (let i = 0; i < posList.length; ++i) {\r\n    let range = posList[i] * 100 / totalRange;\r\n\r\n    if (i === 0) {\r\n      gradient.push(colorList[0] + ' 0%');\r\n      gradient.push(colorList[0] + ' ' + range + '%');\r\n    } else {\r\n      let lastRange = posList[i - 1] * 100 / totalRange;\r\n      gradient.push(colorList[i] + ' ' + lastRange + '%');\r\n      gradient.push(colorList[i] + ' ' + range + '%');\r\n    }\r\n  }\r\n\r\n  return 'linear-gradient(' + gradient.join(',') + ')';\r\n};\r\n\r\nUITools.isPtInElement = function(pt, element) {\r\n  let rect = element.getBoundingClientRect();\r\n  if ((rect.left <= pt.x && pt.x <= rect.right) &&\r\n    (rect.top <= pt.y && pt.y <= rect.bottom)) {\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n};\r\n\r\nexport default UITools;","// extracted by mini-css-extract-plugin","import {\r\n  h,\r\n  Component\r\n} from 'preact';\r\nimport '../css/ui_basic.scss';\r\n\r\nexport default class UIBasic extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n\r\n  componentWillMount() {}\r\n\r\n  componentDidMount() {}\r\n\r\n  render() {\r\n    return (\r\n      <div className='html5-video-player'>\r\n        <div className='vop-video-container'>\r\n          <video className='vop-video' playsInline='true' webkit-playsinline='true'>\r\n          </video>\r\n        </div>\r\n        <div className='vop-ads-container'></div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nfunction createMediaElement() {\r\n  const mediaElement = document.createElement('video');\r\n\r\n  mediaElement.className = 'vop-video';\r\n  mediaElement.setAttribute('webkit-playsinline', '');\r\n  mediaElement.setAttribute('playsinline', '');\r\n\r\n  return mediaElement;\r\n}\r\n\r\nfunction createVideoContainer() {\r\n  let container = document.createElement('div');\r\n  container.setAttribute('class', 'vop-video-container');\r\n\r\n  let mediaElement = createMediaElement();\r\n  container.appendChild(mediaElement);\r\n  return container;\r\n}\r\n\r\nfunction createAdsContainer() {\r\n  let container = document.createElement('div');\r\n  container.setAttribute('class', 'vop-ads-container');\r\n  return container;\r\n}\r\n\r\nexport function dom_initUI(container) {\r\n  let html5VideoPlayer = document.createElement('div');\r\n  html5VideoPlayer.setAttribute('class', 'html5-video-player');\r\n\r\n  // create video container\r\n  let vopVideoContainer = createVideoContainer();\r\n\r\n  // create ads container\r\n  let vopAdsContainer = createAdsContainer();\r\n\r\n  html5VideoPlayer.appendChild(vopVideoContainer);\r\n  html5VideoPlayer.appendChild(vopAdsContainer);\r\n\r\n  //\r\n  container.appendChild(html5VideoPlayer);\r\n}","/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\n/**\n * @class\n * @ignore\n */\nclass Error {\n  constructor(code, message, data) {\n    this.code = code || null;\n    this.message = message || null;\n    this.data = data || null;\n  }\n}\n\nexport default Error;","/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\nimport FactoryMaker from '../core/FactoryMaker';\nimport Debug from '../core/Debug';\n\nconst WEBVTT = 'WEBVTT';\n\nfunction VTTParser() {\n  let context = this.context;\n  let log = Debug(context).getInstance().log;\n\n  let instance,\n    regExNewLine,\n    regExToken,\n    regExWhiteSpace,\n    regExWhiteSpaceWordBoundary;\n\n  function setup() {\n    regExNewLine = /(?:\\r\\n|\\r|\\n)/gm;\n    regExToken = /-->/;\n    regExWhiteSpace = /(^[\\s]+|[\\s]+$)/g;\n    regExWhiteSpaceWordBoundary = /\\s\\b/g;\n  }\n\n  function parse(data) {\n    let captionArray = [];\n    let len,\n      lastStartTime;\n\n    if (!data) {\n      return captionArray;\n    }\n\n    data = data.split(regExNewLine);\n    len = data.length;\n    lastStartTime = -1;\n\n    for (let i = 0; i < len; i++) {\n      let item = data[i];\n\n      if (item.length > 0 && item !== WEBVTT) {\n        if (item.match(regExToken)) {\n          let attributes = parseItemAttributes(item);\n          let cuePoints = attributes.cuePoints;\n          let styles = attributes.styles;\n          let text = getSublines(data, i + 1);\n          let startTime = convertCuePointTimes(cuePoints[0].replace(regExWhiteSpace, ''));\n          let endTime = convertCuePointTimes(cuePoints[1].replace(regExWhiteSpace, ''));\n\n          if ((!isNaN(startTime) && !isNaN(endTime)) && startTime >= lastStartTime && endTime > startTime) {\n            if (text !== '') {\n              lastStartTime = startTime;\n              //TODO Make VO external so other parsers can use.\n              captionArray.push({\n                start: startTime,\n                end: endTime,\n                data: text,\n                styles: styles\n              });\n            } else {\n              log('Skipping cue due to empty/malformed cue text');\n            }\n          } else {\n            log('Skipping cue due to incorrect cue timing');\n          }\n        }\n      }\n    }\n\n    return captionArray;\n  }\n\n  function convertCuePointTimes(time) {\n    let timeArray = time.split(':');\n    const len = timeArray.length - 1;\n\n    time = parseInt(timeArray[len - 1], 10) * 60 + parseFloat(timeArray[len]);\n\n    if (len === 2) {\n      time += parseInt(timeArray[0], 10) * 3600;\n    }\n\n    return time;\n  }\n\n  function parseItemAttributes(data) {\n    let vttCuePoints = data.split(regExToken);\n    let arr = vttCuePoints[1].split(regExWhiteSpaceWordBoundary);\n    arr.shift(); //remove first array index it is empty...\n    vttCuePoints[1] = arr[0];\n    arr.shift();\n    return {\n      cuePoints: vttCuePoints,\n      styles: getCaptionStyles(arr)\n    };\n  }\n\n  function getCaptionStyles(arr) {\n    let styleObject = {};\n    arr.forEach(function(element) {\n      if (element.split(/:/).length > 1) {\n        let val = element.split(/:/)[1];\n        if (val && val.search(/%/) != -1) {\n          val = parseInt(val.replace(/%/, ''), 10);\n        }\n        if (element.match(/align/) || element.match(/A/)) {\n          styleObject.align = val;\n        }\n        if (element.match(/line/) || element.match(/L/)) {\n          styleObject.line = val;\n        }\n        if (element.match(/position/) || element.match(/P/)) {\n          styleObject.position = val;\n        }\n        if (element.match(/size/) || element.match(/S/)) {\n          styleObject.size = val;\n        }\n      }\n    });\n\n    return styleObject;\n  }\n\n  /*\n   * VTT can have multiple lines to display per cuepoint.\n   */\n  function getSublines(data, idx) {\n    let i = idx;\n\n    let subline = '';\n    let lineData = '';\n    let lineCount;\n\n    while (data[i] !== '' && i < data.length) {\n      i++;\n    }\n\n    lineCount = i - idx;\n    if (lineCount > 1) {\n      for (let j = 0; j < lineCount; j++) {\n        lineData = data[(idx + j)];\n        if (!lineData.match(regExToken)) {\n          subline += lineData;\n          if (j !== lineCount - 1) {\n            subline += '\\n';\n          }\n        } else {\n          // caption text should not have '-->' in it\n          subline = '';\n          break;\n        }\n      }\n    } else {\n      lineData = data[idx];\n      if (!lineData.match(regExToken))\n        subline = lineData;\n    }\n    return subline;\n  }\n\n  instance = {\n    parse: parse\n  };\n\n  setup();\n  return instance;\n}\nVTTParser.__h5player_factory_name = 'VTTParser';\nexport default FactoryMaker.getSingletonFactory(VTTParser);","// Define xhr_loader internal structure FYI.\r\n\r\n// XHR ReadyState\r\n// 0 UNSENT ()  open().\r\n// 1 OPENED  () open().\r\n// 2 HEADERS_RECEIVED () send(), .\r\n// 3 LOADING () ; responseText.\r\n// 4 DONE () .\r\n\r\nconst XHR_READYSTATE_UNSENT = 0;\r\nconst XHR_READYSTATE_OPENED = 1;\r\nconst XHR_READYSTATE_HEADERS_RECEIVED = 2;\r\nconst XHR_READYSTATE_LOADING = 3;\r\nconst XHR_READYSTATE_DONE = 4;\r\n\r\n// HTTP Error Code\r\n// 200 OK\r\n\r\nlet xhr = null;\r\n\r\nfunction printlog(log) {\r\n  console.log(log);\r\n}\r\n\r\nfunction _readyStateChangeHandler(options) {\r\n  return function(e) {\r\n    const xhr = e.currentTarget || options.xhr;\r\n    if (xhr.readyState === XHR_READYSTATE_DONE) {\r\n      if (xhr.status === 200) {\r\n        options.oncomplete(xhr);\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nfunction _requestError(options) {\r\n  return function(e) {\r\n    const xhr = e.currentTarget || options.xhr;\r\n    options.onerror(xhr);\r\n  };\r\n}\r\n\r\nexport function ajax(url, completeCallback, errorCallback) {\r\n  printlog('begin load time: ' + (new Date().getTime()) / 1000);\r\n\r\n  // save input parameters\r\n  const options = {\r\n    xhr: null,\r\n    url: url,\r\n    oncomplete: completeCallback,\r\n    onerror: errorCallback\r\n  };\r\n\r\n  printlog('ajax: ' + options.url);\r\n\r\n  // init reference variables\r\n  xhr = options.xhr = new XMLHttpRequest;\r\n\r\n  printlog('--before open--, readyState: ' + xhr.readyState);\r\n  xhr.open('GET', options.url);\r\n\r\n  xhr.onreadystatechange = _readyStateChangeHandler(options);\r\n  xhr.onerror = _requestError(options);\r\n\r\n  printlog('--before send--, readyState: ' + xhr.readyState);\r\n  xhr.send();\r\n\r\n  return xhr;\r\n};","var CommonUtils = {};\r\n\r\n/**\r\n * return IE,IE6,IE7,IE8,IE9,Chrome,Firefox,Opera,WebKit,Safari,Others\r\n */\r\nCommonUtils.getBrowserInfo = function() {\r\n  var sys = {};\r\n  var ua = navigator.userAgent.toLowerCase();\r\n  var s;\r\n  if (s = ua.match(/edge\\/([\\d.]+)/)) {\r\n    sys.edge = s[1];\r\n  } else if (s = ua.match(/rv:([\\d.]+)\\) like gecko/)) {\r\n    sys.ie = s[1];\r\n  } else if (s = ua.match(/msie ([\\d.]+)/)) {\r\n    sys.ie = s[1];\r\n  } else if (s = ua.match(/firefox\\/([\\d.]+)/)) {\r\n    sys.firefox = s[1];\r\n  } else if (s = ua.match(/chrome\\/([\\d.]+)/)) {\r\n    sys.chrome = s[1];\r\n  } else if (s = ua.match(/opera.([\\d.]+)/)) {\r\n    sys.opera = s[1];\r\n  } else if (s = ua.match(/version\\/([\\d.]+).*safari/)) {\r\n    sys.safari = s[1];\r\n  }\r\n\r\n  if (sys.edge) {\r\n    return {\r\n      browser: 'Edge',\r\n      version: sys.edge\r\n    };\r\n  }\r\n  if (sys.ie) {\r\n    return {\r\n      browser: 'IE',\r\n      version: sys.ie\r\n    };\r\n  }\r\n  if (sys.firefox) {\r\n    return {\r\n      browser: 'Firefox',\r\n      version: sys.firefox\r\n    };\r\n  }\r\n  if (sys.chrome) {\r\n    return {\r\n      browser: 'Chrome',\r\n      version: sys.chrome\r\n    };\r\n  }\r\n  if (sys.opera) {\r\n    return {\r\n      browser: 'Opera',\r\n      version: sys.opera\r\n    };\r\n  }\r\n  if (sys.safari) {\r\n    return {\r\n      browser: 'Safari',\r\n      version: sys.safari\r\n    };\r\n  }\r\n\r\n  return {\r\n    browser: '',\r\n    version: '0'\r\n  };\r\n};\r\n\r\nCommonUtils.isSafari = function() {\r\n  if (CommonUtils.getBrowserInfo().browser === 'Safari') {\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n};\r\n\r\nCommonUtils.isFirefox = function() {\r\n  if (CommonUtils.getBrowserInfo().browser === 'Firefox') {\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n};\r\n\r\nCommonUtils.isChrome = function() {\r\n  if (CommonUtils.getBrowserInfo().browser === 'Chrome') {\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n};\r\n\r\nCommonUtils.isChromecast = function() {\r\n  if (window.cast && window.cast.__platform__) {\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n};\r\n\r\nCommonUtils.isEdge = function() {\r\n  var userAgent = navigator.userAgent;\r\n  var isEdge = userAgent.indexOf('Edge') > -1;\r\n  return isEdge;\r\n};\r\n\r\nCommonUtils.isIE = function() {\r\n  if (!!window.ActiveXObject || 'ActiveXObject' in window) {\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n};\r\n\r\nCommonUtils.getOSVersion = function() {\r\n  var os,\r\n    osVersion;\r\n\r\n  // system\r\n  var nAgt = navigator.userAgent;\r\n  var nVer = navigator.appVersion;\r\n\r\n  os = 'unknown';\r\n  osVersion = 'unknown';\r\n  var clientStrings = [{\r\n    s: 'Windows 10',\r\n    r: /(Windows 10.0|Windows NT 10.0)/\r\n  }, {\r\n    s: 'Windows 8.1',\r\n    r: /(Windows 8.1|Windows NT 6.3)/\r\n  }, {\r\n    s: 'Windows 8',\r\n    r: /(Windows 8|Windows NT 6.2)/\r\n  }, {\r\n    s: 'Windows 7',\r\n    r: /(Windows 7|Windows NT 6.1)/\r\n  }, {\r\n    s: 'Windows Vista',\r\n    r: /Windows NT 6.0/\r\n  }, {\r\n    s: 'Windows Server 2003',\r\n    r: /Windows NT 5.2/\r\n  }, {\r\n    s: 'Windows XP',\r\n    r: /(Windows NT 5.1|Windows XP)/\r\n  }, {\r\n    s: 'Windows 2000',\r\n    r: /(Windows NT 5.0|Windows 2000)/\r\n  }, {\r\n    s: 'Windows ME',\r\n    r: /(Win 9x 4.90|Windows ME)/\r\n  }, {\r\n    s: 'Windows 98',\r\n    r: /(Windows 98|Win98)/\r\n  }, {\r\n    s: 'Windows 95',\r\n    r: /(Windows 95|Win95|Windows_95)/\r\n  }, {\r\n    s: 'Windows NT 4.0',\r\n    r: /(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/\r\n  }, {\r\n    s: 'Windows CE',\r\n    r: /Windows CE/\r\n  }, {\r\n    s: 'Windows 3.11',\r\n    r: /Win16/\r\n  }, {\r\n    s: 'Android',\r\n    r: /Android/\r\n  }, {\r\n    s: 'Open BSD',\r\n    r: /OpenBSD/\r\n  }, {\r\n    s: 'Sun OS',\r\n    r: /SunOS/\r\n  }, {\r\n    s: 'Linux',\r\n    r: /(Linux|X11)/\r\n  }, {\r\n    s: 'iOS',\r\n    r: /(iPhone|iPad|iPod)/\r\n  }, {\r\n    s: 'Mac OS X',\r\n    r: /Mac OS X/\r\n  }, {\r\n    s: 'Mac OS',\r\n    r: /(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/\r\n  }, {\r\n    s: 'QNX',\r\n    r: /QNX/\r\n  }, {\r\n    s: 'UNIX',\r\n    r: /UNIX/\r\n  }, {\r\n    s: 'BeOS',\r\n    r: /BeOS/\r\n  }, {\r\n    s: 'OS/2',\r\n    r: /OS\\/2/\r\n  }, {\r\n    s: 'Search Bot',\r\n    r: /(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\\/Teoma|ia_archiver)/\r\n  }];\r\n  for (var id in clientStrings) {\r\n    var cs = clientStrings[id];\r\n    if (cs.r.test(nAgt)) {\r\n      os = cs.s;\r\n      break;\r\n    }\r\n  }\r\n\r\n  if (/Windows/.test(os)) {\r\n    osVersion = /Windows (.*)/.exec(os)[1];\r\n    os = 'Windows';\r\n  }\r\n\r\n  switch (os) {\r\n    case 'Mac OS X':\r\n      osVersion = /Mac OS X (10[\\.\\_\\d]+)/.exec(nAgt)[1];\r\n      break;\r\n    case 'Android':\r\n      osVersion = /Android ([\\.\\_\\d]+)/.exec(nAgt)[1];\r\n      break;\r\n    case 'iOS':\r\n      osVersion = /OS (\\d+)_(\\d+)_?(\\d+)?/.exec(nVer);\r\n      osVersion = osVersion[1] + '.' + osVersion[2] + '.' + (osVersion[3] | 0);\r\n      break;\r\n  }\r\n\r\n  console.log('nAgt: ' + nAgt);\r\n  console.log('nVer: ' + nVer);\r\n  console.log('os: ' + os);\r\n  console.log('osVersion: ' + osVersion);\r\n\r\n  var pattern = 'Linux';\r\n  var ua = 'Mozilla/5.0 (X11; Linux armv7l) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.17 Safari/537.36 CrKey/1.28.100555';\r\n  var arrOSV = RegExp('\\\\b' + pattern + '(?:/[\\\\d.]+|[ \\\\w.]*)', 'i').exec(ua);\r\n  var osv = arrOSV[0];\r\n  var patternLen = pattern.length;\r\n  console.log('pattern length: ' + patternLen);\r\n  osv.indexOf(pattern);\r\n\r\n  var out = osv.slice(patternLen + 1);\r\n  console.log('out: ' + out);\r\n\r\n  let a = 2;\r\n  let b = a;\r\n};\r\n\r\nCommonUtils.isMobilePlatform = function() {\r\n  return (navigator.userAgent.match(/(iPod|iPhone|iPad)/) ||\r\n    navigator.userAgent.toLowerCase().indexOf('android') > -1);\r\n};\r\n\r\n/////////////////////////////////////////////////////////////\r\nCommonUtils.init = function() {\r\n  // Add startsWith prototype method to String object\r\n  if (!String.prototype.startsWith) {\r\n    // Add prototype methods for Number object\r\n    if (!Number.isInteger) {\r\n      Number.isInteger = function(num) {\r\n        return (num ^ 0) === num;\r\n      };\r\n    }\r\n\r\n    // Add prototype methods for String object\r\n    if (!String.prototype.startsWith) {\r\n      String.prototype.startsWith = function(searchString, position) {\r\n        position = position || 0;\r\n        return this.indexOf(searchString, position) === position;\r\n      };\r\n    }\r\n  }\r\n};\r\n\r\n//////////////////////////////////////////////\r\nCommonUtils.getFormatTime = function() {\r\n  let message = '';\r\n  let d = null;\r\n\r\n  d = new Date();\r\n  message += '[' + ('0' + (d.getMonth() + 1)).slice(-2) + '-' +\r\n    ('0' + d.getDate()).slice(-2) + ' ' +\r\n    ('0' + d.getHours()).slice(-2) + ':' +\r\n    ('0' + d.getMinutes()).slice(-2) + ':' +\r\n    ('0' + d.getSeconds()).slice(-2) + '.' +\r\n    ('0' + d.getMilliseconds()).slice(-3) + ']';\r\n\r\n  return message;\r\n};\r\n\r\nCommonUtils.timeToString = function(value) {\r\n  function formatTimeUnit(time) {\r\n    return time < 10 ? '0' + time.toString() : time.toString();\r\n  }\r\n\r\n  value = Math.max(value, 0);\r\n  var h = Math.floor(value / 3600);\r\n  var m = Math.floor((value % 3600) / 60);\r\n  var s = Math.floor((value % 3600) % 60);\r\n  return (h === 0 ? '' : formatTimeUnit(h) + ':') + formatTimeUnit(m) + ':' + formatTimeUnit(s);\r\n};\r\n\r\nCommonUtils.TimeRangesToString = function(r) {\r\n  let log = '',\r\n    len = r.length;\r\n  for (let i = 0; i < len; i++) {\r\n    let beg = r.start(i);\r\n    let end = r.end(i);\r\n\r\n    //console.log('start: ' + beg + ', end: ' + end);\r\n    log += '[' + r.start(i) + ',' + r.end(i) + ']';\r\n  }\r\n  return log;\r\n};\r\n\r\n//\r\nCommonUtils.test1 = function(aa) {\r\n  CommonUtils.init();\r\n\r\n  var s1 = 'aaabbcder';\r\n  var ret = s1.startsWith('aaa', 0);\r\n  var ret2 = s1.startsWith('abc', 0);\r\n  console.log('startsWith ret: ' + ret);\r\n  console.log('startsWith ret2: ' + ret2);\r\n\r\n  var b1 = Number.isInteger(123);\r\n  var b2 = Number.isInteger(123.123);\r\n  var b3 = Number.isInteger(undefined);\r\n  console.log('b1: ' + b1);\r\n  console.log('b2: ' + b2);\r\n  console.log('b3: ' + b3);\r\n};\r\n\r\nexport default CommonUtils;","import FactoryMaker from '../core/FactoryMaker';\nimport Debug from '../core/Debug';\n\n/* Reference\n * 1. https://segmentfault.com/a/1190000007019545\n * 2. https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\n * 3. https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch\n */\n\n// class FetchLoaderContext {\n//   constructor() {\n//     this.url = null;\n//     this.cbSuccess = null;\n//   }\n// }\n\nfunction FetchLoader() {\n  let context_ = this.context;\n  let debug_ = Debug(context_).getInstance();\n\n  let request_ = null;\n\n  function load(request) {\n    request_ = request;\n\n    //\n    let fetchRequest;\n\n    const initParams = {\n      method: 'GET',\n      mode: 'cors',\n      credentials: 'same-origin'\n    };\n\n    const headersObj = {};\n    initParams.headers = new Headers(headersObj);\n    fetchRequest = new Request(request_.url, initParams);\n\n    let totalBytes = 0;\n    let fetchPromise = fetch(fetchRequest, initParams);\n    // process fetchPromise\n    fetchPromise.then(function(response) {\n      if (response.ok) {\n        var pump = function(reader) {\n          return reader.read().then(function(result) {\n            // if we're done reading the stream, return\n            if (result.done) {\n              debug_.log('download ' + fetchRequest.url + ' complete, totalBytes: ' + totalBytes);\n              request_.cbSuccess(totalBytes);\n              return;\n            }\n\n            // retrieve the multi-byte chunk of data\n            let chunk = result.value;\n            totalBytes += chunk.byteLength;\n\n            debug_.log('fetch download chunk: ' + chunk.byteLength);\n            request_.cbProgress(chunk.byteLength);\n\n            return pump(reader);\n          });\n        };\n\n        // start reading the response stream\n        return pump(response.body.getReader());\n      } else {\n        //callbacks.onError({ text: 'fetch, bad network response' }, context);\n      }\n    }).catch(function() {\n      //callbacks.onError({ text: error.message }, context);\n    });\n  }\n\n  let instance_ = {\n    load: load\n  };\n\n  return instance_;\n}\n\nFetchLoader.__h5player_factory_name = 'FetchLoader';\nexport default FactoryMaker.getClassFactory(FetchLoader);","const StringUtils = {\r\n\r\n  // ArrayBufferArrayBuffer\r\n  ab2str: function(buf) {\r\n    return String.fromCharCode.apply(null, new Uint16Array(buf));\r\n  },\r\n  // ArrayBuffer\r\n  str2ab: function(str) {\r\n    var buf = new ArrayBuffer(str.length * 2); // 2\r\n    var bufView = new Uint16Array(buf);\r\n    for (var i = 0, strLen = str.length; i < strLen; i++) {\r\n      bufView[i] = str.charCodeAt(i);\r\n    }\r\n    return buf;\r\n  },\r\n  ab2str_v1: function(buf) {\r\n    return String.fromCharCode.apply(null, new Uint8Array(buf));\r\n  },\r\n  // ArrayBuffer\r\n  str2ab_v1: function(str) {\r\n    var buf = new ArrayBuffer(str.length); // 1\r\n    var bufView = new Uint8Array(buf);\r\n    for (var i = 0, strLen = str.length; i < strLen; i++) {\r\n      bufView[i] = str.charCodeAt(i);\r\n    }\r\n    return buf;\r\n  },\r\n  u8arrToB64: function(u8arr) {\r\n    return btoa(String.fromCharCode.apply(null, u8arr)).\r\n      replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=*$/, '');\r\n  },\r\n  b64ToU8arr: function(encoded) {\r\n    return new Uint8Array(atob(encoded).split('').map(function(c) {\r\n      return c.charCodeAt(0);\r\n    }));\r\n  }\r\n};\r\n\r\nmodule.exports = StringUtils;","/**\r\n *  TimeRanges to string helper\r\n */\r\n\r\nconst TimeRanges = {\r\n  toString: function(r) {\r\n    let log = '',\r\n      len = r.length;\r\n    for (let i = 0; i < len; i++) {\r\n      //let beg = r.start(i);\r\n      //let end = r.end(i);\r\n      //console.log('start: ' + beg + ', end: ' + end);\r\n      log += '[' + r.start(i) + ',' + r.end(i) + ']';\r\n    }\r\n    return log;\r\n  }\r\n};\r\n\r\nmodule.exports = TimeRanges;","// Define xhr_loader internal structure FYI.\r\n\r\n// class XHRLoaderRequest {\r\n//   constructor() {\r\n//     this.url = null;\r\n//     this.rangeStart = null;\r\n//     this.rangeEnd = null;\r\n//     this.cbSuccess = null;\r\n//   }\r\n// }\r\n\r\n// class XHRLoaderConfig {\r\n//   constructor() {\r\n//     this.remainingAttempts = 0;\r\n//     this.retryInterval = 4000;\r\n//   }\r\n// }\r\n\r\n// class XHRLoaderCallback {\r\n//   constructor() {\r\n\r\n//   }\r\n// }\r\n\r\nfunction XHRLoader() {\r\n  let request_ = null;\r\n  let config_ = null;\r\n  let callbacks_ = null;\r\n\r\n  let xhr_ = null;\r\n  let needFailureReport_ = false;\r\n\r\n  function load(request, config, callbacks) {\r\n    printlog('begin load time: ' + (new Date().getTime()) / 1000);\r\n    // save input parameters\r\n    request_ = request;\r\n    config_ = config || {\r\n      remainingAttempts: 0,\r\n      retryInterval: 4000\r\n    };\r\n    callbacks_ = callbacks;\r\n\r\n    printlog(request_.url + ', remainingAttempts_: ' + config_.remainingAttempts);\r\n\r\n    // init reference variables\r\n    needFailureReport_ = true;\r\n    xhr_ = new XMLHttpRequest;\r\n\r\n    printlog('--before open--, readyState: ' + xhr_.readyState);\r\n    xhr_.open('GET', request_.url);\r\n    if (request_.rangeEnd) {\r\n      xhr_.setRequestHeader('Range', 'bytes=' + request_.rangeStart + '-' + (request_.rangeEnd - 1));\r\n    }\r\n\r\n    xhr_.onloadstart = function() {\r\n      printlog('--onloadstart--');\r\n    };\r\n\r\n    const onload = function() {\r\n      //printlog(`--onload--, status:${xhr_.status}, length: ${xhr_.response.byteLength}, readyState:${xhr_.readyState}`);\r\n      printlog(`--onload--, status:${xhr_.status}, readyState:${xhr_.readyState}`);\r\n\r\n      if (xhr_.status >= 200 && xhr_.status <= 299) {\r\n        callbacks_.onSuccess(xhr_.response);\r\n        needFailureReport_ = false;\r\n      }\r\n    };\r\n\r\n    const onloadend = function() {\r\n      printlog('--onloadend--, remainingAttempts_: ' + config_.remainingAttempts + ', readystate: ' + xhr_.readyState);\r\n      printlog('--------------------------------------------------------------');\r\n\r\n      if (needFailureReport_) {\r\n        if (config_.remainingAttempts > 0) {\r\n          config_.remainingAttempts--;\r\n\r\n          // BD, test retry counts\r\n          // if (config_.remainingAttempts === 0) {\r\n          //   request_.url = 'http://localhost/1/tmp/test.txt';\r\n          // }\r\n          // // ED\r\n\r\n          printlog('begin load timeout: ' + (new Date().getTime()) / 1000);\r\n\r\n          //setTimeout(retryFunc, config_.retryInterval);\r\n          setTimeout(load.bind(this, request_), config_.retryInterval);\r\n        }\r\n      }\r\n    };\r\n\r\n    xhr_.onprogress = function(ev) {\r\n      printlog(`--onprogress--, loaded:${ev.loaded}, total:${ev.total}, readyState:${xhr_.readyState}`);\r\n    };\r\n\r\n    xhr_.ontimeout = function() {\r\n      printlog('--ontimeout--, readystate: ' + xhr_.readyState);\r\n    };\r\n\r\n    xhr_.onabort = function() {\r\n      printlog('--onabort--, readystate: ' + xhr_.readyState);\r\n    };\r\n\r\n    xhr_.onerror = function() {\r\n      printlog('--onerror--, readystate: ' + xhr_.readyState);\r\n    };\r\n\r\n    xhr_.onreadystatechange = function() {\r\n      printlog('--onreadystatechange--, readystate: ' + xhr_.readyState);\r\n    };\r\n\r\n    xhr_.onload = onload.bind(this);\r\n    xhr_.onloadend = onloadend.bind(this);\r\n\r\n    xhr_.responseType = request.responseType || 'arraybuffer';\r\n    printlog('--before send--, readyState: ' + xhr_.readyState);\r\n    xhr_.send();\r\n  }\r\n\r\n  function printlog(log) {\r\n    console.log(log);\r\n  }\r\n\r\n  let instance = {\r\n    load: load\r\n  };\r\n\r\n  return instance;\r\n}\r\n\r\nexport default XHRLoader;","import FactoryMaker from './core/FactoryMaker';\r\n\r\nfunction VideoPlayer() {\r\n  let context_ = this.context;\r\n\r\n  function setup() {\r\n  }\r\n\r\n  function setSrc(url) {\r\n    // mediaElement.pause();\r\n    // mediaElement.src='';\r\n    context_.media.src = url;\r\n\r\n    //let media_ = context_.media;\r\n    //console.log(`timeupdate, main buffered: ${TimeRanges.toString(media_.buffered)}, position: ${media_.currentTime}, duration: ${media_.duration}`);\r\n  }\r\n\r\n  let instance_ = {\r\n    setSrc: setSrc\r\n  };\r\n\r\n  setup();\r\n\r\n  return instance_;\r\n}\r\n\r\n\r\nVideoPlayer.__h5player_factory_name = 'VideoPlayer';\r\nexport default FactoryMaker.getSingletonFactory(VideoPlayer);\r\n\r\n\r\n\r\n\r\n\r\n","/**\n * HLS config\n */\n\nimport AbrController from './controller/abr-controller';\nimport BufferController from './controller/buffer-controller';\nimport CapLevelController from './controller/cap-level-controller';\nimport FPSController from './controller/fps-controller';\nimport XhrLoader from './utils/xhr-loader';\n// import FetchLoader from './utils/fetch-loader';\n\nimport AudioTrackController from './controller/audio-track-controller';\nimport AudioStreamController from './controller/audio-stream-controller';\n\nimport * as Cues from './utils/cues';\nimport TimelineController from './controller/timeline-controller';\nimport SubtitleTrackController from './controller/subtitle-track-controller';\nimport SubtitleStreamController from './controller/subtitle-stream-controller';\nimport EMEController from './controller/eme-controller';\n\nimport { requestMediaKeySystemAccess } from './helper/mediakeys-helper';\n\nexport var hlsDefaultConfig = {\n  autoStartLoad: true, // used by stream-controller\n  startPosition: -1, // used by stream-controller\n  defaultAudioCodec: undefined, // used by stream-controller\n  debug: false, // used by logger\n  capLevelOnFPSDrop: false, // used by fps-controller\n  capLevelToPlayerSize: false, // used by cap-level-controller\n  initialLiveManifestSize: 1, // used by stream-controller\n  maxBufferLength: 30, // used by stream-controller\n  maxBufferSize: 60 * 1000 * 1000, // used by stream-controller\n  maxBufferHole: 0.5, // used by stream-controller\n\n  lowBufferWatchdogPeriod: 0.5, // used by stream-controller\n  highBufferWatchdogPeriod: 3, // used by stream-controller\n  nudgeOffset: 0.1, // used by stream-controller\n  nudgeMaxRetry: 3, // used by stream-controller\n  maxFragLookUpTolerance: 0.25, // used by stream-controller\n  liveSyncDurationCount: 3, // used by stream-controller\n  liveMaxLatencyDurationCount: Infinity, // used by stream-controller\n  liveSyncDuration: undefined, // used by stream-controller\n  liveMaxLatencyDuration: undefined, // used by stream-controller\n  liveDurationInfinity: false, // used by buffer-controller\n  maxMaxBufferLength: 600, // used by stream-controller\n  enableWorker: true, // used by demuxer\n  enableSoftwareAES: true, // used by decrypter\n  manifestLoadingTimeOut: 10000, // used by playlist-loader\n  manifestLoadingMaxRetry: 1, // used by playlist-loader\n  manifestLoadingRetryDelay: 1000, // used by playlist-loader\n  manifestLoadingMaxRetryTimeout: 64000, // used by playlist-loader\n  startLevel: undefined, // used by level-controller\n  levelLoadingTimeOut: 10000, // used by playlist-loader\n  levelLoadingMaxRetry: 4, // used by playlist-loader\n  levelLoadingRetryDelay: 1000, // used by playlist-loader\n  levelLoadingMaxRetryTimeout: 64000, // used by playlist-loader\n  fragLoadingTimeOut: 20000, // used by fragment-loader\n  fragLoadingMaxRetry: 6, // used by fragment-loader\n  fragLoadingRetryDelay: 1000, // used by fragment-loader\n  fragLoadingMaxRetryTimeout: 64000, // used by fragment-loader\n  startFragPrefetch: false, // used by stream-controller\n  fpsDroppedMonitoringPeriod: 5000, // used by fps-controller\n  fpsDroppedMonitoringThreshold: 0.2, // used by fps-controller\n  appendErrorMaxRetry: 3, // used by buffer-controller\n  loader: XhrLoader,\n  // loader: FetchLoader,\n  fLoader: undefined, // used by fragment-loader\n  pLoader: undefined, // used by playlist-loader\n  xhrSetup: undefined, // used by xhr-loader\n  licenseXhrSetup: undefined, // used by eme-controller\n  // fetchSetup: undefined,\n  abrController: AbrController,\n  bufferController: BufferController,\n  capLevelController: CapLevelController,\n  fpsController: FPSController,\n  stretchShortVideoTrack: false, // used by mp4-remuxer\n  maxAudioFramesDrift: 1, // used by mp4-remuxer\n  forceKeyFrameOnDiscontinuity: true, // used by ts-demuxer\n  abrEwmaFastLive: 3, // used by abr-controller\n  abrEwmaSlowLive: 9, // used by abr-controller\n  abrEwmaFastVoD: 3, // used by abr-controller\n  abrEwmaSlowVoD: 9, // used by abr-controller\n  abrEwmaDefaultEstimate: 5e5, // 500 kbps  // used by abr-controller\n  abrBandWidthFactor: 0.95, // used by abr-controller\n  abrBandWidthUpFactor: 0.7, // used by abr-controller\n  abrMaxWithRealBitrate: false, // used by abr-controller\n  maxStarvationDelay: 4, // used by abr-controller\n  maxLoadingDelay: 4, // used by abr-controller\n  minAutoBitrate: 0, // used by hls\n  emeEnabled: false, // used by eme-controller\n  widevineLicenseUrl: undefined, // used by eme-controller\n  requestMediaKeySystemAccessFunc:\n            requestMediaKeySystemAccess // used by eme-controller\n};\n\n//if (__USE_SUBTITLES__) {\nif (true) {\n  hlsDefaultConfig.subtitleStreamController = SubtitleStreamController;\n  hlsDefaultConfig.subtitleTrackController = SubtitleTrackController;\n  hlsDefaultConfig.timelineController = TimelineController;\n  hlsDefaultConfig.cueHandler = Cues; // used by timeline-controller\n  hlsDefaultConfig.enableCEA708Captions = true; // used by timeline-controller\n  hlsDefaultConfig.enableWebVTT = true; // used by timeline-controller\n  hlsDefaultConfig.captionsTextTrack1Label = 'English'; // used by timeline-controller\n  hlsDefaultConfig.captionsTextTrack1LanguageCode = 'en'; // used by timeline-controller\n  hlsDefaultConfig.captionsTextTrack2Label = 'Spanish'; // used by timeline-controller\n  hlsDefaultConfig.captionsTextTrack2LanguageCode = 'es'; // used by timeline-controller\n}\n\n//if (__USE_ALT_AUDIO__) {\nif (true) {\n  hlsDefaultConfig.audioStreamController = AudioStreamController;\n  hlsDefaultConfig.audioTrackController = AudioTrackController;\n}\n\n//if (__USE_EME_DRM__)\nif (true)\n  hlsDefaultConfig.emeController = EMEController;\n","/*\n * simple ABR Controller\n *  - compute next level based on last fragment bw heuristics\n *  - implement an abandon rules triggered if we have less than 2 frag buffered and if computed bw shows that we risk buffer stalling\n */\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport BufferHelper from '../helper/buffer-helper';\nimport { ErrorDetails } from '../errors';\nimport { logger } from '../utils/logger';\nimport EwmaBandWidthEstimator from '../utils/ewma-bandwidth-estimator';\n\nclass AbrController extends EventHandler {\n  constructor (hls) {\n    super(hls, Event.FRAG_LOADING,\n      Event.FRAG_LOADED,\n      Event.FRAG_BUFFERED,\n      Event.ERROR);\n    this.lastLoadedFragLevel = 0;\n    this._nextAutoLevel = -1;\n    this.hls = hls;\n    this.timer = null;\n    this._bwEstimator = null;\n    this.onCheck = this._abandonRulesCheck.bind(this);\n  }\n\n  destroy () {\n    this.clearTimer();\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  onFragLoading (data) {\n    let frag = data.frag;\n    if (frag.type === 'main') {\n      if (!this.timer)\n        this.timer = setInterval(this.onCheck, 100);\n\n      // lazy init of bw Estimator, rationale is that we use different params for Live/VoD\n      // so we need to wait for stream manifest / playlist type to instantiate it.\n      if (!this._bwEstimator) {\n        let hls = this.hls,\n          level = data.frag.level,\n          isLive = hls.levels[level].details.live,\n          config = hls.config,\n          ewmaFast, ewmaSlow;\n\n        if (isLive) {\n          ewmaFast = config.abrEwmaFastLive;\n          ewmaSlow = config.abrEwmaSlowLive;\n        } else {\n          ewmaFast = config.abrEwmaFastVoD;\n          ewmaSlow = config.abrEwmaSlowVoD;\n        }\n        this._bwEstimator = new EwmaBandWidthEstimator(hls, ewmaSlow, ewmaFast, config.abrEwmaDefaultEstimate);\n      }\n      this.fragCurrent = frag;\n    }\n  }\n\n  _abandonRulesCheck () {\n    /*\n      monitor fragment retrieval time...\n      we compute expected time of arrival of the complete fragment.\n      we compare it to expected time of buffer starvation\n    */\n    let hls = this.hls, v = hls.media, frag = this.fragCurrent, loader = frag.loader, minAutoLevel = hls.minAutoLevel;\n\n    // if loader has been destroyed or loading has been aborted, stop timer and return\n    if (!loader || (loader.stats && loader.stats.aborted)) {\n      logger.warn('frag loader destroy or aborted, disarm abandonRules');\n      this.clearTimer();\n      // reset forced auto level value so that next level will be selected\n      this._nextAutoLevel = -1;\n      return;\n    }\n    let stats = loader.stats;\n    /* only monitor frag retrieval time if\n    (video not paused OR first fragment being loaded(ready state === HAVE_NOTHING = 0)) AND autoswitching enabled AND not lowest level (=> means that we have several levels) */\n    if (v && stats && ((!v.paused && (v.playbackRate !== 0)) || !v.readyState) && frag.autoLevel && frag.level) {\n      let requestDelay = performance.now() - stats.trequest,\n        playbackRate = Math.abs(v.playbackRate);\n      // monitor fragment load progress after half of expected fragment duration,to stabilize bitrate\n      if (requestDelay > (500 * frag.duration / playbackRate)) {\n        let levels = hls.levels,\n          loadRate = Math.max(1, stats.bw ? stats.bw / 8 : stats.loaded * 1000 / requestDelay), // byte/s; at least 1 byte/s to avoid division by zero\n          // compute expected fragment length using frag duration and level bitrate. also ensure that expected len is gte than already loaded size\n          level = levels[frag.level],\n          levelBitrate = level.realBitrate ? Math.max(level.realBitrate, level.bitrate) : level.bitrate,\n          expectedLen = stats.total ? stats.total : Math.max(stats.loaded, Math.round(frag.duration * levelBitrate / 8)),\n          pos = v.currentTime,\n          fragLoadedDelay = (expectedLen - stats.loaded) / loadRate,\n          bufferStarvationDelay = (BufferHelper.bufferInfo(v, pos, hls.config.maxBufferHole).end - pos) / playbackRate;\n        // consider emergency switch down only if we have less than 2 frag buffered AND\n        // time to finish loading current fragment is bigger than buffer starvation delay\n        // ie if we risk buffer starvation if bw does not increase quickly\n        if ((bufferStarvationDelay < (2 * frag.duration / playbackRate)) && (fragLoadedDelay > bufferStarvationDelay)) {\n          let fragLevelNextLoadedDelay, nextLoadLevel;\n          // lets iterate through lower level and try to find the biggest one that could avoid rebuffering\n          // we start from current level - 1 and we step down , until we find a matching level\n          for (nextLoadLevel = frag.level - 1; nextLoadLevel > minAutoLevel; nextLoadLevel--) {\n            // compute time to load next fragment at lower level\n            // 0.8 : consider only 80% of current bw to be conservative\n            // 8 = bits per byte (bps/Bps)\n            let levelNextBitrate = levels[nextLoadLevel].realBitrate ? Math.max(levels[nextLoadLevel].realBitrate, levels[nextLoadLevel].bitrate) : levels[nextLoadLevel].bitrate;\n            fragLevelNextLoadedDelay = frag.duration * levelNextBitrate / (8 * 0.8 * loadRate);\n            if (fragLevelNextLoadedDelay < bufferStarvationDelay) {\n              // we found a lower level that be rebuffering free with current estimated bw !\n              break;\n            }\n          }\n          // only emergency switch down if it takes less time to load new fragment at lowest level instead\n          // of finishing loading current one ...\n          if (fragLevelNextLoadedDelay < fragLoadedDelay) {\n            logger.warn(`loading too slow, abort fragment loading and switch to level ${nextLoadLevel}:fragLoadedDelay[${nextLoadLevel}]<fragLoadedDelay[${frag.level - 1}];bufferStarvationDelay:${fragLevelNextLoadedDelay.toFixed(1)}<${fragLoadedDelay.toFixed(1)}:${bufferStarvationDelay.toFixed(1)}`);\n            // force next load level in auto mode\n            hls.nextLoadLevel = nextLoadLevel;\n            // update bw estimate for this fragment before cancelling load (this will help reducing the bw)\n            this._bwEstimator.sample(requestDelay, stats.loaded);\n            // abort fragment loading\n            loader.abort();\n            // stop abandon rules timer\n            this.clearTimer();\n            hls.trigger(Event.FRAG_LOAD_EMERGENCY_ABORTED, { frag: frag, stats: stats });\n          }\n        }\n      }\n    }\n  }\n\n  onFragLoaded (data) {\n    let frag = data.frag;\n    if (frag.type === 'main' && !isNaN(frag.sn)) {\n      // stop monitoring bw once frag loaded\n      this.clearTimer();\n      // store level id after successful fragment load\n      this.lastLoadedFragLevel = frag.level;\n      // reset forced auto level value so that next level will be selected\n      this._nextAutoLevel = -1;\n\n      // compute level average bitrate\n      if (this.hls.config.abrMaxWithRealBitrate) {\n        const level = this.hls.levels[frag.level];\n        let loadedBytes = (level.loaded ? level.loaded.bytes : 0) + data.stats.loaded;\n        let loadedDuration = (level.loaded ? level.loaded.duration : 0) + data.frag.duration;\n        level.loaded = { bytes: loadedBytes, duration: loadedDuration };\n        level.realBitrate = Math.round(8 * loadedBytes / loadedDuration);\n      }\n      // if fragment has been loaded to perform a bitrate test,\n      if (data.frag.bitrateTest) {\n        let stats = data.stats;\n        stats.tparsed = stats.tbuffered = stats.tload;\n        this.onFragBuffered(data);\n      }\n    }\n  }\n\n  onFragBuffered (data) {\n    let stats = data.stats, frag = data.frag;\n    // only update stats on first frag buffering\n    // if same frag is loaded multiple times, it might be in browser cache, and loaded quickly\n    // and leading to wrong bw estimation\n    // on bitrate test, also only update stats once (if tload = tbuffered == on FRAG_LOADED)\n    if (stats.aborted !== true && frag.type === 'main' && !isNaN(frag.sn) && ((!frag.bitrateTest || stats.tload === stats.tbuffered))) {\n      // use tparsed-trequest instead of tbuffered-trequest to compute fragLoadingProcessing; rationale is that  buffer appending only happens once media is attached\n      // in case we use config.startFragPrefetch while media is not attached yet, fragment might be parsed while media not attached yet, but it will only be buffered on media attached\n      // as a consequence it could happen really late in the process. meaning that appending duration might appears huge ... leading to underestimated throughput estimation\n      let fragLoadingProcessingMs = stats.tparsed - stats.trequest;\n      logger.log(`latency/loading/parsing/append/kbps:${Math.round(stats.tfirst - stats.trequest)}/${Math.round(stats.tload - stats.tfirst)}/${Math.round(stats.tparsed - stats.tload)}/${Math.round(stats.tbuffered - stats.tparsed)}/${Math.round(8 * stats.loaded / (stats.tbuffered - stats.trequest))}`);\n      this._bwEstimator.sample(fragLoadingProcessingMs, stats.loaded);\n      stats.bwEstimate = this._bwEstimator.getEstimate();\n      // if fragment has been loaded to perform a bitrate test, (hls.startLevel = -1), store bitrate test delay duration\n      if (frag.bitrateTest)\n        this.bitrateTestDelay = fragLoadingProcessingMs / 1000;\n      else\n        this.bitrateTestDelay = 0;\n    }\n  }\n\n  onError (data) {\n    // stop timer in case of frag loading error\n    switch (data.details) {\n    case ErrorDetails.FRAG_LOAD_ERROR:\n    case ErrorDetails.FRAG_LOAD_TIMEOUT:\n      this.clearTimer();\n      break;\n    default:\n      break;\n    }\n  }\n\n  clearTimer () {\n    clearInterval(this.timer);\n    this.timer = null;\n  }\n\n  // return next auto level\n  get nextAutoLevel () {\n    const forcedAutoLevel = this._nextAutoLevel;\n    const bwEstimator = this._bwEstimator;\n    // in case next auto level has been forced, and bw not available or not reliable, return forced value\n    if (forcedAutoLevel !== -1 && (!bwEstimator || !bwEstimator.canEstimate()))\n      return forcedAutoLevel;\n\n    // compute next level using ABR logic\n    let nextABRAutoLevel = this._nextABRAutoLevel;\n    // if forced auto level has been defined, use it to cap ABR computed quality level\n    if (forcedAutoLevel !== -1)\n      nextABRAutoLevel = Math.min(forcedAutoLevel, nextABRAutoLevel);\n\n    return nextABRAutoLevel;\n  }\n  get _nextABRAutoLevel () {\n    let hls = this.hls, maxAutoLevel = hls.maxAutoLevel, levels = hls.levels, config = hls.config, minAutoLevel = hls.minAutoLevel;\n    const v = hls.media,\n      currentLevel = this.lastLoadedFragLevel,\n      currentFragDuration = this.fragCurrent ? this.fragCurrent.duration : 0,\n      pos = (v ? v.currentTime : 0),\n      // playbackRate is the absolute value of the playback rate; if v.playbackRate is 0, we use 1 to load as\n      // if we're playing back at the normal rate.\n      playbackRate = ((v && (v.playbackRate !== 0)) ? Math.abs(v.playbackRate) : 1.0),\n      avgbw = this._bwEstimator ? this._bwEstimator.getEstimate() : config.abrEwmaDefaultEstimate,\n      // bufferStarvationDelay is the wall-clock time left until the playback buffer is exhausted.\n      bufferStarvationDelay = (BufferHelper.bufferInfo(v, pos, config.maxBufferHole).end - pos) / playbackRate;\n\n    // First, look to see if we can find a level matching with our avg bandwidth AND that could also guarantee no rebuffering at all\n    let bestLevel = this._findBestLevel(currentLevel, currentFragDuration, avgbw, minAutoLevel, maxAutoLevel, bufferStarvationDelay, config.abrBandWidthFactor, config.abrBandWidthUpFactor, levels);\n    if (bestLevel >= 0) {\n      return bestLevel;\n    } else {\n      logger.trace('rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering');\n      // not possible to get rid of rebuffering ... let's try to find level that will guarantee less than maxStarvationDelay of rebuffering\n      // if no matching level found, logic will return 0\n      let maxStarvationDelay = currentFragDuration ? Math.min(currentFragDuration, config.maxStarvationDelay) : config.maxStarvationDelay,\n        bwFactor = config.abrBandWidthFactor,\n        bwUpFactor = config.abrBandWidthUpFactor;\n      if (bufferStarvationDelay === 0) {\n        // in case buffer is empty, let's check if previous fragment was loaded to perform a bitrate test\n        let bitrateTestDelay = this.bitrateTestDelay;\n        if (bitrateTestDelay) {\n          // if it is the case, then we need to adjust our max starvation delay using maxLoadingDelay config value\n          // max video loading delay used in  automatic start level selection :\n          // in that mode ABR controller will ensure that video loading time (ie the time to fetch the first fragment at lowest quality level +\n          // the time to fetch the fragment at the appropriate quality level is less than ```maxLoadingDelay``` )\n          // cap maxLoadingDelay and ensure it is not bigger 'than bitrate test' frag duration\n          const maxLoadingDelay = currentFragDuration ? Math.min(currentFragDuration, config.maxLoadingDelay) : config.maxLoadingDelay;\n          maxStarvationDelay = maxLoadingDelay - bitrateTestDelay;\n          logger.trace(`bitrate test took ${Math.round(1000 * bitrateTestDelay)}ms, set first fragment max fetchDuration to ${Math.round(1000 * maxStarvationDelay)} ms`);\n          // don't use conservative factor on bitrate test\n          bwFactor = bwUpFactor = 1;\n        }\n      }\n      bestLevel = this._findBestLevel(currentLevel, currentFragDuration, avgbw, minAutoLevel, maxAutoLevel, bufferStarvationDelay + maxStarvationDelay, bwFactor, bwUpFactor, levels);\n      return Math.max(bestLevel, 0);\n    }\n  }\n\n  _findBestLevel (currentLevel, currentFragDuration, currentBw, minAutoLevel, maxAutoLevel, maxFetchDuration, bwFactor, bwUpFactor, levels) {\n    for (let i = maxAutoLevel; i >= minAutoLevel; i--) {\n      let levelInfo = levels[i],\n        levelDetails = levelInfo.details,\n        avgDuration = levelDetails ? levelDetails.totalduration / levelDetails.fragments.length : currentFragDuration,\n        live = levelDetails ? levelDetails.live : false,\n        adjustedbw;\n      // follow algorithm captured from stagefright :\n      // https://android.googlesource.com/platform/frameworks/av/+/master/media/libstagefright/httplive/LiveSession.cpp\n      // Pick the highest bandwidth stream below or equal to estimated bandwidth.\n      // consider only 80% of the available bandwidth, but if we are switching up,\n      // be even more conservative (70%) to avoid overestimating and immediately\n      // switching back.\n      if (i <= currentLevel)\n        adjustedbw = bwFactor * currentBw;\n      else\n        adjustedbw = bwUpFactor * currentBw;\n\n      const bitrate = levels[i].realBitrate ? Math.max(levels[i].realBitrate, levels[i].bitrate) : levels[i].bitrate,\n        fetchDuration = bitrate * avgDuration / adjustedbw;\n\n      logger.trace(`level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: ${i}/${Math.round(adjustedbw)}/${bitrate}/${avgDuration}/${maxFetchDuration}/${fetchDuration}`);\n      // if adjusted bw is greater than level bitrate AND\n      if (adjustedbw > bitrate &&\n      // fragment fetchDuration unknown OR live stream OR fragment fetchDuration less than max allowed fetch duration, then this level matches\n      // we don't account for max Fetch Duration for live streams, this is to avoid switching down when near the edge of live sliding window ...\n      // special case to support startLevel = -1 (bitrateTest) on live streams : in that case we should not exit loop so that _findBestLevel will return -1\n        (!fetchDuration ||(live && !this.bitrateTestDelay) || fetchDuration < maxFetchDuration)) {\n        // as we are looping from highest to lowest, this will return the best achievable quality level\n        return i;\n      }\n    }\n    // not enough time budget even with quality level 0 ... rebuffering might happen\n    return -1;\n  }\n\n  set nextAutoLevel (nextLevel) {\n    this._nextAutoLevel = nextLevel;\n  }\n}\n\nexport default AbrController;\n","/*\n * Audio Stream Controller\n*/\n\nimport BinarySearch from '../utils/binary-search';\nimport BufferHelper from '../helper/buffer-helper';\nimport Demuxer from '../demux/demuxer';\nimport Event from '../events';\nimport * as LevelHelper from '../helper/level-helper';\nimport TimeRanges from '../utils/time-ranges';\nimport { ErrorTypes, ErrorDetails } from '../errors';\nimport { logger } from '../utils/logger';\nimport { findFragWithCC } from '../utils/discontinuities';\nimport TaskLoop from '../task-loop';\nimport { FragmentState } from '../helper/fragment-tracker';\nimport Fragment from '../loader/fragment';\n\nconst State = {\n  STOPPED: 'STOPPED',\n  STARTING: 'STARTING',\n  IDLE: 'IDLE',\n  PAUSED: 'PAUSED',\n  KEY_LOADING: 'KEY_LOADING',\n  FRAG_LOADING: 'FRAG_LOADING',\n  FRAG_LOADING_WAITING_RETRY: 'FRAG_LOADING_WAITING_RETRY',\n  WAITING_TRACK: 'WAITING_TRACK',\n  PARSING: 'PARSING',\n  PARSED: 'PARSED',\n  BUFFER_FLUSHING: 'BUFFER_FLUSHING',\n  ENDED: 'ENDED',\n  ERROR: 'ERROR',\n  WAITING_INIT_PTS: 'WAITING_INIT_PTS'\n};\n\nclass AudioStreamController extends TaskLoop {\n  constructor (hls, fragmentTracker) {\n    super(hls,\n      Event.MEDIA_ATTACHED,\n      Event.MEDIA_DETACHING,\n      Event.AUDIO_TRACKS_UPDATED,\n      Event.AUDIO_TRACK_SWITCHING,\n      Event.AUDIO_TRACK_LOADED,\n      Event.KEY_LOADED,\n      Event.FRAG_LOADED,\n      Event.FRAG_PARSING_INIT_SEGMENT,\n      Event.FRAG_PARSING_DATA,\n      Event.FRAG_PARSED,\n      Event.ERROR,\n      Event.BUFFER_RESET,\n      Event.BUFFER_CREATED,\n      Event.BUFFER_APPENDED,\n      Event.BUFFER_FLUSHED,\n      Event.INIT_PTS_FOUND);\n    this.fragmentTracker = fragmentTracker;\n    this.config = hls.config;\n    this.audioCodecSwap = false;\n    this._state = State.STOPPED;\n    this.initPTS = [];\n    this.waitingFragment = null;\n    this.videoTrackCC = null;\n  }\n\n  onHandlerDestroying () {\n    this.stopLoad();\n  }\n\n  onHandlerDestroyed () {\n    this.state = State.STOPPED;\n    this.fragmentTracker = null;\n  }\n\n  // Signal that video PTS was found\n  onInitPtsFound (data) {\n    let demuxerId = data.id, cc = data.frag.cc, initPTS = data.initPTS;\n    if (demuxerId === 'main') {\n      // Always update the new INIT PTS\n      // Can change due level switch\n      this.initPTS[cc] = initPTS;\n      this.videoTrackCC = cc;\n      logger.log(`InitPTS for cc: ${cc} found from video track: ${initPTS}`);\n\n      // If we are waiting we need to demux/remux the waiting frag\n      // With the new initPTS\n      if (this.state === State.WAITING_INIT_PTS)\n        this.tick();\n    }\n  }\n\n  startLoad (startPosition) {\n    if (this.tracks) {\n      let lastCurrentTime = this.lastCurrentTime;\n      this.stopLoad();\n      this.setInterval(100);\n      this.fragLoadError = 0;\n      if (lastCurrentTime > 0 && startPosition === -1) {\n        logger.log(`audio:override startPosition with lastCurrentTime @${lastCurrentTime.toFixed(3)}`);\n        this.state = State.IDLE;\n      } else {\n        this.lastCurrentTime = this.startPosition ? this.startPosition : startPosition;\n        this.state = State.STARTING;\n      }\n      this.nextLoadPosition = this.startPosition = this.lastCurrentTime;\n      this.tick();\n    } else {\n      this.startPosition = startPosition;\n      this.state = State.STOPPED;\n    }\n  }\n\n  stopLoad () {\n    let frag = this.fragCurrent;\n    if (frag) {\n      if (frag.loader)\n        frag.loader.abort();\n\n      this.fragmentTracker.removeFragment(frag);\n      this.fragCurrent = null;\n    }\n    this.fragPrevious = null;\n    if (this.demuxer) {\n      this.demuxer.destroy();\n      this.demuxer = null;\n    }\n    this.state = State.STOPPED;\n  }\n\n  set state (nextState) {\n    if (this.state !== nextState) {\n      const previousState = this.state;\n      this._state = nextState;\n      logger.log(`audio stream:${previousState}->${nextState}`);\n    }\n  }\n\n  get state () {\n    return this._state;\n  }\n\n  doTick () {\n    let pos, track, trackDetails, hls = this.hls, config = hls.config;\n    // logger.log('audioStream:' + this.state);\n    switch (this.state) {\n    case State.ERROR:\n      // don't do anything in error state to avoid breaking further ...\n    case State.PAUSED:\n      // don't do anything in paused state either ...\n    case State.BUFFER_FLUSHING:\n      break;\n    case State.STARTING:\n      this.state = State.WAITING_TRACK;\n      this.loadedmetadata = false;\n      break;\n    case State.IDLE:\n      const tracks = this.tracks;\n      // audio tracks not received => exit loop\n      if (!tracks)\n        break;\n\n      // if video not attached AND\n      // start fragment already requested OR start frag prefetch disable\n      // exit loop\n      // => if media not attached but start frag prefetch is enabled and start frag not requested yet, we will not exit loop\n      if (!this.media &&\n          (this.startFragRequested || !config.startFragPrefetch))\n        break;\n\n      // determine next candidate fragment to be loaded, based on current position and\n      //  end of buffer position\n      // if we have not yet loaded any fragment, start loading from start position\n      if (this.loadedmetadata) {\n        pos = this.media.currentTime;\n      } else {\n        pos = this.nextLoadPosition;\n        if (pos === undefined)\n          break;\n      }\n      let media = this.mediaBuffer ? this.mediaBuffer : this.media,\n        videoBuffer = this.videoBuffer ? this.videoBuffer : this.media,\n        bufferInfo = BufferHelper.bufferInfo(media, pos, config.maxBufferHole),\n        mainBufferInfo = BufferHelper.bufferInfo(videoBuffer, pos, config.maxBufferHole),\n        bufferLen = bufferInfo.len,\n        bufferEnd = bufferInfo.end,\n        fragPrevious = this.fragPrevious,\n        // ensure we buffer at least config.maxBufferLength (default 30s) or config.maxMaxBufferLength (default: 600s)\n        // whichever is smaller.\n        // once we reach that threshold, don't buffer more than video (mainBufferInfo.len)\n        maxConfigBuffer = Math.min(config.maxBufferLength, config.maxMaxBufferLength),\n        maxBufLen = Math.max(maxConfigBuffer, mainBufferInfo.len),\n        audioSwitch = this.audioSwitch,\n        trackId = this.trackId;\n\n        // if buffer length is less than maxBufLen try to load a new fragment\n      if ((bufferLen < maxBufLen || audioSwitch) && trackId < tracks.length) {\n        trackDetails = tracks[trackId].details;\n        // if track info not retrieved yet, switch state and wait for track retrieval\n        if (typeof trackDetails === 'undefined') {\n          this.state = State.WAITING_TRACK;\n          break;\n        }\n\n        // check if we need to finalize media stream\n        // we just got done loading the final fragment and there is no other buffered range after ...\n        // rationale is that in case there are any buffered ranges after, it means that there are unbuffered portion in between\n        // so we should not switch to ENDED in that case, to be able to buffer them\n        if (!audioSwitch && !trackDetails.live && fragPrevious && fragPrevious.sn === trackDetails.endSN && !bufferInfo.nextStart) {\n          // if we are not seeking or if we are seeking but everything (almost) til the end is buffered, let's signal eos\n          // we don't compare exactly media.duration === bufferInfo.end as there could be some subtle media duration difference when switching\n          // between different renditions. using half frag duration should help cope with these cases.\n          if (!this.media.seeking || (this.media.duration - bufferEnd) < fragPrevious.duration / 2) {\n            // Finalize the media stream\n            this.hls.trigger(Event.BUFFER_EOS, { type: 'audio' });\n            this.state = State.ENDED;\n            break;\n          }\n        }\n\n        // find fragment index, contiguous with end of buffer position\n        let fragments = trackDetails.fragments,\n          fragLen = fragments.length,\n          start = fragments[0].start,\n          end = fragments[fragLen - 1].start + fragments[fragLen - 1].duration,\n          frag;\n\n          // When switching audio track, reload audio as close as possible to currentTime\n        if (audioSwitch) {\n          if (trackDetails.live && !trackDetails.PTSKnown) {\n            logger.log('switching audiotrack, live stream, unknown PTS,load first fragment');\n            bufferEnd = 0;\n          } else {\n            bufferEnd = pos;\n            // if currentTime (pos) is less than alt audio playlist start time, it means that alt audio is ahead of currentTime\n            if (trackDetails.PTSKnown && pos < start) {\n              // if everything is buffered from pos to start or if audio buffer upfront, let's seek to start\n              if (bufferInfo.end > start || bufferInfo.nextStart) {\n                logger.log('alt audio track ahead of main track, seek to start of alt audio track');\n                this.media.currentTime = start + 0.05;\n              } else {\n                return;\n              }\n            }\n          }\n        }\n        if (trackDetails.initSegment && !trackDetails.initSegment.data) {\n          frag = trackDetails.initSegment;\n        } // eslint-disable-line brace-style\n        // if bufferEnd before start of playlist, load first fragment\n        else if (bufferEnd <= start) {\n          frag = fragments[0];\n          if (this.videoTrackCC !== null && frag.cc !== this.videoTrackCC) {\n            // Ensure we find a fragment which matches the continuity of the video track\n            frag = findFragWithCC(fragments, this.videoTrackCC);\n          }\n          if (trackDetails.live && frag.loadIdx && frag.loadIdx === this.fragLoadIdx) {\n            // we just loaded this first fragment, and we are still lagging behind the start of the live playlist\n            // let's force seek to start\n            const nextBuffered = bufferInfo.nextStart ? bufferInfo.nextStart : start;\n            logger.log(`no alt audio available @currentTime:${this.media.currentTime}, seeking @${nextBuffered + 0.05}`);\n            this.media.currentTime = nextBuffered + 0.05;\n            return;\n          }\n        } else {\n          let foundFrag;\n          let maxFragLookUpTolerance = config.maxFragLookUpTolerance;\n          const fragNext = fragPrevious ? fragments[fragPrevious.sn - fragments[0].sn + 1] : undefined;\n          let fragmentWithinToleranceTest = (candidate) => {\n            // offset should be within fragment boundary - config.maxFragLookUpTolerance\n            // this is to cope with situations like\n            // bufferEnd = 9.991\n            // frag[] : [0,10]\n            // frag[1] : [10,20]\n            // bufferEnd is within frag[0] range ... although what we are expecting is to return frag[1] here\n            //              frag start               frag start+duration\n            //                  |-----------------------------|\n            //              <--->                         <--->\n            //  ...--------><-----------------------------><---------....\n            // previous frag         matching fragment         next frag\n            //  return -1             return 0                 return 1\n            // logger.log(`level/sn/start/end/bufEnd:${level}/${candidate.sn}/${candidate.start}/${(candidate.start+candidate.duration)}/${bufferEnd}`);\n            // Set the lookup tolerance to be small enough to detect the current segment - ensures we don't skip over very small segments\n            let candidateLookupTolerance = Math.min(maxFragLookUpTolerance, candidate.duration);\n            if ((candidate.start + candidate.duration - candidateLookupTolerance) <= bufferEnd)\n              return 1;\n            // if maxFragLookUpTolerance will have negative value then don't return -1 for first element\n            else if (candidate.start - candidateLookupTolerance > bufferEnd && candidate.start)\n              return -1;\n\n            return 0;\n          };\n\n          if (bufferEnd < end) {\n            if (bufferEnd > end - maxFragLookUpTolerance)\n              maxFragLookUpTolerance = 0;\n\n            // Prefer the next fragment if it's within tolerance\n            if (fragNext && !fragmentWithinToleranceTest(fragNext))\n              foundFrag = fragNext;\n            else\n              foundFrag = BinarySearch.search(fragments, fragmentWithinToleranceTest);\n          } else {\n            // reach end of playlist\n            foundFrag = fragments[fragLen - 1];\n          }\n          if (foundFrag) {\n            frag = foundFrag;\n            start = foundFrag.start;\n            // logger.log('find SN matching with pos:' +  bufferEnd + ':' + frag.sn);\n            if (fragPrevious && frag.level === fragPrevious.level && frag.sn === fragPrevious.sn) {\n              if (frag.sn < trackDetails.endSN) {\n                frag = fragments[frag.sn + 1 - trackDetails.startSN];\n                logger.log(`SN just loaded, load next one: ${frag.sn}`);\n              } else {\n                frag = null;\n              }\n            }\n          }\n        }\n        if (frag) {\n          // logger.log('      loading frag ' + i +',pos/bufEnd:' + pos.toFixed(3) + '/' + bufferEnd.toFixed(3));\n          if (frag.decryptdata && (frag.decryptdata.uri != null) && (frag.decryptdata.key == null)) {\n            logger.log(`Loading key for ${frag.sn} of [${trackDetails.startSN} ,${trackDetails.endSN}],track ${trackId}`);\n            this.state = State.KEY_LOADING;\n            hls.trigger(Event.KEY_LOADING, { frag: frag });\n          } else {\n            logger.log(`Loading ${frag.sn}, cc: ${frag.cc} of [${trackDetails.startSN} ,${trackDetails.endSN}],track ${trackId}, currentTime:${pos},bufferEnd:${bufferEnd.toFixed(3)}`);\n            // only load if fragment is not loaded or if in audio switch\n            // we force a frag loading in audio switch as fragment tracker might not have evicted previous frags in case of quick audio switch\n            if (audioSwitch || this.fragmentTracker.getState(frag) === FragmentState.NOT_LOADED) {\n              this.fragCurrent = frag;\n              this.startFragRequested = true;\n              if (!isNaN(frag.sn))\n                this.nextLoadPosition = frag.start + frag.duration;\n\n              hls.trigger(Event.FRAG_LOADING, { frag });\n              this.state = State.FRAG_LOADING;\n            }\n          }\n        }\n      }\n      break;\n    case State.WAITING_TRACK:\n      track = this.tracks[this.trackId];\n      // check if playlist is already loaded\n      if (track && track.details)\n        this.state = State.IDLE;\n\n      break;\n    case State.FRAG_LOADING_WAITING_RETRY:\n      var now = performance.now();\n      var retryDate = this.retryDate;\n      media = this.media;\n      var isSeeking = media && media.seeking;\n      // if current time is gt than retryDate, or if media seeking let's switch to IDLE state to retry loading\n      if (!retryDate || (now >= retryDate) || isSeeking) {\n        logger.log('audioStreamController: retryDate reached, switch back to IDLE state');\n        this.state = State.IDLE;\n      }\n      break;\n    case State.WAITING_INIT_PTS:\n      const videoTrackCC = this.videoTrackCC;\n      if (this.initPTS[videoTrackCC] === undefined)\n        break;\n\n      // Ensure we don't get stuck in the WAITING_INIT_PTS state if the waiting frag CC doesn't match any initPTS\n      const waitingFrag = this.waitingFragment;\n      if (waitingFrag) {\n        const waitingFragCC = waitingFrag.frag.cc;\n        if (videoTrackCC !== waitingFragCC) {\n          track = this.tracks[this.trackId];\n          if (track.details && track.details.live) {\n            logger.warn(`Waiting fragment CC (${waitingFragCC}) does not match video track CC (${videoTrackCC})`);\n            this.waitingFragment = null;\n            this.state = State.IDLE;\n          }\n        } else {\n          this.state = State.FRAG_LOADING;\n          this.onFragLoaded(this.waitingFragment);\n          this.waitingFragment = null;\n        }\n      } else {\n        this.state = State.IDLE;\n      }\n\n      break;\n    case State.STOPPED:\n    case State.FRAG_LOADING:\n    case State.PARSING:\n    case State.PARSED:\n    case State.ENDED:\n      break;\n    default:\n      break;\n    }\n  }\n\n  onMediaAttached (data) {\n    let media = this.media = this.mediaBuffer = data.media;\n    this.onvseeking = this.onMediaSeeking.bind(this);\n    this.onvended = this.onMediaEnded.bind(this);\n    media.addEventListener('seeking', this.onvseeking);\n    media.addEventListener('ended', this.onvended);\n    let config = this.config;\n    if (this.tracks && config.autoStartLoad)\n      this.startLoad(config.startPosition);\n  }\n\n  onMediaDetaching () {\n    let media = this.media;\n    if (media && media.ended) {\n      logger.log('MSE detaching and video ended, reset startPosition');\n      this.startPosition = this.lastCurrentTime = 0;\n    }\n\n    // remove video listeners\n    if (media) {\n      media.removeEventListener('seeking', this.onvseeking);\n      media.removeEventListener('ended', this.onvended);\n      this.onvseeking = this.onvseeked = this.onvended = null;\n    }\n    this.media = this.mediaBuffer = this.videoBuffer = null;\n    this.loadedmetadata = false;\n    this.stopLoad();\n  }\n\n  onMediaSeeking () {\n    if (this.state === State.ENDED) {\n      // switch to IDLE state to check for potential new fragment\n      this.state = State.IDLE;\n    }\n    if (this.media)\n      this.lastCurrentTime = this.media.currentTime;\n\n    // tick to speed up processing\n    this.tick();\n  }\n\n  onMediaEnded () {\n    // reset startPosition and lastCurrentTime to restart playback @ stream beginning\n    this.startPosition = this.lastCurrentTime = 0;\n  }\n\n  onAudioTracksUpdated (data) {\n    logger.log('audio tracks updated');\n    this.tracks = data.audioTracks;\n  }\n\n  onAudioTrackSwitching (data) {\n    // if any URL found on new audio track, it is an alternate audio track\n    let altAudio = !!data.url;\n    this.trackId = data.id;\n\n    this.fragCurrent = null;\n    this.state = State.PAUSED;\n    this.waitingFragment = null;\n    // destroy useless demuxer when switching audio to main\n    if (!altAudio) {\n      if (this.demuxer) {\n        this.demuxer.destroy();\n        this.demuxer = null;\n      }\n    } else {\n      // switching to audio track, start timer if not already started\n      this.setInterval(100);\n    }\n\n    // should we switch tracks ?\n    if (altAudio) {\n      this.audioSwitch = true;\n      // main audio track are handled by stream-controller, just do something if switching to alt audio track\n      this.state = State.IDLE;\n    }\n    this.tick();\n  }\n\n  onAudioTrackLoaded (data) {\n    let newDetails = data.details,\n      trackId = data.id,\n      track = this.tracks[trackId],\n      duration = newDetails.totalduration,\n      sliding = 0;\n\n    logger.log(`track ${trackId} loaded [${newDetails.startSN},${newDetails.endSN}],duration:${duration}`);\n\n    if (newDetails.live) {\n      let curDetails = track.details;\n      if (curDetails && newDetails.fragments.length > 0) {\n        // we already have details for that level, merge them\n        LevelHelper.mergeDetails(curDetails, newDetails);\n        sliding = newDetails.fragments[0].start;\n        // TODO\n        // this.liveSyncPosition = this.computeLivePosition(sliding, curDetails);\n        if (newDetails.PTSKnown)\n          logger.log(`live audio playlist sliding:${sliding.toFixed(3)}`);\n        else\n          logger.log('live audio playlist - outdated PTS, unknown sliding');\n      } else {\n        newDetails.PTSKnown = false;\n        logger.log('live audio playlist - first load, unknown sliding');\n      }\n    } else {\n      newDetails.PTSKnown = false;\n    }\n    track.details = newDetails;\n\n    // compute start position\n    if (!this.startFragRequested) {\n    // compute start position if set to -1. use it straight away if value is defined\n      if (this.startPosition === -1) {\n        // first, check if start time offset has been set in playlist, if yes, use this value\n        let startTimeOffset = newDetails.startTimeOffset;\n        if (!isNaN(startTimeOffset)) {\n          logger.log(`start time offset found in playlist, adjust startPosition to ${startTimeOffset}`);\n          this.startPosition = startTimeOffset;\n        } else {\n          this.startPosition = 0;\n        }\n      }\n      this.nextLoadPosition = this.startPosition;\n    }\n    // only switch batck to IDLE state if we were waiting for track to start downloading a new fragment\n    if (this.state === State.WAITING_TRACK)\n      this.state = State.IDLE;\n\n    // trigger handler right now\n    this.tick();\n  }\n\n  onKeyLoaded () {\n    if (this.state === State.KEY_LOADING) {\n      this.state = State.IDLE;\n      this.tick();\n    }\n  }\n\n  onFragLoaded (data) {\n    let fragCurrent = this.fragCurrent,\n      fragLoaded = data.frag;\n    if (this.state === State.FRAG_LOADING &&\n        fragCurrent &&\n        fragLoaded.type === 'audio' &&\n        fragLoaded.level === fragCurrent.level &&\n        fragLoaded.sn === fragCurrent.sn) {\n      let track = this.tracks[this.trackId],\n        details = track.details,\n        duration = details.totalduration,\n        trackId = fragCurrent.level,\n        sn = fragCurrent.sn,\n        cc = fragCurrent.cc,\n        audioCodec = this.config.defaultAudioCodec || track.audioCodec || 'mp4a.40.2',\n        stats = this.stats = data.stats;\n      if (sn === 'initSegment') {\n        this.state = State.IDLE;\n\n        stats.tparsed = stats.tbuffered = performance.now();\n        details.initSegment.data = data.payload;\n        this.hls.trigger(Event.FRAG_BUFFERED, { stats: stats, frag: fragCurrent, id: 'audio' });\n        this.tick();\n      } else {\n        this.state = State.PARSING;\n        // transmux the MPEG-TS data to ISO-BMFF segments\n        this.appended = false;\n        if (!this.demuxer)\n          this.demuxer = new Demuxer(this.hls, 'audio');\n\n        // Check if we have video initPTS\n        // If not we need to wait for it\n        let initPTS = this.initPTS[cc];\n        let initSegmentData = details.initSegment ? details.initSegment.data : [];\n        if (details.initSegment || initPTS !== undefined) {\n          this.pendingBuffering = true;\n          logger.log(`Demuxing ${sn} of [${details.startSN} ,${details.endSN}],track ${trackId}`);\n          // time Offset is accurate if level PTS is known, or if playlist is not sliding (not live)\n          let accurateTimeOffset = false; // details.PTSKnown || !details.live;\n          this.demuxer.push(data.payload, initSegmentData, audioCodec, null, fragCurrent, duration, accurateTimeOffset, initPTS);\n        } else {\n          logger.log(`unknown video PTS for continuity counter ${cc}, waiting for video PTS before demuxing audio frag ${sn} of [${details.startSN} ,${details.endSN}],track ${trackId}`);\n          this.waitingFragment = data;\n          this.state = State.WAITING_INIT_PTS;\n        }\n      }\n    }\n    this.fragLoadError = 0;\n  }\n\n  onFragParsingInitSegment (data) {\n    const fragCurrent = this.fragCurrent;\n    const fragNew = data.frag;\n    if (fragCurrent &&\n        data.id === 'audio' &&\n        fragNew.sn === fragCurrent.sn &&\n        fragNew.level === fragCurrent.level &&\n        this.state === State.PARSING) {\n      let tracks = data.tracks, track;\n\n      // delete any video track found on audio demuxer\n      if (tracks.video)\n        delete tracks.video;\n\n      // include levelCodec in audio and video tracks\n      track = tracks.audio;\n      if (track) {\n        track.levelCodec = track.codec;\n        track.id = data.id;\n        this.hls.trigger(Event.BUFFER_CODECS, tracks);\n        logger.log(`audio track:audio,container:${track.container},codecs[level/parsed]=[${track.levelCodec}/${track.codec}]`);\n        let initSegment = track.initSegment;\n        if (initSegment) {\n          let appendObj = { type: 'audio', data: initSegment, parent: 'audio', content: 'initSegment' };\n          if (this.audioSwitch) {\n            this.pendingData = [appendObj];\n          } else {\n            this.appended = true;\n            // arm pending Buffering flag before appending a segment\n            this.pendingBuffering = true;\n            this.hls.trigger(Event.BUFFER_APPENDING, appendObj);\n          }\n        }\n        // trigger handler right now\n        this.tick();\n      }\n    }\n  }\n\n  onFragParsingData (data) {\n    const fragCurrent = this.fragCurrent;\n    const fragNew = data.frag;\n    if (fragCurrent &&\n        data.id === 'audio' &&\n        data.type === 'audio' &&\n        fragNew.sn === fragCurrent.sn &&\n        fragNew.level === fragCurrent.level &&\n        this.state === State.PARSING) {\n      let trackId = this.trackId,\n        track = this.tracks[trackId],\n        hls = this.hls;\n\n      if (isNaN(data.endPTS)) {\n        data.endPTS = data.startPTS + fragCurrent.duration;\n        data.endDTS = data.startDTS + fragCurrent.duration;\n      }\n\n      fragCurrent.addElementaryStream(Fragment.ElementaryStreamTypes.AUDIO);\n\n      logger.log(`parsed ${data.type},PTS:[${data.startPTS.toFixed(3)},${data.endPTS.toFixed(3)}],DTS:[${data.startDTS.toFixed(3)}/${data.endDTS.toFixed(3)}],nb:${data.nb}`);\n      LevelHelper.updateFragPTSDTS(track.details, fragCurrent, data.startPTS, data.endPTS);\n\n      let audioSwitch = this.audioSwitch, media = this.media, appendOnBufferFlush = false;\n      // Only flush audio from old audio tracks when PTS is known on new audio track\n      if (audioSwitch && media) {\n        if (media.readyState) {\n          let currentTime = media.currentTime;\n          logger.log('switching audio track : currentTime:' + currentTime);\n          if (currentTime >= data.startPTS) {\n            logger.log('switching audio track : flushing all audio');\n            this.state = State.BUFFER_FLUSHING;\n            hls.trigger(Event.BUFFER_FLUSHING, { startOffset: 0, endOffset: Number.POSITIVE_INFINITY, type: 'audio' });\n            appendOnBufferFlush = true;\n            // Lets announce that the initial audio track switch flush occur\n            this.audioSwitch = false;\n            hls.trigger(Event.AUDIO_TRACK_SWITCHED, { id: trackId });\n          }\n        } else {\n          // Lets announce that the initial audio track switch flush occur\n          this.audioSwitch = false;\n          hls.trigger(Event.AUDIO_TRACK_SWITCHED, { id: trackId });\n        }\n      }\n\n      let pendingData = this.pendingData;\n\n      if (!pendingData) {\n        console.warn('Apparently attempt to enqueue media payload without codec initialization data upfront');\n        hls.trigger(Event.ERROR, { type: ErrorTypes.MEDIA_ERROR, details: null, fatal: true });\n        return;\n      }\n\n      if (!this.audioSwitch) {\n        [data.data1, data.data2].forEach(buffer => {\n          if (buffer && buffer.length)\n            pendingData.push({ type: data.type, data: buffer, parent: 'audio', content: 'data' });\n        });\n        if (!appendOnBufferFlush && pendingData.length) {\n          pendingData.forEach(appendObj => {\n            // only append in PARSING state (rationale is that an appending error could happen synchronously on first segment appending)\n            // in that case it is useless to append following segments\n            if (this.state === State.PARSING) {\n              // arm pending Buffering flag before appending a segment\n              this.pendingBuffering = true;\n              this.hls.trigger(Event.BUFFER_APPENDING, appendObj);\n            }\n          });\n          this.pendingData = [];\n          this.appended = true;\n        }\n      }\n      // trigger handler right now\n      this.tick();\n    }\n  }\n\n  onFragParsed (data) {\n    const fragCurrent = this.fragCurrent;\n    const fragNew = data.frag;\n    if (fragCurrent &&\n        data.id === 'audio' &&\n        fragNew.sn === fragCurrent.sn &&\n        fragNew.level === fragCurrent.level &&\n        this.state === State.PARSING) {\n      this.stats.tparsed = performance.now();\n      this.state = State.PARSED;\n      this._checkAppendedParsed();\n    }\n  }\n\n  onBufferReset () {\n    // reset reference to sourcebuffers\n    this.mediaBuffer = this.videoBuffer = null;\n    this.loadedmetadata = false;\n  }\n\n  onBufferCreated (data) {\n    let audioTrack = data.tracks.audio;\n    if (audioTrack) {\n      this.mediaBuffer = audioTrack.buffer;\n      this.loadedmetadata = true;\n    }\n    if (data.tracks.video)\n      this.videoBuffer = data.tracks.video.buffer;\n  }\n\n  onBufferAppended (data) {\n    if (data.parent === 'audio') {\n      const state = this.state;\n      if (state === State.PARSING || state === State.PARSED) {\n        // check if all buffers have been appended\n        this.pendingBuffering = (data.pending > 0);\n        this._checkAppendedParsed();\n      }\n    }\n  }\n\n  _checkAppendedParsed () {\n    // trigger handler right now\n    if (this.state === State.PARSED && (!this.appended || !this.pendingBuffering)) {\n      let frag = this.fragCurrent, stats = this.stats, hls = this.hls;\n      if (frag) {\n        this.fragPrevious = frag;\n        stats.tbuffered = performance.now();\n        hls.trigger(Event.FRAG_BUFFERED, { stats: stats, frag: frag, id: 'audio' });\n        let media = this.mediaBuffer ? this.mediaBuffer : this.media;\n        logger.log(`audio buffered : ${TimeRanges.toString(media.buffered)}`);\n        if (this.audioSwitch && this.appended) {\n          this.audioSwitch = false;\n          hls.trigger(Event.AUDIO_TRACK_SWITCHED, { id: this.trackId });\n        }\n        this.state = State.IDLE;\n      }\n      this.tick();\n    }\n  }\n\n  onError (data) {\n    let frag = data.frag;\n    // don't handle frag error not related to audio fragment\n    if (frag && frag.type !== 'audio')\n      return;\n\n    switch (data.details) {\n    case ErrorDetails.FRAG_LOAD_ERROR:\n    case ErrorDetails.FRAG_LOAD_TIMEOUT:\n      if (!data.fatal) {\n        let loadError = this.fragLoadError;\n        if (loadError)\n          loadError++;\n        else\n          loadError = 1;\n\n        let config = this.config;\n        if (loadError <= config.fragLoadingMaxRetry) {\n          this.fragLoadError = loadError;\n          // exponential backoff capped to config.fragLoadingMaxRetryTimeout\n          let delay = Math.min(Math.pow(2, loadError - 1) * config.fragLoadingRetryDelay, config.fragLoadingMaxRetryTimeout);\n          logger.warn(`audioStreamController: frag loading failed, retry in ${delay} ms`);\n          this.retryDate = performance.now() + delay;\n          // retry loading state\n          this.state = State.FRAG_LOADING_WAITING_RETRY;\n        } else {\n          logger.error(`audioStreamController: ${data.details} reaches max retry, redispatch as fatal ...`);\n          // switch error to fatal\n          data.fatal = true;\n          this.state = State.ERROR;\n        }\n      }\n      break;\n    case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:\n    case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:\n    case ErrorDetails.KEY_LOAD_ERROR:\n    case ErrorDetails.KEY_LOAD_TIMEOUT:\n      //  when in ERROR state, don't switch back to IDLE state in case a non-fatal error is received\n      if (this.state !== State.ERROR) {\n        // if fatal error, stop processing, otherwise move to IDLE to retry loading\n        this.state = data.fatal ? State.ERROR : State.IDLE;\n        logger.warn(`audioStreamController: ${data.details} while loading frag,switch to ${this.state} state ...`);\n      }\n      break;\n    case ErrorDetails.BUFFER_FULL_ERROR:\n      // if in appending state\n      if (data.parent === 'audio' && (this.state === State.PARSING ||this.state === State.PARSED)) {\n        const media = this.mediaBuffer,\n          currentTime = this.media.currentTime,\n          mediaBuffered = media && BufferHelper.isBuffered(media, currentTime) && BufferHelper.isBuffered(media, currentTime + 0.5);\n          // reduce max buf len if current position is buffered\n        if (mediaBuffered) {\n          const config = this.config;\n          if (config.maxMaxBufferLength >= config.maxBufferLength) {\n            // reduce max buffer length as it might be too high. we do this to avoid loop flushing ...\n            config.maxMaxBufferLength /= 2;\n            logger.warn(`audio:reduce max buffer length to ${config.maxMaxBufferLength}s`);\n          }\n          this.state = State.IDLE;\n        } else {\n          // current position is not buffered, but browser is still complaining about buffer full error\n          // this happens on IE/Edge, refer to https://github.com/video-dev/hls.js/pull/708\n          // in that case flush the whole audio buffer to recover\n          logger.warn('buffer full error also media.currentTime is not buffered, flush audio buffer');\n          this.fragCurrent = null;\n          // flush everything\n          this.state = State.BUFFER_FLUSHING;\n          this.hls.trigger(Event.BUFFER_FLUSHING, { startOffset: 0, endOffset: Number.POSITIVE_INFINITY, type: 'audio' });\n        }\n      }\n      break;\n    default:\n      break;\n    }\n  }\n\n  onBufferFlushed () {\n    let pendingData = this.pendingData;\n    if (pendingData && pendingData.length) {\n      logger.log('appending pending audio data on Buffer Flushed');\n      pendingData.forEach(appendObj => {\n        this.hls.trigger(Event.BUFFER_APPENDING, appendObj);\n      });\n      this.appended = true;\n      this.pendingData = [];\n      this.state = State.PARSED;\n    } else {\n      // move to IDLE once flush complete. this should trigger new fragment loading\n      this.state = State.IDLE;\n      // reset reference to frag\n      this.fragPrevious = null;\n      this.tick();\n    }\n  }\n}\nexport default AudioStreamController;\n","/*\n * audio track controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport { logger } from '../utils/logger';\nimport { ErrorTypes } from '../errors';\n\nclass AudioTrackController extends EventHandler {\n  constructor (hls) {\n    super(hls, Event.MANIFEST_LOADING,\n      Event.MANIFEST_PARSED,\n      Event.AUDIO_TRACK_LOADED,\n      Event.ERROR);\n    this.ticks = 0;\n    this.ontick = this.tick.bind(this);\n  }\n\n  destroy () {\n    this.cleanTimer();\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  cleanTimer () {\n    if (this.timer) {\n      clearTimeout(this.timer);\n      this.timer = null;\n    }\n  }\n\n  tick () {\n    this.ticks++;\n    if (this.ticks === 1) {\n      this.doTick();\n      if (this.ticks > 1)\n        setTimeout(this.tick, 1);\n\n      this.ticks = 0;\n    }\n  }\n\n  doTick () {\n    this.updateTrack(this.trackId);\n  }\n\n  onError (data) {\n    if (data.fatal && data.type === ErrorTypes.NETWORK_ERROR)\n      this.cleanTimer();\n  }\n\n  onManifestLoading () {\n    // reset audio tracks on manifest loading\n    this.tracks = [];\n    this.trackId = -1;\n  }\n\n  onManifestParsed (data) {\n    let tracks = data.audioTracks || [];\n    let defaultFound = false;\n    this.tracks = tracks;\n    this.hls.trigger(Event.AUDIO_TRACKS_UPDATED, { audioTracks: tracks });\n    // loop through available audio tracks and autoselect default if needed\n    let id = 0;\n    tracks.forEach(track => {\n      if (track.default && !defaultFound) {\n        this.audioTrack = id;\n        defaultFound = true;\n        return;\n      }\n      id++;\n    });\n    if (defaultFound === false && tracks.length) {\n      logger.log('no default audio track defined, use first audio track as default');\n      this.audioTrack = 0;\n    }\n  }\n\n  onAudioTrackLoaded (data) {\n    if (data.id < this.tracks.length) {\n      logger.log(`audioTrack ${data.id} loaded`);\n      this.tracks[data.id].details = data.details;\n      // check if current playlist is a live playlist\n      if (data.details.live && !this.timer) {\n        // if live playlist we will have to reload it periodically\n        // set reload period to playlist target duration\n        this.timer = setInterval(this.ontick, 1000 * data.details.targetduration);\n      }\n      if (!data.details.live && this.timer) {\n        // playlist is not live and timer is armed : stopping it\n        this.cleanTimer();\n      }\n    }\n  }\n\n  /** get alternate audio tracks list from playlist **/\n  get audioTracks () {\n    return this.tracks;\n  }\n\n  /** get index of the selected audio track (index in audio track lists) **/\n  get audioTrack () {\n    return this.trackId;\n  }\n\n  /** select an audio track, based on its index in audio track lists**/\n  set audioTrack (audioTrackId) {\n    if (this.trackId !== audioTrackId || this.tracks[audioTrackId].details === undefined)\n      this.setAudioTrackInternal(audioTrackId);\n  }\n\n  setAudioTrackInternal (newId) {\n    // check if level idx is valid\n    if (newId >= 0 && newId < this.tracks.length) {\n      // stopping live reloading timer if any\n      this.cleanTimer();\n      this.trackId = newId;\n      logger.log(`switching to audioTrack ${newId}`);\n      let audioTrack = this.tracks[newId],\n        hls = this.hls,\n        type = audioTrack.type,\n        url = audioTrack.url,\n        eventObj = { id: newId, type: type, url: url };\n      hls.trigger(Event.AUDIO_TRACK_SWITCHING, eventObj);\n      // check if we need to load playlist for this audio Track\n      let details = audioTrack.details;\n      if (url && (details === undefined || details.live === true)) {\n        // track not retrieved yet, or live playlist we need to (re)load it\n        logger.log(`(re)loading playlist for audioTrack ${newId}`);\n        hls.trigger(Event.AUDIO_TRACK_LOADING, { url: url, id: newId });\n      }\n    }\n  }\n\n  updateTrack (newId) {\n    // check if level idx is valid\n    if (newId >= 0 && newId < this.tracks.length) {\n      // stopping live reloading timer if any\n      this.cleanTimer();\n      this.trackId = newId;\n      logger.log(`updating audioTrack ${newId}`);\n      let audioTrack = this.tracks[newId], url = audioTrack.url;\n      // check if we need to load playlist for this audio Track\n      let details = audioTrack.details;\n      if (url && (details === undefined || details.live === true)) {\n        // track not retrieved yet, or live playlist we need to (re)load it\n        logger.log(`(re)loading playlist for audioTrack ${newId}`);\n        this.hls.trigger(Event.AUDIO_TRACK_LOADING, { url: url, id: newId });\n      }\n    }\n  }\n}\n\nexport default AudioTrackController;\n","/*\n * Buffer Controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport { logger } from '../utils/logger';\nimport { ErrorTypes, ErrorDetails } from '../errors';\nimport { getMediaSource } from '../helper/mediasource-helper';\n\nconst MediaSource = getMediaSource();\n\nclass BufferController extends EventHandler {\n  constructor (hls) {\n    super(hls,\n      Event.MEDIA_ATTACHING,\n      Event.MEDIA_DETACHING,\n      Event.MANIFEST_PARSED,\n      Event.BUFFER_RESET,\n      Event.BUFFER_APPENDING,\n      Event.BUFFER_CODECS,\n      Event.BUFFER_EOS,\n      Event.BUFFER_FLUSHING,\n      Event.LEVEL_PTS_UPDATED,\n      Event.LEVEL_UPDATED);\n\n    // the value that we have set mediasource.duration to\n    // (the actual duration may be tweaked slighly by the browser)\n    this._msDuration = null;\n    // the value that we want to set mediaSource.duration to\n    this._levelDuration = null;\n    // current stream state: true - for live broadcast, false - for VoD content\n    this._live = null;\n    // cache the self generated object url to detect hijack of video tag\n    this._objectUrl = null;\n\n    // Source Buffer listeners\n    this.onsbue = this.onSBUpdateEnd.bind(this);\n    this.onsbe = this.onSBUpdateError.bind(this);\n    this.pendingTracks = {};\n    this.tracks = {};\n  }\n\n  destroy () {\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  onLevelPtsUpdated (data) {\n    let type = data.type;\n    let audioTrack = this.tracks.audio;\n\n    // Adjusting `SourceBuffer.timestampOffset` (desired point in the timeline where the next frames should be appended)\n    // in Chrome browser when we detect MPEG audio container and time delta between level PTS and `SourceBuffer.timestampOffset`\n    // is greater than 100ms (this is enough to handle seek for VOD or level change for LIVE videos). At the time of change we issue\n    // `SourceBuffer.abort()` and adjusting `SourceBuffer.timestampOffset` if `SourceBuffer.updating` is false or awaiting `updateend`\n    // event if SB is in updating state.\n    // More info here: https://github.com/video-dev/hls.js/issues/332#issuecomment-257986486\n\n    if (type === 'audio' && audioTrack && audioTrack.container === 'audio/mpeg') { // Chrome audio mp3 track\n      let audioBuffer = this.sourceBuffer.audio;\n      let delta = Math.abs(audioBuffer.timestampOffset - data.start);\n\n      // adjust timestamp offset if time delta is greater than 100ms\n      if (delta > 0.1) {\n        let updating = audioBuffer.updating;\n\n        try {\n          audioBuffer.abort();\n        } catch (err) {\n          updating = true;\n          logger.warn('can not abort audio buffer: ' + err);\n        }\n\n        if (!updating) {\n          logger.warn('change mpeg audio timestamp offset from ' + audioBuffer.timestampOffset + ' to ' + data.start);\n          audioBuffer.timestampOffset = data.start;\n        } else {\n          this.audioTimestampOffset = data.start;\n        }\n      }\n    }\n  }\n\n  onManifestParsed (data) {\n    let audioExpected = data.audio,\n      videoExpected = data.video || (data.levels.length && data.altAudio),\n      sourceBufferNb = 0;\n    // in case of alt audio 2 BUFFER_CODECS events will be triggered, one per stream controller\n    // sourcebuffers will be created all at once when the expected nb of tracks will be reached\n    // in case alt audio is not used, only one BUFFER_CODEC event will be fired from main stream controller\n    // it will contain the expected nb of source buffers, no need to compute it\n    if (data.altAudio && (audioExpected || videoExpected)) {\n      sourceBufferNb = (audioExpected ? 1 : 0) + (videoExpected ? 1 : 0);\n      logger.log(`${sourceBufferNb} sourceBuffer(s) expected`);\n    }\n    this.sourceBufferNb = sourceBufferNb;\n  }\n\n  onMediaAttaching (data) {\n    let media = this.media = data.media;\n    if (media) {\n      // setup the media source\n      let ms = this.mediaSource = new MediaSource();\n      // Media Source listeners\n      this.onmso = this.onMediaSourceOpen.bind(this);\n      this.onmse = this.onMediaSourceEnded.bind(this);\n      this.onmsc = this.onMediaSourceClose.bind(this);\n      ms.addEventListener('sourceopen', this.onmso);\n      ms.addEventListener('sourceended', this.onmse);\n      ms.addEventListener('sourceclose', this.onmsc);\n      // link video and media Source\n      media.src = URL.createObjectURL(ms);\n      // cache the locally generated object url\n      this._objectUrl = media.src;\n    }\n  }\n\n  onMediaDetaching () {\n    logger.log('media source detaching');\n    let ms = this.mediaSource;\n    if (ms) {\n      if (ms.readyState === 'open') {\n        try {\n          // endOfStream could trigger exception if any sourcebuffer is in updating state\n          // we don't really care about checking sourcebuffer state here,\n          // as we are anyway detaching the MediaSource\n          // let's just avoid this exception to propagate\n          ms.endOfStream();\n        } catch (err) {\n          logger.warn(`onMediaDetaching:${err.message} while calling endOfStream`);\n        }\n      }\n      ms.removeEventListener('sourceopen', this.onmso);\n      ms.removeEventListener('sourceended', this.onmse);\n      ms.removeEventListener('sourceclose', this.onmsc);\n\n      // Detach properly the MediaSource from the HTMLMediaElement as\n      // suggested in https://github.com/w3c/media-source/issues/53.\n      if (this.media) {\n        URL.revokeObjectURL(this._objectUrl);\n\n        // clean up video tag src only if it's our own url. some external libraries might\n        // hijack the video tag and change its 'src' without destroying the Hls instance first\n        if (this.media.src === this._objectUrl) {\n          this.media.removeAttribute('src');\n          this.media.load();\n        } else {\n          logger.warn('media.src was changed by a third party - skip cleanup');\n        }\n      }\n\n      this.mediaSource = null;\n      this.media = null;\n      this._objectUrl = null;\n      this.pendingTracks = {};\n      this.tracks = {};\n      this.sourceBuffer = {};\n      this.flushRange = [];\n      this.segments = [];\n      this.appended = 0;\n    }\n    this.onmso = this.onmse = this.onmsc = null;\n    this.hls.trigger(Event.MEDIA_DETACHED);\n  }\n\n  onMediaSourceOpen () {\n    logger.log('media source opened');\n    this.hls.trigger(Event.MEDIA_ATTACHED, { media: this.media });\n    let mediaSource = this.mediaSource;\n    if (mediaSource) {\n      // once received, don't listen anymore to sourceopen event\n      mediaSource.removeEventListener('sourceopen', this.onmso);\n    }\n    this.checkPendingTracks();\n  }\n\n  checkPendingTracks () {\n    // if any buffer codecs pending, check if we have enough to create sourceBuffers\n    let pendingTracks = this.pendingTracks,\n      pendingTracksNb = Object.keys(pendingTracks).length;\n    // if any pending tracks and (if nb of pending tracks gt or equal than expected nb or if unknown expected nb)\n    if (pendingTracksNb && (\n      this.sourceBufferNb <= pendingTracksNb ||\n        this.sourceBufferNb === 0)) {\n      // ok, let's create them now !\n      this.createSourceBuffers(pendingTracks);\n      this.pendingTracks = {};\n      // append any pending segments now !\n      this.doAppending();\n    }\n  }\n\n  onMediaSourceClose () {\n    logger.log('media source closed');\n  }\n\n  onMediaSourceEnded () {\n    logger.log('media source ended');\n  }\n\n  onSBUpdateEnd () {\n    // update timestampOffset\n    if (this.audioTimestampOffset) {\n      let audioBuffer = this.sourceBuffer.audio;\n      logger.warn('change mpeg audio timestamp offset from ' + audioBuffer.timestampOffset + ' to ' + this.audioTimestampOffset);\n      audioBuffer.timestampOffset = this.audioTimestampOffset;\n      delete this.audioTimestampOffset;\n    }\n\n    if (this._needsFlush)\n      this.doFlush();\n\n    if (this._needsEos)\n      this.checkEos();\n\n    this.appending = false;\n    let parent = this.parent;\n    // count nb of pending segments waiting for appending on this sourcebuffer\n    let pending = this.segments.reduce((counter, segment) => (segment.parent === parent) ? counter + 1 : counter, 0);\n\n    // this.sourceBuffer is better to use than media.buffered as it is closer to the PTS data from the fragments\n    let timeRanges = {};\n    const sourceBuffer = this.sourceBuffer;\n    for (let streamType in sourceBuffer)\n      timeRanges[streamType] = sourceBuffer[streamType].buffered;\n\n    this.hls.trigger(Event.BUFFER_APPENDED, { parent, pending, timeRanges });\n    // don't append in flushing mode\n    if (!this._needsFlush)\n      this.doAppending();\n\n    this.updateMediaElementDuration();\n  }\n\n  onSBUpdateError (event) {\n    logger.error('sourceBuffer error:', event);\n    // according to http://www.w3.org/TR/media-source/#sourcebuffer-append-error\n    // this error might not always be fatal (it is fatal if decode error is set, in that case\n    // it will be followed by a mediaElement error ...)\n    this.hls.trigger(Event.ERROR, { type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.BUFFER_APPENDING_ERROR, fatal: false });\n    // we don't need to do more than that, as accordin to the spec, updateend will be fired just after\n  }\n\n  onBufferReset () {\n    let sourceBuffer = this.sourceBuffer;\n    for (let type in sourceBuffer) {\n      let sb = sourceBuffer[type];\n      try {\n        this.mediaSource.removeSourceBuffer(sb);\n        sb.removeEventListener('updateend', this.onsbue);\n        sb.removeEventListener('error', this.onsbe);\n      } catch (err) {\n      }\n    }\n    this.sourceBuffer = {};\n    this.flushRange = [];\n    this.segments = [];\n    this.appended = 0;\n  }\n\n  onBufferCodecs (tracks) {\n    // if source buffer(s) not created yet, appended buffer tracks in this.pendingTracks\n    // if sourcebuffers already created, do nothing ...\n    if (Object.keys(this.sourceBuffer).length === 0) {\n      for (let trackName in tracks) this.pendingTracks[trackName] = tracks[trackName];\n      let mediaSource = this.mediaSource;\n      if (mediaSource && mediaSource.readyState === 'open') {\n        // try to create sourcebuffers if mediasource opened\n        this.checkPendingTracks();\n      }\n    }\n  }\n\n  createSourceBuffers (tracks) {\n    let sourceBuffer = this.sourceBuffer, mediaSource = this.mediaSource;\n\n    for (let trackName in tracks) {\n      if (!sourceBuffer[trackName]) {\n        let track = tracks[trackName];\n        // use levelCodec as first priority\n        let codec = track.levelCodec || track.codec;\n        let mimeType = `${track.container};codecs=${codec}`;\n        logger.log(`creating sourceBuffer(${mimeType})`);\n        try {\n          let sb = sourceBuffer[trackName] = mediaSource.addSourceBuffer(mimeType);\n          sb.addEventListener('updateend', this.onsbue);\n          sb.addEventListener('error', this.onsbe);\n          this.tracks[trackName] = { codec: codec, container: track.container };\n          track.buffer = sb;\n        } catch (err) {\n          logger.error(`error while trying to add sourceBuffer:${err.message}`);\n          this.hls.trigger(Event.ERROR, { type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.BUFFER_ADD_CODEC_ERROR, fatal: false, err: err, mimeType: mimeType });\n        }\n      }\n    }\n    this.hls.trigger(Event.BUFFER_CREATED, { tracks: tracks });\n  }\n\n  onBufferAppending (data) {\n    if (!this._needsFlush) {\n      if (!this.segments)\n        this.segments = [ data ];\n      else\n        this.segments.push(data);\n\n      this.doAppending();\n    }\n  }\n\n  onBufferAppendFail (data) {\n    logger.error('sourceBuffer error:', data.event);\n    // according to http://www.w3.org/TR/media-source/#sourcebuffer-append-error\n    // this error might not always be fatal (it is fatal if decode error is set, in that case\n    // it will be followed by a mediaElement error ...)\n    this.hls.trigger(Event.ERROR, { type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.BUFFER_APPENDING_ERROR, fatal: false });\n  }\n\n  // on BUFFER_EOS mark matching sourcebuffer(s) as ended and trigger checkEos()\n  onBufferEos (data) {\n    let sb = this.sourceBuffer;\n    let dataType = data.type;\n    for (let type in sb) {\n      if (!dataType || type === dataType) {\n        if (!sb[type].ended) {\n          sb[type].ended = true;\n          logger.log(`${type} sourceBuffer now EOS`);\n        }\n      }\n    }\n    this.checkEos();\n  }\n\n  // if all source buffers are marked as ended, signal endOfStream() to MediaSource.\n  checkEos () {\n    let sb = this.sourceBuffer, mediaSource = this.mediaSource;\n    if (!mediaSource || mediaSource.readyState !== 'open') {\n      this._needsEos = false;\n      return;\n    }\n    for (let type in sb) {\n      let sbobj = sb[type];\n      if (!sbobj.ended)\n        return;\n\n      if (sbobj.updating) {\n        this._needsEos = true;\n        return;\n      }\n    }\n    logger.log('all media data available, signal endOfStream() to MediaSource and stop loading fragment');\n    // Notify the media element that it now has all of the media data\n    try {\n      mediaSource.endOfStream();\n    } catch (e) {\n      logger.warn('exception while calling mediaSource.endOfStream()');\n    }\n    this._needsEos = false;\n  }\n\n  onBufferFlushing (data) {\n    this.flushRange.push({ start: data.startOffset, end: data.endOffset, type: data.type });\n    // attempt flush immediately\n    this.flushBufferCounter = 0;\n    this.doFlush();\n  }\n\n  onLevelUpdated ({ details }) {\n    if (details.fragments.length > 0) {\n      this._levelDuration = details.totalduration + details.fragments[0].start;\n      this._live = details.live;\n      this.updateMediaElementDuration();\n    }\n  }\n\n  /**\n   * Update Media Source duration to current level duration or override to Infinity if configuration parameter\n   * 'liveDurationInfinity` is set to `true`\n   * More details: https://github.com/video-dev/hls.js/issues/355\n   */\n  updateMediaElementDuration () {\n    let { config } = this.hls;\n    let duration;\n\n    if (this._levelDuration === null ||\n      !this.media ||\n      !this.mediaSource ||\n      !this.sourceBuffer ||\n      this.media.readyState === 0 ||\n      this.mediaSource.readyState !== 'open')\n      return;\n\n    for (let type in this.sourceBuffer) {\n      if (this.sourceBuffer[type].updating === true) {\n        // can't set duration whilst a buffer is updating\n        return;\n      }\n    }\n\n    duration = this.media.duration;\n    // initialise to the value that the media source is reporting\n    if (this._msDuration === null)\n      this._msDuration = this.mediaSource.duration;\n\n    if (this._live === true && config.liveDurationInfinity === true) {\n      // Override duration to Infinity\n      logger.log('Media Source duration is set to Infinity');\n      this._msDuration = this.mediaSource.duration = Infinity;\n    } else if ((this._levelDuration > this._msDuration && this._levelDuration > duration) ||\n      (duration === Infinity || isNaN(duration))) {\n      // levelDuration was the last value we set.\n      // not using mediaSource.duration as the browser may tweak this value\n      // only update Media Source duration if its value increase, this is to avoid\n      // flushing already buffered portion when switching between quality level\n      logger.log(`Updating Media Source duration to ${this._levelDuration.toFixed(3)}`);\n      this._msDuration = this.mediaSource.duration = this._levelDuration;\n    }\n  }\n\n  doFlush () {\n    // loop through all buffer ranges to flush\n    while (this.flushRange.length) {\n      let range = this.flushRange[0];\n      // flushBuffer will abort any buffer append in progress and flush Audio/Video Buffer\n      if (this.flushBuffer(range.start, range.end, range.type)) {\n        // range flushed, remove from flush array\n        this.flushRange.shift();\n        this.flushBufferCounter = 0;\n      } else {\n        this._needsFlush = true;\n        // avoid looping, wait for SB update end to retrigger a flush\n        return;\n      }\n    }\n    if (this.flushRange.length === 0) {\n      // everything flushed\n      this._needsFlush = false;\n\n      // let's recompute this.appended, which is used to avoid flush looping\n      let appended = 0;\n      let sourceBuffer = this.sourceBuffer;\n      try {\n        for (let type in sourceBuffer)\n          appended += sourceBuffer[type].buffered.length;\n      } catch (error) {\n        // error could be thrown while accessing buffered, in case sourcebuffer has already been removed from MediaSource\n        // this is harmess at this stage, catch this to avoid reporting an internal exception\n        logger.error('error while accessing sourceBuffer.buffered');\n      }\n      this.appended = appended;\n      this.hls.trigger(Event.BUFFER_FLUSHED);\n    }\n  }\n\n  doAppending () {\n    let hls = this.hls, sourceBuffer = this.sourceBuffer, segments = this.segments;\n    if (Object.keys(sourceBuffer).length) {\n      if (this.media.error) {\n        this.segments = [];\n        logger.error('trying to append although a media error occured, flush segment and abort');\n        return;\n      }\n      if (this.appending) {\n        // logger.log(`sb appending in progress`);\n        return;\n      }\n      if (segments && segments.length) {\n        let segment = segments.shift();\n        try {\n          let type = segment.type, sb = sourceBuffer[type];\n          if (sb) {\n            if (!sb.updating) {\n              // reset sourceBuffer ended flag before appending segment\n              sb.ended = false;\n              // logger.log(`appending ${segment.content} ${type} SB, size:${segment.data.length}, ${segment.parent}`);\n              this.parent = segment.parent;\n              sb.appendBuffer(segment.data);\n              this.appendError = 0;\n              this.appended++;\n              this.appending = true;\n            } else {\n              segments.unshift(segment);\n            }\n          } else {\n            // in case we don't have any source buffer matching with this segment type,\n            // it means that Mediasource fails to create sourcebuffer\n            // discard this segment, and trigger update end\n            this.onSBUpdateEnd();\n          }\n        } catch (err) {\n          // in case any error occured while appending, put back segment in segments table\n          logger.error(`error while trying to append buffer:${err.message}`);\n          segments.unshift(segment);\n          let event = { type: ErrorTypes.MEDIA_ERROR, parent: segment.parent };\n          if (err.code !== 22) {\n            if (this.appendError)\n              this.appendError++;\n            else\n              this.appendError = 1;\n\n            event.details = ErrorDetails.BUFFER_APPEND_ERROR;\n            /* with UHD content, we could get loop of quota exceeded error until\n              browser is able to evict some data from sourcebuffer. retrying help recovering this\n            */\n            if (this.appendError > hls.config.appendErrorMaxRetry) {\n              logger.log(`fail ${hls.config.appendErrorMaxRetry} times to append segment in sourceBuffer`);\n              segments = [];\n              event.fatal = true;\n              hls.trigger(Event.ERROR, event);\n            } else {\n              event.fatal = false;\n              hls.trigger(Event.ERROR, event);\n            }\n          } else {\n            // QuotaExceededError: http://www.w3.org/TR/html5/infrastructure.html#quotaexceedederror\n            // let's stop appending any segments, and report BUFFER_FULL_ERROR error\n            this.segments = [];\n            event.details = ErrorDetails.BUFFER_FULL_ERROR;\n            event.fatal = false;\n            hls.trigger(Event.ERROR, event);\n          }\n        }\n      }\n    }\n  }\n\n  /*\n    flush specified buffered range,\n    return true once range has been flushed.\n    as sourceBuffer.remove() is asynchronous, flushBuffer will be retriggered on sourceBuffer update end\n  */\n  flushBuffer (startOffset, endOffset, typeIn) {\n    let sb, i, bufStart, bufEnd, flushStart, flushEnd, sourceBuffer = this.sourceBuffer;\n    if (Object.keys(sourceBuffer).length) {\n      logger.log(`flushBuffer,pos/start/end: ${this.media.currentTime.toFixed(3)}/${startOffset}/${endOffset}`);\n      // safeguard to avoid infinite looping : don't try to flush more than the nb of appended segments\n      if (this.flushBufferCounter < this.appended) {\n        for (let type in sourceBuffer) {\n          // check if sourcebuffer type is defined (typeIn): if yes, let's only flush this one\n          // if no, let's flush all sourcebuffers\n          if (typeIn && type !== typeIn)\n            continue;\n\n          sb = sourceBuffer[type];\n          // we are going to flush buffer, mark source buffer as 'not ended'\n          sb.ended = false;\n          if (!sb.updating) {\n            try {\n              for (i = 0; i < sb.buffered.length; i++) {\n                bufStart = sb.buffered.start(i);\n                bufEnd = sb.buffered.end(i);\n                // workaround firefox not able to properly flush multiple buffered range.\n                if (navigator.userAgent.toLowerCase().indexOf('firefox') !== -1 && endOffset === Number.POSITIVE_INFINITY) {\n                  flushStart = startOffset;\n                  flushEnd = endOffset;\n                } else {\n                  flushStart = Math.max(bufStart, startOffset);\n                  flushEnd = Math.min(bufEnd, endOffset);\n                }\n                /* sometimes sourcebuffer.remove() does not flush\n                   the exact expected time range.\n                   to avoid rounding issues/infinite loop,\n                   only flush buffer range of length greater than 500ms.\n                */\n                if (Math.min(flushEnd, bufEnd) - flushStart > 0.5) {\n                  this.flushBufferCounter++;\n                  logger.log(`flush ${type} [${flushStart},${flushEnd}], of [${bufStart},${bufEnd}], pos:${this.media.currentTime}`);\n                  sb.remove(flushStart, flushEnd);\n                  return false;\n                }\n              }\n            } catch (e) {\n              logger.warn('exception while accessing sourcebuffer, it might have been removed from MediaSource');\n            }\n          } else {\n            // logger.log('abort ' + type + ' append in progress');\n            // this will abort any appending in progress\n            // sb.abort();\n            logger.warn('cannot flush, sb updating in progress');\n            return false;\n          }\n        }\n      } else {\n        logger.warn('abort flushing too many retries');\n      }\n      logger.log('buffer flushed');\n    }\n    // everything flushed !\n    return true;\n  }\n}\n\nexport default BufferController;\n","/*\n * cap stream level to media size dimension controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\n\nclass CapLevelController extends EventHandler {\n  constructor (hls) {\n    super(hls,\n      Event.FPS_DROP_LEVEL_CAPPING,\n      Event.MEDIA_ATTACHING,\n      Event.MANIFEST_PARSED);\n  }\n\n  destroy () {\n    if (this.hls.config.capLevelToPlayerSize) {\n      this.media = this.restrictedLevels = null;\n      this.autoLevelCapping = Number.POSITIVE_INFINITY;\n      if (this.timer)\n        this.timer = clearInterval(this.timer);\n    }\n  }\n\n  onFpsDropLevelCapping (data) {\n    // Don't add a restricted level more than once\n    if (CapLevelController.isLevelAllowed(data.droppedLevel, this.restrictedLevels))\n      this.restrictedLevels.push(data.droppedLevel);\n  }\n\n  onMediaAttaching (data) {\n    this.media = data.media instanceof HTMLVideoElement ? data.media : null;\n  }\n\n  onManifestParsed (data) {\n    const hls = this.hls;\n    this.restrictedLevels = [];\n    // Only fire getMaxLevel or detectPlayerSize if video is expected in the manifest\n    if (hls.config.capLevelToPlayerSize && (data.video || (data.levels.length && data.altAudio))) {\n      this.autoLevelCapping = Number.POSITIVE_INFINITY;\n      this.levels = data.levels;\n      hls.firstLevel = this.getMaxLevel(data.firstLevel);\n      clearInterval(this.timer);\n      this.timer = setInterval(this.detectPlayerSize.bind(this), 1000);\n      this.detectPlayerSize();\n    }\n  }\n\n  detectPlayerSize () {\n    if (this.media) {\n      let levelsLength = this.levels ? this.levels.length : 0;\n      if (levelsLength) {\n        const hls = this.hls;\n        hls.autoLevelCapping = this.getMaxLevel(levelsLength - 1);\n        if (hls.autoLevelCapping > this.autoLevelCapping) {\n          // if auto level capping has a higher value for the previous one, flush the buffer using nextLevelSwitch\n          // usually happen when the user go to the fullscreen mode.\n          hls.streamController.nextLevelSwitch();\n        }\n        this.autoLevelCapping = hls.autoLevelCapping;\n      }\n    }\n  }\n\n  /*\n  * returns level should be the one with the dimensions equal or greater than the media (player) dimensions (so the video will be downscaled)\n  */\n  getMaxLevel (capLevelIndex) {\n    if (!this.levels)\n      return -1;\n\n    const validLevels = this.levels.filter((level, index) =>\n      CapLevelController.isLevelAllowed(index, this.restrictedLevels) && index <= capLevelIndex\n    );\n\n    return CapLevelController.getMaxLevelByMediaSize(validLevels, this.mediaWidth, this.mediaHeight);\n  }\n\n  get mediaWidth () {\n    let width;\n    const media = this.media;\n    if (media) {\n      width = media.width || media.clientWidth || media.offsetWidth;\n      width *= CapLevelController.contentScaleFactor;\n    }\n    return width;\n  }\n\n  get mediaHeight () {\n    let height;\n    const media = this.media;\n    if (media) {\n      height = media.height || media.clientHeight || media.offsetHeight;\n      height *= CapLevelController.contentScaleFactor;\n    }\n    return height;\n  }\n\n  static get contentScaleFactor () {\n    let pixelRatio = 1;\n    try {\n      pixelRatio = window.devicePixelRatio;\n    } catch (e) {}\n    return pixelRatio;\n  }\n\n  static isLevelAllowed (level, restrictedLevels = []) {\n    return restrictedLevels.indexOf(level) === -1;\n  }\n\n  static getMaxLevelByMediaSize (levels, width, height) {\n    if (!levels || (levels && !levels.length))\n      return -1;\n\n    // Levels can have the same dimensions but differing bandwidths - since levels are ordered, we can look to the next\n    // to determine whether we've chosen the greatest bandwidth for the media's dimensions\n    const atGreatestBandiwdth = (curLevel, nextLevel) => {\n      if (!nextLevel)\n        return true;\n\n      return curLevel.width !== nextLevel.width || curLevel.height !== nextLevel.height;\n    };\n\n    // If we run through the loop without breaking, the media's dimensions are greater than every level, so default to\n    // the max level\n    let maxLevelIndex = levels.length - 1;\n\n    for (let i = 0; i < levels.length; i += 1) {\n      const level = levels[i];\n      if ((level.width >= width || level.height >= height) && atGreatestBandiwdth(level, levels[i + 1])) {\n        maxLevelIndex = i;\n        break;\n      }\n    }\n\n    return maxLevelIndex;\n  }\n}\n\nexport default CapLevelController;\n","/**\n * @author Stephan Hesse <disparat@gmail.com> | <tchakabam@gmail.com>\n *\n * DRM support for Hls.js\n */\n\nimport EventHandler from '../event-handler';\nimport Event from '../events';\nimport { ErrorTypes, ErrorDetails } from '../errors';\n\nimport { logger } from '../utils/logger';\n\nconst MAX_LICENSE_REQUEST_FAILURES = 3;\n\n/**\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Navigator/requestMediaKeySystemAccess\n */\nconst KeySystems = {\n  WIDEVINE: 'com.widevine.alpha',\n  PLAYREADY: 'com.microsoft.playready'\n};\n\n/**\n * @see https://developer.mozilla.org/en-US/docs/Web/API/MediaKeySystemConfiguration\n * @param {Array<string>} audioCodecs List of required audio codecs to support\n * @param {Array<string>} videoCodecs List of required video codecs to support\n * @param {object} drmSystemOptions Optional parameters/requirements for the key-system\n * @returns {Array<MediaSystemConfiguration>} An array of supported configurations\n */\n\nconst createWidevineMediaKeySystemConfigurations = function (audioCodecs, videoCodecs, drmSystemOptions) { /* jshint ignore:line */\n  const baseConfig = {\n    // initDataTypes: ['keyids', 'mp4'],\n    // label: \"\",\n    // persistentState: \"not-allowed\", // or \"required\" ?\n    // distinctiveIdentifier: \"not-allowed\", // or \"required\" ?\n    // sessionTypes: ['temporary'],\n    videoCapabilities: [\n      // { contentType: 'video/mp4; codecs=\"avc1.42E01E\"' }\n    ]\n  };\n\n  videoCodecs.forEach((codec) => {\n    baseConfig.videoCapabilities.push({\n      contentType: `video/mp4; codecs=\"${codec}\"`\n    });\n  });\n\n  return [\n    baseConfig\n  ];\n};\n\n/**\n * The idea here is to handle key-system (and their respective platforms) specific configuration differences\n * in order to work with the local requestMediaKeySystemAccess method.\n *\n * We can also rule-out platform-related key-system support at this point by throwing an error or returning null.\n *\n * @param {string} keySystem Identifier for the key-system, see `KeySystems` enum\n * @param {Array<string>} audioCodecs List of required audio codecs to support\n * @param {Array<string>} videoCodecs List of required video codecs to support\n * @returns {Array<MediaSystemConfiguration> | null} A non-empty Array of MediaKeySystemConfiguration objects or `null`\n */\nconst getSupportedMediaKeySystemConfigurations = function (keySystem, audioCodecs, videoCodecs) {\n  switch (keySystem) {\n  case KeySystems.WIDEVINE:\n    return createWidevineMediaKeySystemConfigurations(audioCodecs, videoCodecs);\n  default:\n    throw Error('Unknown key-system: ' + keySystem);\n  }\n};\n\n/**\n * Controller to deal with encrypted media extensions (EME)\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Encrypted_Media_Extensions_API\n *\n * @class\n * @constructor\n */\nclass EMEController extends EventHandler {\n  /**\n     * @constructs\n     * @param {Hls} hls Our Hls.js instance\n     */\n  constructor (hls) {\n    super(hls,\n      Event.MEDIA_ATTACHED,\n      Event.MANIFEST_PARSED\n    );\n\n    this._widevineLicenseUrl = hls.config.widevineLicenseUrl;\n    this._licenseXhrSetup = hls.config.licenseXhrSetup;\n    this._emeEnabled = hls.config.emeEnabled;\n\n    this._requestMediaKeySystemAccess = hls.config.requestMediaKeySystemAccessFunc;\n\n    this._mediaKeysList = [];\n    this._media = null;\n\n    this._hasSetMediaKeys = false;\n    this._isMediaEncrypted = false;\n\n    this._requestLicenseFailureCount = 0;\n  }\n\n  /**\n     *\n     * @param {string} keySystem Identifier for the key-system, see `KeySystems` enum\n     * @returns {string} License server URL for key-system (if any configured, otherwise causes error)\n     */\n  getLicenseServerUrl (keySystem) {\n    let url;\n    switch (keySystem) {\n    case KeySystems.WIDEVINE:\n      url = this._widevineLicenseUrl;\n      break;\n    default:\n      url = null;\n      break;\n    }\n\n    if (!url) {\n      logger.error(`No license server URL configured for key-system \"${keySystem}\"`);\n      this.hls.trigger(Event.ERROR, {\n        type: ErrorTypes.KEY_SYSTEM_ERROR,\n        details: ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,\n        fatal: true\n      });\n    }\n\n    return url;\n  }\n\n  /**\n     * Requests access object and adds it to our list upon success\n     * @private\n     * @param {string} keySystem System ID (see `KeySystems`)\n     * @param {Array<string>} audioCodecs List of required audio codecs to support\n     * @param {Array<string>} videoCodecs List of required video codecs to support\n     */\n  _attemptKeySystemAccess (keySystem, audioCodecs, videoCodecs) {\n    // TODO: add other DRM \"options\"\n\n    const mediaKeySystemConfigs = getSupportedMediaKeySystemConfigurations(keySystem, audioCodecs, videoCodecs);\n\n    if (!mediaKeySystemConfigs) {\n      logger.warn('Can not create config for key-system (maybe because platform is not supported):', keySystem);\n      return;\n    }\n\n    logger.log('Requesting encrypted media key-system access');\n\n    // expecting interface like window.navigator.requestMediaKeySystemAccess\n    this.requestMediaKeySystemAccess(keySystem, mediaKeySystemConfigs)\n      .then((mediaKeySystemAccess) => {\n        this._onMediaKeySystemAccessObtained(keySystem, mediaKeySystemAccess);\n      })\n      .catch((err) => {\n        logger.error(`Failed to obtain key-system \"${keySystem}\" access:`, err);\n      });\n  }\n\n  get requestMediaKeySystemAccess () {\n    if (!this._requestMediaKeySystemAccess)\n      throw new Error('No requestMediaKeySystemAccess function configured');\n\n    return this._requestMediaKeySystemAccess;\n  }\n\n  /**\n     * Handles obtaining access to a key-system\n     *\n     * @param {string} keySystem\n     * @param {MediaKeySystemAccess} mediaKeySystemAccess https://developer.mozilla.org/en-US/docs/Web/API/MediaKeySystemAccess\n     */\n  _onMediaKeySystemAccessObtained (keySystem, mediaKeySystemAccess) {\n    logger.log(`Access for key-system \"${keySystem}\" obtained`);\n\n    const mediaKeysListItem = {\n      mediaKeys: null,\n      mediaKeysSession: null,\n      mediaKeysSessionInitialized: false,\n      mediaKeySystemAccess: mediaKeySystemAccess,\n      mediaKeySystemDomain: keySystem\n    };\n\n    this._mediaKeysList.push(mediaKeysListItem);\n\n    mediaKeySystemAccess.createMediaKeys()\n      .then((mediaKeys) => {\n        mediaKeysListItem.mediaKeys = mediaKeys;\n\n        logger.log(`Media-keys created for key-system \"${keySystem}\"`);\n\n        this._onMediaKeysCreated();\n      })\n      .catch((err) => {\n        logger.error('Failed to create media-keys:', err);\n      });\n  }\n\n  /**\n     * Handles key-creation (represents access to CDM). We are going to create key-sessions upon this\n     * for all existing keys where no session exists yet.\n     */\n  _onMediaKeysCreated () {\n    // check for all key-list items if a session exists, otherwise, create one\n    this._mediaKeysList.forEach((mediaKeysListItem) => {\n      if (!mediaKeysListItem.mediaKeysSession) {\n        mediaKeysListItem.mediaKeysSession = mediaKeysListItem.mediaKeys.createSession();\n        this._onNewMediaKeySession(mediaKeysListItem.mediaKeysSession);\n      }\n    });\n  }\n\n  /**\n     *\n     * @param {*} keySession\n     */\n  _onNewMediaKeySession (keySession) {\n    logger.log(`New key-system session ${keySession.sessionId}`);\n\n    keySession.addEventListener('message', (event) => {\n      this._onKeySessionMessage(keySession, event.message);\n    }, false);\n  }\n\n  _onKeySessionMessage (keySession, message) {\n    logger.log('Got EME message event, creating license request');\n\n    this._requestLicense(message, (data) => {\n      logger.log('Received license data, updating key-session');\n      keySession.update(data);\n    });\n  }\n\n  _onMediaEncrypted (initDataType, initData) {\n    logger.log(`Media is encrypted using \"${initDataType}\" init data type`);\n\n    this._isMediaEncrypted = true;\n    this._mediaEncryptionInitDataType = initDataType;\n    this._mediaEncryptionInitData = initData;\n\n    this._attemptSetMediaKeys();\n    this._generateRequestWithPreferredKeySession();\n  }\n\n  _attemptSetMediaKeys () {\n    if (!this._hasSetMediaKeys) {\n      // FIXME: see if we can/want/need-to really to deal with several potential key-sessions?\n      const keysListItem = this._mediaKeysList[0];\n      if (!keysListItem || !keysListItem.mediaKeys) {\n        logger.error('Fatal: Media is encrypted but no CDM access or no keys have been obtained yet');\n        this.hls.trigger(Event.ERROR, {\n          type: ErrorTypes.KEY_SYSTEM_ERROR,\n          details: ErrorDetails.KEY_SYSTEM_NO_KEYS,\n          fatal: true\n        });\n        return;\n      }\n\n      logger.log('Setting keys for encrypted media');\n\n      this._media.setMediaKeys(keysListItem.mediaKeys);\n      this._hasSetMediaKeys = true;\n    }\n  }\n\n  _generateRequestWithPreferredKeySession () {\n    // FIXME: see if we can/want/need-to really to deal with several potential key-sessions?\n    const keysListItem = this._mediaKeysList[0];\n    if (!keysListItem) {\n      logger.error('Fatal: Media is encrypted but not any key-system access has been obtained yet');\n      this.hls.trigger(Event.ERROR, {\n        type: ErrorTypes.KEY_SYSTEM_ERROR,\n        details: ErrorDetails.KEY_SYSTEM_NO_ACCESS,\n        fatal: true\n      });\n      return;\n    }\n\n    if (keysListItem.mediaKeysSessionInitialized) {\n      logger.warn('Key-Session already initialized but requested again');\n      return;\n    }\n\n    const keySession = keysListItem.mediaKeysSession;\n    if (!keySession) {\n      logger.error('Fatal: Media is encrypted but no key-session existing');\n      this.hls.trigger(Event.ERROR, {\n        type: ErrorTypes.KEY_SYSTEM_ERROR,\n        details: ErrorDetails.KEY_SYSTEM_NO_SESSION,\n        fatal: true\n      });\n    }\n\n    const initDataType = this._mediaEncryptionInitDataType;\n    const initData = this._mediaEncryptionInitData;\n\n    logger.log(`Generating key-session request for \"${initDataType}\" init data type`);\n\n    keysListItem.mediaKeysSessionInitialized = true;\n\n    keySession.generateRequest(initDataType, initData)\n      .then(() => {\n        logger.debug('Key-session generation succeeded');\n      })\n      .catch((err) => {\n        logger.error('Error generating key-session request:', err);\n        this.hls.trigger(Event.ERROR, {\n          type: ErrorTypes.KEY_SYSTEM_ERROR,\n          details: ErrorDetails.KEY_SYSTEM_NO_SESSION,\n          fatal: false\n        });\n      });\n  }\n\n  /**\n     * @param {string} url License server URL\n     * @param {ArrayBuffer} keyMessage Message data issued by key-system\n     * @param {function} callback Called when XHR has succeeded\n     * @returns {XMLHttpRequest} Unsent (but opened state) XHR object\n     */\n  _createLicenseXhr (url, keyMessage, callback) {\n    const xhr = new XMLHttpRequest();\n    const licenseXhrSetup = this._licenseXhrSetup;\n\n    try {\n      if (licenseXhrSetup) {\n        try {\n          licenseXhrSetup(xhr, url);\n        } catch (e) {\n          // let's try to open before running setup\n          xhr.open('POST', url, true);\n          licenseXhrSetup(xhr, url);\n        }\n      }\n      // if licenseXhrSetup did not yet call open, let's do it now\n      if (!xhr.readyState)\n        xhr.open('POST', url, true);\n    } catch (e) {\n      // IE11 throws an exception on xhr.open if attempting to access an HTTP resource over HTTPS\n      logger.error('Error setting up key-system license XHR', e);\n      this.hls.trigger(Event.ERROR, {\n        type: ErrorTypes.KEY_SYSTEM_ERROR,\n        details: ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,\n        fatal: true\n      });\n      return;\n    }\n\n    xhr.responseType = 'arraybuffer';\n    xhr.onreadystatechange =\n        this._onLicenseRequestReadyStageChange.bind(this, xhr, url, keyMessage, callback);\n    return xhr;\n  }\n\n  /**\n     * @param {XMLHttpRequest} xhr\n     * @param {string} url License server URL\n     * @param {ArrayBuffer} keyMessage Message data issued by key-system\n     * @param {function} callback Called when XHR has succeeded\n     *\n     */\n  _onLicenseRequestReadyStageChange (xhr, url, keyMessage, callback) {\n    switch (xhr.readyState) {\n    case 4:\n      if (xhr.status === 200) {\n        this._requestLicenseFailureCount = 0;\n        logger.log('License request succeeded');\n        callback(xhr.response);\n      } else {\n        logger.error(`License Request XHR failed (${url}). Status: ${xhr.status} (${xhr.statusText})`);\n\n        this._requestLicenseFailureCount++;\n        if (this._requestLicenseFailureCount <= MAX_LICENSE_REQUEST_FAILURES) {\n          const attemptsLeft = MAX_LICENSE_REQUEST_FAILURES - this._requestLicenseFailureCount + 1;\n          logger.warn(`Retrying license request, ${attemptsLeft} attempts left`);\n          this._requestLicense(keyMessage, callback);\n          return;\n        }\n\n        this.hls.trigger(Event.ERROR, {\n          type: ErrorTypes.KEY_SYSTEM_ERROR,\n          details: ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,\n          fatal: true\n        });\n      }\n      break;\n    }\n  }\n\n  /**\n     * @param {object} keysListItem\n     * @param {ArrayBuffer} keyMessage\n     * @returns {ArrayBuffer} Challenge data posted to license server\n     */\n  _generateLicenseRequestChallenge (keysListItem, keyMessage) {\n    let challenge;\n\n    if (keysListItem.mediaKeySystemDomain === KeySystems.PLAYREADY) {\n      logger.error('PlayReady is not supported (yet)');\n\n      // from https://github.com/MicrosoftEdge/Demos/blob/master/eme/scripts/demo.js\n      /*\n        if (this.licenseType !== this.LICENSE_TYPE_WIDEVINE) {\n            // For PlayReady CDMs, we need to dig the Challenge out of the XML.\n            var keyMessageXml = new DOMParser().parseFromString(String.fromCharCode.apply(null, new Uint16Array(keyMessage)), 'application/xml');\n            if (keyMessageXml.getElementsByTagName('Challenge')[0]) {\n                challenge = atob(keyMessageXml.getElementsByTagName('Challenge')[0].childNodes[0].nodeValue);\n            } else {\n                throw 'Cannot find <Challenge> in key message';\n            }\n            var headerNames = keyMessageXml.getElementsByTagName('name');\n            var headerValues = keyMessageXml.getElementsByTagName('value');\n            if (headerNames.length !== headerValues.length) {\n                throw 'Mismatched header <name>/<value> pair in key message';\n            }\n            for (var i = 0; i < headerNames.length; i++) {\n                xhr.setRequestHeader(headerNames[i].childNodes[0].nodeValue, headerValues[i].childNodes[0].nodeValue);\n            }\n        }\n        */\n    } else if (keysListItem.mediaKeySystemDomain === KeySystems.WIDEVINE) {\n      // For Widevine CDMs, the challenge is the keyMessage.\n      challenge = keyMessage;\n    } else {\n      logger.error('Unsupported key-system:', keysListItem.mediaKeySystemDomain);\n    }\n\n    return challenge;\n  }\n\n  _requestLicense (keyMessage, callback) {\n    logger.log('Requesting content license for key-system');\n\n    const keysListItem = this._mediaKeysList[0];\n    if (!keysListItem) {\n      logger.error('Fatal error: Media is encrypted but no key-system access has been obtained yet');\n      this.hls.trigger(Event.ERROR, {\n        type: ErrorTypes.KEY_SYSTEM_ERROR,\n        details: ErrorDetails.KEY_SYSTEM_NO_ACCESS,\n        fatal: true\n      });\n      return;\n    }\n\n    const url = this.getLicenseServerUrl(keysListItem.mediaKeySystemDomain);\n    const xhr = this._createLicenseXhr(url, keyMessage, callback);\n\n    logger.log(`Sending license request to URL: ${url}`);\n\n    xhr.send(this._generateLicenseRequestChallenge(keysListItem, keyMessage));\n  }\n\n  onMediaAttached (data) {\n    if (!this._emeEnabled)\n      return;\n\n    const media = data.media;\n\n    // keep reference of media\n    this._media = media;\n\n    // FIXME: also handle detaching media !\n\n    media.addEventListener('encrypted', (e) => {\n      this._onMediaEncrypted(e.initDataType, e.initData);\n    });\n  }\n\n  onManifestParsed (data) {\n    if (!this._emeEnabled)\n      return;\n\n    const audioCodecs = data.levels.map((level) => level.audioCodec);\n    const videoCodecs = data.levels.map((level) => level.videoCodec);\n\n    this._attemptKeySystemAccess(KeySystems.WIDEVINE, audioCodecs, videoCodecs);\n  }\n}\n\nexport default EMEController;\n","/*\n * FPS Controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport { logger } from '../utils/logger';\n\nclass FPSController extends EventHandler {\n  constructor (hls) {\n    super(hls, Event.MEDIA_ATTACHING);\n  }\n\n  destroy () {\n    if (this.timer)\n      clearInterval(this.timer);\n\n    this.isVideoPlaybackQualityAvailable = false;\n  }\n\n  onMediaAttaching (data) {\n    const config = this.hls.config;\n    if (config.capLevelOnFPSDrop) {\n      const video = this.video = data.media instanceof HTMLVideoElement ? data.media : null;\n      if (typeof video.getVideoPlaybackQuality === 'function')\n        this.isVideoPlaybackQualityAvailable = true;\n\n      clearInterval(this.timer);\n      this.timer = setInterval(this.checkFPSInterval.bind(this), config.fpsDroppedMonitoringPeriod);\n    }\n  }\n\n  checkFPS (video, decodedFrames, droppedFrames) {\n    let currentTime = performance.now();\n    if (decodedFrames) {\n      if (this.lastTime) {\n        let currentPeriod = currentTime - this.lastTime,\n          currentDropped = droppedFrames - this.lastDroppedFrames,\n          currentDecoded = decodedFrames - this.lastDecodedFrames,\n          droppedFPS = 1000 * currentDropped / currentPeriod,\n          hls = this.hls;\n        hls.trigger(Event.FPS_DROP, { currentDropped: currentDropped, currentDecoded: currentDecoded, totalDroppedFrames: droppedFrames });\n        if (droppedFPS > 0) {\n          // logger.log('checkFPS : droppedFPS/decodedFPS:' + droppedFPS/(1000 * currentDecoded / currentPeriod));\n          if (currentDropped > hls.config.fpsDroppedMonitoringThreshold * currentDecoded) {\n            let currentLevel = hls.currentLevel;\n            logger.warn('drop FPS ratio greater than max allowed value for currentLevel: ' + currentLevel);\n            if (currentLevel > 0 && (hls.autoLevelCapping === -1 || hls.autoLevelCapping >= currentLevel)) {\n              currentLevel = currentLevel - 1;\n              hls.trigger(Event.FPS_DROP_LEVEL_CAPPING, { level: currentLevel, droppedLevel: hls.currentLevel });\n              hls.autoLevelCapping = currentLevel;\n              hls.streamController.nextLevelSwitch();\n            }\n          }\n        }\n      }\n      this.lastTime = currentTime;\n      this.lastDroppedFrames = droppedFrames;\n      this.lastDecodedFrames = decodedFrames;\n    }\n  }\n\n  checkFPSInterval () {\n    const video = this.video;\n    if (video) {\n      if (this.isVideoPlaybackQualityAvailable) {\n        let videoPlaybackQuality = video.getVideoPlaybackQuality();\n        this.checkFPS(video, videoPlaybackQuality.totalVideoFrames, videoPlaybackQuality.droppedVideoFrames);\n      } else {\n        this.checkFPS(video, video.webkitDecodedFrameCount, video.webkitDroppedFrameCount);\n      }\n    }\n  }\n}\n\nexport default FPSController;\n","/*\n * Subtitle Stream Controller\n*/\n\nimport Event from '../events';\nimport { logger } from '../utils/logger';\nimport Decrypter from '../crypt/decrypter';\nimport TaskLoop from '../task-loop';\n\nconst State = {\n  STOPPED: 'STOPPED',\n  IDLE: 'IDLE',\n  KEY_LOADING: 'KEY_LOADING',\n  FRAG_LOADING: 'FRAG_LOADING'\n};\n\nclass SubtitleStreamController extends TaskLoop {\n  constructor (hls) {\n    super(hls,\n      Event.MEDIA_ATTACHED,\n      Event.ERROR,\n      Event.KEY_LOADED,\n      Event.FRAG_LOADED,\n      Event.SUBTITLE_TRACKS_UPDATED,\n      Event.SUBTITLE_TRACK_SWITCH,\n      Event.SUBTITLE_TRACK_LOADED,\n      Event.SUBTITLE_FRAG_PROCESSED);\n\n    this.config = hls.config;\n    this.vttFragSNsProcessed = {};\n    this.vttFragQueues = undefined;\n    this.currentlyProcessing = null;\n    this.state = State.STOPPED;\n    this.currentTrackId = -1;\n    this.decrypter = new Decrypter(hls.observer, hls.config);\n  }\n\n  onHandlerDestroyed () {\n    this.state = State.STOPPED;\n  }\n\n  // Remove all queued items and create a new, empty queue for each track.\n  clearVttFragQueues () {\n    this.vttFragQueues = {};\n    this.tracks.forEach(track => {\n      this.vttFragQueues[track.id] = [];\n    });\n  }\n\n  // If no frag is being processed and queue isn't empty, initiate processing of next frag in line.\n  nextFrag () {\n    if (this.currentlyProcessing === null && this.currentTrackId > -1 && this.vttFragQueues[this.currentTrackId].length) {\n      let frag = this.currentlyProcessing = this.vttFragQueues[this.currentTrackId].shift();\n      this.fragCurrent = frag;\n      this.hls.trigger(Event.FRAG_LOADING, { frag: frag });\n      this.state = State.FRAG_LOADING;\n    }\n  }\n\n  // When fragment has finished processing, add sn to list of completed if successful.\n  onSubtitleFragProcessed (data) {\n    if (data.success)\n      this.vttFragSNsProcessed[data.frag.trackId].push(data.frag.sn);\n\n    this.currentlyProcessing = null;\n    this.state = State.IDLE;\n    this.nextFrag();\n  }\n\n  onMediaAttached () {\n    this.state = State.IDLE;\n  }\n\n  // If something goes wrong, procede to next frag, if we were processing one.\n  onError (data) {\n    let frag = data.frag;\n    // don't handle frag error not related to subtitle fragment\n    if (frag && frag.type !== 'subtitle')\n      return;\n\n    if (this.currentlyProcessing) {\n      this.currentlyProcessing = null;\n      this.nextFrag();\n    }\n  }\n\n  doTick () {\n    switch (this.state) {\n    case State.IDLE:\n      const tracks = this.tracks;\n      let trackId = this.currentTrackId;\n\n      const processedFragSNs = this.vttFragSNsProcessed[trackId],\n        fragQueue = this.vttFragQueues[trackId],\n        currentFragSN = this.currentlyProcessing ? this.currentlyProcessing.sn : -1;\n\n      const alreadyProcessed = function (frag) {\n        return processedFragSNs.indexOf(frag.sn) > -1;\n      };\n\n      const alreadyInQueue = function (frag) {\n        return fragQueue.some(fragInQueue => { return fragInQueue.sn === frag.sn; });\n      };\n\n        // exit if tracks don't exist\n      if (!tracks)\n        break;\n\n      var trackDetails;\n\n      if (trackId < tracks.length)\n        trackDetails = tracks[trackId].details;\n\n      if (typeof trackDetails === 'undefined')\n        break;\n\n      // Add all fragments that haven't been, aren't currently being and aren't waiting to be processed, to queue.\n      trackDetails.fragments.forEach(frag =>{\n        if (!(alreadyProcessed(frag) || frag.sn === currentFragSN || alreadyInQueue(frag))) {\n          // Load key if subtitles are encrypted\n          if ((frag.decryptdata && frag.decryptdata.uri != null) && (frag.decryptdata.key == null)) {\n            logger.log(`Loading key for ${frag.sn}`);\n            this.state = State.KEY_LOADING;\n            this.hls.trigger(Event.KEY_LOADING, { frag: frag });\n          } else {\n            // Frags don't know their subtitle track ID, so let's just add that...\n            frag.trackId = trackId;\n            fragQueue.push(frag);\n            this.nextFrag();\n          }\n        }\n      });\n    }\n  }\n\n  // Got all new subtitle tracks.\n  onSubtitleTracksUpdated (data) {\n    logger.log('subtitle tracks updated');\n    this.tracks = data.subtitleTracks;\n    this.clearVttFragQueues();\n    this.vttFragSNsProcessed = {};\n    this.tracks.forEach(track => {\n      this.vttFragSNsProcessed[track.id] = [];\n    });\n  }\n\n  onSubtitleTrackSwitch (data) {\n    this.currentTrackId = data.id;\n    if (this.currentTrackId === -1)\n      return;\n\n    // Check if track was already loaded and if so make sure we finish\n    // downloading its frags, if not all have been downloaded yet\n    const currentTrack = this.tracks[this.currentTrackId];\n    let details = currentTrack.details;\n    if (details !== undefined)\n      this.tick();\n  }\n\n  // Got a new set of subtitle fragments.\n  onSubtitleTrackLoaded () {\n    this.tick();\n  }\n\n  onKeyLoaded () {\n    if (this.state === State.KEY_LOADING) {\n      this.state = State.IDLE;\n      this.tick();\n    }\n  }\n\n  onFragLoaded (data) {\n    let fragCurrent = this.fragCurrent,\n      decryptData = data.frag.decryptdata;\n    let fragLoaded = data.frag,\n      hls = this.hls;\n    if (this.state === State.FRAG_LOADING &&\n        fragCurrent &&\n        data.frag.type === 'subtitle' &&\n        fragCurrent.sn === data.frag.sn) {\n      // check to see if the payload needs to be decrypted\n      if ((data.payload.byteLength > 0) && (decryptData != null) && (decryptData.key != null) && (decryptData.method === 'AES-128')) {\n        let startTime;\n        try {\n          startTime = performance.now();\n        } catch (error) {\n          startTime = Date.now();\n        }\n        // decrypt the subtitles\n        this.decrypter.decrypt(data.payload, decryptData.key.buffer, decryptData.iv.buffer, function (decryptedData) {\n          let endTime;\n          try {\n            endTime = performance.now();\n          } catch (error) {\n            endTime = Date.now();\n          }\n          hls.trigger(Event.FRAG_DECRYPTED, { frag: fragLoaded, payload: decryptedData, stats: { tstart: startTime, tdecrypt: endTime } });\n        });\n      }\n    }\n  }\n}\nexport default SubtitleStreamController;\n","/*\n * subtitle track controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport { logger } from '../utils/logger';\n\nfunction filterSubtitleTracks (textTrackList) {\n  let tracks = [];\n  for (let i = 0; i < textTrackList.length; i++) {\n    if (textTrackList[i].kind === 'subtitles')\n      tracks.push(textTrackList[i]);\n  }\n  return tracks;\n}\n\nclass SubtitleTrackController extends EventHandler {\n  constructor (hls) {\n    super(hls,\n      Event.MEDIA_ATTACHED,\n      Event.MEDIA_DETACHING,\n      Event.MANIFEST_LOADING,\n      Event.MANIFEST_LOADED,\n      Event.SUBTITLE_TRACK_LOADED);\n    this.tracks = [];\n    this.trackId = -1;\n    this.media = undefined;\n\n    /**\n     * @member {boolean} subtitleDisplay Enable/disable subtitle display rendering\n     */\n    this.subtitleDisplay = false;\n  }\n\n  _onTextTracksChanged () {\n    // Media is undefined when switching streams via loadSource()\n    if (!this.media)\n      return;\n\n    let trackId = -1;\n    let tracks = filterSubtitleTracks(this.media.textTracks);\n    for (let id = 0; id < tracks.length; id++) {\n      if (tracks[id].mode === 'hidden') {\n        // Do not break in case there is a following track with showing.\n        trackId = id;\n      } else if (tracks[id].mode === 'showing') {\n        trackId = id;\n        break;\n      }\n    }\n\n    // Setting current subtitleTrack will invoke code.\n    this.subtitleTrack = trackId;\n  }\n\n  destroy () {\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  // Listen for subtitle track change, then extract the current track ID.\n  onMediaAttached (data) {\n    this.media = data.media;\n    if (!this.media)\n      return;\n\n    if (this.queuedDefaultTrack !== undefined) {\n      this.subtitleTrack = this.queuedDefaultTrack;\n      delete this.queuedDefaultTrack;\n    }\n\n    this.trackChangeListener = this._onTextTracksChanged.bind(this);\n\n    this.useTextTrackPolling = !(this.media.textTracks && 'onchange' in this.media.textTracks);\n    if (this.useTextTrackPolling) {\n      this.subtitlePollingInterval = setInterval(() => {\n        this.trackChangeListener();\n      }, 500);\n    } else {\n      this.media.textTracks.addEventListener('change', this.trackChangeListener);\n    }\n  }\n\n  onMediaDetaching () {\n    if (!this.media)\n      return;\n\n    if (this.useTextTrackPolling)\n      clearInterval(this.subtitlePollingInterval);\n    else\n      this.media.textTracks.removeEventListener('change', this.trackChangeListener);\n\n    this.media = undefined;\n  }\n\n  // Reset subtitle tracks on manifest loading\n  onManifestLoading () {\n    this.tracks = [];\n    this.trackId = -1;\n  }\n\n  // Fired whenever a new manifest is loaded.\n  onManifestLoaded (data) {\n    let tracks = data.subtitles || [];\n    this.tracks = tracks;\n    this.trackId = -1;\n    this.hls.trigger(Event.SUBTITLE_TRACKS_UPDATED, { subtitleTracks: tracks });\n\n    // loop through available subtitle tracks and autoselect default if needed\n    // TODO: improve selection logic to handle forced, etc\n    tracks.forEach(track => {\n      if (track.default) {\n        // setting this.subtitleTrack will trigger internal logic\n        // if media has not been attached yet, it will fail\n        // we keep a reference to the default track id\n        // and we'll set subtitleTrack when onMediaAttached is triggered\n        if (this.media)\n          this.subtitleTrack = track.id;\n        else\n          this.queuedDefaultTrack = track.id;\n      }\n    });\n  }\n\n  // Trigger subtitle track playlist reload.\n  onTick () {\n    const trackId = this.trackId;\n    const subtitleTrack = this.tracks[trackId];\n    if (!subtitleTrack)\n      return;\n\n    const details = subtitleTrack.details;\n    // check if we need to load playlist for this subtitle Track\n    if (details === undefined || details.live === true) {\n      // track not retrieved yet, or live playlist we need to (re)load it\n      logger.log(`(re)loading playlist for subtitle track ${trackId}`);\n      this.hls.trigger(Event.SUBTITLE_TRACK_LOADING, { url: subtitleTrack.url, id: trackId });\n    }\n  }\n\n  onSubtitleTrackLoaded (data) {\n    if (data.id < this.tracks.length) {\n      logger.log(`subtitle track ${data.id} loaded`);\n      this.tracks[data.id].details = data.details;\n      // check if current playlist is a live playlist\n      if (data.details.live && !this.timer) {\n        // if live playlist we will have to reload it periodically\n        // set reload period to playlist target duration\n        this.timer = setInterval(() => {\n          this.onTick();\n        }, 1000 * data.details.targetduration, this);\n      }\n      if (!data.details.live && this.timer) {\n        // playlist is not live and timer is armed : stopping it\n        clearInterval(this.timer);\n        this.timer = null;\n      }\n    }\n  }\n\n  /** get alternate subtitle tracks list from playlist **/\n  get subtitleTracks () {\n    return this.tracks;\n  }\n\n  /** get index of the selected subtitle track (index in subtitle track lists) **/\n  get subtitleTrack () {\n    return this.trackId;\n  }\n\n  /** select a subtitle track, based on its index in subtitle track lists**/\n  set subtitleTrack (subtitleTrackId) {\n    if (this.trackId !== subtitleTrackId) { // || this.tracks[subtitleTrackId].details === undefined) {\n      this.setSubtitleTrackInternal(subtitleTrackId);\n    }\n  }\n\n  setSubtitleTrackInternal (newId) {\n    // check if level idx is valid\n    if (newId < -1 || newId >= this.tracks.length)\n      return;\n\n    // stopping live reloading timer if any\n    if (this.timer) {\n      clearInterval(this.timer);\n      this.timer = null;\n    }\n\n    let textTracks = filterSubtitleTracks(this.media.textTracks);\n\n    // hide currently enabled subtitle track\n    if (this.trackId !== -1)\n      textTracks[this.trackId].mode = 'disabled';\n\n    this.trackId = newId;\n    logger.log(`switching to subtitle track ${newId}`);\n    this.hls.trigger(Event.SUBTITLE_TRACK_SWITCH, { id: newId });\n\n    if (newId === -1)\n      return;\n\n    const subtitleTrack = this.tracks[newId];\n    if (newId < textTracks.length)\n      textTracks[newId].mode = this.subtitleDisplay ? 'showing' : 'hidden';\n\n    // check if we need to load playlist for this subtitle Track\n    let details = subtitleTrack.details;\n    if (details === undefined || details.live === true) {\n      // track not retrieved yet, or live playlist we need to (re)load it\n      logger.log(`(re)loading playlist for subtitle track ${newId}`);\n      this.hls.trigger(Event.SUBTITLE_TRACK_LOADING, { url: subtitleTrack.url, id: newId });\n    }\n  }\n}\n\nexport default SubtitleTrackController;\n","/*\n * Timeline Controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport Cea608Parser from '../utils/cea-608-parser';\nimport OutputFilter from '../utils/output-filter';\nimport WebVTTParser from '../utils/webvtt-parser';\nimport { logger } from '../utils/logger';\nimport { sendAddTrackEvent, clearCurrentCues } from '../utils/texttrack-utils';\n\nfunction reuseVttTextTrack (inUseTrack, manifestTrack) {\n  return inUseTrack && inUseTrack.label === manifestTrack.name && !(inUseTrack.textTrack1 || inUseTrack.textTrack2);\n}\n\nfunction intersection (x1, x2, y1, y2) {\n  return Math.min(x2, y2) - Math.max(x1, y1);\n}\n\nclass TimelineController extends EventHandler {\n  constructor (hls) {\n    super(hls, Event.MEDIA_ATTACHING,\n      Event.MEDIA_DETACHING,\n      Event.FRAG_PARSING_USERDATA,\n      Event.FRAG_DECRYPTED,\n      Event.MANIFEST_LOADING,\n      Event.MANIFEST_LOADED,\n      Event.FRAG_LOADED,\n      Event.LEVEL_SWITCHING,\n      Event.INIT_PTS_FOUND);\n\n    this.hls = hls;\n    this.config = hls.config;\n    this.enabled = true;\n    this.Cues = hls.config.cueHandler;\n    this.textTracks = [];\n    this.tracks = [];\n    this.unparsedVttFrags = [];\n    this.initPTS = undefined;\n    this.cueRanges = [];\n    this.captionsTracks = {};\n\n    this.captionsProperties = {\n      textTrack1: {\n        label: this.config.captionsTextTrack1Label,\n        languageCode: this.config.captionsTextTrack1LanguageCode\n      },\n      textTrack2: {\n        label: this.config.captionsTextTrack2Label,\n        languageCode: this.config.captionsTextTrack2LanguageCode\n      }\n    };\n\n    if (this.config.enableCEA708Captions) {\n      let channel1 = new OutputFilter(this, 'textTrack1');\n      let channel2 = new OutputFilter(this, 'textTrack2');\n\n      this.cea608Parser = new Cea608Parser(0, channel1, channel2);\n    }\n  }\n\n  addCues (trackName, startTime, endTime, screen) {\n    // skip cues which overlap more than 50% with previously parsed time ranges\n    const ranges = this.cueRanges;\n    let merged = false;\n    for (let i = ranges.length; i--;) {\n      let cueRange = ranges[i];\n      let overlap = intersection(cueRange[0], cueRange[1], startTime, endTime);\n      if (overlap >= 0) {\n        cueRange[0] = Math.min(cueRange[0], startTime);\n        cueRange[1] = Math.max(cueRange[1], endTime);\n        merged = true;\n        if ((overlap / (endTime - startTime)) > 0.5)\n          return;\n      }\n    }\n    if (!merged)\n      ranges.push([startTime, endTime]);\n\n    this.Cues.newCue(this.captionsTracks[trackName], startTime, endTime, screen);\n  }\n\n  // Triggered when an initial PTS is found; used for synchronisation of WebVTT.\n  onInitPtsFound (data) {\n    if (typeof this.initPTS === 'undefined')\n      this.initPTS = data.initPTS;\n\n    // Due to asynchrony, initial PTS may arrive later than the first VTT fragments are loaded.\n    // Parse any unparsed fragments upon receiving the initial PTS.\n    if (this.unparsedVttFrags.length) {\n      this.unparsedVttFrags.forEach(frag => {\n        this.onFragLoaded(frag);\n      });\n      this.unparsedVttFrags = [];\n    }\n  }\n\n  getExistingTrack (trackName) {\n    const { media } = this;\n    if (media) {\n      for (let i = 0; i < media.textTracks.length; i++) {\n        let textTrack = media.textTracks[i];\n        if (textTrack[trackName])\n          return textTrack;\n      }\n    }\n    return null;\n  }\n\n  createCaptionsTrack (trackName) {\n    const { label, languageCode } = this.captionsProperties[trackName];\n    const captionsTracks = this.captionsTracks;\n    if (!captionsTracks[trackName]) {\n      // Enable reuse of existing text track.\n      const existingTrack = this.getExistingTrack(trackName);\n      if (!existingTrack) {\n        const textTrack = this.createTextTrack('captions', label, languageCode);\n        if (textTrack) {\n          // Set a special property on the track so we know it's managed by Hls.js\n          textTrack[trackName] = true;\n          captionsTracks[trackName] = textTrack;\n        }\n      } else {\n        captionsTracks[trackName] = existingTrack;\n        clearCurrentCues(captionsTracks[trackName]);\n        sendAddTrackEvent(captionsTracks[trackName], this.media);\n      }\n    }\n  }\n\n  createTextTrack (kind, label, lang) {\n    const media = this.media;\n    if (media)\n      return media.addTextTrack(kind, label, lang);\n  }\n\n  destroy () {\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  onMediaAttaching (data) {\n    this.media = data.media;\n    this._cleanTracks();\n  }\n\n  onMediaDetaching () {\n    const { captionsTracks } = this;\n    Object.keys(captionsTracks).forEach(trackName => {\n      clearCurrentCues(captionsTracks[trackName]);\n      delete captionsTracks[trackName];\n    });\n  }\n\n  onManifestLoading () {\n    this.lastSn = -1; // Detect discontiguity in fragment parsing\n    this.prevCC = -1;\n    this.vttCCs = { ccOffset: 0, presentationOffset: 0 }; // Detect discontinuity in subtitle manifests\n    this._cleanTracks();\n  }\n\n  _cleanTracks () {\n    // clear outdated subtitles\n    const media = this.media;\n    if (media) {\n      const textTracks = media.textTracks;\n      if (textTracks) {\n        for (let i = 0; i < textTracks.length; i++)\n          clearCurrentCues(textTracks[i]);\n      }\n    }\n  }\n\n  onManifestLoaded (data) {\n    this.textTracks = [];\n    this.unparsedVttFrags = this.unparsedVttFrags || [];\n    this.initPTS = undefined;\n    this.cueRanges = [];\n\n    if (this.config.enableWebVTT) {\n      this.tracks = data.subtitles || [];\n      const inUseTracks = this.media ? this.media.textTracks : [];\n\n      this.tracks.forEach((track, index) => {\n        let textTrack;\n        if (index < inUseTracks.length) {\n          const inUseTrack = inUseTracks[index];\n          // Reuse tracks with the same label, but do not reuse 608/708 tracks\n          if (reuseVttTextTrack(inUseTrack, track))\n            textTrack = inUseTrack;\n        }\n        if (!textTrack)\n          textTrack = this.createTextTrack('subtitles', track.name, track.lang);\n\n        if (track.default)\n          textTrack.mode = this.hls.subtitleDisplay ? 'showing' : 'hidden';\n        else\n          textTrack.mode = 'disabled';\n\n        this.textTracks.push(textTrack);\n      });\n    }\n  }\n\n  onLevelSwitching () {\n    this.enabled = this.hls.currentLevel.closedCaptions !== 'NONE';\n  }\n\n  onFragLoaded (data) {\n    let frag = data.frag,\n      payload = data.payload;\n    if (frag.type === 'main') {\n      let sn = frag.sn;\n      // if this frag isn't contiguous, clear the parser so cues with bad start/end times aren't added to the textTrack\n      if (sn !== this.lastSn + 1) {\n        const cea608Parser = this.cea608Parser;\n        if (cea608Parser)\n          cea608Parser.reset();\n      }\n      this.lastSn = sn;\n    } // eslint-disable-line brace-style\n    // If fragment is subtitle type, parse as WebVTT.\n    else if (frag.type === 'subtitle') {\n      if (payload.byteLength) {\n        // We need an initial synchronisation PTS. Store fragments as long as none has arrived.\n        if (typeof this.initPTS === 'undefined') {\n          this.unparsedVttFrags.push(data);\n          return;\n        }\n\n        let decryptData = frag.decryptdata;\n        // If the subtitles are not encrypted, parse VTTs now. Otherwise, we need to wait.\n        if ((decryptData == null) || (decryptData.key == null) || (decryptData.method !== 'AES-128'))\n          this._parseVTTs(frag, payload);\n      } else {\n        // In case there is no payload, finish unsuccessfully.\n        this.hls.trigger(Event.SUBTITLE_FRAG_PROCESSED, { success: false, frag: frag });\n      }\n    }\n  }\n\n  _parseVTTs (frag, payload) {\n    let vttCCs = this.vttCCs;\n    if (!vttCCs[frag.cc]) {\n      vttCCs[frag.cc] = { start: frag.start, prevCC: this.prevCC, new: true };\n      this.prevCC = frag.cc;\n    }\n    let textTracks = this.textTracks,\n      hls = this.hls;\n\n    // Parse the WebVTT file contents.\n    WebVTTParser.parse(payload, this.initPTS, vttCCs, frag.cc, function (cues) {\n      const currentTrack = textTracks[frag.trackId];\n      // WebVTTParser.parse is an async method and if the currently selected text track mode is set to \"disabled\"\n      // before parsing is done then don't try to access currentTrack.cues.getCueById as cues will be null\n      // and trying to access getCueById method of cues will throw an exception\n      if (currentTrack.mode === 'disabled') {\n        hls.trigger(Event.SUBTITLE_FRAG_PROCESSED, { success: false, frag: frag });\n        return;\n      }\n      // Add cues and trigger event with success true.\n      cues.forEach(cue => {\n        // Sometimes there are cue overlaps on segmented vtts so the same\n        // cue can appear more than once in different vtt files.\n        // This avoid showing duplicated cues with same timecode and text.\n        if (!currentTrack.cues.getCueById(cue.id)) {\n          try {\n            currentTrack.addCue(cue);\n          } catch (err) {\n            const textTrackCue = new window.TextTrackCue(cue.startTime, cue.endTime, cue.text);\n            textTrackCue.id = cue.id;\n            currentTrack.addCue(textTrackCue);\n          }\n        }\n      }\n      );\n      hls.trigger(Event.SUBTITLE_FRAG_PROCESSED, { success: true, frag: frag });\n    },\n    function (e) {\n      // Something went wrong while parsing. Trigger event with success false.\n      logger.log(`Failed to parse VTT cue: ${e}`);\n      hls.trigger(Event.SUBTITLE_FRAG_PROCESSED, { success: false, frag: frag });\n    });\n  }\n\n  onFragDecrypted (data) {\n    let decryptedData = data.payload,\n      frag = data.frag;\n\n    if (frag.type === 'subtitle') {\n      if (typeof this.initPTS === 'undefined') {\n        this.unparsedVttFrags.push(data);\n        return;\n      }\n\n      this._parseVTTs(frag, decryptedData);\n    }\n  }\n\n  onFragParsingUserdata (data) {\n    // push all of the CEA-708 messages into the interpreter\n    // immediately. It will create the proper timestamps based on our PTS value\n    if (this.enabled && this.config.enableCEA708Captions) {\n      for (let i = 0; i < data.samples.length; i++) {\n        let ccdatas = this.extractCea608Data(data.samples[i].bytes);\n        this.cea608Parser.addData(data.samples[i].pts, ccdatas);\n      }\n    }\n  }\n\n  extractCea608Data (byteArray) {\n    let count = byteArray[0] & 31;\n    let position = 2;\n    let tmpByte, ccbyte1, ccbyte2, ccValid, ccType;\n    let actualCCBytes = [];\n\n    for (let j = 0; j < count; j++) {\n      tmpByte = byteArray[position++];\n      ccbyte1 = 0x7F & byteArray[position++];\n      ccbyte2 = 0x7F & byteArray[position++];\n      ccValid = (4 & tmpByte) !== 0;\n      ccType = 3 & tmpByte;\n\n      if (ccbyte1 === 0 && ccbyte2 === 0)\n        continue;\n\n      if (ccValid) {\n        if (ccType === 0) { // || ccType === 1\n          actualCCBytes.push(ccbyte1);\n          actualCCBytes.push(ccbyte2);\n        }\n      }\n    }\n    return actualCCBytes;\n  }\n}\n\nexport default TimelineController;\n","export default class AESCrypto {\n  constructor (subtle, iv) {\n    this.subtle = subtle;\n    this.aesIV = iv;\n  }\n\n  decrypt (data, key) {\n    return this.subtle.decrypt({ name: 'AES-CBC', iv: this.aesIV }, key, data);\n  }\n}\n","// PKCS7\nexport function removePadding (buffer) {\n  const outputBytes = buffer.byteLength;\n  const paddingBytes = outputBytes && (new DataView(buffer)).getUint8(outputBytes - 1);\n  if (paddingBytes)\n    return buffer.slice(0, outputBytes - paddingBytes);\n  else\n    return buffer;\n}\n\nclass AESDecryptor {\n  constructor () {\n    // Static after running initTable\n    this.rcon = [0x0, 0x1, 0x2, 0x4, 0x8, 0x10, 0x20, 0x40, 0x80, 0x1b, 0x36];\n    this.subMix = [new Uint32Array(256), new Uint32Array(256), new Uint32Array(256), new Uint32Array(256)];\n    this.invSubMix = [new Uint32Array(256), new Uint32Array(256), new Uint32Array(256), new Uint32Array(256)];\n    this.sBox = new Uint32Array(256);\n    this.invSBox = new Uint32Array(256);\n\n    // Changes during runtime\n    this.key = new Uint32Array(0);\n\n    this.initTable();\n  }\n\n  // Using view.getUint32() also swaps the byte order.\n  uint8ArrayToUint32Array_ (arrayBuffer) {\n    let view = new DataView(arrayBuffer);\n    let newArray = new Uint32Array(4);\n    for (let i = 0; i < 4; i++)\n      newArray[i] = view.getUint32(i * 4);\n\n    return newArray;\n  }\n\n  initTable () {\n    let sBox = this.sBox;\n    let invSBox = this.invSBox;\n    let subMix = this.subMix;\n    let subMix0 = subMix[0];\n    let subMix1 = subMix[1];\n    let subMix2 = subMix[2];\n    let subMix3 = subMix[3];\n    let invSubMix = this.invSubMix;\n    let invSubMix0 = invSubMix[0];\n    let invSubMix1 = invSubMix[1];\n    let invSubMix2 = invSubMix[2];\n    let invSubMix3 = invSubMix[3];\n\n    let d = new Uint32Array(256);\n    let x = 0;\n    let xi = 0;\n    let i = 0;\n    for (i = 0; i < 256; i++) {\n      if (i < 128)\n        d[i] = i << 1;\n      else\n        d[i] = (i << 1) ^ 0x11b;\n    }\n\n    for (i = 0; i < 256; i++) {\n      let sx = xi ^ (xi << 1) ^ (xi << 2) ^ (xi << 3) ^ (xi << 4);\n      sx = (sx >>> 8) ^ (sx & 0xff) ^ 0x63;\n      sBox[x] = sx;\n      invSBox[sx] = x;\n\n      // Compute multiplication\n      let x2 = d[x];\n      let x4 = d[x2];\n      let x8 = d[x4];\n\n      // Compute sub/invSub bytes, mix columns tables\n      let t = (d[sx] * 0x101) ^ (sx * 0x1010100);\n      subMix0[x] = (t << 24) | (t >>> 8);\n      subMix1[x] = (t << 16) | (t >>> 16);\n      subMix2[x] = (t << 8) | (t >>> 24);\n      subMix3[x] = t;\n\n      // Compute inv sub bytes, inv mix columns tables\n      t = (x8 * 0x1010101) ^ (x4 * 0x10001) ^ (x2 * 0x101) ^ (x * 0x1010100);\n      invSubMix0[sx] = (t << 24) | (t >>> 8);\n      invSubMix1[sx] = (t << 16) | (t >>> 16);\n      invSubMix2[sx] = (t << 8) | (t >>> 24);\n      invSubMix3[sx] = t;\n\n      // Compute next counter\n      if (!x) {\n        x = xi = 1;\n      } else {\n        x = x2 ^ d[d[d[x8 ^ x2]]];\n        xi ^= d[d[xi]];\n      }\n    }\n  }\n\n  expandKey (keyBuffer) {\n    // convert keyBuffer to Uint32Array\n    let key = this.uint8ArrayToUint32Array_(keyBuffer);\n    let sameKey = true;\n    let offset = 0;\n\n    while (offset < key.length && sameKey) {\n      sameKey = (key[offset] === this.key[offset]);\n      offset++;\n    }\n\n    if (sameKey)\n      return;\n\n    this.key = key;\n    let keySize = this.keySize = key.length;\n\n    if (keySize !== 4 && keySize !== 6 && keySize !== 8)\n      throw new Error('Invalid aes key size=' + keySize);\n\n    let ksRows = this.ksRows = (keySize + 6 + 1) * 4;\n    let ksRow;\n    let invKsRow;\n\n    let keySchedule = this.keySchedule = new Uint32Array(ksRows);\n    let invKeySchedule = this.invKeySchedule = new Uint32Array(ksRows);\n    let sbox = this.sBox;\n    let rcon = this.rcon;\n\n    let invSubMix = this.invSubMix;\n    let invSubMix0 = invSubMix[0];\n    let invSubMix1 = invSubMix[1];\n    let invSubMix2 = invSubMix[2];\n    let invSubMix3 = invSubMix[3];\n\n    let prev;\n    let t;\n\n    for (ksRow = 0; ksRow < ksRows; ksRow++) {\n      if (ksRow < keySize) {\n        prev = keySchedule[ksRow] = key[ksRow];\n        continue;\n      }\n      t = prev;\n\n      if (ksRow % keySize === 0) {\n        // Rot word\n        t = (t << 8) | (t >>> 24);\n\n        // Sub word\n        t = (sbox[t >>> 24] << 24) | (sbox[(t >>> 16) & 0xff] << 16) | (sbox[(t >>> 8) & 0xff] << 8) | sbox[t & 0xff];\n\n        // Mix Rcon\n        t ^= rcon[(ksRow / keySize) | 0] << 24;\n      } else if (keySize > 6 && ksRow % keySize === 4) {\n        // Sub word\n        t = (sbox[t >>> 24] << 24) | (sbox[(t >>> 16) & 0xff] << 16) | (sbox[(t >>> 8) & 0xff] << 8) | sbox[t & 0xff];\n      }\n\n      keySchedule[ksRow] = prev = (keySchedule[ksRow - keySize] ^ t) >>> 0;\n    }\n\n    for (invKsRow = 0; invKsRow < ksRows; invKsRow++) {\n      ksRow = ksRows - invKsRow;\n      if (invKsRow & 3)\n        t = keySchedule[ksRow];\n      else\n        t = keySchedule[ksRow - 4];\n\n      if (invKsRow < 4 || ksRow <= 4)\n        invKeySchedule[invKsRow] = t;\n      else\n        invKeySchedule[invKsRow] = invSubMix0[sbox[t >>> 24]] ^ invSubMix1[sbox[(t >>> 16) & 0xff]] ^ invSubMix2[sbox[(t >>> 8) & 0xff]] ^ invSubMix3[sbox[t & 0xff]];\n\n      invKeySchedule[invKsRow] = invKeySchedule[invKsRow] >>> 0;\n    }\n  }\n\n  // Adding this as a method greatly improves performance.\n  networkToHostOrderSwap (word) {\n    return (word << 24) | ((word & 0xff00) << 8) | ((word & 0xff0000) >> 8) | (word >>> 24);\n  }\n\n  decrypt (inputArrayBuffer, offset, aesIV, removePKCS7Padding) {\n    let nRounds = this.keySize + 6;\n    let invKeySchedule = this.invKeySchedule;\n    let invSBOX = this.invSBox;\n\n    let invSubMix = this.invSubMix;\n    let invSubMix0 = invSubMix[0];\n    let invSubMix1 = invSubMix[1];\n    let invSubMix2 = invSubMix[2];\n    let invSubMix3 = invSubMix[3];\n\n    let initVector = this.uint8ArrayToUint32Array_(aesIV);\n    let initVector0 = initVector[0];\n    let initVector1 = initVector[1];\n    let initVector2 = initVector[2];\n    let initVector3 = initVector[3];\n\n    let inputInt32 = new Int32Array(inputArrayBuffer);\n    let outputInt32 = new Int32Array(inputInt32.length);\n\n    let t0, t1, t2, t3;\n    let s0, s1, s2, s3;\n    let inputWords0, inputWords1, inputWords2, inputWords3;\n\n    let ksRow, i;\n    let swapWord = this.networkToHostOrderSwap;\n\n    while (offset < inputInt32.length) {\n      inputWords0 = swapWord(inputInt32[offset]);\n      inputWords1 = swapWord(inputInt32[offset + 1]);\n      inputWords2 = swapWord(inputInt32[offset + 2]);\n      inputWords3 = swapWord(inputInt32[offset + 3]);\n\n      s0 = inputWords0 ^ invKeySchedule[0];\n      s1 = inputWords3 ^ invKeySchedule[1];\n      s2 = inputWords2 ^ invKeySchedule[2];\n      s3 = inputWords1 ^ invKeySchedule[3];\n\n      ksRow = 4;\n\n      // Iterate through the rounds of decryption\n      for (i = 1; i < nRounds; i++) {\n        t0 = invSubMix0[s0 >>> 24] ^ invSubMix1[(s1 >> 16) & 0xff] ^ invSubMix2[(s2 >> 8) & 0xff] ^ invSubMix3[s3 & 0xff] ^ invKeySchedule[ksRow];\n        t1 = invSubMix0[s1 >>> 24] ^ invSubMix1[(s2 >> 16) & 0xff] ^ invSubMix2[(s3 >> 8) & 0xff] ^ invSubMix3[s0 & 0xff] ^ invKeySchedule[ksRow + 1];\n        t2 = invSubMix0[s2 >>> 24] ^ invSubMix1[(s3 >> 16) & 0xff] ^ invSubMix2[(s0 >> 8) & 0xff] ^ invSubMix3[s1 & 0xff] ^ invKeySchedule[ksRow + 2];\n        t3 = invSubMix0[s3 >>> 24] ^ invSubMix1[(s0 >> 16) & 0xff] ^ invSubMix2[(s1 >> 8) & 0xff] ^ invSubMix3[s2 & 0xff] ^ invKeySchedule[ksRow + 3];\n        // Update state\n        s0 = t0;\n        s1 = t1;\n        s2 = t2;\n        s3 = t3;\n\n        ksRow = ksRow + 4;\n      }\n\n      // Shift rows, sub bytes, add round key\n      t0 = ((invSBOX[s0 >>> 24] << 24) ^ (invSBOX[(s1 >> 16) & 0xff] << 16) ^ (invSBOX[(s2 >> 8) & 0xff] << 8) ^ invSBOX[s3 & 0xff]) ^ invKeySchedule[ksRow];\n      t1 = ((invSBOX[s1 >>> 24] << 24) ^ (invSBOX[(s2 >> 16) & 0xff] << 16) ^ (invSBOX[(s3 >> 8) & 0xff] << 8) ^ invSBOX[s0 & 0xff]) ^ invKeySchedule[ksRow + 1];\n      t2 = ((invSBOX[s2 >>> 24] << 24) ^ (invSBOX[(s3 >> 16) & 0xff] << 16) ^ (invSBOX[(s0 >> 8) & 0xff] << 8) ^ invSBOX[s1 & 0xff]) ^ invKeySchedule[ksRow + 2];\n      t3 = ((invSBOX[s3 >>> 24] << 24) ^ (invSBOX[(s0 >> 16) & 0xff] << 16) ^ (invSBOX[(s1 >> 8) & 0xff] << 8) ^ invSBOX[s2 & 0xff]) ^ invKeySchedule[ksRow + 3];\n      ksRow = ksRow + 3;\n\n      // Write\n      outputInt32[offset] = swapWord(t0 ^ initVector0);\n      outputInt32[offset + 1] = swapWord(t3 ^ initVector1);\n      outputInt32[offset + 2] = swapWord(t2 ^ initVector2);\n      outputInt32[offset + 3] = swapWord(t1 ^ initVector3);\n\n      // reset initVector to last 4 unsigned int\n      initVector0 = inputWords0;\n      initVector1 = inputWords1;\n      initVector2 = inputWords2;\n      initVector3 = inputWords3;\n\n      offset = offset + 4;\n    }\n\n    return removePKCS7Padding ? removePadding(outputInt32.buffer) : outputInt32.buffer;\n  }\n\n  destroy () {\n    this.key = undefined;\n    this.keySize = undefined;\n    this.ksRows = undefined;\n\n    this.sBox = undefined;\n    this.invSBox = undefined;\n    this.subMix = undefined;\n    this.invSubMix = undefined;\n    this.keySchedule = undefined;\n    this.invKeySchedule = undefined;\n\n    this.rcon = undefined;\n  }\n}\n\nexport default AESDecryptor;\n","import AESCrypto from './aes-crypto';\nimport FastAESKey from './fast-aes-key';\nimport AESDecryptor from './aes-decryptor';\n\nimport { ErrorTypes, ErrorDetails } from '../errors';\nimport { logger } from '../utils/logger';\n\n/* globals self: false */\n\nclass Decrypter {\n  constructor (observer, config, { removePKCS7Padding = true } = {}) {\n    this.logEnabled = true;\n    this.observer = observer;\n    this.config = config;\n    this.removePKCS7Padding = removePKCS7Padding;\n    // built in decryptor expects PKCS7 padding\n    if (removePKCS7Padding) {\n      try {\n        const browserCrypto = crypto || self.crypto;\n        this.subtle = browserCrypto.subtle || browserCrypto.webkitSubtle;\n      } catch (e) {}\n    }\n    this.disableWebCrypto = !this.subtle;\n  }\n\n  isSync () {\n    return (this.disableWebCrypto && this.config.enableSoftwareAES);\n  }\n\n  decrypt (data, key, iv, callback) {\n    if (this.disableWebCrypto && this.config.enableSoftwareAES) {\n      if (this.logEnabled) {\n        logger.log('JS AES decrypt');\n        this.logEnabled = false;\n      }\n      let decryptor = this.decryptor;\n      if (!decryptor)\n        this.decryptor = decryptor = new AESDecryptor();\n\n      decryptor.expandKey(key);\n      callback(decryptor.decrypt(data, 0, iv, this.removePKCS7Padding));\n    } else {\n      if (this.logEnabled) {\n        logger.log('WebCrypto AES decrypt');\n        this.logEnabled = false;\n      }\n      const subtle = this.subtle;\n      if (this.key !== key) {\n        this.key = key;\n        this.fastAesKey = new FastAESKey(subtle, key);\n      }\n\n      this.fastAesKey.expandKey()\n        .then((aesKey) => {\n          // decrypt using web crypto\n          let crypto = new AESCrypto(subtle, iv);\n          crypto.decrypt(data, aesKey)\n            .catch((err) => {\n              this.onWebCryptoError(err, data, key, iv, callback);\n            })\n            .then((result) => {\n              callback(result);\n            });\n        })\n        .catch((err) => {\n          this.onWebCryptoError(err, data, key, iv, callback);\n        });\n    }\n  }\n\n  onWebCryptoError (err, data, key, iv, callback) {\n    if (this.config.enableSoftwareAES) {\n      logger.log('WebCrypto Error, disable WebCrypto API');\n      this.disableWebCrypto = true;\n      this.logEnabled = true;\n      this.decrypt(data, key, iv, callback);\n    } else {\n      logger.error(`decrypting error : ${err.message}`);\n      this.observer.trigger(Event.ERROR, { type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.FRAG_DECRYPT_ERROR, fatal: true, reason: err.message });\n    }\n  }\n\n  destroy () {\n    let decryptor = this.decryptor;\n    if (decryptor) {\n      decryptor.destroy();\n      this.decryptor = undefined;\n    }\n  }\n}\n\nexport default Decrypter;\n","class FastAESKey {\n  constructor (subtle, key) {\n    this.subtle = subtle;\n    this.key = key;\n  }\n\n  expandKey () {\n    return this.subtle.importKey('raw', this.key, { name: 'AES-CBC' }, false, ['encrypt', 'decrypt']);\n  }\n}\n\nexport default FastAESKey;\n","/**\n * AAC demuxer\n */\nimport * as ADTS from './adts';\nimport { logger } from '../utils/logger';\nimport ID3 from '../demux/id3';\n\nclass AACDemuxer {\n  constructor (observer, remuxer, config) {\n    this.observer = observer;\n    this.config = config;\n    this.remuxer = remuxer;\n  }\n\n  resetInitSegment (initSegment, audioCodec, videoCodec, duration) {\n    this._audioTrack = { container: 'audio/adts', type: 'audio', id: 0, sequenceNumber: 0, isAAC: true, samples: [], len: 0, manifestCodec: audioCodec, duration: duration, inputTimeScale: 90000 };\n  }\n\n  resetTimeStamp () {\n  }\n\n  static probe (data) {\n    if (!data)\n      return false;\n\n    // Check for the ADTS sync word\n    // Look for ADTS header | 1111 1111 | 1111 X00X | where X can be either 0 or 1\n    // Layer bits (position 14 and 15) in header should be always 0 for ADTS\n    // More info https://wiki.multimedia.cx/index.php?title=ADTS\n    const id3Data = ID3.getID3Data(data, 0) || [];\n    let offset = id3Data.length;\n\n    for (let length = data.length; offset < length; offset++) {\n      if (ADTS.probe(data, offset)) {\n        logger.log('ADTS sync word found !');\n        return true;\n      }\n    }\n    return false;\n  }\n\n  // feed incoming data to the front of the parsing pipeline\n  append (data, timeOffset, contiguous, accurateTimeOffset) {\n    let track = this._audioTrack;\n    let id3Data = ID3.getID3Data(data, 0) || [];\n    let timestamp = ID3.getTimeStamp(id3Data);\n    let pts = timestamp ? 90 * timestamp : timeOffset * 90000;\n    let frameIndex = 0;\n    let stamp = pts;\n    let length = data.length;\n    let offset = id3Data.length;\n\n    let id3Samples = [{ pts: stamp, dts: stamp, data: id3Data }];\n\n    while (offset < length - 1) {\n      if (ADTS.isHeader(data, offset) && (offset + 5) < length) {\n        ADTS.initTrackConfig(track, this.observer, data, offset, track.manifestCodec);\n        let frame = ADTS.appendFrame(track, data, offset, pts, frameIndex);\n        if (frame) {\n          offset += frame.length;\n          stamp = frame.sample.pts;\n          frameIndex++;\n        } else {\n          logger.log('Unable to parse AAC frame');\n          break;\n        }\n      } else if (ID3.isHeader(data, offset)) {\n        id3Data = ID3.getID3Data(data, offset);\n        id3Samples.push({ pts: stamp, dts: stamp, data: id3Data });\n        offset += id3Data.length;\n      } else {\n        // nothing found, keep looking\n        offset++;\n      }\n    }\n\n    this.remuxer.remux(track,\n      { samples: [] },\n      { samples: id3Samples, inputTimeScale: 90000 },\n      { samples: [] },\n      timeOffset,\n      contiguous,\n      accurateTimeOffset);\n  }\n\n  destroy () {\n  }\n}\n\nexport default AACDemuxer;\n","/**\n *  ADTS parser helper\n */\nimport { logger } from '../utils/logger';\nimport { ErrorTypes, ErrorDetails } from '../errors';\n\nexport function getAudioConfig (observer, data, offset, audioCodec) {\n  let adtsObjectType, // :int\n    adtsSampleingIndex, // :int\n    adtsExtensionSampleingIndex, // :int\n    adtsChanelConfig, // :int\n    config,\n    userAgent = navigator.userAgent.toLowerCase(),\n    manifestCodec = audioCodec,\n    adtsSampleingRates = [\n      96000, 88200,\n      64000, 48000,\n      44100, 32000,\n      24000, 22050,\n      16000, 12000,\n      11025, 8000,\n      7350];\n  // byte 2\n  adtsObjectType = ((data[offset + 2] & 0xC0) >>> 6) + 1;\n  adtsSampleingIndex = ((data[offset + 2] & 0x3C) >>> 2);\n  if (adtsSampleingIndex > adtsSampleingRates.length - 1) {\n    observer.trigger(Event.ERROR, { type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.FRAG_PARSING_ERROR, fatal: true, reason: `invalid ADTS sampling index:${adtsSampleingIndex}` });\n    return;\n  }\n  adtsChanelConfig = ((data[offset + 2] & 0x01) << 2);\n  // byte 3\n  adtsChanelConfig |= ((data[offset + 3] & 0xC0) >>> 6);\n  logger.log(`manifest codec:${audioCodec},ADTS data:type:${adtsObjectType},sampleingIndex:${adtsSampleingIndex}[${adtsSampleingRates[adtsSampleingIndex]}Hz],channelConfig:${adtsChanelConfig}`);\n  // firefox: freq less than 24kHz = AAC SBR (HE-AAC)\n  if (/firefox/i.test(userAgent)) {\n    if (adtsSampleingIndex >= 6) {\n      adtsObjectType = 5;\n      config = new Array(4);\n      // HE-AAC uses SBR (Spectral Band Replication) , high frequencies are constructed from low frequencies\n      // there is a factor 2 between frame sample rate and output sample rate\n      // multiply frequency by 2 (see table below, equivalent to substract 3)\n      adtsExtensionSampleingIndex = adtsSampleingIndex - 3;\n    } else {\n      adtsObjectType = 2;\n      config = new Array(2);\n      adtsExtensionSampleingIndex = adtsSampleingIndex;\n    }\n    // Android : always use AAC\n  } else if (userAgent.indexOf('android') !== -1) {\n    adtsObjectType = 2;\n    config = new Array(2);\n    adtsExtensionSampleingIndex = adtsSampleingIndex;\n  } else {\n    /*  for other browsers (Chrome/Vivaldi/Opera ...)\n        always force audio type to be HE-AAC SBR, as some browsers do not support audio codec switch properly (like Chrome ...)\n    */\n    adtsObjectType = 5;\n    config = new Array(4);\n    // if (manifest codec is HE-AAC or HE-AACv2) OR (manifest codec not specified AND frequency less than 24kHz)\n    if ((audioCodec && ((audioCodec.indexOf('mp4a.40.29') !== -1) ||\n      (audioCodec.indexOf('mp4a.40.5') !== -1))) ||\n      (!audioCodec && adtsSampleingIndex >= 6)) {\n      // HE-AAC uses SBR (Spectral Band Replication) , high frequencies are constructed from low frequencies\n      // there is a factor 2 between frame sample rate and output sample rate\n      // multiply frequency by 2 (see table below, equivalent to substract 3)\n      adtsExtensionSampleingIndex = adtsSampleingIndex - 3;\n    } else {\n      // if (manifest codec is AAC) AND (frequency less than 24kHz AND nb channel is 1) OR (manifest codec not specified and mono audio)\n      // Chrome fails to play back with low frequency AAC LC mono when initialized with HE-AAC.  This is not a problem with stereo.\n      if (audioCodec && audioCodec.indexOf('mp4a.40.2') !== -1 && ((adtsSampleingIndex >= 6 && adtsChanelConfig === 1) ||\n            /vivaldi/i.test(userAgent)) ||\n        (!audioCodec && adtsChanelConfig === 1)) {\n        adtsObjectType = 2;\n        config = new Array(2);\n      }\n      adtsExtensionSampleingIndex = adtsSampleingIndex;\n    }\n  }\n  /* refer to http://wiki.multimedia.cx/index.php?title=MPEG-4_Audio#Audio_Specific_Config\n      ISO 14496-3 (AAC).pdf - Table 1.13  Syntax of AudioSpecificConfig()\n    Audio Profile / Audio Object Type\n    0: Null\n    1: AAC Main\n    2: AAC LC (Low Complexity)\n    3: AAC SSR (Scalable Sample Rate)\n    4: AAC LTP (Long Term Prediction)\n    5: SBR (Spectral Band Replication)\n    6: AAC Scalable\n   sampling freq\n    0: 96000 Hz\n    1: 88200 Hz\n    2: 64000 Hz\n    3: 48000 Hz\n    4: 44100 Hz\n    5: 32000 Hz\n    6: 24000 Hz\n    7: 22050 Hz\n    8: 16000 Hz\n    9: 12000 Hz\n    10: 11025 Hz\n    11: 8000 Hz\n    12: 7350 Hz\n    13: Reserved\n    14: Reserved\n    15: frequency is written explictly\n    Channel Configurations\n    These are the channel configurations:\n    0: Defined in AOT Specifc Config\n    1: 1 channel: front-center\n    2: 2 channels: front-left, front-right\n  */\n  // audioObjectType = profile => profile, the MPEG-4 Audio Object Type minus 1\n  config[0] = adtsObjectType << 3;\n  // samplingFrequencyIndex\n  config[0] |= (adtsSampleingIndex & 0x0E) >> 1;\n  config[1] |= (adtsSampleingIndex & 0x01) << 7;\n  // channelConfiguration\n  config[1] |= adtsChanelConfig << 3;\n  if (adtsObjectType === 5) {\n    // adtsExtensionSampleingIndex\n    config[1] |= (adtsExtensionSampleingIndex & 0x0E) >> 1;\n    config[2] = (adtsExtensionSampleingIndex & 0x01) << 7;\n    // adtsObjectType (force to 2, chrome is checking that object type is less than 5 ???\n    //    https://chromium.googlesource.com/chromium/src.git/+/master/media/formats/mp4/aac.cc\n    config[2] |= 2 << 2;\n    config[3] = 0;\n  }\n  return { config: config, samplerate: adtsSampleingRates[adtsSampleingIndex], channelCount: adtsChanelConfig, codec: ('mp4a.40.' + adtsObjectType), manifestCodec: manifestCodec };\n}\n\nexport function isHeaderPattern (data, offset) {\n  return data[offset] === 0xff && (data[offset + 1] & 0xf6) === 0xf0;\n}\n\nexport function getHeaderLength (data, offset) {\n  return (data[offset + 1] & 0x01 ? 7 : 9);\n}\n\nexport function getFullFrameLength (data, offset) {\n  return ((data[offset + 3] & 0x03) << 11) |\n    (data[offset + 4] << 3) |\n    ((data[offset + 5] & 0xE0) >>> 5);\n}\n\nexport function isHeader (data, offset) {\n  // Look for ADTS header | 1111 1111 | 1111 X00X | where X can be either 0 or 1\n  // Layer bits (position 14 and 15) in header should be always 0 for ADTS\n  // More info https://wiki.multimedia.cx/index.php?title=ADTS\n  if (offset + 1 < data.length && isHeaderPattern(data, offset))\n    return true;\n\n  return false;\n}\n\nexport function probe (data, offset) {\n  // same as isHeader but we also check that ADTS frame follows last ADTS frame\n  // or end of data is reached\n  if (offset + 1 < data.length && isHeaderPattern(data, offset)) {\n    // ADTS header Length\n    let headerLength = getHeaderLength(data, offset);\n    // ADTS frame Length\n    let frameLength = headerLength;\n    if (offset + 5 < data.length)\n      frameLength = getFullFrameLength(data, offset);\n\n    let newOffset = offset + frameLength;\n    if (newOffset === data.length || (newOffset + 1 < data.length && isHeaderPattern(data, newOffset)))\n      return true;\n  }\n  return false;\n}\n\nexport function initTrackConfig (track, observer, data, offset, audioCodec) {\n  if (!track.samplerate) {\n    let config = getAudioConfig(observer, data, offset, audioCodec);\n    track.config = config.config;\n    track.samplerate = config.samplerate;\n    track.channelCount = config.channelCount;\n    track.codec = config.codec;\n    track.manifestCodec = config.manifestCodec;\n    logger.log(`parsed codec:${track.codec},rate:${config.samplerate},nb channel:${config.channelCount}`);\n  }\n}\n\nexport function getFrameDuration (samplerate) {\n  return 1024 * 90000 / samplerate;\n}\n\nexport function parseFrameHeader (data, offset, pts, frameIndex, frameDuration) {\n  let headerLength, frameLength, stamp;\n  let length = data.length;\n\n  // The protection skip bit tells us if we have 2 bytes of CRC data at the end of the ADTS header\n  headerLength = getHeaderLength(data, offset);\n  // retrieve frame size\n  frameLength = getFullFrameLength(data, offset);\n  frameLength -= headerLength;\n\n  if ((frameLength > 0) && ((offset + headerLength + frameLength) <= length)) {\n    stamp = pts + frameIndex * frameDuration;\n    // logger.log(`AAC frame, offset/length/total/pts:${offset+headerLength}/${frameLength}/${data.byteLength}/${(stamp/90).toFixed(0)}`);\n    return { headerLength, frameLength, stamp };\n  }\n\n  return undefined;\n}\n\nexport function appendFrame (track, data, offset, pts, frameIndex) {\n  let frameDuration = getFrameDuration(track.samplerate);\n  let header = parseFrameHeader(data, offset, pts, frameIndex, frameDuration);\n  if (header) {\n    let stamp = header.stamp;\n    let headerLength = header.headerLength;\n    let frameLength = header.frameLength;\n\n    // logger.log(`AAC frame, offset/length/total/pts:${offset+headerLength}/${frameLength}/${data.byteLength}/${(stamp/90).toFixed(0)}`);\n    let aacSample = {\n      unit: data.subarray(offset + headerLength, offset + headerLength + frameLength),\n      pts: stamp,\n      dts: stamp\n    };\n\n    track.samples.push(aacSample);\n    track.len += frameLength;\n\n    return { sample: aacSample, length: frameLength + headerLength };\n  }\n\n  return undefined;\n}\n","/*  inline demuxer.\n *   probe fragments and instantiate appropriate demuxer depending on content type (TSDemuxer, AACDemuxer, ...)\n */\n\nimport Event from '../events';\nimport { ErrorTypes, ErrorDetails } from '../errors';\nimport Decrypter from '../crypt/decrypter';\nimport AACDemuxer from '../demux/aacdemuxer';\nimport MP4Demuxer from '../demux/mp4demuxer';\nimport TSDemuxer from '../demux/tsdemuxer';\nimport MP3Demuxer from '../demux/mp3demuxer';\nimport MP4Remuxer from '../remux/mp4-remuxer';\nimport PassThroughRemuxer from '../remux/passthrough-remuxer';\n\nclass DemuxerInline {\n  constructor (observer, typeSupported, config, vendor) {\n    this.observer = observer;\n    this.typeSupported = typeSupported;\n    this.config = config;\n    this.vendor = vendor;\n  }\n\n  destroy () {\n    let demuxer = this.demuxer;\n    if (demuxer)\n      demuxer.destroy();\n  }\n\n  push (data, decryptdata, initSegment, audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset, defaultInitPTS) {\n    if ((data.byteLength > 0) && (decryptdata != null) && (decryptdata.key != null) && (decryptdata.method === 'AES-128')) {\n      let decrypter = this.decrypter;\n      if (decrypter == null)\n        decrypter = this.decrypter = new Decrypter(this.observer, this.config);\n\n      let localthis = this;\n      // performance.now() not available on WebWorker, at least on Safari Desktop\n      let startTime;\n      try {\n        startTime = performance.now();\n      } catch (error) {\n        startTime = Date.now();\n      }\n      decrypter.decrypt(data, decryptdata.key.buffer, decryptdata.iv.buffer, function (decryptedData) {\n        let endTime;\n        try {\n          endTime = performance.now();\n        } catch (error) {\n          endTime = Date.now();\n        }\n        localthis.observer.trigger(Event.FRAG_DECRYPTED, { stats: { tstart: startTime, tdecrypt: endTime } });\n        localthis.pushDecrypted(new Uint8Array(decryptedData), decryptdata, new Uint8Array(initSegment), audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset, defaultInitPTS);\n      });\n    } else {\n      this.pushDecrypted(new Uint8Array(data), decryptdata, new Uint8Array(initSegment), audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset, defaultInitPTS);\n    }\n  }\n\n  pushDecrypted (data, decryptdata, initSegment, audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset, defaultInitPTS) {\n    let demuxer = this.demuxer;\n    if (!demuxer ||\n      // in case of continuity change, or track switch\n      // we might switch from content type (AAC container to TS container, or TS to fmp4 for example)\n      // so let's check that current demuxer is still valid\n      ((discontinuity || trackSwitch) && !this.probe(data))) {\n      const observer = this.observer;\n      const typeSupported = this.typeSupported;\n      const config = this.config;\n      // probing order is TS/AAC/MP3/MP4\n      const muxConfig = [\n        { demux: TSDemuxer, remux: MP4Remuxer },\n        { demux: MP4Demuxer, remux: PassThroughRemuxer },\n        { demux: AACDemuxer, remux: MP4Remuxer },\n        { demux: MP3Demuxer, remux: MP4Remuxer }\n      ];\n\n      // probe for content type\n      for (let i = 0, len = muxConfig.length; i < len; i++) {\n        const mux = muxConfig[i];\n        const probe = mux.demux.probe;\n        if (probe(data)) {\n          const remuxer = this.remuxer = new mux.remux(observer, config, typeSupported, this.vendor);\n          demuxer = new mux.demux(observer, remuxer, config, typeSupported);\n          this.probe = probe;\n          break;\n        }\n      }\n      if (!demuxer) {\n        observer.trigger(Event.ERROR, { type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.FRAG_PARSING_ERROR, fatal: true, reason: 'no demux matching with content found' });\n        return;\n      }\n      this.demuxer = demuxer;\n    }\n    const remuxer = this.remuxer;\n\n    if (discontinuity || trackSwitch) {\n      demuxer.resetInitSegment(initSegment, audioCodec, videoCodec, duration);\n      remuxer.resetInitSegment();\n    }\n    if (discontinuity) {\n      demuxer.resetTimeStamp(defaultInitPTS);\n      remuxer.resetTimeStamp(defaultInitPTS);\n    }\n    if (typeof demuxer.setDecryptData === 'function')\n      demuxer.setDecryptData(decryptdata);\n\n    demuxer.append(data, timeOffset, contiguous, accurateTimeOffset);\n  }\n}\n\nexport default DemuxerInline;\n","/* demuxer web worker.\n *  - listen to worker message, and trigger DemuxerInline upon reception of Fragments.\n *  - provides MP4 Boxes back to main thread using [transferable objects](https://developers.google.com/web/updates/2011/12/Transferable-Objects-Lightning-Fast) in order to minimize message passing overhead.\n */\n\nimport DemuxerInline from '../demux/demuxer-inline';\nimport Event from '../events';\nimport { enableLogs } from '../utils/logger';\nimport EventEmitter from 'events';\n\nlet DemuxerWorker = function (self) {\n  // observer setup\n  let observer = new EventEmitter();\n  observer.trigger = function trigger (event, ...data) {\n    observer.emit(event, event, ...data);\n  };\n\n  observer.off = function off (event, ...data) {\n    observer.removeListener(event, ...data);\n  };\n\n  let forwardMessage = function (ev, data) {\n    self.postMessage({ event: ev, data: data });\n  };\n\n  self.addEventListener('message', function (ev) {\n    let data = ev.data;\n    // console.log('demuxer cmd:' + data.cmd);\n    switch (data.cmd) {\n    case 'init':\n      let config = JSON.parse(data.config);\n      self.demuxer = new DemuxerInline(observer, data.typeSupported, config, data.vendor);\n      try {\n        enableLogs(config.debug === true);\n      } catch (err) {\n        console.warn('demuxerWorker: unable to enable logs');\n      }\n      // signal end of worker init\n      forwardMessage('init', null);\n      break;\n    case 'demux':\n      self.demuxer.push(data.data, data.decryptdata, data.initSegment, data.audioCodec, data.videoCodec, data.timeOffset, data.discontinuity, data.trackSwitch, data.contiguous, data.duration, data.accurateTimeOffset, data.defaultInitPTS);\n      break;\n    default:\n      break;\n    }\n  });\n\n  // forward events to main thread\n  observer.on(Event.FRAG_DECRYPTED, forwardMessage);\n  observer.on(Event.FRAG_PARSING_INIT_SEGMENT, forwardMessage);\n  observer.on(Event.FRAG_PARSED, forwardMessage);\n  observer.on(Event.ERROR, forwardMessage);\n  observer.on(Event.FRAG_PARSING_METADATA, forwardMessage);\n  observer.on(Event.FRAG_PARSING_USERDATA, forwardMessage);\n  observer.on(Event.INIT_PTS_FOUND, forwardMessage);\n\n  // special case for FRAG_PARSING_DATA: pass data1/data2 as transferable object (no copy)\n  observer.on(Event.FRAG_PARSING_DATA, function (ev, data) {\n    let transferable = [];\n    let message = { event: ev, data: data };\n    if (data.data1) {\n      message.data1 = data.data1.buffer;\n      transferable.push(data.data1.buffer);\n      delete data.data1;\n    }\n    if (data.data2) {\n      message.data2 = data.data2.buffer;\n      transferable.push(data.data2.buffer);\n      delete data.data2;\n    }\n    self.postMessage(message, transferable);\n  });\n};\n\nexport default DemuxerWorker;\n","import Event from '../events';\nimport DemuxerInline from '../demux/demuxer-inline';\nimport DemuxerWorker from '../demux/demuxer-worker';\nimport { logger } from '../utils/logger';\nimport { ErrorTypes, ErrorDetails } from '../errors';\nimport EventEmitter from 'events';\nimport work from 'webworkify-webpack';\nimport { getMediaSource } from '../helper/mediasource-helper';\n\nconst MediaSource = getMediaSource();\n\nclass Demuxer {\n  constructor (hls, id) {\n    this.hls = hls;\n    this.id = id;\n    // observer setup\n    const observer = this.observer = new EventEmitter();\n    const config = hls.config;\n    observer.trigger = function trigger (event, ...data) {\n      observer.emit(event, event, ...data);\n    };\n\n    observer.off = function off (event, ...data) {\n      observer.removeListener(event, ...data);\n    };\n\n    let forwardMessage = function (ev, data) {\n      data = data || {};\n      data.frag = this.frag;\n      data.id = this.id;\n      hls.trigger(ev, data);\n    }.bind(this);\n\n    // forward events to main thread\n    observer.on(Event.FRAG_DECRYPTED, forwardMessage);\n    observer.on(Event.FRAG_PARSING_INIT_SEGMENT, forwardMessage);\n    observer.on(Event.FRAG_PARSING_DATA, forwardMessage);\n    observer.on(Event.FRAG_PARSED, forwardMessage);\n    observer.on(Event.ERROR, forwardMessage);\n    observer.on(Event.FRAG_PARSING_METADATA, forwardMessage);\n    observer.on(Event.FRAG_PARSING_USERDATA, forwardMessage);\n    observer.on(Event.INIT_PTS_FOUND, forwardMessage);\n\n    const typeSupported = {\n      mp4: MediaSource.isTypeSupported('video/mp4'),\n      mpeg: MediaSource.isTypeSupported('audio/mpeg'),\n      mp3: MediaSource.isTypeSupported('audio/mp4; codecs=\"mp3\"')\n    };\n    // navigator.vendor is not always available in Web Worker\n    // refer to https://developer.mozilla.org/en-US/docs/Web/API/WorkerGlobalScope/navigator\n    const vendor = navigator.vendor;\n    if (config.enableWorker && (typeof (Worker) !== 'undefined')) {\n      logger.log('demuxing in webworker');\n      let w;\n      try {\n        // new\n        let work = require('webworkify');\n        w = this.w = work(DemuxerWorker);\n        // old\n        //w = this.w = work(require.resolve('../demux/demuxer-worker.js'));\n\n        this.onwmsg = this.onWorkerMessage.bind(this);\n        w.addEventListener('message', this.onwmsg);\n        w.onerror = function (event) { hls.trigger(Event.ERROR, { type: ErrorTypes.OTHER_ERROR, details: ErrorDetails.INTERNAL_EXCEPTION, fatal: true, event: 'demuxerWorker', err: { message: event.message + ' (' + event.filename + ':' + event.lineno + ')' } }); };\n        w.postMessage({ cmd: 'init', typeSupported: typeSupported, vendor: vendor, id: id, config: JSON.stringify(config) });\n      } catch (err) {\n        logger.error('error while initializing DemuxerWorker, fallback on DemuxerInline');\n        if (w) {\n          // revoke the Object URL that was used to create demuxer worker, so as not to leak it\n          URL.revokeObjectURL(w.objectURL);\n        }\n        this.demuxer = new DemuxerInline(observer, typeSupported, config, vendor);\n        this.w = undefined;\n      }\n    } else {\n      this.demuxer = new DemuxerInline(observer, typeSupported, config, vendor);\n    }\n  }\n\n  destroy () {\n    let w = this.w;\n    if (w) {\n      w.removeEventListener('message', this.onwmsg);\n      w.terminate();\n      this.w = null;\n    } else {\n      let demuxer = this.demuxer;\n      if (demuxer) {\n        demuxer.destroy();\n        this.demuxer = null;\n      }\n    }\n    let observer = this.observer;\n    if (observer) {\n      observer.removeAllListeners();\n      this.observer = null;\n    }\n  }\n\n  push (data, initSegment, audioCodec, videoCodec, frag, duration, accurateTimeOffset, defaultInitPTS) {\n    const w = this.w;\n    const timeOffset = !isNaN(frag.startDTS) ? frag.startDTS : frag.start;\n    const decryptdata = frag.decryptdata;\n    const lastFrag = this.frag;\n    const discontinuity = !(lastFrag && (frag.cc === lastFrag.cc));\n    const trackSwitch = !(lastFrag && (frag.level === lastFrag.level));\n    const nextSN = lastFrag && (frag.sn === (lastFrag.sn + 1));\n    const contiguous = !trackSwitch && nextSN;\n    if (discontinuity)\n      logger.log(`${this.id}:discontinuity detected`);\n\n    if (trackSwitch)\n      logger.log(`${this.id}:switch detected`);\n\n    this.frag = frag;\n    if (w) {\n      // post fragment payload as transferable objects for ArrayBuffer (no copy)\n      w.postMessage({ cmd: 'demux', data, decryptdata, initSegment, audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset, defaultInitPTS }, data instanceof ArrayBuffer ? [data] : []);\n    } else {\n      let demuxer = this.demuxer;\n      if (demuxer)\n        demuxer.push(data, decryptdata, initSegment, audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset, defaultInitPTS);\n    }\n  }\n\n  onWorkerMessage (ev) {\n    let data = ev.data,\n      hls = this.hls;\n    switch (data.event) {\n    case 'init':\n      // revoke the Object URL that was used to create demuxer worker, so as not to leak it\n      URL.revokeObjectURL(this.w.objectURL);\n      break;\n      // special case for FRAG_PARSING_DATA: data1 and data2 are transferable objects\n    case Event.FRAG_PARSING_DATA:\n      data.data.data1 = new Uint8Array(data.data1);\n      if (data.data2)\n        data.data.data2 = new Uint8Array(data.data2);\n\n      /* falls through */\n    default:\n      data.data = data.data || {};\n      data.data.frag = this.frag;\n      data.data.id = this.id;\n      hls.trigger(data.event, data.data);\n      break;\n    }\n  }\n}\n\nexport default Demuxer;\n","/**\n * Parser for exponential Golomb codes, a variable-bitwidth number encoding scheme used by h264.\n*/\n\nimport { logger } from '../utils/logger';\n\nclass ExpGolomb {\n  constructor (data) {\n    this.data = data;\n    // the number of bytes left to examine in this.data\n    this.bytesAvailable = data.byteLength;\n    // the current word being examined\n    this.word = 0; // :uint\n    // the number of bits left to examine in the current word\n    this.bitsAvailable = 0; // :uint\n  }\n\n  // ():void\n  loadWord () {\n    let\n      data = this.data,\n      bytesAvailable = this.bytesAvailable,\n      position = data.byteLength - bytesAvailable,\n      workingBytes = new Uint8Array(4),\n      availableBytes = Math.min(4, bytesAvailable);\n    if (availableBytes === 0)\n      throw new Error('no bytes available');\n\n    workingBytes.set(data.subarray(position, position + availableBytes));\n    this.word = new DataView(workingBytes.buffer).getUint32(0);\n    // track the amount of this.data that has been processed\n    this.bitsAvailable = availableBytes * 8;\n    this.bytesAvailable -= availableBytes;\n  }\n\n  // (count:int):void\n  skipBits (count) {\n    let skipBytes; // :int\n    if (this.bitsAvailable > count) {\n      this.word <<= count;\n      this.bitsAvailable -= count;\n    } else {\n      count -= this.bitsAvailable;\n      skipBytes = count >> 3;\n      count -= (skipBytes >> 3);\n      this.bytesAvailable -= skipBytes;\n      this.loadWord();\n      this.word <<= count;\n      this.bitsAvailable -= count;\n    }\n  }\n\n  // (size:int):uint\n  readBits (size) {\n    let\n      bits = Math.min(this.bitsAvailable, size), // :uint\n      valu = this.word >>> (32 - bits); // :uint\n    if (size > 32)\n      logger.error('Cannot read more than 32 bits at a time');\n\n    this.bitsAvailable -= bits;\n    if (this.bitsAvailable > 0)\n      this.word <<= bits;\n    else if (this.bytesAvailable > 0)\n      this.loadWord();\n\n    bits = size - bits;\n    if (bits > 0 && this.bitsAvailable)\n      return valu << bits | this.readBits(bits);\n    else\n      return valu;\n  }\n\n  // ():uint\n  skipLZ () {\n    let leadingZeroCount; // :uint\n    for (leadingZeroCount = 0; leadingZeroCount < this.bitsAvailable; ++leadingZeroCount) {\n      if ((this.word & (0x80000000 >>> leadingZeroCount)) !== 0) {\n        // the first bit of working word is 1\n        this.word <<= leadingZeroCount;\n        this.bitsAvailable -= leadingZeroCount;\n        return leadingZeroCount;\n      }\n    }\n    // we exhausted word and still have not found a 1\n    this.loadWord();\n    return leadingZeroCount + this.skipLZ();\n  }\n\n  // ():void\n  skipUEG () {\n    this.skipBits(1 + this.skipLZ());\n  }\n\n  // ():void\n  skipEG () {\n    this.skipBits(1 + this.skipLZ());\n  }\n\n  // ():uint\n  readUEG () {\n    let clz = this.skipLZ(); // :uint\n    return this.readBits(clz + 1) - 1;\n  }\n\n  // ():int\n  readEG () {\n    let valu = this.readUEG(); // :int\n    if (0x01 & valu) {\n      // the number is odd if the low order bit is set\n      return (1 + valu) >>> 1; // add 1 to make it even, and divide by 2\n    } else {\n      return -1 * (valu >>> 1); // divide by two then make it negative\n    }\n  }\n\n  // Some convenience functions\n  // :Boolean\n  readBoolean () {\n    return this.readBits(1) === 1;\n  }\n\n  // ():int\n  readUByte () {\n    return this.readBits(8);\n  }\n\n  // ():int\n  readUShort () {\n    return this.readBits(16);\n  }\n  // ():int\n  readUInt () {\n    return this.readBits(32);\n  }\n\n  /**\n   * Advance the ExpGolomb decoder past a scaling list. The scaling\n   * list is optionally transmitted as part of a sequence parameter\n   * set and is not relevant to transmuxing.\n   * @param count {number} the number of entries in this scaling list\n   * @see Recommendation ITU-T H.264, Section 7.3.2.1.1.1\n   */\n  skipScalingList (count) {\n    let\n      lastScale = 8,\n      nextScale = 8,\n      j,\n      deltaScale;\n    for (j = 0; j < count; j++) {\n      if (nextScale !== 0) {\n        deltaScale = this.readEG();\n        nextScale = (lastScale + deltaScale + 256) % 256;\n      }\n      lastScale = (nextScale === 0) ? lastScale : nextScale;\n    }\n  }\n\n  /**\n   * Read a sequence parameter set and return some interesting video\n   * properties. A sequence parameter set is the H264 metadata that\n   * describes the properties of upcoming video frames.\n   * @param data {Uint8Array} the bytes of a sequence parameter set\n   * @return {object} an object with configuration parsed from the\n   * sequence parameter set, including the dimensions of the\n   * associated video frames.\n   */\n  readSPS () {\n    let\n      frameCropLeftOffset = 0,\n      frameCropRightOffset = 0,\n      frameCropTopOffset = 0,\n      frameCropBottomOffset = 0,\n      profileIdc, profileCompat, levelIdc,\n      numRefFramesInPicOrderCntCycle, picWidthInMbsMinus1,\n      picHeightInMapUnitsMinus1,\n      frameMbsOnlyFlag,\n      scalingListCount,\n      i,\n      readUByte = this.readUByte.bind(this),\n      readBits = this.readBits.bind(this),\n      readUEG = this.readUEG.bind(this),\n      readBoolean = this.readBoolean.bind(this),\n      skipBits = this.skipBits.bind(this),\n      skipEG = this.skipEG.bind(this),\n      skipUEG = this.skipUEG.bind(this),\n      skipScalingList = this.skipScalingList.bind(this);\n\n    readUByte();\n    profileIdc = readUByte(); // profile_idc\n    profileCompat = readBits(5); // constraint_set[0-4]_flag, u(5)\n    skipBits(3); // reserved_zero_3bits u(3),\n    levelIdc = readUByte(); // level_idc u(8)\n    skipUEG(); // seq_parameter_set_id\n    // some profiles have more optional data we don't need\n    if (profileIdc === 100 ||\n        profileIdc === 110 ||\n        profileIdc === 122 ||\n        profileIdc === 244 ||\n        profileIdc === 44 ||\n        profileIdc === 83 ||\n        profileIdc === 86 ||\n        profileIdc === 118 ||\n        profileIdc === 128) {\n      let chromaFormatIdc = readUEG();\n      if (chromaFormatIdc === 3)\n        skipBits(1); // separate_colour_plane_flag\n\n      skipUEG(); // bit_depth_luma_minus8\n      skipUEG(); // bit_depth_chroma_minus8\n      skipBits(1); // qpprime_y_zero_transform_bypass_flag\n      if (readBoolean()) { // seq_scaling_matrix_present_flag\n        scalingListCount = (chromaFormatIdc !== 3) ? 8 : 12;\n        for (i = 0; i < scalingListCount; i++) {\n          if (readBoolean()) { // seq_scaling_list_present_flag[ i ]\n            if (i < 6)\n              skipScalingList(16);\n            else\n              skipScalingList(64);\n          }\n        }\n      }\n    }\n    skipUEG(); // log2_max_frame_num_minus4\n    let picOrderCntType = readUEG();\n    if (picOrderCntType === 0) {\n      readUEG(); // log2_max_pic_order_cnt_lsb_minus4\n    } else if (picOrderCntType === 1) {\n      skipBits(1); // delta_pic_order_always_zero_flag\n      skipEG(); // offset_for_non_ref_pic\n      skipEG(); // offset_for_top_to_bottom_field\n      numRefFramesInPicOrderCntCycle = readUEG();\n      for (i = 0; i < numRefFramesInPicOrderCntCycle; i++)\n        skipEG(); // offset_for_ref_frame[ i ]\n    }\n    skipUEG(); // max_num_ref_frames\n    skipBits(1); // gaps_in_frame_num_value_allowed_flag\n    picWidthInMbsMinus1 = readUEG();\n    picHeightInMapUnitsMinus1 = readUEG();\n    frameMbsOnlyFlag = readBits(1);\n    if (frameMbsOnlyFlag === 0)\n      skipBits(1); // mb_adaptive_frame_field_flag\n\n    skipBits(1); // direct_8x8_inference_flag\n    if (readBoolean()) { // frame_cropping_flag\n      frameCropLeftOffset = readUEG();\n      frameCropRightOffset = readUEG();\n      frameCropTopOffset = readUEG();\n      frameCropBottomOffset = readUEG();\n    }\n    let pixelRatio = [1, 1];\n    if (readBoolean()) {\n      // vui_parameters_present_flag\n      if (readBoolean()) {\n        // aspect_ratio_info_present_flag\n        const aspectRatioIdc = readUByte();\n        switch (aspectRatioIdc) {\n        case 1: pixelRatio = [1, 1]; break;\n        case 2: pixelRatio = [12, 11]; break;\n        case 3: pixelRatio = [10, 11]; break;\n        case 4: pixelRatio = [16, 11]; break;\n        case 5: pixelRatio = [40, 33]; break;\n        case 6: pixelRatio = [24, 11]; break;\n        case 7: pixelRatio = [20, 11]; break;\n        case 8: pixelRatio = [32, 11]; break;\n        case 9: pixelRatio = [80, 33]; break;\n        case 10: pixelRatio = [18, 11]; break;\n        case 11: pixelRatio = [15, 11]; break;\n        case 12: pixelRatio = [64, 33]; break;\n        case 13: pixelRatio = [160, 99]; break;\n        case 14: pixelRatio = [4, 3]; break;\n        case 15: pixelRatio = [3, 2]; break;\n        case 16: pixelRatio = [2, 1]; break;\n        case 255: {\n          pixelRatio = [readUByte() << 8 | readUByte(), readUByte() << 8 | readUByte()];\n          break;\n        }\n        }\n      }\n    }\n    return {\n      width: Math.ceil((((picWidthInMbsMinus1 + 1) * 16) - frameCropLeftOffset * 2 - frameCropRightOffset * 2)),\n      height: ((2 - frameMbsOnlyFlag) * (picHeightInMapUnitsMinus1 + 1) * 16) - ((frameMbsOnlyFlag ? 2 : 4) * (frameCropTopOffset + frameCropBottomOffset)),\n      pixelRatio: pixelRatio\n    };\n  }\n\n  readSliceType () {\n    // skip NALu type\n    this.readUByte();\n    // discard first_mb_in_slice\n    this.readUEG();\n    // return slice_type\n    return this.readUEG();\n  }\n}\n\nexport default ExpGolomb;\n","/**\n * ID3 parser\n */\nclass ID3 {\n  /**\n   * Returns true if an ID3 header can be found at offset in data\n   * @param {Uint8Array} data - The data to search in\n   * @param {number} offset - The offset at which to start searching\n   * @return {boolean} - True if an ID3 header is found\n   */\n  static isHeader (data, offset) {\n    /*\n    * http://id3.org/id3v2.3.0\n    * [0]     = 'I'\n    * [1]     = 'D'\n    * [2]     = '3'\n    * [3,4]   = {Version}\n    * [5]     = {Flags}\n    * [6-9]   = {ID3 Size}\n    *\n    * An ID3v2 tag can be detected with the following pattern:\n    *  $49 44 33 yy yy xx zz zz zz zz\n    * Where yy is less than $FF, xx is the 'flags' byte and zz is less than $80\n    */\n    if (offset + 10 <= data.length) {\n      // look for 'ID3' identifier\n      if (data[offset] === 0x49 && data[offset + 1] === 0x44 && data[offset + 2] === 0x33) {\n        // check version is within range\n        if (data[offset + 3] < 0xFF && data[offset + 4] < 0xFF) {\n          // check size is within range\n          if (data[offset + 6] < 0x80 && data[offset + 7] < 0x80 && data[offset + 8] < 0x80 && data[offset + 9] < 0x80)\n            return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Returns true if an ID3 footer can be found at offset in data\n   * @param {Uint8Array} data - The data to search in\n   * @param {number} offset - The offset at which to start searching\n   * @return {boolean} - True if an ID3 footer is found\n   */\n  static isFooter (data, offset) {\n    /*\n    * The footer is a copy of the header, but with a different identifier\n    */\n    if (offset + 10 <= data.length) {\n      // look for '3DI' identifier\n      if (data[offset] === 0x33 && data[offset + 1] === 0x44 && data[offset + 2] === 0x49) {\n        // check version is within range\n        if (data[offset + 3] < 0xFF && data[offset + 4] < 0xFF) {\n          // check size is within range\n          if (data[offset + 6] < 0x80 && data[offset + 7] < 0x80 && data[offset + 8] < 0x80 && data[offset + 9] < 0x80)\n            return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Returns any adjacent ID3 tags found in data starting at offset, as one block of data\n   * @param {Uint8Array} data - The data to search in\n   * @param {number} offset - The offset at which to start searching\n   * @return {Uint8Array} - The block of data containing any ID3 tags found\n   */\n  static getID3Data (data, offset) {\n    const front = offset;\n    let length = 0;\n\n    while (ID3.isHeader(data, offset)) {\n      // ID3 header is 10 bytes\n      length += 10;\n\n      const size = ID3._readSize(data, offset + 6);\n      length += size;\n\n      if (ID3.isFooter(data, offset + 10)) {\n        // ID3 footer is 10 bytes\n        length += 10;\n      }\n\n      offset += length;\n    }\n\n    if (length > 0)\n      return data.subarray(front, front + length);\n\n    return undefined;\n  }\n\n  static _readSize (data, offset) {\n    let size = 0;\n    size = ((data[offset] & 0x7f) << 21);\n    size |= ((data[offset + 1] & 0x7f) << 14);\n    size |= ((data[offset + 2] & 0x7f) << 7);\n    size |= (data[offset + 3] & 0x7f);\n    return size;\n  }\n\n  /**\n   * Searches for the Elementary Stream timestamp found in the ID3 data chunk\n   * @param {Uint8Array} data - Block of data containing one or more ID3 tags\n   * @return {number} - The timestamp\n   */\n  static getTimeStamp (data) {\n    const frames = ID3.getID3Frames(data);\n    for (let i = 0; i < frames.length; i++) {\n      const frame = frames[i];\n      if (ID3.isTimeStampFrame(frame))\n        return ID3._readTimeStamp(frame);\n    }\n\n    return undefined;\n  }\n\n  /**\n   * Returns true if the ID3 frame is an Elementary Stream timestamp frame\n   * @param {ID3 frame} frame\n   */\n  static isTimeStampFrame (frame) {\n    return (frame && frame.key === 'PRIV' && frame.info === 'com.apple.streaming.transportStreamTimestamp');\n  }\n\n  static _getFrameData (data) {\n    /*\n    Frame ID       $xx xx xx xx (four characters)\n    Size           $xx xx xx xx\n    Flags          $xx xx\n    */\n    const type = String.fromCharCode(data[0], data[1], data[2], data[3]);\n    const size = ID3._readSize(data, 4);\n\n    // skip frame id, size, and flags\n    let offset = 10;\n\n    return { type, size, data: data.subarray(offset, offset + size) };\n  }\n\n  /**\n   * Returns an array of ID3 frames found in all the ID3 tags in the id3Data\n   * @param {Uint8Array} id3Data - The ID3 data containing one or more ID3 tags\n   * @return {ID3 frame[]} - Array of ID3 frame objects\n   */\n  static getID3Frames (id3Data) {\n    let offset = 0;\n    const frames = [];\n\n    while (ID3.isHeader(id3Data, offset)) {\n      const size = ID3._readSize(id3Data, offset + 6);\n      // skip past ID3 header\n      offset += 10;\n      const end = offset + size;\n      // loop through frames in the ID3 tag\n      while (offset + 8 < end) {\n        const frameData = ID3._getFrameData(id3Data.subarray(offset));\n        const frame = ID3._decodeFrame(frameData);\n        if (frame)\n          frames.push(frame);\n\n        // skip frame header and frame data\n        offset += frameData.size + 10;\n      }\n\n      if (ID3.isFooter(id3Data, offset))\n        offset += 10;\n    }\n\n    return frames;\n  }\n\n  static _decodeFrame (frame) {\n    if (frame.type === 'PRIV')\n      return ID3._decodePrivFrame(frame);\n    else if (frame.type[0] === 'T')\n      return ID3._decodeTextFrame(frame);\n    else if (frame.type[0] === 'W')\n      return ID3._decodeURLFrame(frame);\n\n    return undefined;\n  }\n\n  static _readTimeStamp (timeStampFrame) {\n    if (timeStampFrame.data.byteLength === 8) {\n      const data = new Uint8Array(timeStampFrame.data);\n      // timestamp is 33 bit expressed as a big-endian eight-octet number,\n      // with the upper 31 bits set to zero.\n      const pts33Bit = data[3] & 0x1;\n      let timestamp = (data[4] << 23) +\n                      (data[5] << 15) +\n                      (data[6] << 7) +\n                       data[7];\n      timestamp /= 45;\n\n      if (pts33Bit)\n        timestamp += 47721858.84; // 2^32 / 90\n\n      return Math.round(timestamp);\n    }\n\n    return undefined;\n  }\n\n  static _decodePrivFrame (frame) {\n    /*\n    Format: <text string>\\0<binary data>\n    */\n    if (frame.size < 2)\n      return undefined;\n\n    const owner = ID3._utf8ArrayToStr(frame.data, true);\n    const privateData = new Uint8Array(frame.data.subarray(owner.length + 1));\n\n    return { key: frame.type, info: owner, data: privateData.buffer };\n  }\n\n  static _decodeTextFrame (frame) {\n    if (frame.size < 2)\n      return undefined;\n\n    if (frame.type === 'TXXX') {\n      /*\n      Format:\n      [0]   = {Text Encoding}\n      [1-?] = {Description}\\0{Value}\n      */\n      let index = 1;\n      const description = ID3._utf8ArrayToStr(frame.data.subarray(index));\n\n      index += description.length + 1;\n      const value = ID3._utf8ArrayToStr(frame.data.subarray(index));\n\n      return { key: frame.type, info: description, data: value };\n    } else {\n      /*\n      Format:\n      [0]   = {Text Encoding}\n      [1-?] = {Value}\n      */\n      const text = ID3._utf8ArrayToStr(frame.data.subarray(1));\n      return { key: frame.type, data: text };\n    }\n  }\n\n  static _decodeURLFrame (frame) {\n    if (frame.type === 'WXXX') {\n      /*\n      Format:\n      [0]   = {Text Encoding}\n      [1-?] = {Description}\\0{URL}\n      */\n      if (frame.size < 2)\n        return undefined;\n\n      let index = 1;\n      const description = ID3._utf8ArrayToStr(frame.data.subarray(index));\n\n      index += description.length + 1;\n      const value = ID3._utf8ArrayToStr(frame.data.subarray(index));\n\n      return { key: frame.type, info: description, data: value };\n    } else {\n      /*\n      Format:\n      [0-?] = {URL}\n      */\n      const url = ID3._utf8ArrayToStr(frame.data);\n      return { key: frame.type, data: url };\n    }\n  }\n\n  // http://stackoverflow.com/questions/8936984/uint8array-to-string-in-javascript/22373197\n  // http://www.onicos.com/staff/iz/amuse/javascript/expert/utf.txt\n  /* utf.js - UTF-8 <=> UTF-16 convertion\n   *\n   * Copyright (C) 1999 Masanao Izumo <iz@onicos.co.jp>\n   * Version: 1.0\n   * LastModified: Dec 25 1999\n   * This library is free.  You can redistribute it and/or modify it.\n   */\n  static _utf8ArrayToStr (array, exitOnNull = false) {\n    const len = array.length;\n    let c;\n    let char2;\n    let char3;\n    let out = '';\n    let i = 0;\n    while (i < len) {\n      c = array[i++];\n      if (c === 0x00 && exitOnNull) {\n        return out;\n      } else if (c === 0x00 || c === 0x03) {\n        // If the character is 3 (END_OF_TEXT) or 0 (NULL) then skip it\n        continue;\n      }\n      switch (c >> 4) {\n      case 0: case 1: case 2: case 3: case 4: case 5: case 6: case 7:\n        // 0xxxxxxx\n        out += String.fromCharCode(c);\n        break;\n      case 12: case 13:\n        // 110x xxxx   10xx xxxx\n        char2 = array[i++];\n        out += String.fromCharCode(((c & 0x1F) << 6) | (char2 & 0x3F));\n        break;\n      case 14:\n        // 1110 xxxx  10xx xxxx  10xx xxxx\n        char2 = array[i++];\n        char3 = array[i++];\n        out += String.fromCharCode(((c & 0x0F) << 12) |\n                    ((char2 & 0x3F) << 6) |\n                    ((char3 & 0x3F) << 0));\n        break;\n      default:\n      }\n    }\n    return out;\n  }\n}\n\nconst utf8ArrayToStr = ID3._utf8ArrayToStr;\n\nexport default ID3;\n\nexport { utf8ArrayToStr };\n","/**\n * MP3 demuxer\n */\nimport ID3 from '../demux/id3';\nimport { logger } from '../utils/logger';\nimport MpegAudio from './mpegaudio';\n\nclass MP3Demuxer {\n  constructor (observer, remuxer, config) {\n    this.observer = observer;\n    this.config = config;\n    this.remuxer = remuxer;\n  }\n\n  resetInitSegment (initSegment, audioCodec, videoCodec, duration) {\n    this._audioTrack = { container: 'audio/mpeg', type: 'audio', id: -1, sequenceNumber: 0, isAAC: false, samples: [], len: 0, manifestCodec: audioCodec, duration: duration, inputTimeScale: 90000 };\n  }\n\n  resetTimeStamp () {\n  }\n\n  static probe (data) {\n    // check if data contains ID3 timestamp and MPEG sync word\n    let offset, length;\n    let id3Data = ID3.getID3Data(data, 0);\n    if (id3Data && ID3.getTimeStamp(id3Data) !== undefined) {\n      // Look for MPEG header | 1111 1111 | 111X XYZX | where X can be either 0 or 1 and Y or Z should be 1\n      // Layer bits (position 14 and 15) in header should be always different from 0 (Layer I or Layer II or Layer III)\n      // More info http://www.mp3-tech.org/programmer/frame_header.html\n      for (offset = id3Data.length, length = Math.min(data.length - 1, offset + 100); offset < length; offset++) {\n        if (MpegAudio.probe(data, offset)) {\n          logger.log('MPEG Audio sync word found !');\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  // feed incoming data to the front of the parsing pipeline\n  append (data, timeOffset, contiguous, accurateTimeOffset) {\n    let id3Data = ID3.getID3Data(data, 0);\n    let timestamp = ID3.getTimeStamp(id3Data);\n    let pts = timestamp ? 90 * timestamp : timeOffset * 90000;\n    let offset = id3Data.length;\n    let length = data.length;\n    let frameIndex = 0, stamp = 0;\n    let track = this._audioTrack;\n\n    let id3Samples = [{ pts: pts, dts: pts, data: id3Data }];\n\n    while (offset < length) {\n      if (MpegAudio.isHeader(data, offset)) {\n        let frame = MpegAudio.appendFrame(track, data, offset, pts, frameIndex);\n        if (frame) {\n          offset += frame.length;\n          stamp = frame.sample.pts;\n          frameIndex++;\n        } else {\n          // logger.log('Unable to parse Mpeg audio frame');\n          break;\n        }\n      } else if (ID3.isHeader(data, offset)) {\n        id3Data = ID3.getID3Data(data, offset);\n        id3Samples.push({ pts: stamp, dts: stamp, data: id3Data });\n        offset += id3Data.length;\n      } else {\n        // nothing found, keep looking\n        offset++;\n      }\n    }\n\n    this.remuxer.remux(track,\n      { samples: [] },\n      { samples: id3Samples, inputTimeScale: 90000 },\n      { samples: [] },\n      timeOffset,\n      contiguous,\n      accurateTimeOffset);\n  }\n\n  destroy () {\n  }\n}\n\nexport default MP3Demuxer;\n","/**\n * MP4 demuxer\n */\nimport { logger } from '../utils/logger';\nimport Event from '../events';\n\nconst UINT32_MAX = Math.pow(2, 32) - 1;\n\nclass MP4Demuxer {\n  constructor (observer, remuxer) {\n    this.observer = observer;\n    this.remuxer = remuxer;\n  }\n\n  resetTimeStamp (initPTS) {\n    this.initPTS = initPTS;\n  }\n\n  resetInitSegment (initSegment, audioCodec, videoCodec, duration) {\n    // jshint unused:false\n    if (initSegment && initSegment.byteLength) {\n      const initData = this.initData = MP4Demuxer.parseInitSegment(initSegment);\n\n      // default audio codec if nothing specified\n      // TODO : extract that from initsegment\n      if (audioCodec == null)\n        audioCodec = 'mp4a.40.5';\n\n      if (videoCodec == null)\n        videoCodec = 'avc1.42e01e';\n\n      const tracks = {};\n      if (initData.audio && initData.video) {\n        tracks.audiovideo = { container: 'video/mp4', codec: audioCodec + ',' + videoCodec, initSegment: duration ? initSegment : null };\n      } else {\n        if (initData.audio)\n          tracks.audio = { container: 'audio/mp4', codec: audioCodec, initSegment: duration ? initSegment : null };\n\n        if (initData.video)\n          tracks.video = { container: 'video/mp4', codec: videoCodec, initSegment: duration ? initSegment : null };\n      }\n      this.observer.trigger(Event.FRAG_PARSING_INIT_SEGMENT, { tracks });\n    } else {\n      if (audioCodec)\n        this.audioCodec = audioCodec;\n\n      if (videoCodec)\n        this.videoCodec = videoCodec;\n    }\n  }\n\n  static probe (data) {\n    // ensure we find a moof box in the first 16 kB\n    return MP4Demuxer.findBox({ data: data, start: 0, end: Math.min(data.length, 16384) }, ['moof']).length > 0;\n  }\n\n  static bin2str (buffer) {\n    return String.fromCharCode.apply(null, buffer);\n  }\n\n  static readUint16 (buffer, offset) {\n    if (buffer.data) {\n      offset += buffer.start;\n      buffer = buffer.data;\n    }\n\n    const val = buffer[offset] << 8 |\n                buffer[offset + 1];\n\n    return val < 0 ? 65536 + val : val;\n  }\n\n  static readUint32 (buffer, offset) {\n    if (buffer.data) {\n      offset += buffer.start;\n      buffer = buffer.data;\n    }\n\n    const val = buffer[offset] << 24 |\n                buffer[offset + 1] << 16 |\n                buffer[offset + 2] << 8 |\n                buffer[offset + 3];\n    return val < 0 ? 4294967296 + val : val;\n  }\n\n  static writeUint32 (buffer, offset, value) {\n    if (buffer.data) {\n      offset += buffer.start;\n      buffer = buffer.data;\n    }\n    buffer[offset] = value >> 24;\n    buffer[offset + 1] = (value >> 16) & 0xff;\n    buffer[offset + 2] = (value >> 8) & 0xff;\n    buffer[offset + 3] = value & 0xff;\n  }\n\n  // Find the data for a box specified by its path\n  static findBox (data, path) {\n    let results = [],\n      i, size, type, end, subresults, start, endbox;\n\n    if (data.data) {\n      start = data.start;\n      end = data.end;\n      data = data.data;\n    } else {\n      start = 0;\n      end = data.byteLength;\n    }\n\n    if (!path.length) {\n      // short-circuit the search for empty paths\n      return null;\n    }\n\n    for (i = start; i < end;) {\n      size = MP4Demuxer.readUint32(data, i);\n      type = MP4Demuxer.bin2str(data.subarray(i + 4, i + 8));\n      endbox = size > 1 ? i + size : end;\n\n      if (type === path[0]) {\n        if (path.length === 1) {\n          // this is the end of the path and we've found the box we were\n          // looking for\n          results.push({ data: data, start: i + 8, end: endbox });\n        } else {\n          // recursively search for the next box along the path\n          subresults = MP4Demuxer.findBox({ data: data, start: i + 8, end: endbox }, path.slice(1));\n          if (subresults.length)\n            results = results.concat(subresults);\n        }\n      }\n      i = endbox;\n    }\n\n    // we've finished searching all of data\n    return results;\n  }\n\n  static parseSegmentIndex (initSegment) {\n    const moov = MP4Demuxer.findBox(initSegment, ['moov'])[0];\n    const moovEndOffset = moov ? moov.end : null; // we need this in case we need to chop of garbage of the end of current data\n\n    let index = 0;\n    let sidx = MP4Demuxer.findBox(initSegment, ['sidx']);\n    let references;\n\n    if (!sidx || !sidx[0])\n      return null;\n\n    references = [];\n    sidx = sidx[0];\n\n    const version = sidx.data[0];\n\n    // set initial offset, we skip the reference ID (not needed)\n    index = version === 0 ? 8 : 16;\n\n    const timescale = MP4Demuxer.readUint32(sidx, index);\n    index += 4;\n\n    // TODO: parse earliestPresentationTime and firstOffset\n    // usually zero in our case\n    let earliestPresentationTime = 0;\n    let firstOffset = 0;\n\n    if (version === 0)\n      index += 8;\n    else\n      index += 16;\n\n    // skip reserved\n    index += 2;\n\n    let startByte = sidx.end + firstOffset;\n\n    const referencesCount = MP4Demuxer.readUint16(sidx, index);\n    index += 2;\n\n    for (let i = 0; i < referencesCount; i++) {\n      let referenceIndex = index;\n\n      const referenceInfo = MP4Demuxer.readUint32(sidx, referenceIndex);\n      referenceIndex += 4;\n\n      const referenceSize = referenceInfo & 0x7FFFFFFF;\n      const referenceType = (referenceInfo & 0x80000000) >>> 31;\n\n      if (referenceType === 1) {\n        console.warn('SIDX has hierarchical references (not supported)');\n        return;\n      }\n\n      const subsegmentDuration = MP4Demuxer.readUint32(sidx, referenceIndex);\n      referenceIndex += 4;\n\n      references.push({\n        referenceSize,\n        subsegmentDuration, // unscaled\n        info: {\n          duration: subsegmentDuration / timescale,\n          start: startByte,\n          end: startByte + referenceSize - 1\n        }\n      });\n\n      startByte += referenceSize;\n\n      // Skipping 1 bit for |startsWithSap|, 3 bits for |sapType|, and 28 bits\n      // for |sapDelta|.\n      referenceIndex += 4;\n\n      // skip to next ref\n      index = referenceIndex;\n    }\n\n    return {\n      earliestPresentationTime,\n      timescale,\n      version,\n      referencesCount,\n      references,\n      moovEndOffset\n    };\n  }\n\n  /**\n   * Parses an MP4 initialization segment and extracts stream type and\n   * timescale values for any declared tracks. Timescale values indicate the\n   * number of clock ticks per second to assume for time-based values\n   * elsewhere in the MP4.\n   *\n   * To determine the start time of an MP4, you need two pieces of\n   * information: the timescale unit and the earliest base media decode\n   * time. Multiple timescales can be specified within an MP4 but the\n   * base media decode time is always expressed in the timescale from\n   * the media header box for the track:\n   * ```\n   * moov > trak > mdia > mdhd.timescale\n   * moov > trak > mdia > hdlr\n   * ```\n   * @param init {Uint8Array} the bytes of the init segment\n   * @return {object} a hash of track type to timescale values or null if\n   * the init segment is malformed.\n   */\n  static parseInitSegment (initSegment) {\n    let result = [];\n    let traks = MP4Demuxer.findBox(initSegment, ['moov', 'trak']);\n\n    traks.forEach(trak => {\n      const tkhd = MP4Demuxer.findBox(trak, ['tkhd'])[0];\n      if (tkhd) {\n        let version = tkhd.data[tkhd.start];\n        let index = version === 0 ? 12 : 20;\n        let trackId = MP4Demuxer.readUint32(tkhd, index);\n\n        const mdhd = MP4Demuxer.findBox(trak, ['mdia', 'mdhd'])[0];\n        if (mdhd) {\n          version = mdhd.data[mdhd.start];\n          index = version === 0 ? 12 : 20;\n          const timescale = MP4Demuxer.readUint32(mdhd, index);\n\n          const hdlr = MP4Demuxer.findBox(trak, ['mdia', 'hdlr'])[0];\n          if (hdlr) {\n            const hdlrType = MP4Demuxer.bin2str(hdlr.data.subarray(hdlr.start + 8, hdlr.start + 12));\n            let type = { 'soun': 'audio', 'vide': 'video' }[hdlrType];\n            if (type) {\n              // extract codec info. TODO : parse codec details to be able to build MIME type\n              let codecBox = MP4Demuxer.findBox(trak, ['mdia', 'minf', 'stbl', 'stsd']);\n              if (codecBox.length) {\n                codecBox = codecBox[0];\n                let codecType = MP4Demuxer.bin2str(codecBox.data.subarray(codecBox.start + 12, codecBox.start + 16));\n                logger.log(`MP4Demuxer:${type}:${codecType} found`);\n              }\n              result[trackId] = { timescale: timescale, type: type };\n              result[type] = { timescale: timescale, id: trackId };\n            }\n          }\n        }\n      }\n    });\n    return result;\n  }\n\n  /**\n * Determine the base media decode start time, in seconds, for an MP4\n * fragment. If multiple fragments are specified, the earliest time is\n * returned.\n *\n * The base media decode time can be parsed from track fragment\n * metadata:\n * ```\n * moof > traf > tfdt.baseMediaDecodeTime\n * ```\n * It requires the timescale value from the mdhd to interpret.\n *\n * @param timescale {object} a hash of track ids to timescale values.\n * @return {number} the earliest base media decode start time for the\n * fragment, in seconds\n */\n  static getStartDTS (initData, fragment) {\n    let trafs, baseTimes, result;\n\n    // we need info from two childrend of each track fragment box\n    trafs = MP4Demuxer.findBox(fragment, ['moof', 'traf']);\n\n    // determine the start times for each track\n    baseTimes = [].concat.apply([], trafs.map(function (traf) {\n      return MP4Demuxer.findBox(traf, ['tfhd']).map(function (tfhd) {\n        let id, scale, baseTime;\n\n        // get the track id from the tfhd\n        id = MP4Demuxer.readUint32(tfhd, 4);\n        // assume a 90kHz clock if no timescale was specified\n        scale = initData[id].timescale || 90e3;\n\n        // get the base media decode time from the tfdt\n        baseTime = MP4Demuxer.findBox(traf, ['tfdt']).map(function (tfdt) {\n          let version, result;\n\n          version = tfdt.data[tfdt.start];\n          result = MP4Demuxer.readUint32(tfdt, 4);\n          if (version === 1) {\n            result *= Math.pow(2, 32);\n\n            result += MP4Demuxer.readUint32(tfdt, 8);\n          }\n          return result;\n        })[0];\n        // convert base time to seconds\n        return baseTime / scale;\n      });\n    }));\n\n    // return the minimum\n    result = Math.min.apply(null, baseTimes);\n    return isFinite(result) ? result : 0;\n  }\n\n  static offsetStartDTS (initData, fragment, timeOffset) {\n    MP4Demuxer.findBox(fragment, ['moof', 'traf']).map(function (traf) {\n      return MP4Demuxer.findBox(traf, ['tfhd']).map(function (tfhd) {\n      // get the track id from the tfhd\n        let id = MP4Demuxer.readUint32(tfhd, 4);\n        // assume a 90kHz clock if no timescale was specified\n        let timescale = initData[id].timescale || 90e3;\n\n        // get the base media decode time from the tfdt\n        MP4Demuxer.findBox(traf, ['tfdt']).map(function (tfdt) {\n          let version = tfdt.data[tfdt.start];\n          let baseMediaDecodeTime = MP4Demuxer.readUint32(tfdt, 4);\n          if (version === 0) {\n            MP4Demuxer.writeUint32(tfdt, 4, baseMediaDecodeTime - timeOffset * timescale);\n          } else {\n            baseMediaDecodeTime *= Math.pow(2, 32);\n            baseMediaDecodeTime += MP4Demuxer.readUint32(tfdt, 8);\n            baseMediaDecodeTime -= timeOffset * timescale;\n            baseMediaDecodeTime = Math.max(baseMediaDecodeTime, 0);\n            const upper = Math.floor(baseMediaDecodeTime / (UINT32_MAX + 1));\n            const lower = Math.floor(baseMediaDecodeTime % (UINT32_MAX + 1));\n            MP4Demuxer.writeUint32(tfdt, 4, upper);\n            MP4Demuxer.writeUint32(tfdt, 8, lower);\n          }\n        });\n      });\n    });\n  }\n\n  // feed incoming data to the front of the parsing pipeline\n  append (data, timeOffset, contiguous, accurateTimeOffset) {\n    let initData = this.initData;\n    if (!initData) {\n      this.resetInitSegment(data, this.audioCodec, this.videoCodec, false);\n      initData = this.initData;\n    }\n    let startDTS, initPTS = this.initPTS;\n    if (initPTS === undefined) {\n      let startDTS = MP4Demuxer.getStartDTS(initData, data);\n      this.initPTS = initPTS = startDTS - timeOffset;\n      this.observer.trigger(Event.INIT_PTS_FOUND, { initPTS: initPTS });\n    }\n    MP4Demuxer.offsetStartDTS(initData, data, initPTS);\n    startDTS = MP4Demuxer.getStartDTS(initData, data);\n    this.remuxer.remux(initData.audio, initData.video, null, null, startDTS, contiguous, accurateTimeOffset, data);\n  }\n\n  destroy () {}\n}\n\nexport default MP4Demuxer;\n","/**\n *  MPEG parser helper\n */\n\nconst MpegAudio = {\n\n  BitratesMap: [\n    32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416, 448,\n    32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384,\n    32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320,\n    32, 48, 56, 64, 80, 96, 112, 128, 144, 160, 176, 192, 224, 256,\n    8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160],\n\n  SamplingRateMap: [44100, 48000, 32000, 22050, 24000, 16000, 11025, 12000, 8000],\n\n  SamplesCoefficients: [\n    // MPEG 2.5\n    [\n      0, // Reserved\n      72, // Layer3\n      144, // Layer2\n      12 // Layer1\n    ],\n    // Reserved\n    [\n      0, // Reserved\n      0, // Layer3\n      0, // Layer2\n      0 // Layer1\n    ],\n    // MPEG 2\n    [\n      0, // Reserved\n      72, // Layer3\n      144, // Layer2\n      12 // Layer1\n    ],\n    // MPEG 1\n    [\n      0, // Reserved\n      144, // Layer3\n      144, // Layer2\n      12 // Layer1\n    ]\n  ],\n\n  BytesInSlot: [\n    0, // Reserved\n    1, // Layer3\n    1, // Layer2\n    4 // Layer1\n  ],\n\n  appendFrame: function (track, data, offset, pts, frameIndex) {\n    // Using http://www.datavoyage.com/mpgscript/mpeghdr.htm as a reference\n    if (offset + 24 > data.length)\n      return undefined;\n\n    let header = this.parseHeader(data, offset);\n    if (header && offset + header.frameLength <= data.length) {\n      let frameDuration = header.samplesPerFrame * 90000 / header.sampleRate;\n      let stamp = pts + frameIndex * frameDuration;\n      let sample = { unit: data.subarray(offset, offset + header.frameLength), pts: stamp, dts: stamp };\n\n      track.config = [];\n      track.channelCount = header.channelCount;\n      track.samplerate = header.sampleRate;\n      track.samples.push(sample);\n      track.len += header.frameLength;\n\n      return { sample, length: header.frameLength };\n    }\n\n    return undefined;\n  },\n\n  parseHeader: function (data, offset) {\n    let headerB = (data[offset + 1] >> 3) & 3;\n    let headerC = (data[offset + 1] >> 1) & 3;\n    let headerE = (data[offset + 2] >> 4) & 15;\n    let headerF = (data[offset + 2] >> 2) & 3;\n    let headerG = (data[offset + 2] >> 1) & 1;\n    if (headerB !== 1 && headerE !== 0 && headerE !== 15 && headerF !== 3) {\n      let columnInBitrates = headerB === 3 ? (3 - headerC) : (headerC === 3 ? 3 : 4);\n      let bitRate = MpegAudio.BitratesMap[columnInBitrates * 14 + headerE - 1] * 1000;\n      let columnInSampleRates = headerB === 3 ? 0 : headerB === 2 ? 1 : 2;\n      let sampleRate = MpegAudio.SamplingRateMap[columnInSampleRates * 3 + headerF];\n      let channelCount = data[offset + 3] >> 6 === 3 ? 1 : 2; // If bits of channel mode are `11` then it is a single channel (Mono)\n      let sampleCoefficient = MpegAudio.SamplesCoefficients[headerB][headerC];\n      let bytesInSlot = MpegAudio.BytesInSlot[headerC];\n      let samplesPerFrame = sampleCoefficient * 8 * bytesInSlot;\n      let frameLength = parseInt(sampleCoefficient * bitRate / sampleRate + headerG, 10) * bytesInSlot;\n\n      return { sampleRate, channelCount, frameLength, samplesPerFrame };\n    }\n\n    return undefined;\n  },\n\n  isHeaderPattern: function (data, offset) {\n    return data[offset] === 0xff && (data[offset + 1] & 0xe0) === 0xe0 && (data[offset + 1] & 0x06) !== 0x00;\n  },\n\n  isHeader: function (data, offset) {\n    // Look for MPEG header | 1111 1111 | 111X XYZX | where X can be either 0 or 1 and Y or Z should be 1\n    // Layer bits (position 14 and 15) in header should be always different from 0 (Layer I or Layer II or Layer III)\n    // More info http://www.mp3-tech.org/programmer/frame_header.html\n    if (offset + 1 < data.length && this.isHeaderPattern(data, offset))\n      return true;\n\n    return false;\n  },\n\n  probe: function (data, offset) {\n    // same as isHeader but we also check that MPEG frame follows last MPEG frame\n    // or end of data is reached\n    if (offset + 1 < data.length && this.isHeaderPattern(data, offset)) {\n      // MPEG header Length\n      let headerLength = 4;\n      // MPEG frame Length\n      let header = this.parseHeader(data, offset);\n      let frameLength = headerLength;\n      if (header && header.frameLength)\n        frameLength = header.frameLength;\n\n      let newOffset = offset + frameLength;\n      if (newOffset === data.length || (newOffset + 1 < data.length && this.isHeaderPattern(data, newOffset)))\n        return true;\n    }\n    return false;\n  }\n};\n\nexport default MpegAudio;\n","/**\n * SAMPLE-AES decrypter\n*/\n\nimport Decrypter from '../crypt/decrypter';\n\nclass SampleAesDecrypter {\n  constructor (observer, config, decryptdata, discardEPB) {\n    this.decryptdata = decryptdata;\n    this.discardEPB = discardEPB;\n    this.decrypter = new Decrypter(observer, config, { removePKCS7Padding: false });\n  }\n\n  decryptBuffer (encryptedData, callback) {\n    this.decrypter.decrypt(encryptedData, this.decryptdata.key.buffer, this.decryptdata.iv.buffer, callback);\n  }\n\n  // AAC - encrypt all full 16 bytes blocks starting from offset 16\n  decryptAacSample (samples, sampleIndex, callback, sync) {\n    let curUnit = samples[sampleIndex].unit;\n    let encryptedData = curUnit.subarray(16, curUnit.length - curUnit.length % 16);\n    let encryptedBuffer = encryptedData.buffer.slice(\n      encryptedData.byteOffset,\n      encryptedData.byteOffset + encryptedData.length);\n\n    let localthis = this;\n    this.decryptBuffer(encryptedBuffer, function (decryptedData) {\n      decryptedData = new Uint8Array(decryptedData);\n      curUnit.set(decryptedData, 16);\n\n      if (!sync)\n        localthis.decryptAacSamples(samples, sampleIndex + 1, callback);\n    });\n  }\n\n  decryptAacSamples (samples, sampleIndex, callback) {\n    for (;; sampleIndex++) {\n      if (sampleIndex >= samples.length) {\n        callback();\n        return;\n      }\n\n      if (samples[sampleIndex].unit.length < 32)\n        continue;\n\n      let sync = this.decrypter.isSync();\n\n      this.decryptAacSample(samples, sampleIndex, callback, sync);\n\n      if (!sync)\n        return;\n    }\n  }\n\n  // AVC - encrypt one 16 bytes block out of ten, starting from offset 32\n  getAvcEncryptedData (decodedData) {\n    let encryptedDataLen = Math.floor((decodedData.length - 48) / 160) * 16 + 16;\n    let encryptedData = new Int8Array(encryptedDataLen);\n    let outputPos = 0;\n    for (let inputPos = 32; inputPos <= decodedData.length - 16; inputPos += 160, outputPos += 16)\n      encryptedData.set(decodedData.subarray(inputPos, inputPos + 16), outputPos);\n\n    return encryptedData;\n  }\n\n  getAvcDecryptedUnit (decodedData, decryptedData) {\n    decryptedData = new Uint8Array(decryptedData);\n    let inputPos = 0;\n    for (let outputPos = 32; outputPos <= decodedData.length - 16; outputPos += 160, inputPos += 16)\n      decodedData.set(decryptedData.subarray(inputPos, inputPos + 16), outputPos);\n\n    return decodedData;\n  }\n\n  decryptAvcSample (samples, sampleIndex, unitIndex, callback, curUnit, sync) {\n    let decodedData = this.discardEPB(curUnit.data);\n    let encryptedData = this.getAvcEncryptedData(decodedData);\n    let localthis = this;\n\n    this.decryptBuffer(encryptedData.buffer, function (decryptedData) {\n      curUnit.data = localthis.getAvcDecryptedUnit(decodedData, decryptedData);\n\n      if (!sync)\n        localthis.decryptAvcSamples(samples, sampleIndex, unitIndex + 1, callback);\n    });\n  }\n\n  decryptAvcSamples (samples, sampleIndex, unitIndex, callback) {\n    for (;; sampleIndex++, unitIndex = 0) {\n      if (sampleIndex >= samples.length) {\n        callback();\n        return;\n      }\n\n      let curUnits = samples[sampleIndex].units;\n      for (;; unitIndex++) {\n        if (unitIndex >= curUnits.length)\n          break;\n\n        let curUnit = curUnits[unitIndex];\n        if (curUnit.length <= 48 || (curUnit.type !== 1 && curUnit.type !== 5))\n          continue;\n\n        let sync = this.decrypter.isSync();\n\n        this.decryptAvcSample(samples, sampleIndex, unitIndex, callback, curUnit, sync);\n\n        if (!sync)\n          return;\n      }\n    }\n  }\n}\n\nexport default SampleAesDecrypter;\n","/**\n * highly optimized TS demuxer:\n * parse PAT, PMT\n * extract PES packet from audio and video PIDs\n * extract AVC/H264 NAL units and AAC/ADTS samples from PES packet\n * trigger the remuxer upon parsing completion\n * it also tries to workaround as best as it can audio codec switch (HE-AAC to AAC and vice versa), without having to restart the MediaSource.\n * it also controls the remuxing process :\n * upon discontinuity or level switch detection, it will also notifies the remuxer so that it can reset its state.\n*/\n\nimport * as ADTS from './adts';\nimport MpegAudio from './mpegaudio';\nimport Event from '../events';\nimport ExpGolomb from './exp-golomb';\nimport SampleAesDecrypter from './sample-aes';\n// import Hex from '../utils/hex';\nimport { logger } from '../utils/logger';\nimport { ErrorTypes, ErrorDetails } from '../errors';\n\n// We are using fixed track IDs for driving the MP4 remuxer\n// instead of following the TS PIDs.\n// There is no reason not to do this and some browsers/SourceBuffer-demuxers\n// may not like if there are TrackID \"switches\"\n// See https://github.com/video-dev/hls.js/issues/1331\n// Here we are mapping our internal track types to constant MP4 track IDs\n// With MSE currently one can only have one track of each, and we are muxing\n// whatever video/audio rendition in them.\nconst RemuxerTrackIdConfig = {\n  video: 0,\n  audio: 1,\n  id3: 2,\n  text: 3\n};\n\nclass TSDemuxer {\n  constructor (observer, remuxer, config, typeSupported) {\n    this.observer = observer;\n    this.config = config;\n    this.typeSupported = typeSupported;\n    this.remuxer = remuxer;\n    this.sampleAes = null;\n  }\n\n  setDecryptData (decryptdata) {\n    if ((decryptdata != null) && (decryptdata.key != null) && (decryptdata.method === 'SAMPLE-AES'))\n      this.sampleAes = new SampleAesDecrypter(this.observer, this.config, decryptdata, this.discardEPB);\n    else\n      this.sampleAes = null;\n  }\n\n  static probe (data) {\n    const syncOffset = TSDemuxer._syncOffset(data);\n    if (syncOffset < 0) {\n      return false;\n    } else {\n      if (syncOffset)\n        logger.warn(`MPEG2-TS detected but first sync word found @ offset ${syncOffset}, junk ahead ?`);\n\n      return true;\n    }\n  }\n\n  static _syncOffset (data) {\n    // scan 1000 first bytes\n    const scanwindow = Math.min(1000, data.length - 3 * 188);\n    let i = 0;\n    while (i < scanwindow) {\n      // a TS fragment should contain at least 3 TS packets, a PAT, a PMT, and one PID, each starting with 0x47\n      if (data[i] === 0x47 && data[i + 188] === 0x47 && data[i + 2 * 188] === 0x47)\n        return i;\n      else\n        i++;\n    }\n    return -1;\n  }\n\n  /**\n   * Creates a track model internal to demuxer used to drive remuxing input\n   *\n   * @param {string} type 'audio' | 'video' | 'id3' | 'text'\n   * @param {number} duration\n   * @return {object} TSDemuxer's internal track model\n   */\n  static createTrack (type, duration) {\n    return {\n      container: type === 'video' || type === 'audio' ? 'video/mp2t' : undefined,\n      type,\n      id: RemuxerTrackIdConfig[type],\n      pid: -1,\n      inputTimeScale: 90000,\n      sequenceNumber: 0,\n      samples: [],\n      len: 0,\n      dropped: type === 'video' ? 0 : undefined,\n      isAAC: type === 'audio' ? true : undefined,\n      duration: type === 'audio' ? duration : undefined\n    };\n  }\n\n  /**\n   * Initializes a new init segment on the demuxer/remuxer interface. Needed for discontinuities/track-switches (or at stream start)\n   * Resets all internal track instances of the demuxer.\n   *\n   * @override Implements generic demuxing/remuxing interface (see DemuxerInline)\n   * @param {object} initSegment\n   * @param {string} audioCodec\n   * @param {string} videoCodec\n   * @param {number} duration (in TS timescale = 90kHz)\n   */\n  resetInitSegment (initSegment, audioCodec, videoCodec, duration) {\n    this.pmtParsed = false;\n    this._pmtId = -1;\n\n    this._avcTrack = TSDemuxer.createTrack('video', duration);\n    this._audioTrack = TSDemuxer.createTrack('audio', duration);\n    this._id3Track = TSDemuxer.createTrack('id3', duration);\n    this._txtTrack = TSDemuxer.createTrack('text', duration);\n\n    // flush any partial content\n    this.aacOverFlow = null;\n    this.aacLastPTS = null;\n    this.avcSample = null;\n    this.audioCodec = audioCodec;\n    this.videoCodec = videoCodec;\n    this._duration = duration;\n  }\n\n  /**\n   *\n   * @override\n   */\n  resetTimeStamp () {}\n\n  // feed incoming data to the front of the parsing pipeline\n  append (data, timeOffset, contiguous, accurateTimeOffset) {\n    let start, len = data.length, stt, pid, atf, offset, pes,\n      unknownPIDs = false;\n    this.contiguous = contiguous;\n    let pmtParsed = this.pmtParsed,\n      avcTrack = this._avcTrack,\n      audioTrack = this._audioTrack,\n      id3Track = this._id3Track,\n      avcId = avcTrack.pid,\n      audioId = audioTrack.pid,\n      id3Id = id3Track.pid,\n      pmtId = this._pmtId,\n      avcData = avcTrack.pesData,\n      audioData = audioTrack.pesData,\n      id3Data = id3Track.pesData,\n      parsePAT = this._parsePAT,\n      parsePMT = this._parsePMT,\n      parsePES = this._parsePES,\n      parseAVCPES = this._parseAVCPES.bind(this),\n      parseAACPES = this._parseAACPES.bind(this),\n      parseMPEGPES = this._parseMPEGPES.bind(this),\n      parseID3PES = this._parseID3PES.bind(this);\n\n    const syncOffset = TSDemuxer._syncOffset(data);\n\n    // don't parse last TS packet if incomplete\n    len -= (len + syncOffset) % 188;\n\n    // loop through TS packets\n    for (start = syncOffset; start < len; start += 188) {\n      if (data[start] === 0x47) {\n        stt = !!(data[start + 1] & 0x40);\n        // pid is a 13-bit field starting at the last bit of TS[1]\n        pid = ((data[start + 1] & 0x1f) << 8) + data[start + 2];\n        atf = (data[start + 3] & 0x30) >> 4;\n        // if an adaption field is present, its length is specified by the fifth byte of the TS packet header.\n        if (atf > 1) {\n          offset = start + 5 + data[start + 4];\n          // continue if there is only adaptation field\n          if (offset === (start + 188))\n            continue;\n        } else {\n          offset = start + 4;\n        }\n        switch (pid) {\n        case avcId:\n          if (stt) {\n            if (avcData && (pes = parsePES(avcData)) && pes.pts !== undefined)\n              parseAVCPES(pes, false);\n\n            avcData = { data: [], size: 0 };\n          }\n          if (avcData) {\n            avcData.data.push(data.subarray(offset, start + 188));\n            avcData.size += start + 188 - offset;\n          }\n          break;\n        case audioId:\n          if (stt) {\n            if (audioData && (pes = parsePES(audioData)) && pes.pts !== undefined) {\n              if (audioTrack.isAAC)\n                parseAACPES(pes);\n              else\n                parseMPEGPES(pes);\n            }\n            audioData = { data: [], size: 0 };\n          }\n          if (audioData) {\n            audioData.data.push(data.subarray(offset, start + 188));\n            audioData.size += start + 188 - offset;\n          }\n          break;\n        case id3Id:\n          if (stt) {\n            if (id3Data && (pes = parsePES(id3Data)) && pes.pts !== undefined)\n              parseID3PES(pes);\n\n            id3Data = { data: [], size: 0 };\n          }\n          if (id3Data) {\n            id3Data.data.push(data.subarray(offset, start + 188));\n            id3Data.size += start + 188 - offset;\n          }\n          break;\n        case 0:\n          if (stt)\n            offset += data[offset] + 1;\n\n          pmtId = this._pmtId = parsePAT(data, offset);\n          break;\n        case pmtId:\n          if (stt)\n            offset += data[offset] + 1;\n\n          let parsedPIDs = parsePMT(data, offset, this.typeSupported.mpeg === true || this.typeSupported.mp3 === true, this.sampleAes != null);\n\n          // only update track id if track PID found while parsing PMT\n          // this is to avoid resetting the PID to -1 in case\n          // track PID transiently disappears from the stream\n          // this could happen in case of transient missing audio samples for example\n          // NOTE this is only the PID of the track as found in TS,\n          // but we are not using this for MP4 track IDs.\n          avcId = parsedPIDs.avc;\n          if (avcId > 0)\n            avcTrack.pid = avcId;\n\n          audioId = parsedPIDs.audio;\n          if (audioId > 0) {\n            audioTrack.pid = audioId;\n            audioTrack.isAAC = parsedPIDs.isAAC;\n          }\n          id3Id = parsedPIDs.id3;\n          if (id3Id > 0)\n            id3Track.pid = id3Id;\n\n          if (unknownPIDs && !pmtParsed) {\n            logger.log('reparse from beginning');\n            unknownPIDs = false;\n            // we set it to -188, the += 188 in the for loop will reset start to 0\n            start = syncOffset - 188;\n          }\n          pmtParsed = this.pmtParsed = true;\n          break;\n        case 17:\n        case 0x1fff:\n          break;\n        default:\n          unknownPIDs = true;\n          break;\n        }\n      } else {\n        this.observer.trigger(Event.ERROR, { type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.FRAG_PARSING_ERROR, fatal: false, reason: 'TS packet did not start with 0x47' });\n      }\n    }\n    // try to parse last PES packets\n    if (avcData && (pes = parsePES(avcData)) && pes.pts !== undefined) {\n      parseAVCPES(pes, true);\n      avcTrack.pesData = null;\n    } else {\n      // either avcData null or PES truncated, keep it for next frag parsing\n      avcTrack.pesData = avcData;\n    }\n\n    if (audioData && (pes = parsePES(audioData)) && pes.pts !== undefined) {\n      if (audioTrack.isAAC)\n        parseAACPES(pes);\n      else\n        parseMPEGPES(pes);\n\n      audioTrack.pesData = null;\n    } else {\n      if (audioData && audioData.size)\n        logger.log('last AAC PES packet truncated,might overlap between fragments');\n\n      // either audioData null or PES truncated, keep it for next frag parsing\n      audioTrack.pesData = audioData;\n    }\n\n    if (id3Data && (pes = parsePES(id3Data)) && pes.pts !== undefined) {\n      parseID3PES(pes);\n      id3Track.pesData = null;\n    } else {\n      // either id3Data null or PES truncated, keep it for next frag parsing\n      id3Track.pesData = id3Data;\n    }\n\n    if (this.sampleAes == null)\n      this.remuxer.remux(audioTrack, avcTrack, id3Track, this._txtTrack, timeOffset, contiguous, accurateTimeOffset);\n    else\n      this.decryptAndRemux(audioTrack, avcTrack, id3Track, this._txtTrack, timeOffset, contiguous, accurateTimeOffset);\n  }\n\n  decryptAndRemux (audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset) {\n    if (audioTrack.samples && audioTrack.isAAC) {\n      let localthis = this;\n      this.sampleAes.decryptAacSamples(audioTrack.samples, 0, function () {\n        localthis.decryptAndRemuxAvc(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset);\n      });\n    } else {\n      this.decryptAndRemuxAvc(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset);\n    }\n  }\n\n  decryptAndRemuxAvc (audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset) {\n    if (videoTrack.samples) {\n      let localthis = this;\n      this.sampleAes.decryptAvcSamples(videoTrack.samples, 0, 0, function () {\n        localthis.remuxer.remux(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset);\n      });\n    } else {\n      this.remuxer.remux(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset);\n    }\n  }\n\n  destroy () {\n    this._initPTS = this._initDTS = undefined;\n    this._duration = 0;\n  }\n\n  _parsePAT (data, offset) {\n    // skip the PSI header and parse the first PMT entry\n    return (data[offset + 10] & 0x1F) << 8 | data[offset + 11];\n    // logger.log('PMT PID:'  + this._pmtId);\n  }\n\n  _parsePMT (data, offset, mpegSupported, isSampleAes) {\n    let sectionLength, tableEnd, programInfoLength, pid, result = { audio: -1, avc: -1, id3: -1, isAAC: true };\n    sectionLength = (data[offset + 1] & 0x0f) << 8 | data[offset + 2];\n    tableEnd = offset + 3 + sectionLength - 4;\n    // to determine where the table is, we have to figure out how\n    // long the program info descriptors are\n    programInfoLength = (data[offset + 10] & 0x0f) << 8 | data[offset + 11];\n    // advance the offset to the first entry in the mapping table\n    offset += 12 + programInfoLength;\n    while (offset < tableEnd) {\n      pid = (data[offset + 1] & 0x1F) << 8 | data[offset + 2];\n      switch (data[offset]) {\n      case 0xcf: // SAMPLE-AES AAC\n        if (!isSampleAes) {\n          logger.log('unkown stream type:' + data[offset]);\n          break;\n        }\n        /* falls through */\n\n        // ISO/IEC 13818-7 ADTS AAC (MPEG-2 lower bit-rate audio)\n      case 0x0f:\n        // logger.log('AAC PID:'  + pid);\n        if (result.audio === -1)\n          result.audio = pid;\n\n        break;\n\n        // Packetized metadata (ID3)\n      case 0x15:\n        // logger.log('ID3 PID:'  + pid);\n        if (result.id3 === -1)\n          result.id3 = pid;\n\n        break;\n\n      case 0xdb: // SAMPLE-AES AVC\n        if (!isSampleAes) {\n          logger.log('unkown stream type:' + data[offset]);\n          break;\n        }\n        /* falls through */\n\n        // ITU-T Rec. H.264 and ISO/IEC 14496-10 (lower bit-rate video)\n      case 0x1b:\n        // logger.log('AVC PID:'  + pid);\n        if (result.avc === -1)\n          result.avc = pid;\n\n        break;\n\n        // ISO/IEC 11172-3 (MPEG-1 audio)\n        // or ISO/IEC 13818-3 (MPEG-2 halved sample rate audio)\n      case 0x03:\n      case 0x04:\n        // logger.log('MPEG PID:'  + pid);\n        if (!mpegSupported) {\n          logger.log('MPEG audio found, not supported in this browser for now');\n        } else if (result.audio === -1) {\n          result.audio = pid;\n          result.isAAC = false;\n        }\n        break;\n\n      case 0x24:\n        logger.warn('HEVC stream type found, not supported for now');\n        break;\n\n      default:\n        logger.log('unkown stream type:' + data[offset]);\n        break;\n      }\n      // move to the next table entry\n      // skip past the elementary stream descriptors, if present\n      offset += ((data[offset + 3] & 0x0F) << 8 | data[offset + 4]) + 5;\n    }\n    return result;\n  }\n\n  _parsePES (stream) {\n    let i = 0, frag, pesFlags, pesPrefix, pesLen, pesHdrLen, pesData, pesPts, pesDts, payloadStartOffset, data = stream.data;\n    // safety check\n    if (!stream || stream.size === 0)\n      return null;\n\n    // we might need up to 19 bytes to read PES header\n    // if first chunk of data is less than 19 bytes, let's merge it with following ones until we get 19 bytes\n    // usually only one merge is needed (and this is rare ...)\n    while (data[0].length < 19 && data.length > 1) {\n      let newData = new Uint8Array(data[0].length + data[1].length);\n      newData.set(data[0]);\n      newData.set(data[1], data[0].length);\n      data[0] = newData;\n      data.splice(1, 1);\n    }\n    // retrieve PTS/DTS from first fragment\n    frag = data[0];\n    pesPrefix = (frag[0] << 16) + (frag[1] << 8) + frag[2];\n    if (pesPrefix === 1) {\n      pesLen = (frag[4] << 8) + frag[5];\n      // if PES parsed length is not zero and greater than total received length, stop parsing. PES might be truncated\n      // minus 6 : PES header size\n      if (pesLen && pesLen > stream.size - 6)\n        return null;\n\n      pesFlags = frag[7];\n      if (pesFlags & 0xC0) {\n        /* PES header described here : http://dvd.sourceforge.net/dvdinfo/pes-hdr.html\n            as PTS / DTS is 33 bit we cannot use bitwise operator in JS,\n            as Bitwise operators treat their operands as a sequence of 32 bits */\n        pesPts = (frag[9] & 0x0E) * 536870912 +// 1 << 29\n          (frag[10] & 0xFF) * 4194304 +// 1 << 22\n          (frag[11] & 0xFE) * 16384 +// 1 << 14\n          (frag[12] & 0xFF) * 128 +// 1 << 7\n          (frag[13] & 0xFE) / 2;\n        // check if greater than 2^32 -1\n        if (pesPts > 4294967295) {\n          // decrement 2^33\n          pesPts -= 8589934592;\n        }\n        if (pesFlags & 0x40) {\n          pesDts = (frag[14] & 0x0E) * 536870912 +// 1 << 29\n            (frag[15] & 0xFF) * 4194304 +// 1 << 22\n            (frag[16] & 0xFE) * 16384 +// 1 << 14\n            (frag[17] & 0xFF) * 128 +// 1 << 7\n            (frag[18] & 0xFE) / 2;\n          // check if greater than 2^32 -1\n          if (pesDts > 4294967295) {\n            // decrement 2^33\n            pesDts -= 8589934592;\n          }\n          if (pesPts - pesDts > 60 * 90000) {\n            logger.warn(`${Math.round((pesPts - pesDts) / 90000)}s delta between PTS and DTS, align them`);\n            pesPts = pesDts;\n          }\n        } else {\n          pesDts = pesPts;\n        }\n      }\n      pesHdrLen = frag[8];\n      // 9 bytes : 6 bytes for PES header + 3 bytes for PES extension\n      payloadStartOffset = pesHdrLen + 9;\n\n      stream.size -= payloadStartOffset;\n      // reassemble PES packet\n      pesData = new Uint8Array(stream.size);\n      for (let j = 0, dataLen = data.length; j < dataLen; j++) {\n        frag = data[j];\n        let len = frag.byteLength;\n        if (payloadStartOffset) {\n          if (payloadStartOffset > len) {\n            // trim full frag if PES header bigger than frag\n            payloadStartOffset -= len;\n            continue;\n          } else {\n            // trim partial frag if PES header smaller than frag\n            frag = frag.subarray(payloadStartOffset);\n            len -= payloadStartOffset;\n            payloadStartOffset = 0;\n          }\n        }\n        pesData.set(frag, i);\n        i += len;\n      }\n      if (pesLen) {\n        // payload size : remove PES header + PES extension\n        pesLen -= pesHdrLen + 3;\n      }\n      return { data: pesData, pts: pesPts, dts: pesDts, len: pesLen };\n    } else {\n      return null;\n    }\n  }\n\n  pushAccesUnit (avcSample, avcTrack) {\n    if (avcSample.units.length && avcSample.frame) {\n      const samples = avcTrack.samples;\n      const nbSamples = samples.length;\n      // only push AVC sample if starting with a keyframe is not mandatory OR\n      //    if keyframe already found in this fragment OR\n      //       keyframe found in last fragment (track.sps) AND\n      //          samples already appended (we already found a keyframe in this fragment) OR fragment is contiguous\n      if (!this.config.forceKeyFrameOnDiscontinuity ||\n          avcSample.key === true ||\n          (avcTrack.sps && (nbSamples || this.contiguous))) {\n        avcSample.id = nbSamples;\n        samples.push(avcSample);\n      } else {\n        // dropped samples, track it\n        avcTrack.dropped++;\n      }\n    }\n    if (avcSample.debug.length)\n      logger.log(avcSample.pts + '/' + avcSample.dts + ':' + avcSample.debug);\n  }\n\n  _parseAVCPES (pes, last) {\n    // logger.log('parse new PES');\n    let track = this._avcTrack,\n      units = this._parseAVCNALu(pes.data),\n      debug = false,\n      expGolombDecoder,\n      avcSample = this.avcSample,\n      push,\n      spsfound = false,\n      i,\n      pushAccesUnit = this.pushAccesUnit.bind(this),\n      createAVCSample = function (key, pts, dts, debug) {\n        return { key: key, pts: pts, dts: dts, units: [], debug: debug };\n      };\n    // free pes.data to save up some memory\n    pes.data = null;\n\n    // if new NAL units found and last sample still there, let's push ...\n    // this helps parsing streams with missing AUD (only do this if AUD never found)\n    if (avcSample && units.length && !track.audFound) {\n      pushAccesUnit(avcSample, track);\n      avcSample = this.avcSample = createAVCSample(false, pes.pts, pes.dts, '');\n    }\n\n    units.forEach(unit => {\n      switch (unit.type) {\n      // NDR\n      case 1:\n        push = true;\n        if (!avcSample)\n          avcSample = this.avcSample = createAVCSample(true, pes.pts, pes.dts, '');\n\n        if (debug)\n          avcSample.debug += 'NDR ';\n\n        avcSample.frame = true;\n        let data = unit.data;\n        // only check slice type to detect KF in case SPS found in same packet (any keyframe is preceded by SPS ...)\n        if (spsfound && data.length > 4) {\n          // retrieve slice type by parsing beginning of NAL unit (follow H264 spec, slice_header definition) to detect keyframe embedded in NDR\n          let sliceType = new ExpGolomb(data).readSliceType();\n          // 2 : I slice, 4 : SI slice, 7 : I slice, 9: SI slice\n          // SI slice : A slice that is coded using intra prediction only and using quantisation of the prediction samples.\n          // An SI slice can be coded such that its decoded samples can be constructed identically to an SP slice.\n          // I slice: A slice that is not an SI slice that is decoded using intra prediction only.\n          // if (sliceType === 2 || sliceType === 7) {\n          if (sliceType === 2 || sliceType === 4 || sliceType === 7 || sliceType === 9)\n            avcSample.key = true;\n        }\n        break;\n        // IDR\n      case 5:\n        push = true;\n        // handle PES not starting with AUD\n        if (!avcSample)\n          avcSample = this.avcSample = createAVCSample(true, pes.pts, pes.dts, '');\n\n        if (debug)\n          avcSample.debug += 'IDR ';\n\n        avcSample.key = true;\n        avcSample.frame = true;\n        break;\n        // SEI\n      case 6:\n        push = true;\n        if (debug && avcSample)\n          avcSample.debug += 'SEI ';\n\n        expGolombDecoder = new ExpGolomb(this.discardEPB(unit.data));\n\n        // skip frameType\n        expGolombDecoder.readUByte();\n\n        var payloadType = 0;\n        var payloadSize = 0;\n        var endOfCaptions = false;\n        var b = 0;\n\n        while (!endOfCaptions && expGolombDecoder.bytesAvailable > 1) {\n          payloadType = 0;\n          do {\n            b = expGolombDecoder.readUByte();\n            payloadType += b;\n          } while (b === 0xFF);\n\n          // Parse payload size.\n          payloadSize = 0;\n          do {\n            b = expGolombDecoder.readUByte();\n            payloadSize += b;\n          } while (b === 0xFF);\n\n          // TODO: there can be more than one payload in an SEI packet...\n          // TODO: need to read type and size in a while loop to get them all\n          if (payloadType === 4 && expGolombDecoder.bytesAvailable !== 0) {\n            endOfCaptions = true;\n\n            let countryCode = expGolombDecoder.readUByte();\n\n            if (countryCode === 181) {\n              let providerCode = expGolombDecoder.readUShort();\n\n              if (providerCode === 49) {\n                let userStructure = expGolombDecoder.readUInt();\n\n                if (userStructure === 0x47413934) {\n                  let userDataType = expGolombDecoder.readUByte();\n\n                  // Raw CEA-608 bytes wrapped in CEA-708 packet\n                  if (userDataType === 3) {\n                    let firstByte = expGolombDecoder.readUByte();\n                    let secondByte = expGolombDecoder.readUByte();\n\n                    let totalCCs = 31 & firstByte;\n                    let byteArray = [firstByte, secondByte];\n\n                    for (i = 0; i < totalCCs; i++) {\n                      // 3 bytes per CC\n                      byteArray.push(expGolombDecoder.readUByte());\n                      byteArray.push(expGolombDecoder.readUByte());\n                      byteArray.push(expGolombDecoder.readUByte());\n                    }\n\n                    this._insertSampleInOrder(this._txtTrack.samples, { type: 3, pts: pes.pts, bytes: byteArray });\n                  }\n                }\n              }\n            }\n          } else if (payloadSize < expGolombDecoder.bytesAvailable) {\n            for (i = 0; i < payloadSize; i++)\n              expGolombDecoder.readUByte();\n          }\n        }\n        break;\n        // SPS\n      case 7:\n        push = true;\n        spsfound = true;\n        if (debug && avcSample)\n          avcSample.debug += 'SPS ';\n\n        if (!track.sps) {\n          expGolombDecoder = new ExpGolomb(unit.data);\n          let config = expGolombDecoder.readSPS();\n          track.width = config.width;\n          track.height = config.height;\n          track.pixelRatio = config.pixelRatio;\n          track.sps = [unit.data];\n          track.duration = this._duration;\n          let codecarray = unit.data.subarray(1, 4);\n          let codecstring = 'avc1.';\n          for (i = 0; i < 3; i++) {\n            let h = codecarray[i].toString(16);\n            if (h.length < 2)\n              h = '0' + h;\n\n            codecstring += h;\n          }\n          track.codec = codecstring;\n        }\n        break;\n        // PPS\n      case 8:\n        push = true;\n        if (debug && avcSample)\n          avcSample.debug += 'PPS ';\n\n        if (!track.pps)\n          track.pps = [unit.data];\n\n        break;\n        // AUD\n      case 9:\n        push = false;\n        track.audFound = true;\n        if (avcSample)\n          pushAccesUnit(avcSample, track);\n\n        avcSample = this.avcSample = createAVCSample(false, pes.pts, pes.dts, debug ? 'AUD ' : '');\n        break;\n        // Filler Data\n      case 12:\n        push = false;\n        break;\n      default:\n        push = false;\n        if (avcSample)\n          avcSample.debug += 'unknown NAL ' + unit.type + ' ';\n\n        break;\n      }\n      if (avcSample && push) {\n        let units = avcSample.units;\n        units.push(unit);\n      }\n    });\n    // if last PES packet, push samples\n    if (last && avcSample) {\n      pushAccesUnit(avcSample, track);\n      this.avcSample = null;\n    }\n  }\n\n  _insertSampleInOrder (arr, data) {\n    let len = arr.length;\n    if (len > 0) {\n      if (data.pts >= arr[len - 1].pts) {\n        arr.push(data);\n      } else {\n        for (let pos = len - 1; pos >= 0; pos--) {\n          if (data.pts < arr[pos].pts) {\n            arr.splice(pos, 0, data);\n            break;\n          }\n        }\n      }\n    } else {\n      arr.push(data);\n    }\n  }\n\n  _getLastNalUnit () {\n    let avcSample = this.avcSample, lastUnit;\n    // try to fallback to previous sample if current one is empty\n    if (!avcSample || avcSample.units.length === 0) {\n      let track = this._avcTrack, samples = track.samples;\n      avcSample = samples[samples.length - 1];\n    }\n    if (avcSample) {\n      let units = avcSample.units;\n      lastUnit = units[units.length - 1];\n    }\n    return lastUnit;\n  }\n\n  _parseAVCNALu (array) {\n    let i = 0, len = array.byteLength, value, overflow, track = this._avcTrack, state = track.naluState || 0, lastState = state;\n    let units = [], unit, unitType, lastUnitStart = -1, lastUnitType;\n    // logger.log('PES:' + Hex.hexDump(array));\n\n    if (state === -1) {\n    // special use case where we found 3 or 4-byte start codes exactly at the end of previous PES packet\n      lastUnitStart = 0;\n      // NALu type is value read from offset 0\n      lastUnitType = array[0] & 0x1f;\n      state = 0;\n      i = 1;\n    }\n\n    while (i < len) {\n      value = array[i++];\n      // optimization. state 0 and 1 are the predominant case. let's handle them outside of the switch/case\n      if (!state) {\n        state = value ? 0 : 1;\n        continue;\n      }\n      if (state === 1) {\n        state = value ? 0 : 2;\n        continue;\n      }\n      // here we have state either equal to 2 or 3\n      if (!value) {\n        state = 3;\n      } else if (value === 1) {\n        if (lastUnitStart >= 0) {\n          unit = { data: array.subarray(lastUnitStart, i - state - 1), type: lastUnitType };\n          // logger.log('pushing NALU, type/size:' + unit.type + '/' + unit.data.byteLength);\n          units.push(unit);\n        } else {\n          // lastUnitStart is undefined => this is the first start code found in this PES packet\n          // first check if start code delimiter is overlapping between 2 PES packets,\n          // ie it started in last packet (lastState not zero)\n          // and ended at the beginning of this PES packet (i <= 4 - lastState)\n          let lastUnit = this._getLastNalUnit();\n          if (lastUnit) {\n            if (lastState && (i <= 4 - lastState)) {\n              // start delimiter overlapping between PES packets\n              // strip start delimiter bytes from the end of last NAL unit\n              // check if lastUnit had a state different from zero\n              if (lastUnit.state) {\n                // strip last bytes\n                lastUnit.data = lastUnit.data.subarray(0, lastUnit.data.byteLength - lastState);\n              }\n            }\n            // If NAL units are not starting right at the beginning of the PES packet, push preceding data into previous NAL unit.\n            overflow = i - state - 1;\n            if (overflow > 0) {\n              // logger.log('first NALU found with overflow:' + overflow);\n              let tmp = new Uint8Array(lastUnit.data.byteLength + overflow);\n              tmp.set(lastUnit.data, 0);\n              tmp.set(array.subarray(0, overflow), lastUnit.data.byteLength);\n              lastUnit.data = tmp;\n            }\n          }\n        }\n        // check if we can read unit type\n        if (i < len) {\n          unitType = array[i] & 0x1f;\n          // logger.log('find NALU @ offset:' + i + ',type:' + unitType);\n          lastUnitStart = i;\n          lastUnitType = unitType;\n          state = 0;\n        } else {\n          // not enough byte to read unit type. let's read it on next PES parsing\n          state = -1;\n        }\n      } else {\n        state = 0;\n      }\n    }\n    if (lastUnitStart >= 0 && state >= 0) {\n      unit = { data: array.subarray(lastUnitStart, len), type: lastUnitType, state: state };\n      units.push(unit);\n      // logger.log('pushing NALU, type/size/state:' + unit.type + '/' + unit.data.byteLength + '/' + state);\n    }\n    // no NALu found\n    if (units.length === 0) {\n      // append pes.data to previous NAL unit\n      let lastUnit = this._getLastNalUnit();\n      if (lastUnit) {\n        let tmp = new Uint8Array(lastUnit.data.byteLength + array.byteLength);\n        tmp.set(lastUnit.data, 0);\n        tmp.set(array, lastUnit.data.byteLength);\n        lastUnit.data = tmp;\n      }\n    }\n    track.naluState = state;\n    return units;\n  }\n\n  /**\n   * remove Emulation Prevention bytes from a RBSP\n   */\n  discardEPB (data) {\n    let length = data.byteLength,\n      EPBPositions = [],\n      i = 1,\n      newLength, newData;\n\n    // Find all `Emulation Prevention Bytes`\n    while (i < length - 2) {\n      if (data[i] === 0 &&\n          data[i + 1] === 0 &&\n          data[i + 2] === 0x03) {\n        EPBPositions.push(i + 2);\n        i += 2;\n      } else {\n        i++;\n      }\n    }\n\n    // If no Emulation Prevention Bytes were found just return the original\n    // array\n    if (EPBPositions.length === 0)\n      return data;\n\n    // Create a new array to hold the NAL unit data\n    newLength = length - EPBPositions.length;\n    newData = new Uint8Array(newLength);\n    let sourceIndex = 0;\n\n    for (i = 0; i < newLength; sourceIndex++, i++) {\n      if (sourceIndex === EPBPositions[0]) {\n        // Skip this byte\n        sourceIndex++;\n        // Remove this position index\n        EPBPositions.shift();\n      }\n      newData[i] = data[sourceIndex];\n    }\n    return newData;\n  }\n\n  _parseAACPES (pes) {\n    let track = this._audioTrack,\n      data = pes.data,\n      pts = pes.pts,\n      startOffset = 0,\n      aacOverFlow = this.aacOverFlow,\n      aacLastPTS = this.aacLastPTS,\n      frameDuration, frameIndex, offset, stamp, len;\n    if (aacOverFlow) {\n      let tmp = new Uint8Array(aacOverFlow.byteLength + data.byteLength);\n      tmp.set(aacOverFlow, 0);\n      tmp.set(data, aacOverFlow.byteLength);\n      // logger.log(`AAC: append overflowing ${aacOverFlow.byteLength} bytes to beginning of new PES`);\n      data = tmp;\n    }\n    // look for ADTS header (0xFFFx)\n    for (offset = startOffset, len = data.length; offset < len - 1; offset++) {\n      if (ADTS.isHeader(data, offset))\n        break;\n    }\n    // if ADTS header does not start straight from the beginning of the PES payload, raise an error\n    if (offset) {\n      let reason, fatal;\n      if (offset < len - 1) {\n        reason = `AAC PES did not start with ADTS header,offset:${offset}`;\n        fatal = false;\n      } else {\n        reason = 'no ADTS header found in AAC PES';\n        fatal = true;\n      }\n      logger.warn(`parsing error:${reason}`);\n      this.observer.trigger(Event.ERROR, { type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.FRAG_PARSING_ERROR, fatal: fatal, reason: reason });\n      if (fatal)\n        return;\n    }\n\n    ADTS.initTrackConfig(track, this.observer, data, offset, this.audioCodec);\n    frameIndex = 0;\n    frameDuration = ADTS.getFrameDuration(track.samplerate);\n\n    // if last AAC frame is overflowing, we should ensure timestamps are contiguous:\n    // first sample PTS should be equal to last sample PTS + frameDuration\n    if (aacOverFlow && aacLastPTS) {\n      let newPTS = aacLastPTS + frameDuration;\n      if (Math.abs(newPTS - pts) > 1) {\n        logger.log(`AAC: align PTS for overlapping frames by ${Math.round((newPTS - pts) / 90)}`);\n        pts = newPTS;\n      }\n    }\n\n    // scan for aac samples\n    while (offset < len) {\n      if (ADTS.isHeader(data, offset) && (offset + 5) < len) {\n        let frame = ADTS.appendFrame(track, data, offset, pts, frameIndex);\n        if (frame) {\n          // logger.log(`${Math.round(frame.sample.pts)} : AAC`);\n          offset += frame.length;\n          stamp = frame.sample.pts;\n          frameIndex++;\n        } else {\n          // logger.log('Unable to parse AAC frame');\n          break;\n        }\n      } else {\n        // nothing found, keep looking\n        offset++;\n      }\n    }\n\n    if (offset < len)\n      aacOverFlow = data.subarray(offset, len);\n    // logger.log(`AAC: overflow detected:${len-offset}`);\n    else\n      aacOverFlow = null;\n\n    this.aacOverFlow = aacOverFlow;\n    this.aacLastPTS = stamp;\n  }\n\n  _parseMPEGPES (pes) {\n    let data = pes.data;\n    let length = data.length;\n    let frameIndex = 0;\n    let offset = 0;\n    let pts = pes.pts;\n\n    while (offset < length) {\n      if (MpegAudio.isHeader(data, offset)) {\n        let frame = MpegAudio.appendFrame(this._audioTrack, data, offset, pts, frameIndex);\n        if (frame) {\n          offset += frame.length;\n          frameIndex++;\n        } else {\n          // logger.log('Unable to parse Mpeg audio frame');\n          break;\n        }\n      } else {\n        // nothing found, keep looking\n        offset++;\n      }\n    }\n  }\n\n  _parseID3PES (pes) {\n    this._id3Track.samples.push(pes);\n  }\n}\n\nexport default TSDemuxer;\n","export const ErrorTypes = {\n  // Identifier for a network error (loading error / timeout ...)\n  NETWORK_ERROR: 'networkError',\n  // Identifier for a media Error (video/parsing/mediasource error)\n  MEDIA_ERROR: 'mediaError',\n  // EME (encrypted media extensions) errors\n  KEY_SYSTEM_ERROR: 'keySystemError',\n  // Identifier for a mux Error (demuxing/remuxing)\n  MUX_ERROR: 'muxError',\n  // Identifier for all other errors\n  OTHER_ERROR: 'otherError'\n};\n\n/**\n * @enum {ErrorDetails}\n * @typedef {string} ErrorDetail\n */\nexport const ErrorDetails = {\n  KEY_SYSTEM_NO_KEYS: 'keySystemNoKeys',\n  KEY_SYSTEM_NO_ACCESS: 'keySystemNoAccess',\n  KEY_SYSTEM_NO_SESSION: 'keySystemNoSession',\n  KEY_SYSTEM_LICENSE_REQUEST_FAILED: 'keySystemLicenseRequestFailed',\n  // Identifier for a manifest load error - data: { url : faulty URL, response : { code: error code, text: error text }}\n  MANIFEST_LOAD_ERROR: 'manifestLoadError',\n  // Identifier for a manifest load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\n  MANIFEST_LOAD_TIMEOUT: 'manifestLoadTimeOut',\n  // Identifier for a manifest parsing error - data: { url : faulty URL, reason : error reason}\n  MANIFEST_PARSING_ERROR: 'manifestParsingError',\n  // Identifier for a manifest with only incompatible codecs error - data: { url : faulty URL, reason : error reason}\n  MANIFEST_INCOMPATIBLE_CODECS_ERROR: 'manifestIncompatibleCodecsError',\n  // Identifier for a level load error - data: { url : faulty URL, response : { code: error code, text: error text }}\n  LEVEL_LOAD_ERROR: 'levelLoadError',\n  // Identifier for a level load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\n  LEVEL_LOAD_TIMEOUT: 'levelLoadTimeOut',\n  // Identifier for a level switch error - data: { level : faulty level Id, event : error description}\n  LEVEL_SWITCH_ERROR: 'levelSwitchError',\n  // Identifier for an audio track load error - data: { url : faulty URL, response : { code: error code, text: error text }}\n  AUDIO_TRACK_LOAD_ERROR: 'audioTrackLoadError',\n  // Identifier for an audio track load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\n  AUDIO_TRACK_LOAD_TIMEOUT: 'audioTrackLoadTimeOut',\n  // Identifier for fragment load error - data: { frag : fragment object, response : { code: error code, text: error text }}\n  FRAG_LOAD_ERROR: 'fragLoadError',\n  // Identifier for fragment load timeout error - data: { frag : fragment object}\n  FRAG_LOAD_TIMEOUT: 'fragLoadTimeOut',\n  // Identifier for a fragment decryption error event - data: {id : demuxer Id,frag: fragment object, reason : parsing error description }\n  FRAG_DECRYPT_ERROR: 'fragDecryptError',\n  // Identifier for a fragment parsing error event - data: { id : demuxer Id, reason : parsing error description }\n  // will be renamed DEMUX_PARSING_ERROR and switched to MUX_ERROR in the next major release\n  FRAG_PARSING_ERROR: 'fragParsingError',\n  // Identifier for a remux alloc error event - data: { id : demuxer Id, frag : fragment object, bytes : nb of bytes on which allocation failed , reason : error text }\n  REMUX_ALLOC_ERROR: 'remuxAllocError',\n  // Identifier for decrypt key load error - data: { frag : fragment object, response : { code: error code, text: error text }}\n  KEY_LOAD_ERROR: 'keyLoadError',\n  // Identifier for decrypt key load timeout error - data: { frag : fragment object}\n  KEY_LOAD_TIMEOUT: 'keyLoadTimeOut',\n  // Triggered when an exception occurs while adding a sourceBuffer to MediaSource - data : {  err : exception , mimeType : mimeType }\n  BUFFER_ADD_CODEC_ERROR: 'bufferAddCodecError',\n  // Identifier for a buffer append error - data: append error description\n  BUFFER_APPEND_ERROR: 'bufferAppendError',\n  // Identifier for a buffer appending error event - data: appending error description\n  BUFFER_APPENDING_ERROR: 'bufferAppendingError',\n  // Identifier for a buffer stalled error event\n  BUFFER_STALLED_ERROR: 'bufferStalledError',\n  // Identifier for a buffer full event\n  BUFFER_FULL_ERROR: 'bufferFullError',\n  // Identifier for a buffer seek over hole event\n  BUFFER_SEEK_OVER_HOLE: 'bufferSeekOverHole',\n  // Identifier for a buffer nudge on stall (playback is stuck although currentTime is in a buffered area)\n  BUFFER_NUDGE_ON_STALL: 'bufferNudgeOnStall',\n  // Identifier for an internal exception happening inside hls.js while handling an event\n  INTERNAL_EXCEPTION: 'internalException'\n};\n","/*\n*\n* All objects in the event handling chain should inherit from this class\n*\n*/\n\nimport { logger } from './utils/logger';\nimport { ErrorTypes, ErrorDetails } from './errors';\nimport Event from './events';\n\nconst FORBIDDEN_EVENT_NAMES = new Set([\n  'hlsEventGeneric',\n  'hlsHandlerDestroying',\n  'hlsHandlerDestroyed'\n]);\n\nclass EventHandler {\n  constructor (hls, ...events) {\n    this.hls = hls;\n    this.onEvent = this.onEvent.bind(this);\n    this.handledEvents = events;\n    this.useGenericHandler = true;\n\n    this.registerListeners();\n  }\n\n  destroy () {\n    this.onHandlerDestroying();\n    this.unregisterListeners();\n    this.onHandlerDestroyed();\n  }\n\n  onHandlerDestroying () {}\n  onHandlerDestroyed () {}\n\n  isEventHandler () {\n    return typeof this.handledEvents === 'object' && this.handledEvents.length && typeof this.onEvent === 'function';\n  }\n\n  registerListeners () {\n    if (this.isEventHandler()) {\n      this.handledEvents.forEach(function (event) {\n        if (FORBIDDEN_EVENT_NAMES.has(event))\n          throw new Error('Forbidden event-name: ' + event);\n\n        this.hls.on(event, this.onEvent);\n      }, this);\n    }\n  }\n\n  unregisterListeners () {\n    if (this.isEventHandler()) {\n      this.handledEvents.forEach(function (event) {\n        this.hls.off(event, this.onEvent);\n      }, this);\n    }\n  }\n\n  /**\n   * arguments: event (string), data (any)\n   */\n  onEvent (event, data) {\n    this.onEventGeneric(event, data);\n  }\n\n  onEventGeneric (event, data) {\n    let eventToFunction = function (event, data) {\n      let funcName = 'on' + event.replace('hls', '');\n      if (typeof this[funcName] !== 'function')\n        throw new Error(`Event ${event} has no generic handler in this ${this.constructor.name} class (tried ${funcName})`);\n\n      return this[funcName].bind(this, data);\n    };\n    try {\n      eventToFunction.call(this, event, data).call();\n    } catch (err) {\n      logger.error(`An internal error happened while handling event ${event}. Error message: \"${err.message}\". Here is a stacktrace:`, err);\n      this.hls.trigger(Event.ERROR, { type: ErrorTypes.OTHER_ERROR, details: ErrorDetails.INTERNAL_EXCEPTION, fatal: false, event: event, err: err });\n    }\n  }\n}\n\nexport default EventHandler;\n","/**\n * @readonly\n * @enum {string}\n */\nconst HlsEvents = {\n  // fired before MediaSource is attaching to media element - data: { media }\n  MEDIA_ATTACHING: 'hlsMediaAttaching',\n  // fired when MediaSource has been succesfully attached to media element - data: { }\n  MEDIA_ATTACHED: 'hlsMediaAttached',\n  // fired before detaching MediaSource from media element - data: { }\n  MEDIA_DETACHING: 'hlsMediaDetaching',\n  // fired when MediaSource has been detached from media element - data: { }\n  MEDIA_DETACHED: 'hlsMediaDetached',\n  // fired when we buffer is going to be reset - data: { }\n  BUFFER_RESET: 'hlsBufferReset',\n  // fired when we know about the codecs that we need buffers for to push into - data: {tracks : { container, codec, levelCodec, initSegment, metadata }}\n  BUFFER_CODECS: 'hlsBufferCodecs',\n  // fired when sourcebuffers have been created - data: { tracks : tracks }\n  BUFFER_CREATED: 'hlsBufferCreated',\n  // fired when we append a segment to the buffer - data: { segment: segment object }\n  BUFFER_APPENDING: 'hlsBufferAppending',\n  // fired when we are done with appending a media segment to the buffer - data : { parent : segment parent that triggered BUFFER_APPENDING, pending : nb of segments waiting for appending for this segment parent}\n  BUFFER_APPENDED: 'hlsBufferAppended',\n  // fired when the stream is finished and we want to notify the media buffer that there will be no more data - data: { }\n  BUFFER_EOS: 'hlsBufferEos',\n  // fired when the media buffer should be flushed - data { startOffset, endOffset }\n  BUFFER_FLUSHING: 'hlsBufferFlushing',\n  // fired when the media buffer has been flushed - data: { }\n  BUFFER_FLUSHED: 'hlsBufferFlushed',\n  // fired to signal that a manifest loading starts - data: { url : manifestURL}\n  MANIFEST_LOADING: 'hlsManifestLoading',\n  // fired after manifest has been loaded - data: { levels : [available quality levels], audioTracks : [ available audio tracks], url : manifestURL, stats : { trequest, tfirst, tload, mtime}}\n  MANIFEST_LOADED: 'hlsManifestLoaded',\n  // fired after manifest has been parsed - data: { levels : [available quality levels], firstLevel : index of first quality level appearing in Manifest}\n  MANIFEST_PARSED: 'hlsManifestParsed',\n  // fired when a level switch is requested - data: { level : id of new level }\n  LEVEL_SWITCHING: 'hlsLevelSwitching',\n  // fired when a level switch is effective - data: { level : id of new level }\n  LEVEL_SWITCHED: 'hlsLevelSwitched',\n  // fired when a level playlist loading starts - data: { url : level URL, level : id of level being loaded}\n  LEVEL_LOADING: 'hlsLevelLoading',\n  // fired when a level playlist loading finishes - data: { details : levelDetails object, level : id of loaded level, stats : { trequest, tfirst, tload, mtime} }\n  LEVEL_LOADED: 'hlsLevelLoaded',\n  // fired when a level's details have been updated based on previous details, after it has been loaded - data: { details : levelDetails object, level : id of updated level }\n  LEVEL_UPDATED: 'hlsLevelUpdated',\n  // fired when a level's PTS information has been updated after parsing a fragment - data: { details : levelDetails object, level : id of updated level, drift: PTS drift observed when parsing last fragment }\n  LEVEL_PTS_UPDATED: 'hlsLevelPtsUpdated',\n  // fired to notify that audio track lists has been updated - data: { audioTracks : audioTracks }\n  AUDIO_TRACKS_UPDATED: 'hlsAudioTracksUpdated',\n  // fired when an audio track switching is requested - data: { id : audio track id }\n  AUDIO_TRACK_SWITCHING: 'hlsAudioTrackSwitching',\n  // fired when an audio track switch actually occurs - data: { id : audio track id }\n  AUDIO_TRACK_SWITCHED: 'hlsAudioTrackSwitched',\n  // fired when an audio track loading starts - data: { url : audio track URL, id : audio track id }\n  AUDIO_TRACK_LOADING: 'hlsAudioTrackLoading',\n  // fired when an audio track loading finishes - data: { details : levelDetails object, id : audio track id, stats : { trequest, tfirst, tload, mtime } }\n  AUDIO_TRACK_LOADED: 'hlsAudioTrackLoaded',\n  // fired to notify that subtitle track lists has been updated - data: { subtitleTracks : subtitleTracks }\n  SUBTITLE_TRACKS_UPDATED: 'hlsSubtitleTracksUpdated',\n  // fired when an subtitle track switch occurs - data: { id : subtitle track id }\n  SUBTITLE_TRACK_SWITCH: 'hlsSubtitleTrackSwitch',\n  // fired when a subtitle track loading starts - data: { url : subtitle track URL, id : subtitle track id }\n  SUBTITLE_TRACK_LOADING: 'hlsSubtitleTrackLoading',\n  // fired when a subtitle track loading finishes - data: { details : levelDetails object, id : subtitle track id, stats : { trequest, tfirst, tload, mtime } }\n  SUBTITLE_TRACK_LOADED: 'hlsSubtitleTrackLoaded',\n  // fired when a subtitle fragment has been processed - data: { success : boolean, frag : the processed frag }\n  SUBTITLE_FRAG_PROCESSED: 'hlsSubtitleFragProcessed',\n  // fired when the first timestamp is found - data: { id : demuxer id, initPTS: initPTS, frag : fragment object }\n  INIT_PTS_FOUND: 'hlsInitPtsFound',\n  // fired when a fragment loading starts - data: { frag : fragment object }\n  FRAG_LOADING: 'hlsFragLoading',\n  // fired when a fragment loading is progressing - data: { frag : fragment object, { trequest, tfirst, loaded } }\n  FRAG_LOAD_PROGRESS: 'hlsFragLoadProgress',\n  // Identifier for fragment load aborting for emergency switch down - data: { frag : fragment object }\n  FRAG_LOAD_EMERGENCY_ABORTED: 'hlsFragLoadEmergencyAborted',\n  // fired when a fragment loading is completed - data: { frag : fragment object, payload : fragment payload, stats : { trequest, tfirst, tload, length } }\n  FRAG_LOADED: 'hlsFragLoaded',\n  // fired when a fragment has finished decrypting - data: { id : demuxer id, frag: fragment object, payload : fragment payload, stats : { tstart, tdecrypt } }\n  FRAG_DECRYPTED: 'hlsFragDecrypted',\n  // fired when Init Segment has been extracted from fragment - data: { id : demuxer id, frag: fragment object, moov : moov MP4 box, codecs : codecs found while parsing fragment }\n  FRAG_PARSING_INIT_SEGMENT: 'hlsFragParsingInitSegment',\n  // fired when parsing sei text is completed - data: { id : demuxer id, frag: fragment object, samples : [ sei samples pes ] }\n  FRAG_PARSING_USERDATA: 'hlsFragParsingUserdata',\n  // fired when parsing id3 is completed - data: { id : demuxer id, frag: fragment object, samples : [ id3 samples pes ] }\n  FRAG_PARSING_METADATA: 'hlsFragParsingMetadata',\n  // fired when data have been extracted from fragment - data: { id : demuxer id, frag: fragment object, data1 : moof MP4 box or TS fragments, data2 : mdat MP4 box or null}\n  FRAG_PARSING_DATA: 'hlsFragParsingData',\n  // fired when fragment parsing is completed - data: { id : demuxer id, frag: fragment object }\n  FRAG_PARSED: 'hlsFragParsed',\n  // fired when fragment remuxed MP4 boxes have all been appended into SourceBuffer - data: { id : demuxer id, frag : fragment object, stats : { trequest, tfirst, tload, tparsed, tbuffered, length, bwEstimate } }\n  FRAG_BUFFERED: 'hlsFragBuffered',\n  // fired when fragment matching with current media position is changing - data : { id : demuxer id, frag : fragment object }\n  FRAG_CHANGED: 'hlsFragChanged',\n  // Identifier for a FPS drop event - data: { curentDropped, currentDecoded, totalDroppedFrames }\n  FPS_DROP: 'hlsFpsDrop',\n  // triggered when FPS drop triggers auto level capping - data: { level, droppedlevel }\n  FPS_DROP_LEVEL_CAPPING: 'hlsFpsDropLevelCapping',\n  // Identifier for an error event - data: { type : error type, details : error details, fatal : if true, hls.js cannot/will not try to recover, if false, hls.js will try to recover,other error specific data }\n  ERROR: 'hlsError',\n  // fired when hls.js instance starts destroying. Different from MEDIA_DETACHED as one could want to detach and reattach a media to the instance of hls.js to handle mid-rolls for example - data: { }\n  DESTROYING: 'hlsDestroying',\n  // fired when a decrypt key loading starts - data: { frag : fragment object }\n  KEY_LOADING: 'hlsKeyLoading',\n  // fired when a decrypt key loading is completed - data: { frag : fragment object, payload : key payload, stats : { trequest, tfirst, tload, length } }\n  KEY_LOADED: 'hlsKeyLoaded',\n  // fired upon stream controller state transitions - data: { previousState, nextState }\n  STREAM_STATE_TRANSITION: 'hlsStreamStateTransition'\n};\nexport default HlsEvents;\n","/**\n *  AAC helper\n */\n\nclass AAC {\n  static getSilentFrame (codec, channelCount) {\n    switch (codec) {\n    case 'mp4a.40.2':\n      if (channelCount === 1)\n        return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x23, 0x80]);\n      else if (channelCount === 2)\n        return new Uint8Array([0x21, 0x00, 0x49, 0x90, 0x02, 0x19, 0x00, 0x23, 0x80]);\n      else if (channelCount === 3)\n        return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x8e]);\n      else if (channelCount === 4)\n        return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x80, 0x2c, 0x80, 0x08, 0x02, 0x38]);\n      else if (channelCount === 5)\n        return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x38]);\n      else if (channelCount === 6)\n        return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x00, 0xb2, 0x00, 0x20, 0x08, 0xe0]);\n\n      break;\n    // handle HE-AAC below (mp4a.40.5 / mp4a.40.29)\n    default:\n      if (channelCount === 1) {\n        // ffmpeg -y -f lavfi -i \"aevalsrc=0:d=0.05\" -c:a libfdk_aac -profile:a aac_he -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n        return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x4e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x1c, 0x6, 0xf1, 0xc1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n      } else if (channelCount === 2) {\n        // ffmpeg -y -f lavfi -i \"aevalsrc=0|0:d=0.05\" -c:a libfdk_aac -profile:a aac_he_v2 -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n        return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x5e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x0, 0x95, 0x0, 0x6, 0xf1, 0xa1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n      } else if (channelCount === 3) {\n        // ffmpeg -y -f lavfi -i \"aevalsrc=0|0|0:d=0.05\" -c:a libfdk_aac -profile:a aac_he_v2 -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n        return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x5e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x0, 0x95, 0x0, 0x6, 0xf1, 0xa1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n      }\n      break;\n    }\n    return null;\n  }\n}\n\nexport default AAC;\n","/**\n * Buffer Helper utils, providing methods dealing buffer length retrieval\n*/\n\nconst BufferHelper = {\n  /**\n   * Return true if `media`'s buffered include `position`\n   * @param {HTMLMediaElement|SourceBuffer} media\n   * @param {number} position\n   * @returns {boolean}\n   */\n  isBuffered: function (media, position) {\n    try {\n      if (media) {\n        let buffered = media.buffered;\n        for (let i = 0; i < buffered.length; i++) {\n          if (position >= buffered.start(i) && position <= buffered.end(i))\n            return true;\n        }\n      }\n    } catch (error) {\n      // this is to catch\n      // InvalidStateError: Failed to read the 'buffered' property from 'SourceBuffer':\n      // This SourceBuffer has been removed from the parent media source\n    }\n    return false;\n  },\n\n  bufferInfo: function (media, pos, maxHoleDuration) {\n    try {\n      if (media) {\n        let vbuffered = media.buffered, buffered = [], i;\n        for (i = 0; i < vbuffered.length; i++)\n          buffered.push({ start: vbuffered.start(i), end: vbuffered.end(i) });\n\n        return this.bufferedInfo(buffered, pos, maxHoleDuration);\n      }\n    } catch (error) {\n      // this is to catch\n      // InvalidStateError: Failed to read the 'buffered' property from 'SourceBuffer':\n      // This SourceBuffer has been removed from the parent media source\n    }\n    return { len: 0, start: pos, end: pos, nextStart: undefined };\n  },\n\n  bufferedInfo: function (buffered, pos, maxHoleDuration) {\n    let buffered2 = [],\n      // bufferStart and bufferEnd are buffer boundaries around current video position\n      bufferLen, bufferStart, bufferEnd, bufferStartNext, i;\n    // sort on buffer.start/smaller end (IE does not always return sorted buffered range)\n    buffered.sort(function (a, b) {\n      let diff = a.start - b.start;\n      if (diff)\n        return diff;\n      else\n        return b.end - a.end;\n    });\n    // there might be some small holes between buffer time range\n    // consider that holes smaller than maxHoleDuration are irrelevant and build another\n    // buffer time range representations that discards those holes\n    for (i = 0; i < buffered.length; i++) {\n      let buf2len = buffered2.length;\n      if (buf2len) {\n        let buf2end = buffered2[buf2len - 1].end;\n        // if small hole (value between 0 or maxHoleDuration ) or overlapping (negative)\n        if ((buffered[i].start - buf2end) < maxHoleDuration) {\n          // merge overlapping time ranges\n          // update lastRange.end only if smaller than item.end\n          // e.g.  [ 1, 15] with  [ 2,8] => [ 1,15] (no need to modify lastRange.end)\n          // whereas [ 1, 8] with  [ 2,15] => [ 1,15] ( lastRange should switch from [1,8] to [1,15])\n          if (buffered[i].end > buf2end)\n            buffered2[buf2len - 1].end = buffered[i].end;\n        } else {\n          // big hole\n          buffered2.push(buffered[i]);\n        }\n      } else {\n        // first value\n        buffered2.push(buffered[i]);\n      }\n    }\n    for (i = 0, bufferLen = 0, bufferStart = bufferEnd = pos; i < buffered2.length; i++) {\n      let start = buffered2[i].start,\n        end = buffered2[i].end;\n      // logger.log('buf start/end:' + buffered.start(i) + '/' + buffered.end(i));\n      if ((pos + maxHoleDuration) >= start && pos < end) {\n        // play position is inside this buffer TimeRange, retrieve end of buffer position and buffer length\n        bufferStart = start;\n        bufferEnd = end;\n        bufferLen = bufferEnd - pos;\n      } else if ((pos + maxHoleDuration) < start) {\n        bufferStartNext = start;\n        break;\n      }\n    }\n    return { len: bufferLen, start: bufferStart, end: bufferEnd, nextStart: bufferStartNext };\n  }\n};\n\nexport default BufferHelper;\n","import EventHandler from '../event-handler';\nimport Event from '../events';\n\nexport const FragmentState = {\n  NOT_LOADED: 'NOT_LOADED',\n  APPENDING: 'APPENDING',\n  PARTIAL: 'PARTIAL',\n  OK: 'OK'\n};\n\nexport class FragmentTracker extends EventHandler {\n  constructor (hls) {\n    super(hls,\n      Event.BUFFER_APPENDED,\n      Event.FRAG_BUFFERED,\n      Event.FRAG_LOADED\n    );\n\n    this.bufferPadding = 0.2;\n\n    this.fragments = Object.create(null);\n    this.timeRanges = Object.create(null);\n\n    this.config = hls.config;\n  }\n\n  destroy () {\n    this.fragments = null;\n    this.timeRanges = null;\n    this.config = null;\n    EventHandler.prototype.destroy.call(this);\n    super.destroy();\n  }\n\n  /**\n   * Return a Fragment that match the position and levelType.\n   * If not found any Fragment, return null\n   * @param {number} position\n   * @param {LevelType} levelType\n   * @returns {Fragment|null}\n   */\n  getBufferedFrag (position, levelType) {\n    const fragments = this.fragments;\n    const bufferedFrags = Object.keys(fragments).filter(key => {\n      const fragmentEntity = fragments[key];\n      if (fragmentEntity.body.type !== levelType)\n        return false;\n\n      if (!fragmentEntity.buffered)\n        return false;\n\n      const frag = fragmentEntity.body;\n      return frag.startPTS <= position && position <= frag.endPTS;\n    });\n    if (bufferedFrags.length === 0) {\n      return null;\n    } else {\n      // https://github.com/video-dev/hls.js/pull/1545#discussion_r166229566\n      const bufferedFragKey = bufferedFrags.pop();\n      return fragments[bufferedFragKey].body;\n    }\n  }\n\n  /**\n   * Partial fragments effected by coded frame eviction will be removed\n   * The browser will unload parts of the buffer to free up memory for new buffer data\n   * Fragments will need to be reloaded when the buffer is freed up, removing partial fragments will allow them to reload(since there might be parts that are still playable)\n   * @param {String} elementaryStream The elementaryStream of media this is (eg. video/audio)\n   * @param {TimeRanges} timeRange TimeRange object from a sourceBuffer\n   */\n  detectEvictedFragments (elementaryStream, timeRange) {\n    let fragmentTimes, time;\n    // Check if any flagged fragments have been unloaded\n    Object.keys(this.fragments).forEach(key => {\n      const fragmentEntity = this.fragments[key];\n      if (fragmentEntity.buffered === true) {\n        const esData = fragmentEntity.range[elementaryStream];\n        if (esData) {\n          fragmentTimes = esData.time;\n          for (let i = 0; i < fragmentTimes.length; i++) {\n            time = fragmentTimes[i];\n\n            if (this.isTimeBuffered(time.startPTS, time.endPTS, timeRange) === false) {\n              // Unregister partial fragment as it needs to load again to be reused\n              this.removeFragment(fragmentEntity.body);\n              break;\n            }\n          }\n        }\n      }\n    });\n  }\n\n  /**\n   * Checks if the fragment passed in is loaded in the buffer properly\n   * Partially loaded fragments will be registered as a partial fragment\n   * @param {Object} fragment Check the fragment against all sourceBuffers loaded\n   */\n  detectPartialFragments (fragment) {\n    let fragKey = this.getFragmentKey(fragment);\n    let fragmentEntity = this.fragments[fragKey];\n    if (fragmentEntity) {\n      fragmentEntity.buffered = true;\n\n      Object.keys(this.timeRanges).forEach(elementaryStream => {\n        if (fragment.hasElementaryStream(elementaryStream) === true) {\n          let timeRange = this.timeRanges[elementaryStream];\n          // Check for malformed fragments\n          // Gaps need to be calculated for each elementaryStream\n          fragmentEntity.range[elementaryStream] = this.getBufferedTimes(fragment.startPTS, fragment.endPTS, timeRange);\n        }\n      });\n    }\n  }\n\n  getBufferedTimes (startPTS, endPTS, timeRange) {\n    let fragmentTimes = [];\n    let startTime, endTime;\n    let fragmentPartial = false;\n    for (let i = 0; i < timeRange.length; i++) {\n      startTime = timeRange.start(i) - this.bufferPadding;\n      endTime = timeRange.end(i) + this.bufferPadding;\n      if (startPTS >= startTime && endPTS <= endTime) {\n        // Fragment is entirely contained in buffer\n        // No need to check the other timeRange times since it's completely playable\n        fragmentTimes.push({\n          startPTS: Math.max(startPTS, timeRange.start(i)),\n          endPTS: Math.min(endPTS, timeRange.end(i))\n        });\n        break;\n      } else if (startPTS < endTime && endPTS > startTime) {\n        // Check for intersection with buffer\n        // Get playable sections of the fragment\n        fragmentTimes.push({\n          startPTS: Math.max(startPTS, timeRange.start(i)),\n          endPTS: Math.min(endPTS, timeRange.end(i))\n        });\n        fragmentPartial = true;\n      } else if (endPTS <= startTime) {\n        // No need to check the rest of the timeRange as it is in order\n        break;\n      }\n    }\n\n    return {\n      time: fragmentTimes,\n      partial: fragmentPartial\n    };\n  }\n\n  getFragmentKey (fragment) {\n    return `${fragment.type}_${fragment.level}_${fragment.sn}`;\n  }\n\n  /**\n   * Gets the partial fragment for a certain time\n   * @param {Number} time\n   * @returns {Object} fragment Returns a partial fragment at a time or null if there is no partial fragment\n   */\n  getPartialFragment (time) {\n    let timePadding, startTime, endTime;\n    let bestFragment = null;\n    let bestOverlap = 0;\n    Object.keys(this.fragments).forEach(key => {\n      const fragmentEntity = this.fragments[key];\n      if (this.isPartial(fragmentEntity)) {\n        startTime = fragmentEntity.body.startPTS - this.bufferPadding;\n        endTime = fragmentEntity.body.endPTS + this.bufferPadding;\n        if (time >= startTime && time <= endTime) {\n          // Use the fragment that has the most padding from start and end time\n          timePadding = Math.min(time - startTime, endTime - time);\n          if (bestOverlap <= timePadding) {\n            bestFragment = fragmentEntity.body;\n            bestOverlap = timePadding;\n          }\n        }\n      }\n    });\n    return bestFragment;\n  }\n\n  /**\n   * @param {Object} fragment The fragment to check\n   * @returns {String} Returns the fragment state when a fragment never loaded or if it partially loaded\n   */\n  getState (fragment) {\n    let fragKey = this.getFragmentKey(fragment);\n    let fragmentEntity = this.fragments[fragKey];\n    let state = FragmentState.NOT_LOADED;\n\n    if (fragmentEntity !== undefined) {\n      if (!fragmentEntity.buffered)\n        state = FragmentState.APPENDING;\n      else if (this.isPartial(fragmentEntity) === true)\n        state = FragmentState.PARTIAL;\n      else\n        state = FragmentState.OK;\n    }\n\n    return state;\n  }\n\n  isPartial (fragmentEntity) {\n    return fragmentEntity.buffered === true &&\n      ((fragmentEntity.range.video !== undefined && fragmentEntity.range.video.partial === true) ||\n        (fragmentEntity.range.audio !== undefined && fragmentEntity.range.audio.partial === true));\n  }\n\n  isTimeBuffered (startPTS, endPTS, timeRange) {\n    let startTime, endTime;\n    for (let i = 0; i < timeRange.length; i++) {\n      startTime = timeRange.start(i) - this.bufferPadding;\n      endTime = timeRange.end(i) + this.bufferPadding;\n      if (startPTS >= startTime && endPTS <= endTime)\n        return true;\n\n      if (endPTS <= startTime) {\n        // No need to check the rest of the timeRange as it is in order\n        return false;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Fires when a fragment loading is completed\n   */\n  onFragLoaded (e) {\n    let fragment = e.frag;\n    // dont track initsegment (for which sn is not a number)\n    if (!isNaN(fragment.sn)) {\n      let fragKey = this.getFragmentKey(fragment);\n      let fragmentEntity = {\n        body: fragment,\n        range: Object.create(null),\n        buffered: false\n      };\n      this.fragments[fragKey] = fragmentEntity;\n    }\n  }\n\n  /**\n   * Fires when the buffer is updated\n   */\n  onBufferAppended (e) {\n    // Store the latest timeRanges loaded in the buffer\n    this.timeRanges = e.timeRanges;\n    Object.keys(this.timeRanges).forEach(elementaryStream => {\n      let timeRange = this.timeRanges[elementaryStream];\n      this.detectEvictedFragments(elementaryStream, timeRange);\n    });\n  }\n\n  /**\n   * Fires after a fragment has been loaded into the source buffer\n   */\n  onFragBuffered (e) {\n    this.detectPartialFragments(e.frag);\n  }\n\n  /**\n   * Return true if fragment tracker has the fragment.\n   * @param {Object} fragment\n   * @returns {boolean}\n   */\n  hasFragment (fragment) {\n    const fragKey = this.getFragmentKey(fragment);\n    return this.fragments[fragKey] !== undefined;\n  }\n\n  /**\n   * Remove a fragment from fragment tracker until it is loaded again\n   * @param {Object} fragment The fragment to remove\n   */\n  removeFragment (fragment) {\n    let fragKey = this.getFragmentKey(fragment);\n    delete this.fragments[fragKey];\n  }\n\n  /**\n   * Remove all fragments from fragment tracker.\n   */\n  removeAllFragments () {\n    this.fragments = Object.create(null);\n  }\n}\n","/**\n * Level Helper class, providing methods dealing with playlist sliding and drift\n*/\n\nimport { logger } from '../utils/logger';\n\nexport function updatePTS (fragments, fromIdx, toIdx) {\n  let fragFrom = fragments[fromIdx], fragTo = fragments[toIdx], fragToPTS = fragTo.startPTS;\n  // if we know startPTS[toIdx]\n  if (!isNaN(fragToPTS)) {\n    // update fragment duration.\n    // it helps to fix drifts between playlist reported duration and fragment real duration\n    if (toIdx > fromIdx) {\n      fragFrom.duration = fragToPTS - fragFrom.start;\n      if (fragFrom.duration < 0)\n        logger.warn(`negative duration computed for frag ${fragFrom.sn},level ${fragFrom.level}, there should be some duration drift between playlist and fragment!`);\n    } else {\n      fragTo.duration = fragFrom.start - fragToPTS;\n      if (fragTo.duration < 0)\n        logger.warn(`negative duration computed for frag ${fragTo.sn},level ${fragTo.level}, there should be some duration drift between playlist and fragment!`);\n    }\n  } else {\n    // we dont know startPTS[toIdx]\n    if (toIdx > fromIdx)\n      fragTo.start = fragFrom.start + fragFrom.duration;\n    else\n      fragTo.start = Math.max(fragFrom.start - fragTo.duration, 0);\n  }\n}\n\nexport function updateFragPTSDTS (details, frag, startPTS, endPTS, startDTS, endDTS) {\n  // update frag PTS/DTS\n  let maxStartPTS = startPTS;\n  if (!isNaN(frag.startPTS)) {\n    // delta PTS between audio and video\n    let deltaPTS = Math.abs(frag.startPTS - startPTS);\n    if (isNaN(frag.deltaPTS))\n      frag.deltaPTS = deltaPTS;\n    else\n      frag.deltaPTS = Math.max(deltaPTS, frag.deltaPTS);\n\n    maxStartPTS = Math.max(startPTS, frag.startPTS);\n    startPTS = Math.min(startPTS, frag.startPTS);\n    endPTS = Math.max(endPTS, frag.endPTS);\n    startDTS = Math.min(startDTS, frag.startDTS);\n    endDTS = Math.max(endDTS, frag.endDTS);\n  }\n\n  const drift = startPTS - frag.start;\n  frag.start = frag.startPTS = startPTS;\n  frag.maxStartPTS = maxStartPTS;\n  frag.endPTS = endPTS;\n  frag.startDTS = startDTS;\n  frag.endDTS = endDTS;\n  frag.duration = endPTS - startPTS;\n\n  const sn = frag.sn;\n  // exit if sn out of range\n  if (!details || sn < details.startSN || sn > details.endSN)\n    return 0;\n\n  let fragIdx, fragments, i;\n  fragIdx = sn - details.startSN;\n  fragments = details.fragments;\n  // update frag reference in fragments array\n  // rationale is that fragments array might not contain this frag object.\n  // this will happpen if playlist has been refreshed between frag loading and call to updateFragPTSDTS()\n  // if we don't update frag, we won't be able to propagate PTS info on the playlist\n  // resulting in invalid sliding computation\n  fragments[fragIdx] = frag;\n  // adjust fragment PTS/duration from seqnum-1 to frag 0\n  for (i = fragIdx; i > 0; i--)\n    updatePTS(fragments, i, i - 1);\n\n  // adjust fragment PTS/duration from seqnum to last frag\n  for (i = fragIdx; i < fragments.length - 1; i++)\n    updatePTS(fragments, i, i + 1);\n\n  details.PTSKnown = true;\n  // logger.log(`                                            frag start/end:${startPTS.toFixed(3)}/${endPTS.toFixed(3)}`);\n\n  return drift;\n}\n\nexport function mergeDetails (oldDetails, newDetails) {\n  let start = Math.max(oldDetails.startSN, newDetails.startSN) - newDetails.startSN,\n    end = Math.min(oldDetails.endSN, newDetails.endSN) - newDetails.startSN,\n    delta = newDetails.startSN - oldDetails.startSN,\n    oldfragments = oldDetails.fragments,\n    newfragments = newDetails.fragments,\n    ccOffset = 0,\n    PTSFrag;\n\n  // potentially retrieve cached initsegment\n  if (newDetails.initSegment && oldDetails.initSegment)\n    newDetails.initSegment = oldDetails.initSegment;\n\n  // check if old/new playlists have fragments in common\n  if (end < start) {\n    newDetails.PTSKnown = false;\n    return;\n  }\n  // loop through overlapping SN and update startPTS , cc, and duration if any found\n  for (var i = start; i <= end; i++) {\n    let oldFrag = oldfragments[delta + i],\n      newFrag = newfragments[i];\n    if (newFrag && oldFrag) {\n      ccOffset = oldFrag.cc - newFrag.cc;\n      if (!isNaN(oldFrag.startPTS)) {\n        newFrag.start = newFrag.startPTS = oldFrag.startPTS;\n        newFrag.endPTS = oldFrag.endPTS;\n        newFrag.duration = oldFrag.duration;\n        newFrag.backtracked = oldFrag.backtracked;\n        newFrag.dropped = oldFrag.dropped;\n        PTSFrag = newFrag;\n      }\n    }\n  }\n\n  if (ccOffset) {\n    logger.log('discontinuity sliding from playlist, take drift into account');\n    for (i = 0; i < newfragments.length; i++)\n      newfragments[i].cc += ccOffset;\n  }\n\n  // if at least one fragment contains PTS info, recompute PTS information for all fragments\n  if (PTSFrag) {\n    updateFragPTSDTS(newDetails, PTSFrag, PTSFrag.startPTS, PTSFrag.endPTS, PTSFrag.startDTS, PTSFrag.endDTS);\n  } else {\n    // ensure that delta is within oldfragments range\n    // also adjust sliding in case delta is 0 (we could have old=[50-60] and new=old=[50-61])\n    // in that case we also need to adjust start offset of all fragments\n    if (delta >= 0 && delta < oldfragments.length) {\n      // adjust start by sliding offset\n      let sliding = oldfragments[delta].start;\n      for (i = 0; i < newfragments.length; i++)\n        newfragments[i].start += sliding;\n    }\n  }\n  // if we are here, it means we have fragments overlapping between\n  // old and new level. reliable PTS info is thus relying on old level\n  newDetails.PTSKnown = oldDetails.PTSKnown;\n}\n","const requestMediaKeySystemAccess = (function () {\n  if (typeof window !== 'undefined' && window.navigator && window.navigator.requestMediaKeySystemAccess)\n    return window.navigator.requestMediaKeySystemAccess.bind(window.navigator);\n  else\n    return null;\n})();\n\nexport {\n  requestMediaKeySystemAccess\n};\n","/**\n * MediaSource helper\n */\n\nexport function getMediaSource () {\n  if (typeof window !== 'undefined')\n    return window.MediaSource || window.WebKitMediaSource;\n}\n","\nimport URLToolkit from 'url-toolkit';\n\nimport LevelKey from './level-key';\n\nexport default class Fragment {\n  constructor () {\n    this._url = null;\n    this._byteRange = null;\n    this._decryptdata = null;\n    this.tagList = [];\n\n    // Holds the types of data this fragment supports\n    this._elementaryStreams = {\n      [Fragment.ElementaryStreamTypes.AUDIO]: false,\n      [Fragment.ElementaryStreamTypes.VIDEO]: false\n    };\n  }\n\n  /**\n   * `type` property for this._elementaryStreams\n   *\n   * @enum\n   */\n  static get ElementaryStreamTypes () {\n    return {\n      AUDIO: 'audio',\n      VIDEO: 'video'\n    };\n  }\n\n  get url () {\n    if (!this._url && this.relurl)\n      this._url = URLToolkit.buildAbsoluteURL(this.baseurl, this.relurl, { alwaysNormalize: true });\n\n    return this._url;\n  }\n\n  set url (value) {\n    this._url = value;\n  }\n\n  get programDateTime () {\n    if (!this._programDateTime && this.rawProgramDateTime)\n      this._programDateTime = new Date(Date.parse(this.rawProgramDateTime));\n\n    return this._programDateTime;\n  }\n\n  get byteRange () {\n    if (!this._byteRange && !this.rawByteRange)\n      return [];\n\n    if (this._byteRange)\n      return this._byteRange;\n\n    let byteRange = [];\n    if (this.rawByteRange) {\n      const params = this.rawByteRange.split('@', 2);\n      if (params.length === 1) {\n        const lastByteRangeEndOffset = this.lastByteRangeEndOffset;\n        byteRange[0] = lastByteRangeEndOffset || 0;\n      } else {\n        byteRange[0] = parseInt(params[1]);\n      }\n      byteRange[1] = parseInt(params[0]) + byteRange[0];\n      this._byteRange = byteRange;\n    }\n    return byteRange;\n  }\n\n  /**\n   * @type {number}\n   */\n  get byteRangeStartOffset () {\n    return this.byteRange[0];\n  }\n\n  get byteRangeEndOffset () {\n    return this.byteRange[1];\n  }\n\n  get decryptdata () {\n    if (!this._decryptdata)\n      this._decryptdata = this.fragmentDecryptdataFromLevelkey(this.levelkey, this.sn);\n\n    return this._decryptdata;\n  }\n\n  /**\n   * @param {ElementaryStreamType} type\n   */\n  addElementaryStream (type) {\n    this._elementaryStreams[type] = true;\n  }\n\n  /**\n   * @param {ElementaryStreamType} type\n   */\n  hasElementaryStream (type) {\n    return this._elementaryStreams[type] === true;\n  }\n\n  /**\n   * Utility method for parseLevelPlaylist to create an initialization vector for a given segment\n   * @returns {Uint8Array}\n   */\n  createInitializationVector (segmentNumber) {\n    let uint8View = new Uint8Array(16);\n\n    for (let i = 12; i < 16; i++)\n      uint8View[i] = (segmentNumber >> 8 * (15 - i)) & 0xff;\n\n    return uint8View;\n  }\n\n  /**\n   * Utility method for parseLevelPlaylist to get a fragment's decryption data from the currently parsed encryption key data\n   * @param levelkey - a playlist's encryption info\n   * @param segmentNumber - the fragment's segment number\n   * @returns {*} - an object to be applied as a fragment's decryptdata\n   */\n  fragmentDecryptdataFromLevelkey (levelkey, segmentNumber) {\n    let decryptdata = levelkey;\n\n    if (levelkey && levelkey.method && levelkey.uri && !levelkey.iv) {\n      decryptdata = new LevelKey();\n      decryptdata.method = levelkey.method;\n      decryptdata.baseuri = levelkey.baseuri;\n      decryptdata.reluri = levelkey.reluri;\n      decryptdata.iv = this.createInitializationVector(segmentNumber);\n    }\n\n    return decryptdata;\n  }\n}\n","import URLToolkit from 'url-toolkit';\n\nexport default class LevelKey {\n  constructor () {\n    this.method = null;\n    this.key = null;\n    this.iv = null;\n    this._uri = null;\n  }\n\n  get uri () {\n    if (!this._uri && this.reluri)\n      this._uri = URLToolkit.buildAbsoluteURL(this.baseuri, this.reluri, { alwaysNormalize: true });\n\n    return this._uri;\n  }\n}\n","\nimport URLToolkit from 'url-toolkit';\n\nimport Fragment from './fragment';\nimport LevelKey from './level-key';\n\nimport AttrList from '../utils/attr-list';\nimport { logger } from '../utils/logger';\nimport { isCodecType } from '../utils/codecs';\n\n/**\n * M3U8 parser\n * @module\n */\n\n// https://regex101.com is your friend\nconst MASTER_PLAYLIST_REGEX = /#EXT-X-STREAM-INF:([^\\n\\r]*)[\\r\\n]+([^\\r\\n]+)/g;\nconst MASTER_PLAYLIST_MEDIA_REGEX = /#EXT-X-MEDIA:(.*)/g;\n\nconst LEVEL_PLAYLIST_REGEX_FAST = new RegExp([\n  /#EXTINF:\\s*(\\d*(?:\\.\\d+)?)(?:,(.*)\\s+)?/.source, // duration (#EXTINF:<duration>,<title>), group 1 => duration, group 2 => title\n  /|(?!#)(\\S+)/.source, // segment URI, group 3 => the URI (note newline is not eaten)\n  /|#EXT-X-BYTERANGE:*(.+)/.source, // next segment's byterange, group 4 => range spec (x@y)\n  /|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source, // next segment's program date/time group 5 => the datetime spec\n  /|#.*/.source // All other non-segment oriented tags will match with all groups empty\n].join(''), 'g');\n\nconst LEVEL_PLAYLIST_REGEX_SLOW = /(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\\d+))|(?:#EXT-X-(TARGETDURATION): *(\\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\\r?\\n?/;\n\nexport default class M3U8Parser {\n  static findGroup (groups, mediaGroupId) {\n    if (!groups)\n      return null;\n\n    let matchingGroup = null;\n\n    for (let i = 0; i < groups.length; i++) {\n      const group = groups[i];\n      if (group.id === mediaGroupId)\n        matchingGroup = group;\n    }\n\n    return matchingGroup;\n  }\n\n  static convertAVC1ToAVCOTI (codec) {\n    let result, avcdata = codec.split('.');\n    if (avcdata.length > 2) {\n      result = avcdata.shift() + '.';\n      result += parseInt(avcdata.shift()).toString(16);\n      result += ('000' + parseInt(avcdata.shift()).toString(16)).substr(-4);\n    } else {\n      result = codec;\n    }\n    return result;\n  }\n\n  static resolve (url, baseUrl) {\n    return URLToolkit.buildAbsoluteURL(baseUrl, url, { alwaysNormalize: true });\n  }\n\n  static parseMasterPlaylist (string, baseurl) {\n    let levels = [], result;\n    MASTER_PLAYLIST_REGEX.lastIndex = 0;\n\n    function setCodecs (codecs, level) {\n      ['video', 'audio'].forEach((type) => {\n        const filtered = codecs.filter((codec) => isCodecType(codec, type));\n        if (filtered.length) {\n          const preferred = filtered.filter((codec) => {\n            return codec.lastIndexOf('avc1', 0) === 0 || codec.lastIndexOf('mp4a', 0) === 0;\n          });\n          level[`${type}Codec`] = preferred.length > 0 ? preferred[0] : filtered[0];\n\n          // remove from list\n          codecs = codecs.filter((codec) => filtered.indexOf(codec) === -1);\n        }\n      });\n\n      level.unknownCodecs = codecs;\n    }\n\n    while ((result = MASTER_PLAYLIST_REGEX.exec(string)) != null) {\n      const level = {};\n\n      let attrs = level.attrs = new AttrList(result[1]);\n      level.url = M3U8Parser.resolve(result[2], baseurl);\n\n      let resolution = attrs.decimalResolution('RESOLUTION');\n      if (resolution) {\n        level.width = resolution.width;\n        level.height = resolution.height;\n      }\n      level.bitrate = attrs.decimalInteger('AVERAGE-BANDWIDTH') || attrs.decimalInteger('BANDWIDTH');\n      level.name = attrs.NAME;\n\n      setCodecs([].concat((attrs.CODECS || '').split(/[ ,]+/)), level);\n\n      if (level.videoCodec && level.videoCodec.indexOf('avc1') !== -1)\n        level.videoCodec = M3U8Parser.convertAVC1ToAVCOTI(level.videoCodec);\n\n      levels.push(level);\n    }\n    return levels;\n  }\n\n  static parseMasterPlaylistMedia (string, baseurl, type, audioGroups = []) {\n    let result;\n    let medias = [];\n    let id = 0;\n    MASTER_PLAYLIST_MEDIA_REGEX.lastIndex = 0;\n    while ((result = MASTER_PLAYLIST_MEDIA_REGEX.exec(string)) !== null) {\n      const media = {};\n      const attrs = new AttrList(result[1]);\n      if (attrs.TYPE === type) {\n        media.groupId = attrs['GROUP-ID'];\n        media.name = attrs.NAME;\n        media.type = type;\n        media.default = (attrs.DEFAULT === 'YES');\n        media.autoselect = (attrs.AUTOSELECT === 'YES');\n        media.forced = (attrs.FORCED === 'YES');\n        if (attrs.URI)\n          media.url = M3U8Parser.resolve(attrs.URI, baseurl);\n\n        media.lang = attrs.LANGUAGE;\n        if (!media.name)\n          media.name = media.lang;\n\n        if (audioGroups.length) {\n          const groupCodec = M3U8Parser.findGroup(audioGroups, media.groupId);\n          media.audioCodec = groupCodec ? groupCodec.codec : audioGroups[0].codec;\n        }\n        media.id = id++;\n        medias.push(media);\n      }\n    }\n    return medias;\n  }\n\n  static parseLevelPlaylist (string, baseurl, id, type) {\n    let currentSN = 0,\n      totalduration = 0,\n      level = { type: null, version: null, url: baseurl, fragments: [], live: true, startSN: 0 },\n      levelkey = new LevelKey(),\n      cc = 0,\n      prevFrag = null,\n      frag = new Fragment(),\n      result,\n      i;\n\n    LEVEL_PLAYLIST_REGEX_FAST.lastIndex = 0;\n\n    while ((result = LEVEL_PLAYLIST_REGEX_FAST.exec(string)) !== null) {\n      const duration = result[1];\n      if (duration) { // INF\n        frag.duration = parseFloat(duration);\n        // avoid sliced strings    https://github.com/video-dev/hls.js/issues/939\n        const title = (' ' + result[2]).slice(1);\n        frag.title = title || null;\n        frag.tagList.push(title ? [ 'INF', duration, title ] : [ 'INF', duration ]);\n      } else if (result[3]) { // url\n        if (!isNaN(frag.duration)) {\n          const sn = currentSN++;\n          frag.type = type;\n          frag.start = totalduration;\n          frag.levelkey = levelkey;\n          frag.sn = sn;\n          frag.level = id;\n          frag.cc = cc;\n          frag.baseurl = baseurl;\n          // avoid sliced strings    https://github.com/video-dev/hls.js/issues/939\n          frag.relurl = (' ' + result[3]).slice(1);\n\n          if (level.programDateTime) {\n            if (prevFrag) {\n              if (frag.rawProgramDateTime) { // PDT discontinuity found\n                frag.pdt = Date.parse(frag.rawProgramDateTime);\n              } else { // Contiguous fragment\n                frag.pdt = prevFrag.pdt + (prevFrag.duration * 1000);\n              }\n            } else { // First fragment\n              frag.pdt = Date.parse(level.programDateTime);\n            }\n            frag.endPdt = frag.pdt + (frag.duration * 1000);\n          }\n\n          level.fragments.push(frag);\n          prevFrag = frag;\n          totalduration += frag.duration;\n\n          frag = new Fragment();\n        }\n      } else if (result[4]) { // X-BYTERANGE\n        frag.rawByteRange = (' ' + result[4]).slice(1);\n        if (prevFrag) {\n          const lastByteRangeEndOffset = prevFrag.byteRangeEndOffset;\n          if (lastByteRangeEndOffset)\n            frag.lastByteRangeEndOffset = lastByteRangeEndOffset;\n        }\n      } else if (result[5]) { // PROGRAM-DATE-TIME\n        // avoid sliced strings    https://github.com/video-dev/hls.js/issues/939\n        frag.rawProgramDateTime = (' ' + result[5]).slice(1);\n        frag.tagList.push(['PROGRAM-DATE-TIME', frag.rawProgramDateTime]);\n        if (level.programDateTime === undefined)\n          level.programDateTime = new Date(new Date(Date.parse(result[5])) - 1000 * totalduration);\n      } else {\n        result = result[0].match(LEVEL_PLAYLIST_REGEX_SLOW);\n        for (i = 1; i < result.length; i++) {\n          if (result[i] !== undefined)\n            break;\n        }\n\n        // avoid sliced strings    https://github.com/video-dev/hls.js/issues/939\n        const value1 = (' ' + result[i + 1]).slice(1);\n        const value2 = (' ' + result[i + 2]).slice(1);\n\n        switch (result[i]) {\n        case '#':\n          frag.tagList.push(value2 ? [ value1, value2 ] : [ value1 ]);\n          break;\n        case 'PLAYLIST-TYPE':\n          level.type = value1.toUpperCase();\n          break;\n        case 'MEDIA-SEQUENCE':\n          currentSN = level.startSN = parseInt(value1);\n          break;\n        case 'TARGETDURATION':\n          level.targetduration = parseFloat(value1);\n          break;\n        case 'VERSION':\n          level.version = parseInt(value1);\n          break;\n        case 'EXTM3U':\n          break;\n        case 'ENDLIST':\n          level.live = false;\n          break;\n        case 'DIS':\n          cc++;\n          frag.tagList.push(['DIS']);\n          break;\n        case 'DISCONTINUITY-SEQ':\n          cc = parseInt(value1);\n          break;\n        case 'KEY':\n          // https://tools.ietf.org/html/draft-pantos-http-live-streaming-08#section-3.4.4\n          var decryptparams = value1;\n          var keyAttrs = new AttrList(decryptparams);\n          var decryptmethod = keyAttrs.enumeratedString('METHOD'),\n            decrypturi = keyAttrs.URI,\n            decryptiv = keyAttrs.hexadecimalInteger('IV');\n          if (decryptmethod) {\n            levelkey = new LevelKey();\n            if ((decrypturi) && (['AES-128', 'SAMPLE-AES', 'SAMPLE-AES-CENC'].indexOf(decryptmethod) >= 0)) {\n              levelkey.method = decryptmethod;\n              // URI to get the key\n              levelkey.baseuri = baseurl;\n              levelkey.reluri = decrypturi;\n              levelkey.key = null;\n              // Initialization Vector (IV)\n              levelkey.iv = decryptiv;\n            }\n          }\n          break;\n        case 'START':\n          let startParams = value1;\n          let startAttrs = new AttrList(startParams);\n          let startTimeOffset = startAttrs.decimalFloatingPoint('TIME-OFFSET');\n          // TIME-OFFSET can be 0\n          if (!isNaN(startTimeOffset))\n            level.startTimeOffset = startTimeOffset;\n\n          break;\n        case 'MAP':\n          let mapAttrs = new AttrList(value1);\n          frag.relurl = mapAttrs.URI;\n          frag.rawByteRange = mapAttrs.BYTERANGE;\n          frag.baseurl = baseurl;\n          frag.level = id;\n          frag.type = type;\n          frag.sn = 'initSegment';\n          level.initSegment = frag;\n          frag = new Fragment();\n          break;\n        default:\n          logger.warn(`line parsed but not handled: ${result}`);\n          break;\n        }\n      }\n    }\n    frag = prevFrag;\n    // logger.log('found ' + level.fragments.length + ' fragments');\n    if (frag && !frag.relurl) {\n      level.fragments.pop();\n      totalduration -= frag.duration;\n    }\n    level.totalduration = totalduration;\n    level.averagetargetduration = totalduration / level.fragments.length;\n    level.endSN = currentSN - 1;\n    level.startCC = level.fragments[0] ? level.fragments[0].cc : 0;\n    level.endCC = cc;\n\n    if (!level.initSegment && level.fragments.length) {\n      // this is a bit lurky but HLS really has no other way to tell us\n      // if the fragments are TS or MP4, except if we download them :/\n      // but this is to be able to handle SIDX.\n      // FIXME: replace string test by a regex that matches\n      //        also `m4s` `m4a` `m4v` and other popular extensions\n      if (level.fragments.every((frag) => frag.relurl.endsWith('.mp4'))) {\n        logger.warn('MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX');\n\n        frag = new Fragment();\n        frag.relurl = level.fragments[0].relurl;\n        frag.baseurl = baseurl;\n        frag.level = id;\n        frag.type = type;\n        frag.sn = 'initSegment';\n\n        level.initSegment = frag;\n        level.needSidxRanges = true;\n      }\n    }\n\n    return level;\n  }\n}\n","/**\n * Generate MP4 Box\n*/\n\n// import Hex from '../utils/hex';\n\nconst UINT32_MAX = Math.pow(2, 32) - 1;\n\nclass MP4 {\n  static init () {\n    MP4.types = {\n      avc1: [], // codingname\n      avcC: [],\n      btrt: [],\n      dinf: [],\n      dref: [],\n      esds: [],\n      ftyp: [],\n      hdlr: [],\n      mdat: [],\n      mdhd: [],\n      mdia: [],\n      mfhd: [],\n      minf: [],\n      moof: [],\n      moov: [],\n      mp4a: [],\n      '.mp3': [],\n      mvex: [],\n      mvhd: [],\n      pasp: [],\n      sdtp: [],\n      stbl: [],\n      stco: [],\n      stsc: [],\n      stsd: [],\n      stsz: [],\n      stts: [],\n      tfdt: [],\n      tfhd: [],\n      traf: [],\n      trak: [],\n      trun: [],\n      trex: [],\n      tkhd: [],\n      vmhd: [],\n      smhd: []\n    };\n\n    let i;\n    for (i in MP4.types) {\n      if (MP4.types.hasOwnProperty(i)) {\n        MP4.types[i] = [\n          i.charCodeAt(0),\n          i.charCodeAt(1),\n          i.charCodeAt(2),\n          i.charCodeAt(3)\n        ];\n      }\n    }\n\n    let videoHdlr = new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00, // pre_defined\n      0x76, 0x69, 0x64, 0x65, // handler_type: 'vide'\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x56, 0x69, 0x64, 0x65,\n      0x6f, 0x48, 0x61, 0x6e,\n      0x64, 0x6c, 0x65, 0x72, 0x00 // name: 'VideoHandler'\n    ]);\n\n    let audioHdlr = new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00, // pre_defined\n      0x73, 0x6f, 0x75, 0x6e, // handler_type: 'soun'\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x53, 0x6f, 0x75, 0x6e,\n      0x64, 0x48, 0x61, 0x6e,\n      0x64, 0x6c, 0x65, 0x72, 0x00 // name: 'SoundHandler'\n    ]);\n\n    MP4.HDLR_TYPES = {\n      'video': videoHdlr,\n      'audio': audioHdlr\n    };\n\n    let dref = new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x01, // entry_count\n      0x00, 0x00, 0x00, 0x0c, // entry_size\n      0x75, 0x72, 0x6c, 0x20, // 'url' type\n      0x00, // version 0\n      0x00, 0x00, 0x01 // entry_flags\n    ]);\n\n    let stco = new Uint8Array([\n      0x00, // version\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00 // entry_count\n    ]);\n\n    MP4.STTS = MP4.STSC = MP4.STCO = stco;\n\n    MP4.STSZ = new Uint8Array([\n      0x00, // version\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00, // sample_size\n      0x00, 0x00, 0x00, 0x00 // sample_count\n    ]);\n    MP4.VMHD = new Uint8Array([\n      0x00, // version\n      0x00, 0x00, 0x01, // flags\n      0x00, 0x00, // graphicsmode\n      0x00, 0x00,\n      0x00, 0x00,\n      0x00, 0x00 // opcolor\n    ]);\n    MP4.SMHD = new Uint8Array([\n      0x00, // version\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, // balance\n      0x00, 0x00 // reserved\n    ]);\n\n    MP4.STSD = new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x01]);// entry_count\n\n    let majorBrand = new Uint8Array([105, 115, 111, 109]); // isom\n    let avc1Brand = new Uint8Array([97, 118, 99, 49]); // avc1\n    let minorVersion = new Uint8Array([0, 0, 0, 1]);\n\n    MP4.FTYP = MP4.box(MP4.types.ftyp, majorBrand, minorVersion, majorBrand, avc1Brand);\n    MP4.DINF = MP4.box(MP4.types.dinf, MP4.box(MP4.types.dref, dref));\n  }\n\n  static box (type) {\n    let\n      payload = Array.prototype.slice.call(arguments, 1),\n      size = 8,\n      i = payload.length,\n      len = i,\n      result;\n    // calculate the total size we need to allocate\n    while (i--)\n      size += payload[i].byteLength;\n\n    result = new Uint8Array(size);\n    result[0] = (size >> 24) & 0xff;\n    result[1] = (size >> 16) & 0xff;\n    result[2] = (size >> 8) & 0xff;\n    result[3] = size & 0xff;\n    result.set(type, 4);\n    // copy the payload into the result\n    for (i = 0, size = 8; i < len; i++) {\n      // copy payload[i] array @ offset size\n      result.set(payload[i], size);\n      size += payload[i].byteLength;\n    }\n    return result;\n  }\n\n  static hdlr (type) {\n    return MP4.box(MP4.types.hdlr, MP4.HDLR_TYPES[type]);\n  }\n\n  static mdat (data) {\n    return MP4.box(MP4.types.mdat, data);\n  }\n\n  static mdhd (timescale, duration) {\n    duration *= timescale;\n    const upperWordDuration = Math.floor(duration / (UINT32_MAX + 1));\n    const lowerWordDuration = Math.floor(duration % (UINT32_MAX + 1));\n    return MP4.box(MP4.types.mdhd, new Uint8Array([\n      0x01, // version 1\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, // creation_time\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, // modification_time\n      (timescale >> 24) & 0xFF,\n      (timescale >> 16) & 0xFF,\n      (timescale >> 8) & 0xFF,\n      timescale & 0xFF, // timescale\n      (upperWordDuration >> 24),\n      (upperWordDuration >> 16) & 0xFF,\n      (upperWordDuration >> 8) & 0xFF,\n      upperWordDuration & 0xFF,\n      (lowerWordDuration >> 24),\n      (lowerWordDuration >> 16) & 0xFF,\n      (lowerWordDuration >> 8) & 0xFF,\n      lowerWordDuration & 0xFF,\n      0x55, 0xc4, // 'und' language (undetermined)\n      0x00, 0x00\n    ]));\n  }\n\n  static mdia (track) {\n    return MP4.box(MP4.types.mdia, MP4.mdhd(track.timescale, track.duration), MP4.hdlr(track.type), MP4.minf(track));\n  }\n\n  static mfhd (sequenceNumber) {\n    return MP4.box(MP4.types.mfhd, new Uint8Array([\n      0x00,\n      0x00, 0x00, 0x00, // flags\n      (sequenceNumber >> 24),\n      (sequenceNumber >> 16) & 0xFF,\n      (sequenceNumber >> 8) & 0xFF,\n      sequenceNumber & 0xFF // sequence_number\n    ]));\n  }\n\n  static minf (track) {\n    if (track.type === 'audio')\n      return MP4.box(MP4.types.minf, MP4.box(MP4.types.smhd, MP4.SMHD), MP4.DINF, MP4.stbl(track));\n    else\n      return MP4.box(MP4.types.minf, MP4.box(MP4.types.vmhd, MP4.VMHD), MP4.DINF, MP4.stbl(track));\n  }\n\n  static moof (sn, baseMediaDecodeTime, track) {\n    return MP4.box(MP4.types.moof, MP4.mfhd(sn), MP4.traf(track, baseMediaDecodeTime));\n  }\n  /**\n * @param tracks... (optional) {array} the tracks associated with this movie\n */\n  static moov (tracks) {\n    let\n      i = tracks.length,\n      boxes = [];\n\n    while (i--)\n      boxes[i] = MP4.trak(tracks[i]);\n\n    return MP4.box.apply(null, [MP4.types.moov, MP4.mvhd(tracks[0].timescale, tracks[0].duration)].concat(boxes).concat(MP4.mvex(tracks)));\n  }\n\n  static mvex (tracks) {\n    let\n      i = tracks.length,\n      boxes = [];\n\n    while (i--)\n      boxes[i] = MP4.trex(tracks[i]);\n\n    return MP4.box.apply(null, [MP4.types.mvex].concat(boxes));\n  }\n\n  static mvhd (timescale, duration) {\n    duration *= timescale;\n    const upperWordDuration = Math.floor(duration / (UINT32_MAX + 1));\n    const lowerWordDuration = Math.floor(duration % (UINT32_MAX + 1));\n    let\n      bytes = new Uint8Array([\n        0x01, // version 1\n        0x00, 0x00, 0x00, // flags\n        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, // creation_time\n        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, // modification_time\n        (timescale >> 24) & 0xFF,\n        (timescale >> 16) & 0xFF,\n        (timescale >> 8) & 0xFF,\n        timescale & 0xFF, // timescale\n        (upperWordDuration >> 24),\n        (upperWordDuration >> 16) & 0xFF,\n        (upperWordDuration >> 8) & 0xFF,\n        upperWordDuration & 0xFF,\n        (lowerWordDuration >> 24),\n        (lowerWordDuration >> 16) & 0xFF,\n        (lowerWordDuration >> 8) & 0xFF,\n        lowerWordDuration & 0xFF,\n        0x00, 0x01, 0x00, 0x00, // 1.0 rate\n        0x01, 0x00, // 1.0 volume\n        0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x01, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x01, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x40, 0x00, 0x00, 0x00, // transformation: unity matrix\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00, // pre_defined\n        0xff, 0xff, 0xff, 0xff // next_track_ID\n      ]);\n    return MP4.box(MP4.types.mvhd, bytes);\n  }\n\n  static sdtp (track) {\n    let\n      samples = track.samples || [],\n      bytes = new Uint8Array(4 + samples.length),\n      flags,\n      i;\n    // leave the full box header (4 bytes) all zero\n    // write the sample table\n    for (i = 0; i < samples.length; i++) {\n      flags = samples[i].flags;\n      bytes[i + 4] = (flags.dependsOn << 4) |\n        (flags.isDependedOn << 2) |\n        (flags.hasRedundancy);\n    }\n\n    return MP4.box(MP4.types.sdtp, bytes);\n  }\n\n  static stbl (track) {\n    return MP4.box(MP4.types.stbl, MP4.stsd(track), MP4.box(MP4.types.stts, MP4.STTS), MP4.box(MP4.types.stsc, MP4.STSC), MP4.box(MP4.types.stsz, MP4.STSZ), MP4.box(MP4.types.stco, MP4.STCO));\n  }\n\n  static avc1 (track) {\n    let sps = [], pps = [], i, data, len;\n    // assemble the SPSs\n\n    for (i = 0; i < track.sps.length; i++) {\n      data = track.sps[i];\n      len = data.byteLength;\n      sps.push((len >>> 8) & 0xFF);\n      sps.push((len & 0xFF));\n      sps = sps.concat(Array.prototype.slice.call(data)); // SPS\n    }\n\n    // assemble the PPSs\n    for (i = 0; i < track.pps.length; i++) {\n      data = track.pps[i];\n      len = data.byteLength;\n      pps.push((len >>> 8) & 0xFF);\n      pps.push((len & 0xFF));\n      pps = pps.concat(Array.prototype.slice.call(data));\n    }\n\n    let avcc = MP4.box(MP4.types.avcC, new Uint8Array([\n        0x01, // version\n        sps[3], // profile\n        sps[4], // profile compat\n        sps[5], // level\n        0xfc | 3, // lengthSizeMinusOne, hard-coded to 4 bytes\n        0xE0 | track.sps.length // 3bit reserved (111) + numOfSequenceParameterSets\n      ].concat(sps).concat([\n        track.pps.length // numOfPictureParameterSets\n      ]).concat(pps))), // \"PPS\"\n      width = track.width,\n      height = track.height,\n      hSpacing = track.pixelRatio[0],\n      vSpacing = track.pixelRatio[1];\n\n    return MP4.box(MP4.types.avc1, new Uint8Array([\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x01, // data_reference_index\n      0x00, 0x00, // pre_defined\n      0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00, // pre_defined\n      (width >> 8) & 0xFF,\n      width & 0xff, // width\n      (height >> 8) & 0xFF,\n      height & 0xff, // height\n      0x00, 0x48, 0x00, 0x00, // horizresolution\n      0x00, 0x48, 0x00, 0x00, // vertresolution\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x01, // frame_count\n      0x12,\n      0x64, 0x61, 0x69, 0x6C, // dailymotion/hls.js\n      0x79, 0x6D, 0x6F, 0x74,\n      0x69, 0x6F, 0x6E, 0x2F,\n      0x68, 0x6C, 0x73, 0x2E,\n      0x6A, 0x73, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, // compressorname\n      0x00, 0x18, // depth = 24\n      0x11, 0x11]), // pre_defined = -1\n    avcc,\n    MP4.box(MP4.types.btrt, new Uint8Array([\n      0x00, 0x1c, 0x9c, 0x80, // bufferSizeDB\n      0x00, 0x2d, 0xc6, 0xc0, // maxBitrate\n      0x00, 0x2d, 0xc6, 0xc0])), // avgBitrate\n    MP4.box(MP4.types.pasp, new Uint8Array([\n      (hSpacing >> 24), // hSpacing\n      (hSpacing >> 16) & 0xFF,\n      (hSpacing >> 8) & 0xFF,\n      hSpacing & 0xFF,\n      (vSpacing >> 24), // vSpacing\n      (vSpacing >> 16) & 0xFF,\n      (vSpacing >> 8) & 0xFF,\n      vSpacing & 0xFF]))\n    );\n  }\n\n  static esds (track) {\n    let configlen = track.config.length;\n    return new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n\n      0x03, // descriptor_type\n      0x17 + configlen, // length\n      0x00, 0x01, // es_id\n      0x00, // stream_priority\n\n      0x04, // descriptor_type\n      0x0f + configlen, // length\n      0x40, // codec : mpeg4_audio\n      0x15, // stream_type\n      0x00, 0x00, 0x00, // buffer_size\n      0x00, 0x00, 0x00, 0x00, // maxBitrate\n      0x00, 0x00, 0x00, 0x00, // avgBitrate\n\n      0x05 // descriptor_type\n    ].concat([configlen]).concat(track.config).concat([0x06, 0x01, 0x02])); // GASpecificConfig)); // length + audio config descriptor\n  }\n\n  static mp4a (track) {\n    let samplerate = track.samplerate;\n    return MP4.box(MP4.types.mp4a, new Uint8Array([\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x01, // data_reference_index\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, track.channelCount, // channelcount\n      0x00, 0x10, // sampleSize:16bits\n      0x00, 0x00, 0x00, 0x00, // reserved2\n      (samplerate >> 8) & 0xFF,\n      samplerate & 0xff, //\n      0x00, 0x00]),\n    MP4.box(MP4.types.esds, MP4.esds(track)));\n  }\n\n  static mp3 (track) {\n    let samplerate = track.samplerate;\n    return MP4.box(MP4.types['.mp3'], new Uint8Array([\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x01, // data_reference_index\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, track.channelCount, // channelcount\n      0x00, 0x10, // sampleSize:16bits\n      0x00, 0x00, 0x00, 0x00, // reserved2\n      (samplerate >> 8) & 0xFF,\n      samplerate & 0xff, //\n      0x00, 0x00]));\n  }\n\n  static stsd (track) {\n    if (track.type === 'audio') {\n      if (!track.isAAC && track.codec === 'mp3')\n        return MP4.box(MP4.types.stsd, MP4.STSD, MP4.mp3(track));\n\n      return MP4.box(MP4.types.stsd, MP4.STSD, MP4.mp4a(track));\n    } else {\n      return MP4.box(MP4.types.stsd, MP4.STSD, MP4.avc1(track));\n    }\n  }\n\n  static tkhd (track) {\n    let id = track.id,\n      duration = track.duration * track.timescale,\n      width = track.width,\n      height = track.height,\n      upperWordDuration = Math.floor(duration / (UINT32_MAX + 1)),\n      lowerWordDuration = Math.floor(duration % (UINT32_MAX + 1));\n    return MP4.box(MP4.types.tkhd, new Uint8Array([\n      0x01, // version 1\n      0x00, 0x00, 0x07, // flags\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, // creation_time\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, // modification_time\n      (id >> 24) & 0xFF,\n      (id >> 16) & 0xFF,\n      (id >> 8) & 0xFF,\n      id & 0xFF, // track_ID\n      0x00, 0x00, 0x00, 0x00, // reserved\n      (upperWordDuration >> 24),\n      (upperWordDuration >> 16) & 0xFF,\n      (upperWordDuration >> 8) & 0xFF,\n      upperWordDuration & 0xFF,\n      (lowerWordDuration >> 24),\n      (lowerWordDuration >> 16) & 0xFF,\n      (lowerWordDuration >> 8) & 0xFF,\n      lowerWordDuration & 0xFF,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, // layer\n      0x00, 0x00, // alternate_group\n      0x00, 0x00, // non-audio track volume\n      0x00, 0x00, // reserved\n      0x00, 0x01, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x01, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x40, 0x00, 0x00, 0x00, // transformation: unity matrix\n      (width >> 8) & 0xFF,\n      width & 0xFF,\n      0x00, 0x00, // width\n      (height >> 8) & 0xFF,\n      height & 0xFF,\n      0x00, 0x00 // height\n    ]));\n  }\n\n  static traf (track, baseMediaDecodeTime) {\n    let sampleDependencyTable = MP4.sdtp(track),\n      id = track.id,\n      upperWordBaseMediaDecodeTime = Math.floor(baseMediaDecodeTime / (UINT32_MAX + 1)),\n      lowerWordBaseMediaDecodeTime = Math.floor(baseMediaDecodeTime % (UINT32_MAX + 1));\n    return MP4.box(MP4.types.traf,\n      MP4.box(MP4.types.tfhd, new Uint8Array([\n        0x00, // version 0\n        0x00, 0x00, 0x00, // flags\n        (id >> 24),\n        (id >> 16) & 0XFF,\n        (id >> 8) & 0XFF,\n        (id & 0xFF) // track_ID\n      ])),\n      MP4.box(MP4.types.tfdt, new Uint8Array([\n        0x01, // version 1\n        0x00, 0x00, 0x00, // flags\n        (upperWordBaseMediaDecodeTime >> 24),\n        (upperWordBaseMediaDecodeTime >> 16) & 0XFF,\n        (upperWordBaseMediaDecodeTime >> 8) & 0XFF,\n        (upperWordBaseMediaDecodeTime & 0xFF),\n        (lowerWordBaseMediaDecodeTime >> 24),\n        (lowerWordBaseMediaDecodeTime >> 16) & 0XFF,\n        (lowerWordBaseMediaDecodeTime >> 8) & 0XFF,\n        (lowerWordBaseMediaDecodeTime & 0xFF)\n      ])),\n      MP4.trun(track,\n        sampleDependencyTable.length +\n                    16 + // tfhd\n                    20 + // tfdt\n                    8 + // traf header\n                    16 + // mfhd\n                    8 + // moof header\n                    8), // mdat header\n      sampleDependencyTable);\n  }\n\n  /**\n   * Generate a track box.\n   * @param track {object} a track definition\n   * @return {Uint8Array} the track box\n   */\n  static trak (track) {\n    track.duration = track.duration || 0xffffffff;\n    return MP4.box(MP4.types.trak, MP4.tkhd(track), MP4.mdia(track));\n  }\n\n  static trex (track) {\n    let id = track.id;\n    return MP4.box(MP4.types.trex, new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      (id >> 24),\n      (id >> 16) & 0XFF,\n      (id >> 8) & 0XFF,\n      (id & 0xFF), // track_ID\n      0x00, 0x00, 0x00, 0x01, // default_sample_description_index\n      0x00, 0x00, 0x00, 0x00, // default_sample_duration\n      0x00, 0x00, 0x00, 0x00, // default_sample_size\n      0x00, 0x01, 0x00, 0x01 // default_sample_flags\n    ]));\n  }\n\n  static trun (track, offset) {\n    let samples = track.samples || [],\n      len = samples.length,\n      arraylen = 12 + (16 * len),\n      array = new Uint8Array(arraylen),\n      i, sample, duration, size, flags, cts;\n    offset += 8 + arraylen;\n    array.set([\n      0x00, // version 0\n      0x00, 0x0f, 0x01, // flags\n      (len >>> 24) & 0xFF,\n      (len >>> 16) & 0xFF,\n      (len >>> 8) & 0xFF,\n      len & 0xFF, // sample_count\n      (offset >>> 24) & 0xFF,\n      (offset >>> 16) & 0xFF,\n      (offset >>> 8) & 0xFF,\n      offset & 0xFF // data_offset\n    ], 0);\n    for (i = 0; i < len; i++) {\n      sample = samples[i];\n      duration = sample.duration;\n      size = sample.size;\n      flags = sample.flags;\n      cts = sample.cts;\n      array.set([\n        (duration >>> 24) & 0xFF,\n        (duration >>> 16) & 0xFF,\n        (duration >>> 8) & 0xFF,\n        duration & 0xFF, // sample_duration\n        (size >>> 24) & 0xFF,\n        (size >>> 16) & 0xFF,\n        (size >>> 8) & 0xFF,\n        size & 0xFF, // sample_size\n        (flags.isLeading << 2) | flags.dependsOn,\n        (flags.isDependedOn << 6) |\n          (flags.hasRedundancy << 4) |\n          (flags.paddingValue << 1) |\n          flags.isNonSync,\n        flags.degradPrio & 0xF0 << 8,\n        flags.degradPrio & 0x0F, // sample_flags\n        (cts >>> 24) & 0xFF,\n        (cts >>> 16) & 0xFF,\n        (cts >>> 8) & 0xFF,\n        cts & 0xFF // sample_composition_time_offset\n      ], 12 + 16 * i);\n    }\n    return MP4.box(MP4.types.trun, array);\n  }\n\n  static initSegment (tracks) {\n    if (!MP4.types)\n      MP4.init();\n\n    let movie = MP4.moov(tracks), result;\n    result = new Uint8Array(MP4.FTYP.byteLength + movie.byteLength);\n    result.set(MP4.FTYP);\n    result.set(movie, MP4.FTYP.byteLength);\n    return result;\n  }\n}\n\nexport default MP4;\n","/**\n * fMP4 remuxer\n*/\n\nimport AAC from '../helper/aac';\nimport Event from '../events';\nimport { logger } from '../utils/logger';\nimport MP4 from '../remux/mp4-generator';\nimport { ErrorTypes, ErrorDetails } from '../errors';\n\n// 10 seconds\nconst MAX_SILENT_FRAME_DURATION = 10 * 1000;\n\nclass MP4Remuxer {\n  constructor (observer, config, typeSupported, vendor) {\n    this.observer = observer;\n    this.config = config;\n    this.typeSupported = typeSupported;\n    const userAgent = navigator.userAgent;\n    this.isSafari = vendor && vendor.indexOf('Apple') > -1 && userAgent && !userAgent.match('CriOS');\n    this.ISGenerated = false;\n  }\n\n  destroy () {\n  }\n\n  resetTimeStamp (defaultTimeStamp) {\n    this._initPTS = this._initDTS = defaultTimeStamp;\n  }\n\n  resetInitSegment () {\n    this.ISGenerated = false;\n  }\n\n  remux (audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset) {\n    // generate Init Segment if needed\n    if (!this.ISGenerated)\n      this.generateIS(audioTrack, videoTrack, timeOffset);\n\n    if (this.ISGenerated) {\n      const nbAudioSamples = audioTrack.samples.length;\n      const nbVideoSamples = videoTrack.samples.length;\n      let audioTimeOffset = timeOffset;\n      let videoTimeOffset = timeOffset;\n      if (nbAudioSamples && nbVideoSamples) {\n        // timeOffset is expected to be the offset of the first timestamp of this fragment (first DTS)\n        // if first audio DTS is not aligned with first video DTS then we need to take that into account\n        // when providing timeOffset to remuxAudio / remuxVideo. if we don't do that, there might be a permanent / small\n        // drift between audio and video streams\n        let audiovideoDeltaDts = (audioTrack.samples[0].dts - videoTrack.samples[0].dts) / videoTrack.inputTimeScale;\n        audioTimeOffset += Math.max(0, audiovideoDeltaDts);\n        videoTimeOffset += Math.max(0, -audiovideoDeltaDts);\n      }\n      // Purposefully remuxing audio before video, so that remuxVideo can use nextAudioPts, which is\n      // calculated in remuxAudio.\n      // logger.log('nb AAC samples:' + audioTrack.samples.length);\n      if (nbAudioSamples) {\n        // if initSegment was generated without video samples, regenerate it again\n        if (!audioTrack.timescale) {\n          logger.warn('regenerate InitSegment as audio detected');\n          this.generateIS(audioTrack, videoTrack, timeOffset);\n        }\n        let audioData = this.remuxAudio(audioTrack, audioTimeOffset, contiguous, accurateTimeOffset);\n        // logger.log('nb AVC samples:' + videoTrack.samples.length);\n        if (nbVideoSamples) {\n          let audioTrackLength;\n          if (audioData)\n            audioTrackLength = audioData.endPTS - audioData.startPTS;\n\n          // if initSegment was generated without video samples, regenerate it again\n          if (!videoTrack.timescale) {\n            logger.warn('regenerate InitSegment as video detected');\n            this.generateIS(audioTrack, videoTrack, timeOffset);\n          }\n          this.remuxVideo(videoTrack, videoTimeOffset, contiguous, audioTrackLength, accurateTimeOffset);\n        }\n      } else {\n        // logger.log('nb AVC samples:' + videoTrack.samples.length);\n        if (nbVideoSamples) {\n          let videoData = this.remuxVideo(videoTrack, videoTimeOffset, contiguous, 0, accurateTimeOffset);\n          if (videoData && audioTrack.codec)\n            this.remuxEmptyAudio(audioTrack, audioTimeOffset, contiguous, videoData);\n        }\n      }\n    }\n    // logger.log('nb ID3 samples:' + audioTrack.samples.length);\n    if (id3Track.samples.length)\n      this.remuxID3(id3Track, timeOffset);\n\n    // logger.log('nb ID3 samples:' + audioTrack.samples.length);\n    if (textTrack.samples.length)\n      this.remuxText(textTrack, timeOffset);\n\n    // notify end of parsing\n    this.observer.trigger(Event.FRAG_PARSED);\n  }\n\n  generateIS (audioTrack, videoTrack, timeOffset) {\n    let observer = this.observer,\n      audioSamples = audioTrack.samples,\n      videoSamples = videoTrack.samples,\n      typeSupported = this.typeSupported,\n      container = 'audio/mp4',\n      tracks = {},\n      data = { tracks: tracks },\n      computePTSDTS = (this._initPTS === undefined),\n      initPTS, initDTS;\n\n    if (computePTSDTS)\n      initPTS = initDTS = Infinity;\n\n    if (audioTrack.config && audioSamples.length) {\n      // let's use audio sampling rate as MP4 time scale.\n      // rationale is that there is a integer nb of audio frames per audio sample (1024 for AAC)\n      // using audio sampling rate here helps having an integer MP4 frame duration\n      // this avoids potential rounding issue and AV sync issue\n      audioTrack.timescale = audioTrack.samplerate;\n      logger.log(`audio sampling rate : ${audioTrack.samplerate}`);\n      if (!audioTrack.isAAC) {\n        if (typeSupported.mpeg) { // Chrome and Safari\n          container = 'audio/mpeg';\n          audioTrack.codec = '';\n        } else if (typeSupported.mp3) { // Firefox\n          audioTrack.codec = 'mp3';\n        }\n      }\n      tracks.audio = {\n        container: container,\n        codec: audioTrack.codec,\n        initSegment: !audioTrack.isAAC && typeSupported.mpeg ? new Uint8Array() : MP4.initSegment([audioTrack]),\n        metadata: {\n          channelCount: audioTrack.channelCount\n        }\n      };\n      if (computePTSDTS) {\n        // remember first PTS of this demuxing context. for audio, PTS = DTS\n        initPTS = initDTS = audioSamples[0].pts - audioTrack.inputTimeScale * timeOffset;\n      }\n    }\n\n    if (videoTrack.sps && videoTrack.pps && videoSamples.length) {\n      // let's use input time scale as MP4 video timescale\n      // we use input time scale straight away to avoid rounding issues on frame duration / cts computation\n      const inputTimeScale = videoTrack.inputTimeScale;\n      videoTrack.timescale = inputTimeScale;\n      tracks.video = {\n        container: 'video/mp4',\n        codec: videoTrack.codec,\n        initSegment: MP4.initSegment([videoTrack]),\n        metadata: {\n          width: videoTrack.width,\n          height: videoTrack.height\n        }\n      };\n      if (computePTSDTS) {\n        initPTS = Math.min(initPTS, videoSamples[0].pts - inputTimeScale * timeOffset);\n        initDTS = Math.min(initDTS, videoSamples[0].dts - inputTimeScale * timeOffset);\n        this.observer.trigger(Event.INIT_PTS_FOUND, { initPTS: initPTS });\n      }\n    }\n\n    if (Object.keys(tracks).length) {\n      observer.trigger(Event.FRAG_PARSING_INIT_SEGMENT, data);\n      this.ISGenerated = true;\n      if (computePTSDTS) {\n        this._initPTS = initPTS;\n        this._initDTS = initDTS;\n      }\n    } else {\n      observer.trigger(Event.ERROR, { type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.FRAG_PARSING_ERROR, fatal: false, reason: 'no audio/video samples found' });\n    }\n  }\n\n  remuxVideo (track, timeOffset, contiguous, audioTrackLength, accurateTimeOffset) {\n    let offset = 8,\n      timeScale = track.timescale,\n      mp4SampleDuration,\n      mdat, moof,\n      firstPTS, firstDTS,\n      nextDTS,\n      lastPTS, lastDTS,\n      inputSamples = track.samples,\n      outputSamples = [],\n      nbSamples = inputSamples.length,\n      ptsNormalize = this._PTSNormalize,\n      initDTS = this._initDTS;\n\n    // for (let i = 0; i < track.samples.length; i++) {\n    //   let avcSample = track.samples[i];\n    //   let units = avcSample.units;\n    //   let unitsString = '';\n    //   for (let j = 0; j < units.length ; j++) {\n    //     unitsString += units[j].type + ',';\n    //     if (units[j].data.length < 500) {\n    //       unitsString += Hex.hexDump(units[j].data);\n    //     }\n    //   }\n    //   logger.log(avcSample.pts + '/' + avcSample.dts + ',' + unitsString + avcSample.units.length);\n    // }\n\n    // if parsed fragment is contiguous with last one, let's use last DTS value as reference\n    let nextAvcDts = this.nextAvcDts;\n\n    const isSafari = this.isSafari;\n\n    if (nbSamples === 0)\n      return;\n\n    // Safari does not like overlapping DTS on consecutive fragments. let's use nextAvcDts to overcome this if fragments are consecutive\n    if (isSafari) {\n      // also consider consecutive fragments as being contiguous (even if a level switch occurs),\n      // for sake of clarity:\n      // consecutive fragments are frags with\n      //  - less than 100ms gaps between new time offset (if accurate) and next expected PTS OR\n      //  - less than 200 ms PTS gaps (timeScale/5)\n      contiguous |= (inputSamples.length && nextAvcDts &&\n                     ((accurateTimeOffset && Math.abs(timeOffset - nextAvcDts / timeScale) < 0.1) ||\n                      Math.abs((inputSamples[0].pts - nextAvcDts - initDTS)) < timeScale / 5)\n      );\n    }\n\n    if (!contiguous) {\n      // if not contiguous, let's use target timeOffset\n      nextAvcDts = timeOffset * timeScale;\n    }\n\n    // PTS is coded on 33bits, and can loop from -2^32 to 2^32\n    // ptsNormalize will make PTS/DTS value monotonic, we use last known DTS value as reference value\n    inputSamples.forEach(function (sample) {\n      sample.pts = ptsNormalize(sample.pts - initDTS, nextAvcDts);\n      sample.dts = ptsNormalize(sample.dts - initDTS, nextAvcDts);\n    });\n\n    // sort video samples by DTS then PTS then demux id order\n    inputSamples.sort(function (a, b) {\n      const deltadts = a.dts - b.dts;\n      const deltapts = a.pts - b.pts;\n      return deltadts || (deltapts || (a.id - b.id));\n    });\n\n    // handle broken streams with PTS < DTS, tolerance up 200ms (18000 in 90kHz timescale)\n    let PTSDTSshift = inputSamples.reduce((prev, curr) => Math.max(Math.min(prev, curr.pts - curr.dts), -18000), 0);\n    if (PTSDTSshift < 0) {\n      logger.warn(`PTS < DTS detected in video samples, shifting DTS by ${Math.round(PTSDTSshift / 90)} ms to overcome this issue`);\n      for (let i = 0; i < inputSamples.length; i++)\n        inputSamples[i].dts += PTSDTSshift;\n    }\n\n    // compute first DTS and last DTS, normalize them against reference value\n    let sample = inputSamples[0];\n    firstDTS = Math.max(sample.dts, 0);\n    firstPTS = Math.max(sample.pts, 0);\n\n    // check timestamp continuity accross consecutive fragments (this is to remove inter-fragment gap/hole)\n    let delta = Math.round((firstDTS - nextAvcDts) / 90);\n    // if fragment are contiguous, detect hole/overlapping between fragments\n    if (contiguous) {\n      if (delta) {\n        if (delta > 1)\n          logger.log(`AVC:${delta} ms hole between fragments detected,filling it`);\n        else if (delta < -1)\n          logger.log(`AVC:${(-delta)} ms overlapping between fragments detected`);\n\n        // remove hole/gap : set DTS to next expected DTS\n        firstDTS = nextAvcDts;\n        inputSamples[0].dts = firstDTS;\n        // offset PTS as well, ensure that PTS is smaller or equal than new DTS\n        firstPTS = Math.max(firstPTS - delta, nextAvcDts);\n        inputSamples[0].pts = firstPTS;\n        logger.log(`Video/PTS/DTS adjusted: ${Math.round(firstPTS / 90)}/${Math.round(firstDTS / 90)},delta:${delta} ms`);\n      }\n    }\n    nextDTS = firstDTS;\n\n    // compute lastPTS/lastDTS\n    sample = inputSamples[inputSamples.length - 1];\n    lastDTS = Math.max(sample.dts, 0);\n    lastPTS = Math.max(sample.pts, 0, lastDTS);\n\n    // on Safari let's signal the same sample duration for all samples\n    // sample duration (as expected by trun MP4 boxes), should be the delta between sample DTS\n    // set this constant duration as being the avg delta between consecutive DTS.\n    if (isSafari)\n      mp4SampleDuration = Math.round((lastDTS - firstDTS) / (inputSamples.length - 1));\n\n    let nbNalu = 0, naluLen = 0;\n    for (let i = 0; i < nbSamples; i++) {\n      // compute total/avc sample length and nb of NAL units\n      let sample = inputSamples[i], units = sample.units, nbUnits = units.length, sampleLen = 0;\n      for (let j = 0; j < nbUnits; j++)\n        sampleLen += units[j].data.length;\n\n      naluLen += sampleLen;\n      nbNalu += nbUnits;\n      sample.length = sampleLen;\n\n      // normalize PTS/DTS\n      if (isSafari) {\n        // sample DTS is computed using a constant decoding offset (mp4SampleDuration) between samples\n        sample.dts = firstDTS + i * mp4SampleDuration;\n      } else {\n        // ensure sample monotonic DTS\n        sample.dts = Math.max(sample.dts, firstDTS);\n      }\n      // ensure that computed value is greater or equal than sample DTS\n      sample.pts = Math.max(sample.pts, sample.dts);\n    }\n\n    /* concatenate the video data and construct the mdat in place\n      (need 8 more bytes to fill length and mpdat type) */\n    let mdatSize = naluLen + (4 * nbNalu) + 8;\n    try {\n      mdat = new Uint8Array(mdatSize);\n    } catch (err) {\n      this.observer.trigger(Event.ERROR, { type: ErrorTypes.MUX_ERROR, details: ErrorDetails.REMUX_ALLOC_ERROR, fatal: false, bytes: mdatSize, reason: `fail allocating video mdat ${mdatSize}` });\n      return;\n    }\n    let view = new DataView(mdat.buffer);\n    view.setUint32(0, mdatSize);\n    mdat.set(MP4.types.mdat, 4);\n\n    for (let i = 0; i < nbSamples; i++) {\n      let avcSample = inputSamples[i],\n        avcSampleUnits = avcSample.units,\n        mp4SampleLength = 0,\n        compositionTimeOffset;\n      // convert NALU bitstream to MP4 format (prepend NALU with size field)\n      for (let j = 0, nbUnits = avcSampleUnits.length; j < nbUnits; j++) {\n        let unit = avcSampleUnits[j],\n          unitData = unit.data,\n          unitDataLen = unit.data.byteLength;\n        view.setUint32(offset, unitDataLen);\n        offset += 4;\n        mdat.set(unitData, offset);\n        offset += unitDataLen;\n        mp4SampleLength += 4 + unitDataLen;\n      }\n\n      if (!isSafari) {\n        // expected sample duration is the Decoding Timestamp diff of consecutive samples\n        if (i < nbSamples - 1) {\n          mp4SampleDuration = inputSamples[i + 1].dts - avcSample.dts;\n        } else {\n          let config = this.config,\n            lastFrameDuration = avcSample.dts - inputSamples[i > 0 ? i - 1 : i].dts;\n          if (config.stretchShortVideoTrack) {\n            // In some cases, a segment's audio track duration may exceed the video track duration.\n            // Since we've already remuxed audio, and we know how long the audio track is, we look to\n            // see if the delta to the next segment is longer than maxBufferHole.\n            // If so, playback would potentially get stuck, so we artificially inflate\n            // the duration of the last frame to minimize any potential gap between segments.\n            let maxBufferHole = config.maxBufferHole,\n              gapTolerance = Math.floor(maxBufferHole * timeScale),\n              deltaToFrameEnd = (audioTrackLength ? firstPTS + audioTrackLength * timeScale : this.nextAudioPts) - avcSample.pts;\n            if (deltaToFrameEnd > gapTolerance) {\n              // We subtract lastFrameDuration from deltaToFrameEnd to try to prevent any video\n              // frame overlap. maxBufferHole should be >> lastFrameDuration anyway.\n              mp4SampleDuration = deltaToFrameEnd - lastFrameDuration;\n              if (mp4SampleDuration < 0)\n                mp4SampleDuration = lastFrameDuration;\n\n              logger.log(`It is approximately ${deltaToFrameEnd / 90} ms to the next segment; using duration ${mp4SampleDuration / 90} ms for the last video frame.`);\n            } else {\n              mp4SampleDuration = lastFrameDuration;\n            }\n          } else {\n            mp4SampleDuration = lastFrameDuration;\n          }\n        }\n        compositionTimeOffset = Math.round(avcSample.pts - avcSample.dts);\n      } else {\n        compositionTimeOffset = Math.max(0, mp4SampleDuration * Math.round((avcSample.pts - avcSample.dts) / mp4SampleDuration));\n      }\n\n      // console.log('PTS/DTS/initDTS/normPTS/normDTS/relative PTS : ${avcSample.pts}/${avcSample.dts}/${initDTS}/${ptsnorm}/${dtsnorm}/${(avcSample.pts/4294967296).toFixed(3)}');\n      outputSamples.push({\n        size: mp4SampleLength,\n        // constant duration\n        duration: mp4SampleDuration,\n        cts: compositionTimeOffset,\n        flags: {\n          isLeading: 0,\n          isDependedOn: 0,\n          hasRedundancy: 0,\n          degradPrio: 0,\n          dependsOn: avcSample.key ? 2 : 1,\n          isNonSync: avcSample.key ? 0 : 1\n        }\n      });\n    }\n    // next AVC sample DTS should be equal to last sample DTS + last sample duration (in PES timescale)\n    this.nextAvcDts = lastDTS + mp4SampleDuration;\n    let dropped = track.dropped;\n    track.len = 0;\n    track.nbNalu = 0;\n    track.dropped = 0;\n    if (outputSamples.length && navigator.userAgent.toLowerCase().indexOf('chrome') > -1) {\n      let flags = outputSamples[0].flags;\n      // chrome workaround, mark first sample as being a Random Access Point to avoid sourcebuffer append issue\n      // https://code.google.com/p/chromium/issues/detail?id=229412\n      flags.dependsOn = 2;\n      flags.isNonSync = 0;\n    }\n    track.samples = outputSamples;\n    moof = MP4.moof(track.sequenceNumber++, firstDTS, track);\n    track.samples = [];\n\n    let data = {\n      data1: moof,\n      data2: mdat,\n      startPTS: firstPTS / timeScale,\n      endPTS: (lastPTS + mp4SampleDuration) / timeScale,\n      startDTS: firstDTS / timeScale,\n      endDTS: this.nextAvcDts / timeScale,\n      type: 'video',\n      hasAudio: false,\n      hasVideo: true,\n      nb: outputSamples.length,\n      dropped: dropped\n    };\n    this.observer.trigger(Event.FRAG_PARSING_DATA, data);\n    return data;\n  }\n\n  remuxAudio (track, timeOffset, contiguous, accurateTimeOffset) {\n    const inputTimeScale = track.inputTimeScale,\n      mp4timeScale = track.timescale,\n      scaleFactor = inputTimeScale / mp4timeScale,\n      mp4SampleDuration = track.isAAC ? 1024 : 1152,\n      inputSampleDuration = mp4SampleDuration * scaleFactor,\n      ptsNormalize = this._PTSNormalize,\n      initDTS = this._initDTS,\n      rawMPEG = !track.isAAC && this.typeSupported.mpeg;\n\n    let offset,\n      mp4Sample,\n      fillFrame,\n      mdat, moof,\n      firstPTS, lastPTS,\n      inputSamples = track.samples,\n      outputSamples = [],\n      nextAudioPts = this.nextAudioPts;\n\n    // for audio samples, also consider consecutive fragments as being contiguous (even if a level switch occurs),\n    // for sake of clarity:\n    // consecutive fragments are frags with\n    //  - less than 100ms gaps between new time offset (if accurate) and next expected PTS OR\n    //  - less than 20 audio frames distance\n    // contiguous fragments are consecutive fragments from same quality level (same level, new SN = old SN + 1)\n    // this helps ensuring audio continuity\n    // and this also avoids audio glitches/cut when switching quality, or reporting wrong duration on first audio frame\n    contiguous |= (inputSamples.length && nextAudioPts &&\n                   ((accurateTimeOffset && Math.abs(timeOffset - nextAudioPts / inputTimeScale) < 0.1) ||\n                    Math.abs((inputSamples[0].pts - nextAudioPts - initDTS)) < 20 * inputSampleDuration)\n    );\n\n    // compute normalized PTS\n    inputSamples.forEach(function (sample) {\n      sample.pts = sample.dts = ptsNormalize(sample.pts - initDTS, timeOffset * inputTimeScale);\n    });\n\n    // filter out sample with negative PTS that are not playable anyway\n    // if we don't remove these negative samples, they will shift all audio samples forward.\n    // leading to audio overlap between current / next fragment\n    inputSamples = inputSamples.filter(function (sample) {\n      return sample.pts >= 0;\n    });\n\n    // in case all samples have negative PTS, and have been filtered out, return now\n    if (inputSamples.length === 0)\n      return;\n\n    if (!contiguous) {\n      if (!accurateTimeOffset) {\n        // if frag are mot contiguous and if we cant trust time offset, let's use first sample PTS as next audio PTS\n        nextAudioPts = inputSamples[0].pts;\n      } else {\n        // if timeOffset is accurate, let's use it as predicted next audio PTS\n        nextAudioPts = timeOffset * inputTimeScale;\n      }\n    }\n\n    // If the audio track is missing samples, the frames seem to get \"left-shifted\" within the\n    // resulting mp4 segment, causing sync issues and leaving gaps at the end of the audio segment.\n    // In an effort to prevent this from happening, we inject frames here where there are gaps.\n    // When possible, we inject a silent frame; when that's not possible, we duplicate the last\n    // frame.\n\n    if (track.isAAC) {\n      const maxAudioFramesDrift = this.config.maxAudioFramesDrift;\n      for (let i = 0, nextPts = nextAudioPts; i < inputSamples.length;) {\n        // First, let's see how far off this frame is from where we expect it to be\n        var sample = inputSamples[i], delta;\n        let pts = sample.pts;\n        delta = pts - nextPts;\n\n        const duration = Math.abs(1000 * delta / inputTimeScale);\n\n        // If we're overlapping by more than a duration, drop this sample\n        if (delta <= -maxAudioFramesDrift * inputSampleDuration) {\n          logger.warn(`Dropping 1 audio frame @ ${(nextPts / inputTimeScale).toFixed(3)}s due to ${Math.round(duration)} ms overlap.`);\n          inputSamples.splice(i, 1);\n          track.len -= sample.unit.length;\n          // Don't touch nextPtsNorm or i\n        } // eslint-disable-line brace-style\n\n        // Insert missing frames if:\n        // 1: We're more than maxAudioFramesDrift frame away\n        // 2: Not more than MAX_SILENT_FRAME_DURATION away\n        // 3: currentTime (aka nextPtsNorm) is not 0\n        else if (delta >= maxAudioFramesDrift * inputSampleDuration && duration < MAX_SILENT_FRAME_DURATION && nextPts) {\n          let missing = Math.round(delta / inputSampleDuration);\n          logger.warn(`Injecting ${missing} audio frame @ ${(nextPts / inputTimeScale).toFixed(3)}s due to ${Math.round(1000 * delta / inputTimeScale)} ms gap.`);\n          for (let j = 0; j < missing; j++) {\n            let newStamp = Math.max(nextPts, 0);\n            fillFrame = AAC.getSilentFrame(track.manifestCodec || track.codec, track.channelCount);\n            if (!fillFrame) {\n              logger.log('Unable to get silent frame for given audio codec; duplicating last frame instead.');\n              fillFrame = sample.unit.subarray();\n            }\n            inputSamples.splice(i, 0, { unit: fillFrame, pts: newStamp, dts: newStamp });\n            track.len += fillFrame.length;\n            nextPts += inputSampleDuration;\n            i++;\n          }\n\n          // Adjust sample to next expected pts\n          sample.pts = sample.dts = nextPts;\n          nextPts += inputSampleDuration;\n          i++;\n        } else {\n        // Otherwise, just adjust pts\n          if (Math.abs(delta) > (0.1 * inputSampleDuration)) {\n            // logger.log(`Invalid frame delta ${Math.round(delta + inputSampleDuration)} at PTS ${Math.round(pts / 90)} (should be ${Math.round(inputSampleDuration)}).`);\n          }\n          sample.pts = sample.dts = nextPts;\n          nextPts += inputSampleDuration;\n          i++;\n        }\n      }\n    }\n\n    for (let j = 0, nbSamples = inputSamples.length; j < nbSamples; j++) {\n      let audioSample = inputSamples[j];\n      let unit = audioSample.unit;\n      let pts = audioSample.pts;\n      // logger.log(`Audio/PTS:${Math.round(pts/90)}`);\n      // if not first sample\n      if (lastPTS !== undefined) {\n        mp4Sample.duration = Math.round((pts - lastPTS) / scaleFactor);\n      } else {\n        let delta = Math.round(1000 * (pts - nextAudioPts) / inputTimeScale),\n          numMissingFrames = 0;\n        // if fragment are contiguous, detect hole/overlapping between fragments\n        // contiguous fragments are consecutive fragments from same quality level (same level, new SN = old SN + 1)\n        if (contiguous && track.isAAC) {\n          // log delta\n          if (delta) {\n            if (delta > 0 && delta < MAX_SILENT_FRAME_DURATION) {\n              numMissingFrames = Math.round((pts - nextAudioPts) / inputSampleDuration);\n              logger.log(`${delta} ms hole between AAC samples detected,filling it`);\n              if (numMissingFrames > 0) {\n                fillFrame = AAC.getSilentFrame(track.manifestCodec || track.codec, track.channelCount);\n                if (!fillFrame)\n                  fillFrame = unit.subarray();\n\n                track.len += numMissingFrames * fillFrame.length;\n              }\n              // if we have frame overlap, overlapping for more than half a frame duraion\n            } else if (delta < -12) {\n              // drop overlapping audio frames... browser will deal with it\n              logger.log(`drop overlapping AAC sample, expected/parsed/delta:${(nextAudioPts / inputTimeScale).toFixed(3)}s/${(pts / inputTimeScale).toFixed(3)}s/${(-delta)}ms`);\n              track.len -= unit.byteLength;\n              continue;\n            }\n            // set PTS/DTS to expected PTS/DTS\n            pts = nextAudioPts;\n          }\n        }\n        // remember first PTS of our audioSamples\n        firstPTS = pts;\n        if (track.len > 0) {\n          /* concatenate the audio data and construct the mdat in place\n            (need 8 more bytes to fill length and mdat type) */\n          let mdatSize = rawMPEG ? track.len : track.len + 8;\n          offset = rawMPEG ? 0 : 8;\n          try {\n            mdat = new Uint8Array(mdatSize);\n          } catch (err) {\n            this.observer.trigger(Event.ERROR, { type: ErrorTypes.MUX_ERROR, details: ErrorDetails.REMUX_ALLOC_ERROR, fatal: false, bytes: mdatSize, reason: `fail allocating audio mdat ${mdatSize}` });\n            return;\n          }\n          if (!rawMPEG) {\n            const view = new DataView(mdat.buffer);\n            view.setUint32(0, mdatSize);\n            mdat.set(MP4.types.mdat, 4);\n          }\n        } else {\n          // no audio samples\n          return;\n        }\n        for (let i = 0; i < numMissingFrames; i++) {\n          fillFrame = AAC.getSilentFrame(track.manifestCodec || track.codec, track.channelCount);\n          if (!fillFrame) {\n            logger.log('Unable to get silent frame for given audio codec; duplicating this frame instead.');\n            fillFrame = unit.subarray();\n          }\n          mdat.set(fillFrame, offset);\n          offset += fillFrame.byteLength;\n          mp4Sample = {\n            size: fillFrame.byteLength,\n            cts: 0,\n            duration: 1024,\n            flags: {\n              isLeading: 0,\n              isDependedOn: 0,\n              hasRedundancy: 0,\n              degradPrio: 0,\n              dependsOn: 1\n            }\n          };\n          outputSamples.push(mp4Sample);\n        }\n      }\n      mdat.set(unit, offset);\n      let unitLen = unit.byteLength;\n      offset += unitLen;\n      // console.log('PTS/DTS/initDTS/normPTS/normDTS/relative PTS : ${audioSample.pts}/${audioSample.dts}/${initDTS}/${ptsnorm}/${dtsnorm}/${(audioSample.pts/4294967296).toFixed(3)}');\n      mp4Sample = {\n        size: unitLen,\n        cts: 0,\n        duration: 0,\n        flags: {\n          isLeading: 0,\n          isDependedOn: 0,\n          hasRedundancy: 0,\n          degradPrio: 0,\n          dependsOn: 1\n        }\n      };\n      outputSamples.push(mp4Sample);\n      lastPTS = pts;\n    }\n    let lastSampleDuration = 0;\n    let nbSamples = outputSamples.length;\n    // set last sample duration as being identical to previous sample\n    if (nbSamples >= 2) {\n      lastSampleDuration = outputSamples[nbSamples - 2].duration;\n      mp4Sample.duration = lastSampleDuration;\n    }\n    if (nbSamples) {\n      // next audio sample PTS should be equal to last sample PTS + duration\n      this.nextAudioPts = nextAudioPts = lastPTS + scaleFactor * lastSampleDuration;\n      // logger.log('Audio/PTS/PTSend:' + audioSample.pts.toFixed(0) + '/' + this.nextAacDts.toFixed(0));\n      track.len = 0;\n      track.samples = outputSamples;\n      if (rawMPEG)\n        moof = new Uint8Array();\n      else\n        moof = MP4.moof(track.sequenceNumber++, firstPTS / scaleFactor, track);\n\n      track.samples = [];\n      const start = firstPTS / inputTimeScale;\n      const end = nextAudioPts / inputTimeScale;\n      const audioData = {\n        data1: moof,\n        data2: mdat,\n        startPTS: start,\n        endPTS: end,\n        startDTS: start,\n        endDTS: end,\n        type: 'audio',\n        hasAudio: true,\n        hasVideo: false,\n        nb: nbSamples\n      };\n      this.observer.trigger(Event.FRAG_PARSING_DATA, audioData);\n      return audioData;\n    }\n    return null;\n  }\n\n  remuxEmptyAudio (track, timeOffset, contiguous, videoData) {\n    let inputTimeScale = track.inputTimeScale,\n      mp4timeScale = track.samplerate ? track.samplerate : inputTimeScale,\n      scaleFactor = inputTimeScale / mp4timeScale,\n      nextAudioPts = this.nextAudioPts,\n\n      // sync with video's timestamp\n      startDTS = (nextAudioPts !== undefined ? nextAudioPts : videoData.startDTS * inputTimeScale) + this._initDTS,\n      endDTS = videoData.endDTS * inputTimeScale + this._initDTS,\n      // one sample's duration value\n      sampleDuration = 1024,\n      frameDuration = scaleFactor * sampleDuration,\n\n      // samples count of this segment's duration\n      nbSamples = Math.ceil((endDTS - startDTS) / frameDuration),\n\n      // silent frame\n      silentFrame = AAC.getSilentFrame(track.manifestCodec || track.codec, track.channelCount);\n\n    logger.warn('remux empty Audio');\n    // Can't remux if we can't generate a silent frame...\n    if (!silentFrame) {\n      logger.trace('Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!');\n      return;\n    }\n\n    let samples = [];\n    for (let i = 0; i < nbSamples; i++) {\n      let stamp = startDTS + i * frameDuration;\n      samples.push({ unit: silentFrame, pts: stamp, dts: stamp });\n      track.len += silentFrame.length;\n    }\n    track.samples = samples;\n\n    this.remuxAudio(track, timeOffset, contiguous);\n  }\n\n  remuxID3 (track, timeOffset) {\n    let length = track.samples.length, sample;\n    const inputTimeScale = track.inputTimeScale;\n    const initPTS = this._initPTS;\n    const initDTS = this._initDTS;\n    // consume samples\n    if (length) {\n      for (let index = 0; index < length; index++) {\n        sample = track.samples[index];\n        // setting id3 pts, dts to relative time\n        // using this._initPTS and this._initDTS to calculate relative time\n        sample.pts = ((sample.pts - initPTS) / inputTimeScale);\n        sample.dts = ((sample.dts - initDTS) / inputTimeScale);\n      }\n      this.observer.trigger(Event.FRAG_PARSING_METADATA, {\n        samples: track.samples\n      });\n    }\n\n    track.samples = [];\n    timeOffset = timeOffset;\n  }\n\n  remuxText (track, timeOffset) {\n    track.samples.sort(function (a, b) {\n      return (a.pts - b.pts);\n    });\n\n    let length = track.samples.length, sample;\n    const inputTimeScale = track.inputTimeScale;\n    const initPTS = this._initPTS;\n    // consume samples\n    if (length) {\n      for (let index = 0; index < length; index++) {\n        sample = track.samples[index];\n        // setting text pts, dts to relative time\n        // using this._initPTS and this._initDTS to calculate relative time\n        sample.pts = ((sample.pts - initPTS) / inputTimeScale);\n      }\n      this.observer.trigger(Event.FRAG_PARSING_USERDATA, {\n        samples: track.samples\n      });\n    }\n\n    track.samples = [];\n    timeOffset = timeOffset;\n  }\n\n  _PTSNormalize (value, reference) {\n    let offset;\n    if (reference === undefined)\n      return value;\n\n    if (reference < value) {\n      // - 2^33\n      offset = -8589934592;\n    } else {\n      // + 2^33\n      offset = 8589934592;\n    }\n    /* PTS is 33bit (from 0 to 2^33 -1)\n      if diff between value and reference is bigger than half of the amplitude (2^32) then it means that\n      PTS looping occured. fill the gap */\n    while (Math.abs(value - reference) > 4294967296)\n      value += offset;\n\n    return value;\n  }\n}\n\nexport default MP4Remuxer;\n","/**\n * passthrough remuxer\n*/\nimport Event from '../events';\n\nclass PassThroughRemuxer {\n  constructor (observer) {\n    this.observer = observer;\n  }\n\n  destroy () {\n  }\n\n  resetTimeStamp () {\n  }\n\n  resetInitSegment () {\n  }\n\n  remux (audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset, rawData) {\n    let observer = this.observer;\n    let streamType = '';\n    if (audioTrack)\n      streamType += 'audio';\n\n    if (videoTrack)\n      streamType += 'video';\n\n    observer.trigger(Event.FRAG_PARSING_DATA, {\n      data1: rawData,\n      startPTS: timeOffset,\n      startDTS: timeOffset,\n      type: streamType,\n      hasAudio: !!audioTrack,\n      hasVideo: !!videoTrack,\n      nb: 1,\n      dropped: 0\n    });\n    // notify end of parsing\n    observer.trigger(Event.FRAG_PARSED);\n  }\n}\n\nexport default PassThroughRemuxer;\n","import EventHandler from './event-handler';\n\nexport default class TaskLoop extends EventHandler {\n  constructor (hls, ...events) {\n    super(hls, ...events);\n\n    this._tickInterval = null;\n    this._tickCallCount = 0;\n  }\n\n  /**\n   * @override\n   */\n  destroy () {\n    this.clearInterval();\n    super.destroy();\n  }\n\n  /**\n   * @returns {boolean}\n   */\n  hasInterval () {\n    return this._tickInterval !== null;\n  }\n\n  /**\n   * @param {number} millis Interval time (ms)\n   * @returns {boolean} True when interval has been scheduled, false when already scheduled (no effect)\n   */\n  setInterval (millis) {\n    if (!this._tickInterval) {\n      this._tickInterval = setInterval(this.tick.bind(this, false), millis);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * @returns {boolean} True when interval was cleared, false when none was set (no effect)\n   */\n  clearInterval () {\n    if (this._tickInterval) {\n      clearInterval(this._tickInterval);\n      this._tickInterval = null;\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   *\n   * @param {Wether to force async} forceAsync\n   * @returns {boolean} True when async, false when sync\n   */\n  tick () {\n    this._tickCallCount++;\n    if (this._tickCallCount === 1) {\n      this.doTick();\n      if (this._tickCallCount > 1)\n        setTimeout(this.tick.bind(this), 0);\n\n      this._tickCallCount = 0;\n    }\n  }\n\n  /**\n   * For subclass to implement task logic\n   * @abstract\n   */\n  doTick () {\n    throw new Error('TaskLoop is abstract and `doLoop` must be implemented');\n  }\n}\n","const DECIMAL_RESOLUTION_REGEX = /^(\\d+)x(\\d+)$/; // eslint-disable-line no-useless-escape\nconst ATTR_LIST_REGEX = /\\s*(.+?)\\s*=((?:\\\".*?\\\")|.*?)(?:,|$)/g; // eslint-disable-line no-useless-escape\n\n// adapted from https://github.com/kanongil/node-m3u8parse/blob/master/attrlist.js\nclass AttrList {\n  constructor (attrs) {\n    if (typeof attrs === 'string')\n      attrs = AttrList.parseAttrList(attrs);\n\n    for (let attr in attrs) {\n      if (attrs.hasOwnProperty(attr))\n        this[attr] = attrs[attr];\n    }\n  }\n\n  decimalInteger (attrName) {\n    const intValue = parseInt(this[attrName], 10);\n    if (intValue > Number.MAX_SAFE_INTEGER)\n      return Infinity;\n\n    return intValue;\n  }\n\n  hexadecimalInteger (attrName) {\n    if (this[attrName]) {\n      let stringValue = (this[attrName] || '0x').slice(2);\n      stringValue = ((stringValue.length & 1) ? '0' : '') + stringValue;\n\n      const value = new Uint8Array(stringValue.length / 2);\n      for (let i = 0; i < stringValue.length / 2; i++)\n        value[i] = parseInt(stringValue.slice(i * 2, i * 2 + 2), 16);\n\n      return value;\n    } else {\n      return null;\n    }\n  }\n\n  hexadecimalIntegerAsNumber (attrName) {\n    const intValue = parseInt(this[attrName], 16);\n    if (intValue > Number.MAX_SAFE_INTEGER)\n      return Infinity;\n\n    return intValue;\n  }\n\n  decimalFloatingPoint (attrName) {\n    return parseFloat(this[attrName]);\n  }\n\n  enumeratedString (attrName) {\n    return this[attrName];\n  }\n\n  decimalResolution (attrName) {\n    const res = DECIMAL_RESOLUTION_REGEX.exec(this[attrName]);\n    if (res === null)\n      return undefined;\n\n    return {\n      width: parseInt(res[1], 10),\n      height: parseInt(res[2], 10)\n    };\n  }\n\n  static parseAttrList (input) {\n    let match, attrs = {};\n    ATTR_LIST_REGEX.lastIndex = 0;\n    while ((match = ATTR_LIST_REGEX.exec(input)) !== null) {\n      let value = match[2], quote = '\"';\n\n      if (value.indexOf(quote) === 0 &&\n          value.lastIndexOf(quote) === (value.length - 1))\n        value = value.slice(1, -1);\n\n      attrs[match[1]] = value;\n    }\n    return attrs;\n  }\n}\n\nexport default AttrList;\n","let BinarySearch = {\n  /**\n     * Searches for an item in an array which matches a certain condition.\n     * This requires the condition to only match one item in the array,\n     * and for the array to be ordered.\n     *\n     * @param {Array} list The array to search.\n     * @param {Function} comparisonFunction\n     *      Called and provided a candidate item as the first argument.\n     *      Should return:\n     *          > -1 if the item should be located at a lower index than the provided item.\n     *          > 1 if the item should be located at a higher index than the provided item.\n     *          > 0 if the item is the item you're looking for.\n     *\n     * @return {*} The object if it is found or null otherwise.\n     */\n  search: function (list, comparisonFunction) {\n    let minIndex = 0;\n    let maxIndex = list.length - 1;\n    let currentIndex = null;\n    let currentElement = null;\n\n    while (minIndex <= maxIndex) {\n      currentIndex = (minIndex + maxIndex) / 2 | 0;\n      currentElement = list[currentIndex];\n\n      let comparisonResult = comparisonFunction(currentElement);\n      if (comparisonResult > 0)\n        minIndex = currentIndex + 1;\n      else if (comparisonResult < 0)\n        maxIndex = currentIndex - 1;\n      else\n        return currentElement;\n    }\n\n    return null;\n  }\n};\n\nexport default BinarySearch;\n","/**\n *\n * This code was ported from the dash.js project at:\n *   https://github.com/Dash-Industry-Forum/dash.js/blob/development/externals/cea608-parser.js\n *   https://github.com/Dash-Industry-Forum/dash.js/commit/8269b26a761e0853bb21d78780ed945144ecdd4d#diff-71bc295a2d6b6b7093a1d3290d53a4b2\n *\n * The original copyright appears below:\n *\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2015-2016, DASH Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  1. Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  2. Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\n/**\n     *  Exceptions from regular ASCII. CodePoints are mapped to UTF-16 codes\n     */\n\nlet specialCea608CharsCodes = {\n  0x2a: 0xe1, // lowercase a, acute accent\n  0x5c: 0xe9, // lowercase e, acute accent\n  0x5e: 0xed, // lowercase i, acute accent\n  0x5f: 0xf3, // lowercase o, acute accent\n  0x60: 0xfa, // lowercase u, acute accent\n  0x7b: 0xe7, // lowercase c with cedilla\n  0x7c: 0xf7, // division symbol\n  0x7d: 0xd1, // uppercase N tilde\n  0x7e: 0xf1, // lowercase n tilde\n  0x7f: 0x2588, // Full block\n  // THIS BLOCK INCLUDES THE 16 EXTENDED (TWO-BYTE) LINE 21 CHARACTERS\n  // THAT COME FROM HI BYTE=0x11 AND LOW BETWEEN 0x30 AND 0x3F\n  // THIS MEANS THAT \\x50 MUST BE ADDED TO THE VALUES\n  0x80: 0xae, // Registered symbol (R)\n  0x81: 0xb0, // degree sign\n  0x82: 0xbd, // 1/2 symbol\n  0x83: 0xbf, // Inverted (open) question mark\n  0x84: 0x2122, // Trademark symbol (TM)\n  0x85: 0xa2, // Cents symbol\n  0x86: 0xa3, // Pounds sterling\n  0x87: 0x266a, // Music 8'th note\n  0x88: 0xe0, // lowercase a, grave accent\n  0x89: 0x20, // transparent space (regular)\n  0x8a: 0xe8, // lowercase e, grave accent\n  0x8b: 0xe2, // lowercase a, circumflex accent\n  0x8c: 0xea, // lowercase e, circumflex accent\n  0x8d: 0xee, // lowercase i, circumflex accent\n  0x8e: 0xf4, // lowercase o, circumflex accent\n  0x8f: 0xfb, // lowercase u, circumflex accent\n  // THIS BLOCK INCLUDES THE 32 EXTENDED (TWO-BYTE) LINE 21 CHARACTERS\n  // THAT COME FROM HI BYTE=0x12 AND LOW BETWEEN 0x20 AND 0x3F\n  0x90: 0xc1, // capital letter A with acute\n  0x91: 0xc9, // capital letter E with acute\n  0x92: 0xd3, // capital letter O with acute\n  0x93: 0xda, // capital letter U with acute\n  0x94: 0xdc, // capital letter U with diaresis\n  0x95: 0xfc, // lowercase letter U with diaeresis\n  0x96: 0x2018, // opening single quote\n  0x97: 0xa1, // inverted exclamation mark\n  0x98: 0x2a, // asterisk\n  0x99: 0x2019, // closing single quote\n  0x9a: 0x2501, // box drawings heavy horizontal\n  0x9b: 0xa9, // copyright sign\n  0x9c: 0x2120, // Service mark\n  0x9d: 0x2022, // (round) bullet\n  0x9e: 0x201c, // Left double quotation mark\n  0x9f: 0x201d, // Right double quotation mark\n  0xa0: 0xc0, // uppercase A, grave accent\n  0xa1: 0xc2, // uppercase A, circumflex\n  0xa2: 0xc7, // uppercase C with cedilla\n  0xa3: 0xc8, // uppercase E, grave accent\n  0xa4: 0xca, // uppercase E, circumflex\n  0xa5: 0xcb, // capital letter E with diaresis\n  0xa6: 0xeb, // lowercase letter e with diaresis\n  0xa7: 0xce, // uppercase I, circumflex\n  0xa8: 0xcf, // uppercase I, with diaresis\n  0xa9: 0xef, // lowercase i, with diaresis\n  0xaa: 0xd4, // uppercase O, circumflex\n  0xab: 0xd9, // uppercase U, grave accent\n  0xac: 0xf9, // lowercase u, grave accent\n  0xad: 0xdb, // uppercase U, circumflex\n  0xae: 0xab, // left-pointing double angle quotation mark\n  0xaf: 0xbb, // right-pointing double angle quotation mark\n  // THIS BLOCK INCLUDES THE 32 EXTENDED (TWO-BYTE) LINE 21 CHARACTERS\n  // THAT COME FROM HI BYTE=0x13 AND LOW BETWEEN 0x20 AND 0x3F\n  0xb0: 0xc3, // Uppercase A, tilde\n  0xb1: 0xe3, // Lowercase a, tilde\n  0xb2: 0xcd, // Uppercase I, acute accent\n  0xb3: 0xcc, // Uppercase I, grave accent\n  0xb4: 0xec, // Lowercase i, grave accent\n  0xb5: 0xd2, // Uppercase O, grave accent\n  0xb6: 0xf2, // Lowercase o, grave accent\n  0xb7: 0xd5, // Uppercase O, tilde\n  0xb8: 0xf5, // Lowercase o, tilde\n  0xb9: 0x7b, // Open curly brace\n  0xba: 0x7d, // Closing curly brace\n  0xbb: 0x5c, // Backslash\n  0xbc: 0x5e, // Caret\n  0xbd: 0x5f, // Underscore\n  0xbe: 0x7c, // Pipe (vertical line)\n  0xbf: 0x223c, // Tilde operator\n  0xc0: 0xc4, // Uppercase A, umlaut\n  0xc1: 0xe4, // Lowercase A, umlaut\n  0xc2: 0xd6, // Uppercase O, umlaut\n  0xc3: 0xf6, // Lowercase o, umlaut\n  0xc4: 0xdf, // Esszett (sharp S)\n  0xc5: 0xa5, // Yen symbol\n  0xc6: 0xa4, // Generic currency sign\n  0xc7: 0x2503, // Box drawings heavy vertical\n  0xc8: 0xc5, // Uppercase A, ring\n  0xc9: 0xe5, // Lowercase A, ring\n  0xca: 0xd8, // Uppercase O, stroke\n  0xcb: 0xf8, // Lowercase o, strok\n  0xcc: 0x250f, // Box drawings heavy down and right\n  0xcd: 0x2513, // Box drawings heavy down and left\n  0xce: 0x2517, // Box drawings heavy up and right\n  0xcf: 0x251b // Box drawings heavy up and left\n};\n\n/**\n * Utils\n */\nlet getCharForByte = function (byte) {\n  let charCode = byte;\n  if (specialCea608CharsCodes.hasOwnProperty(byte))\n    charCode = specialCea608CharsCodes[byte];\n\n  return String.fromCharCode(charCode);\n};\n\nlet NR_ROWS = 15,\n  NR_COLS = 100;\n// Tables to look up row from PAC data\nlet rowsLowCh1 = { 0x11: 1, 0x12: 3, 0x15: 5, 0x16: 7, 0x17: 9, 0x10: 11, 0x13: 12, 0x14: 14 };\nlet rowsHighCh1 = { 0x11: 2, 0x12: 4, 0x15: 6, 0x16: 8, 0x17: 10, 0x13: 13, 0x14: 15 };\nlet rowsLowCh2 = { 0x19: 1, 0x1A: 3, 0x1D: 5, 0x1E: 7, 0x1F: 9, 0x18: 11, 0x1B: 12, 0x1C: 14 };\nlet rowsHighCh2 = { 0x19: 2, 0x1A: 4, 0x1D: 6, 0x1E: 8, 0x1F: 10, 0x1B: 13, 0x1C: 15 };\n\nlet backgroundColors = ['white', 'green', 'blue', 'cyan', 'red', 'yellow', 'magenta', 'black', 'transparent'];\n\n/**\n * Simple logger class to be able to write with time-stamps and filter on level.\n */\nlet logger = {\n  verboseFilter: { 'DATA': 3, 'DEBUG': 3, 'INFO': 2, 'WARNING': 2, 'TEXT': 1, 'ERROR': 0 },\n  time: null,\n  verboseLevel: 0, // Only write errors\n  setTime: function (newTime) {\n    this.time = newTime;\n  },\n  log: function (severity, msg) {\n    let minLevel = this.verboseFilter[severity];\n    if (this.verboseLevel >= minLevel)\n      console.log(this.time + ' [' + severity + '] ' + msg);\n  }\n};\n\nlet numArrayToHexArray = function (numArray) {\n  let hexArray = [];\n  for (let j = 0; j < numArray.length; j++)\n    hexArray.push(numArray[j].toString(16));\n\n  return hexArray;\n};\n\nclass PenState {\n  constructor (foreground, underline, italics, background, flash) {\n    this.foreground = foreground || 'white';\n    this.underline = underline || false;\n    this.italics = italics || false;\n    this.background = background || 'black';\n    this.flash = flash || false;\n  }\n\n  reset () {\n    this.foreground = 'white';\n    this.underline = false;\n    this.italics = false;\n    this.background = 'black';\n    this.flash = false;\n  }\n\n  setStyles (styles) {\n    let attribs = ['foreground', 'underline', 'italics', 'background', 'flash'];\n    for (let i = 0; i < attribs.length; i++) {\n      let style = attribs[i];\n      if (styles.hasOwnProperty(style))\n        this[style] = styles[style];\n    }\n  }\n\n  isDefault () {\n    return (this.foreground === 'white' && !this.underline && !this.italics &&\n                this.background === 'black' && !this.flash);\n  }\n\n  equals (other) {\n    return ((this.foreground === other.foreground) &&\n                 (this.underline === other.underline) &&\n                 (this.italics === other.italics) &&\n                 (this.background === other.background) &&\n                 (this.flash === other.flash));\n  }\n\n  copy (newPenState) {\n    this.foreground = newPenState.foreground;\n    this.underline = newPenState.underline;\n    this.italics = newPenState.italics;\n    this.background = newPenState.background;\n    this.flash = newPenState.flash;\n  }\n\n  toString () {\n    return ('color=' + this.foreground + ', underline=' + this.underline + ', italics=' + this.italics +\n            ', background=' + this.background + ', flash=' + this.flash);\n  }\n}\n\n/**\n * Unicode character with styling and background.\n * @constructor\n */\nclass StyledUnicodeChar {\n  constructor (uchar, foreground, underline, italics, background, flash) {\n    this.uchar = uchar || ' '; // unicode character\n    this.penState = new PenState(foreground, underline, italics, background, flash);\n  }\n\n  reset () {\n    this.uchar = ' ';\n    this.penState.reset();\n  }\n\n  setChar (uchar, newPenState) {\n    this.uchar = uchar;\n    this.penState.copy(newPenState);\n  }\n\n  setPenState (newPenState) {\n    this.penState.copy(newPenState);\n  }\n\n  equals (other) {\n    return this.uchar === other.uchar && this.penState.equals(other.penState);\n  }\n\n  copy (newChar) {\n    this.uchar = newChar.uchar;\n    this.penState.copy(newChar.penState);\n  }\n\n  isEmpty () {\n    return this.uchar === ' ' && this.penState.isDefault();\n  }\n}\n\n/**\n * CEA-608 row consisting of NR_COLS instances of StyledUnicodeChar.\n * @constructor\n */\nclass Row {\n  constructor () {\n    this.chars = [];\n    for (let i = 0; i < NR_COLS; i++)\n      this.chars.push(new StyledUnicodeChar());\n\n    this.pos = 0;\n    this.currPenState = new PenState();\n  }\n\n  equals (other) {\n    let equal = true;\n    for (let i = 0; i < NR_COLS; i++) {\n      if (!this.chars[i].equals(other.chars[i])) {\n        equal = false;\n        break;\n      }\n    }\n    return equal;\n  }\n\n  copy (other) {\n    for (let i = 0; i < NR_COLS; i++)\n      this.chars[i].copy(other.chars[i]);\n  }\n\n  isEmpty () {\n    let empty = true;\n    for (let i = 0; i < NR_COLS; i++) {\n      if (!this.chars[i].isEmpty()) {\n        empty = false;\n        break;\n      }\n    }\n    return empty;\n  }\n\n  /**\n     *  Set the cursor to a valid column.\n     */\n  setCursor (absPos) {\n    if (this.pos !== absPos)\n      this.pos = absPos;\n\n    if (this.pos < 0) {\n      logger.log('ERROR', 'Negative cursor position ' + this.pos);\n      this.pos = 0;\n    } else if (this.pos > NR_COLS) {\n      logger.log('ERROR', 'Too large cursor position ' + this.pos);\n      this.pos = NR_COLS;\n    }\n  }\n\n  /**\n     * Move the cursor relative to current position.\n     */\n  moveCursor (relPos) {\n    let newPos = this.pos + relPos;\n    if (relPos > 1) {\n      for (let i = this.pos + 1; i < newPos + 1; i++)\n        this.chars[i].setPenState(this.currPenState);\n    }\n    this.setCursor(newPos);\n  }\n\n  /**\n     * Backspace, move one step back and clear character.\n     */\n  backSpace () {\n    this.moveCursor(-1);\n    this.chars[this.pos].setChar(' ', this.currPenState);\n  }\n\n  insertChar (byte) {\n    if (byte >= 0x90) { // Extended char\n      this.backSpace();\n    }\n    let char = getCharForByte(byte);\n    if (this.pos >= NR_COLS) {\n      logger.log('ERROR', 'Cannot insert ' + byte.toString(16) +\n                        ' (' + char + ') at position ' + this.pos + '. Skipping it!');\n      return;\n    }\n    this.chars[this.pos].setChar(char, this.currPenState);\n    this.moveCursor(1);\n  }\n\n  clearFromPos (startPos) {\n    let i;\n    for (i = startPos; i < NR_COLS; i++)\n      this.chars[i].reset();\n  }\n\n  clear () {\n    this.clearFromPos(0);\n    this.pos = 0;\n    this.currPenState.reset();\n  }\n\n  clearToEndOfRow () {\n    this.clearFromPos(this.pos);\n  }\n\n  getTextString () {\n    let chars = [];\n    let empty = true;\n    for (let i = 0; i < NR_COLS; i++) {\n      let char = this.chars[i].uchar;\n      if (char !== ' ')\n        empty = false;\n\n      chars.push(char);\n    }\n    if (empty)\n      return '';\n    else\n      return chars.join('');\n  }\n\n  setPenStyles (styles) {\n    this.currPenState.setStyles(styles);\n    let currChar = this.chars[this.pos];\n    currChar.setPenState(this.currPenState);\n  }\n}\n\n/**\n * Keep a CEA-608 screen of 32x15 styled characters\n * @constructor\n*/\nclass CaptionScreen {\n  constructor () {\n    this.rows = [];\n    for (let i = 0; i < NR_ROWS; i++)\n      this.rows.push(new Row()); // Note that we use zero-based numbering (0-14)\n\n    this.currRow = NR_ROWS - 1;\n    this.nrRollUpRows = null;\n    this.reset();\n  }\n\n  reset () {\n    for (let i = 0; i < NR_ROWS; i++)\n      this.rows[i].clear();\n\n    this.currRow = NR_ROWS - 1;\n  }\n\n  equals (other) {\n    let equal = true;\n    for (let i = 0; i < NR_ROWS; i++) {\n      if (!this.rows[i].equals(other.rows[i])) {\n        equal = false;\n        break;\n      }\n    }\n    return equal;\n  }\n\n  copy (other) {\n    for (let i = 0; i < NR_ROWS; i++)\n      this.rows[i].copy(other.rows[i]);\n  }\n\n  isEmpty () {\n    let empty = true;\n    for (let i = 0; i < NR_ROWS; i++) {\n      if (!this.rows[i].isEmpty()) {\n        empty = false;\n        break;\n      }\n    }\n    return empty;\n  }\n\n  backSpace () {\n    let row = this.rows[this.currRow];\n    row.backSpace();\n  }\n\n  clearToEndOfRow () {\n    let row = this.rows[this.currRow];\n    row.clearToEndOfRow();\n  }\n\n  /**\n     * Insert a character (without styling) in the current row.\n     */\n  insertChar (char) {\n    let row = this.rows[this.currRow];\n    row.insertChar(char);\n  }\n\n  setPen (styles) {\n    let row = this.rows[this.currRow];\n    row.setPenStyles(styles);\n  }\n\n  moveCursor (relPos) {\n    let row = this.rows[this.currRow];\n    row.moveCursor(relPos);\n  }\n\n  setCursor (absPos) {\n    logger.log('INFO', 'setCursor: ' + absPos);\n    let row = this.rows[this.currRow];\n    row.setCursor(absPos);\n  }\n\n  setPAC (pacData) {\n    logger.log('INFO', 'pacData = ' + JSON.stringify(pacData));\n    let newRow = pacData.row - 1;\n    if (this.nrRollUpRows && newRow < this.nrRollUpRows - 1)\n      newRow = this.nrRollUpRows - 1;\n\n    // Make sure this only affects Roll-up Captions by checking this.nrRollUpRows\n    if (this.nrRollUpRows && this.currRow !== newRow) {\n      // clear all rows first\n      for (let i = 0; i < NR_ROWS; i++)\n        this.rows[i].clear();\n\n      // Copy this.nrRollUpRows rows from lastOutputScreen and place it in the newRow location\n      // topRowIndex - the start of rows to copy (inclusive index)\n      let topRowIndex = this.currRow + 1 - (this.nrRollUpRows);\n      // We only copy if the last position was already shown.\n      // We use the cueStartTime value to check this.\n      const lastOutputScreen = this.lastOutputScreen;\n      if (lastOutputScreen) {\n        let prevLineTime = lastOutputScreen.rows[topRowIndex].cueStartTime;\n        if (prevLineTime && prevLineTime < logger.time) {\n          for (let i = 0; i < this.nrRollUpRows; i++)\n            this.rows[newRow - this.nrRollUpRows + i + 1].copy(lastOutputScreen.rows[topRowIndex + i]);\n        }\n      }\n    }\n\n    this.currRow = newRow;\n    let row = this.rows[this.currRow];\n    if (pacData.indent !== null) {\n      let indent = pacData.indent;\n      let prevPos = Math.max(indent - 1, 0);\n      row.setCursor(pacData.indent);\n      pacData.color = row.chars[prevPos].penState.foreground;\n    }\n    let styles = { foreground: pacData.color, underline: pacData.underline, italics: pacData.italics, background: 'black', flash: false };\n    this.setPen(styles);\n  }\n\n  /**\n     * Set background/extra foreground, but first do back_space, and then insert space (backwards compatibility).\n     */\n  setBkgData (bkgData) {\n    logger.log('INFO', 'bkgData = ' + JSON.stringify(bkgData));\n    this.backSpace();\n    this.setPen(bkgData);\n    this.insertChar(0x20); // Space\n  }\n\n  setRollUpRows (nrRows) {\n    this.nrRollUpRows = nrRows;\n  }\n\n  rollUp () {\n    if (this.nrRollUpRows === null) {\n      logger.log('DEBUG', 'roll_up but nrRollUpRows not set yet');\n      return; // Not properly setup\n    }\n    logger.log('TEXT', this.getDisplayText());\n    let topRowIndex = this.currRow + 1 - this.nrRollUpRows;\n    let topRow = this.rows.splice(topRowIndex, 1)[0];\n    topRow.clear();\n    this.rows.splice(this.currRow, 0, topRow);\n    logger.log('INFO', 'Rolling up');\n    // logger.log('TEXT', this.get_display_text())\n  }\n\n  /**\n    * Get all non-empty rows with as unicode text.\n    */\n  getDisplayText (asOneRow) {\n    asOneRow = asOneRow || false;\n    let displayText = [];\n    let text = '';\n    let rowNr = -1;\n    for (let i = 0; i < NR_ROWS; i++) {\n      let rowText = this.rows[i].getTextString();\n      if (rowText) {\n        rowNr = i + 1;\n        if (asOneRow)\n          displayText.push('Row ' + rowNr + ': \\'' + rowText + '\\'');\n        else\n          displayText.push(rowText.trim());\n      }\n    }\n    if (displayText.length > 0) {\n      if (asOneRow)\n        text = '[' + displayText.join(' | ') + ']';\n      else\n        text = displayText.join('\\n');\n    }\n    return text;\n  }\n\n  getTextAndFormat () {\n    return this.rows;\n  }\n}\n\n// var modes = ['MODE_ROLL-UP', 'MODE_POP-ON', 'MODE_PAINT-ON', 'MODE_TEXT'];\n\nclass Cea608Channel {\n  constructor (channelNumber, outputFilter) {\n    this.chNr = channelNumber;\n    this.outputFilter = outputFilter;\n    this.mode = null;\n    this.verbose = 0;\n    this.displayedMemory = new CaptionScreen();\n    this.nonDisplayedMemory = new CaptionScreen();\n    this.lastOutputScreen = new CaptionScreen();\n    this.currRollUpRow = this.displayedMemory.rows[NR_ROWS - 1];\n    this.writeScreen = this.displayedMemory;\n    this.mode = null;\n    this.cueStartTime = null; // Keeps track of where a cue started.\n  }\n\n  reset () {\n    this.mode = null;\n    this.displayedMemory.reset();\n    this.nonDisplayedMemory.reset();\n    this.lastOutputScreen.reset();\n    this.currRollUpRow = this.displayedMemory.rows[NR_ROWS - 1];\n    this.writeScreen = this.displayedMemory;\n    this.mode = null;\n    this.cueStartTime = null;\n    this.lastCueEndTime = null;\n  }\n\n  getHandler () {\n    return this.outputFilter;\n  }\n\n  setHandler (newHandler) {\n    this.outputFilter = newHandler;\n  }\n\n  setPAC (pacData) {\n    this.writeScreen.setPAC(pacData);\n  }\n\n  setBkgData (bkgData) {\n    this.writeScreen.setBkgData(bkgData);\n  }\n\n  setMode (newMode) {\n    if (newMode === this.mode)\n      return;\n\n    this.mode = newMode;\n    logger.log('INFO', 'MODE=' + newMode);\n    if (this.mode === 'MODE_POP-ON') {\n      this.writeScreen = this.nonDisplayedMemory;\n    } else {\n      this.writeScreen = this.displayedMemory;\n      this.writeScreen.reset();\n    }\n    if (this.mode !== 'MODE_ROLL-UP') {\n      this.displayedMemory.nrRollUpRows = null;\n      this.nonDisplayedMemory.nrRollUpRows = null;\n    }\n    this.mode = newMode;\n  }\n\n  insertChars (chars) {\n    for (let i = 0; i < chars.length; i++)\n      this.writeScreen.insertChar(chars[i]);\n\n    let screen = this.writeScreen === this.displayedMemory ? 'DISP' : 'NON_DISP';\n    logger.log('INFO', screen + ': ' + this.writeScreen.getDisplayText(true));\n    if (this.mode === 'MODE_PAINT-ON' || this.mode === 'MODE_ROLL-UP') {\n      logger.log('TEXT', 'DISPLAYED: ' + this.displayedMemory.getDisplayText(true));\n      this.outputDataUpdate();\n    }\n  }\n\n  ccRCL () { // Resume Caption Loading (switch mode to Pop On)\n    logger.log('INFO', 'RCL - Resume Caption Loading');\n    this.setMode('MODE_POP-ON');\n  }\n\n  ccBS () { // BackSpace\n    logger.log('INFO', 'BS - BackSpace');\n    if (this.mode === 'MODE_TEXT')\n      return;\n\n    this.writeScreen.backSpace();\n    if (this.writeScreen === this.displayedMemory)\n      this.outputDataUpdate();\n  }\n\n  ccAOF () { // Reserved (formerly Alarm Off)\n\n  }\n\n  ccAON () { // Reserved (formerly Alarm On)\n\n  }\n\n  ccDER () { // Delete to End of Row\n    logger.log('INFO', 'DER- Delete to End of Row');\n    this.writeScreen.clearToEndOfRow();\n    this.outputDataUpdate();\n  }\n\n  ccRU (nrRows) { // Roll-Up Captions-2,3,or 4 Rows\n    logger.log('INFO', 'RU(' + nrRows + ') - Roll Up');\n    this.writeScreen = this.displayedMemory;\n    this.setMode('MODE_ROLL-UP');\n    this.writeScreen.setRollUpRows(nrRows);\n  }\n\n  ccFON () { // Flash On\n    logger.log('INFO', 'FON - Flash On');\n    this.writeScreen.setPen({ flash: true });\n  }\n\n  ccRDC () { // Resume Direct Captioning (switch mode to PaintOn)\n    logger.log('INFO', 'RDC - Resume Direct Captioning');\n    this.setMode('MODE_PAINT-ON');\n  }\n\n  ccTR () { // Text Restart in text mode (not supported, however)\n    logger.log('INFO', 'TR');\n    this.setMode('MODE_TEXT');\n  }\n\n  ccRTD () { // Resume Text Display in Text mode (not supported, however)\n    logger.log('INFO', 'RTD');\n    this.setMode('MODE_TEXT');\n  }\n\n  ccEDM () { // Erase Displayed Memory\n    logger.log('INFO', 'EDM - Erase Displayed Memory');\n    this.displayedMemory.reset();\n    this.outputDataUpdate(true);\n  }\n\n  ccCR () { // Carriage Return\n    logger.log('CR - Carriage Return');\n    this.writeScreen.rollUp();\n    this.outputDataUpdate(true);\n  }\n\n  ccENM () { // Erase Non-Displayed Memory\n    logger.log('INFO', 'ENM - Erase Non-displayed Memory');\n    this.nonDisplayedMemory.reset();\n  }\n\n  ccEOC () { // End of Caption (Flip Memories)\n    logger.log('INFO', 'EOC - End Of Caption');\n    if (this.mode === 'MODE_POP-ON') {\n      let tmp = this.displayedMemory;\n      this.displayedMemory = this.nonDisplayedMemory;\n      this.nonDisplayedMemory = tmp;\n      this.writeScreen = this.nonDisplayedMemory;\n      logger.log('TEXT', 'DISP: ' + this.displayedMemory.getDisplayText());\n    }\n    this.outputDataUpdate(true);\n  }\n\n  ccTO (nrCols) { // Tab Offset 1,2, or 3 columns\n    logger.log('INFO', 'TO(' + nrCols + ') - Tab Offset');\n    this.writeScreen.moveCursor(nrCols);\n  }\n\n  ccMIDROW (secondByte) { // Parse MIDROW command\n    let styles = { flash: false };\n    styles.underline = secondByte % 2 === 1;\n    styles.italics = secondByte >= 0x2e;\n    if (!styles.italics) {\n      let colorIndex = Math.floor(secondByte / 2) - 0x10;\n      let colors = ['white', 'green', 'blue', 'cyan', 'red', 'yellow', 'magenta'];\n      styles.foreground = colors[colorIndex];\n    } else {\n      styles.foreground = 'white';\n    }\n    logger.log('INFO', 'MIDROW: ' + JSON.stringify(styles));\n    this.writeScreen.setPen(styles);\n  }\n\n  outputDataUpdate (dispatch = false) {\n    let t = logger.time;\n    if (t === null)\n      return;\n\n    if (this.outputFilter) {\n      if (this.cueStartTime === null && !this.displayedMemory.isEmpty()) { // Start of a new cue\n        this.cueStartTime = t;\n      } else {\n        if (!this.displayedMemory.equals(this.lastOutputScreen)) {\n          if (this.outputFilter.newCue) {\n            this.outputFilter.newCue(this.cueStartTime, t, this.lastOutputScreen);\n            if (dispatch === true && this.outputFilter.dispatchCue)\n              this.outputFilter.dispatchCue();\n          }\n          this.cueStartTime = this.displayedMemory.isEmpty() ? null : t;\n        }\n      }\n      this.lastOutputScreen.copy(this.displayedMemory);\n    }\n  }\n\n  cueSplitAtTime (t) {\n    if (this.outputFilter) {\n      if (!this.displayedMemory.isEmpty()) {\n        if (this.outputFilter.newCue)\n          this.outputFilter.newCue(this.cueStartTime, t, this.displayedMemory);\n\n        this.cueStartTime = t;\n      }\n    }\n  }\n}\n\nclass Cea608Parser {\n  constructor (field, out1, out2) {\n    this.field = field || 1;\n    this.outputs = [out1, out2];\n    this.channels = [new Cea608Channel(1, out1), new Cea608Channel(2, out2)];\n    this.currChNr = -1; // Will be 1 or 2\n    this.lastCmdA = null; // First byte of last command\n    this.lastCmdB = null; // Second byte of last command\n    this.bufferedData = [];\n    this.startTime = null;\n    this.lastTime = null;\n    this.dataCounters = { 'padding': 0, 'char': 0, 'cmd': 0, 'other': 0 };\n  }\n\n  getHandler (index) {\n    return this.channels[index].getHandler();\n  }\n\n  setHandler (index, newHandler) {\n    this.channels[index].setHandler(newHandler);\n  }\n\n  /**\n     * Add data for time t in forms of list of bytes (unsigned ints). The bytes are treated as pairs.\n     */\n  addData (t, byteList) {\n    let cmdFound, a, b,\n      charsFound = false;\n\n    this.lastTime = t;\n    logger.setTime(t);\n\n    for (let i = 0; i < byteList.length; i += 2) {\n      a = byteList[i] & 0x7f;\n      b = byteList[i + 1] & 0x7f;\n      if (a === 0 && b === 0) {\n        this.dataCounters.padding += 2;\n        continue;\n      } else {\n        logger.log('DATA', '[' + numArrayToHexArray([byteList[i], byteList[i + 1]]) + '] -> (' + numArrayToHexArray([a, b]) + ')');\n      }\n      cmdFound = this.parseCmd(a, b);\n      if (!cmdFound)\n        cmdFound = this.parseMidrow(a, b);\n\n      if (!cmdFound)\n        cmdFound = this.parsePAC(a, b);\n\n      if (!cmdFound)\n        cmdFound = this.parseBackgroundAttributes(a, b);\n\n      if (!cmdFound) {\n        charsFound = this.parseChars(a, b);\n        if (charsFound) {\n          if (this.currChNr && this.currChNr >= 0) {\n            let channel = this.channels[this.currChNr - 1];\n            channel.insertChars(charsFound);\n          } else {\n            logger.log('WARNING', 'No channel found yet. TEXT-MODE?');\n          }\n        }\n      }\n      if (cmdFound) {\n        this.dataCounters.cmd += 2;\n      } else if (charsFound) {\n        this.dataCounters.char += 2;\n      } else {\n        this.dataCounters.other += 2;\n        logger.log('WARNING', 'Couldn\\'t parse cleaned data ' + numArrayToHexArray([a, b]) +\n                            ' orig: ' + numArrayToHexArray([byteList[i], byteList[i + 1]]));\n      }\n    }\n  }\n\n  /**\n     * Parse Command.\n     * @returns {Boolean} Tells if a command was found\n     */\n  parseCmd (a, b) {\n    let chNr = null;\n\n    let cond1 = (a === 0x14 || a === 0x1C) && (b >= 0x20 && b <= 0x2F);\n    let cond2 = (a === 0x17 || a === 0x1F) && (b >= 0x21 && b <= 0x23);\n    if (!(cond1 || cond2))\n      return false;\n\n    if (a === this.lastCmdA && b === this.lastCmdB) {\n      this.lastCmdA = null;\n      this.lastCmdB = null; // Repeated commands are dropped (once)\n      logger.log('DEBUG', 'Repeated command (' + numArrayToHexArray([a, b]) + ') is dropped');\n      return true;\n    }\n\n    if (a === 0x14 || a === 0x17)\n      chNr = 1;\n    else\n      chNr = 2; // (a === 0x1C || a=== 0x1f)\n\n    let channel = this.channels[chNr - 1];\n\n    if (a === 0x14 || a === 0x1C) {\n      if (b === 0x20)\n        channel.ccRCL();\n      else if (b === 0x21)\n        channel.ccBS();\n      else if (b === 0x22)\n        channel.ccAOF();\n      else if (b === 0x23)\n        channel.ccAON();\n      else if (b === 0x24)\n        channel.ccDER();\n      else if (b === 0x25)\n        channel.ccRU(2);\n      else if (b === 0x26)\n        channel.ccRU(3);\n      else if (b === 0x27)\n        channel.ccRU(4);\n      else if (b === 0x28)\n        channel.ccFON();\n      else if (b === 0x29)\n        channel.ccRDC();\n      else if (b === 0x2A)\n        channel.ccTR();\n      else if (b === 0x2B)\n        channel.ccRTD();\n      else if (b === 0x2C)\n        channel.ccEDM();\n      else if (b === 0x2D)\n        channel.ccCR();\n      else if (b === 0x2E)\n        channel.ccENM();\n      else if (b === 0x2F)\n        channel.ccEOC();\n    } else { // a == 0x17 || a == 0x1F\n      channel.ccTO(b - 0x20);\n    }\n    this.lastCmdA = a;\n    this.lastCmdB = b;\n    this.currChNr = chNr;\n    return true;\n  }\n\n  /**\n     * Parse midrow styling command\n     * @returns {Boolean}\n     */\n  parseMidrow (a, b) {\n    let chNr = null;\n\n    if (((a === 0x11) || (a === 0x19)) && b >= 0x20 && b <= 0x2f) {\n      if (a === 0x11)\n        chNr = 1;\n      else\n        chNr = 2;\n\n      if (chNr !== this.currChNr) {\n        logger.log('ERROR', 'Mismatch channel in midrow parsing');\n        return false;\n      }\n      let channel = this.channels[chNr - 1];\n      channel.ccMIDROW(b);\n      logger.log('DEBUG', 'MIDROW (' + numArrayToHexArray([a, b]) + ')');\n      return true;\n    }\n    return false;\n  }\n  /**\n     * Parse Preable Access Codes (Table 53).\n     * @returns {Boolean} Tells if PAC found\n     */\n  parsePAC (a, b) {\n    let chNr = null;\n    let row = null;\n\n    let case1 = ((a >= 0x11 && a <= 0x17) || (a >= 0x19 && a <= 0x1F)) && (b >= 0x40 && b <= 0x7F);\n    let case2 = (a === 0x10 || a === 0x18) && (b >= 0x40 && b <= 0x5F);\n    if (!(case1 || case2))\n      return false;\n\n    if (a === this.lastCmdA && b === this.lastCmdB) {\n      this.lastCmdA = null;\n      this.lastCmdB = null;\n      return true; // Repeated commands are dropped (once)\n    }\n\n    chNr = (a <= 0x17) ? 1 : 2;\n\n    if (b >= 0x40 && b <= 0x5F) {\n      row = (chNr === 1) ? rowsLowCh1[a] : rowsLowCh2[a];\n    } else { // 0x60 <= b <= 0x7F\n      row = (chNr === 1) ? rowsHighCh1[a] : rowsHighCh2[a];\n    }\n    let pacData = this.interpretPAC(row, b);\n    let channel = this.channels[chNr - 1];\n    channel.setPAC(pacData);\n    this.lastCmdA = a;\n    this.lastCmdB = b;\n    this.currChNr = chNr;\n    return true;\n  }\n\n  /**\n     * Interpret the second byte of the pac, and return the information.\n     * @returns {Object} pacData with style parameters.\n     */\n  interpretPAC (row, byte) {\n    let pacIndex = byte;\n    let pacData = { color: null, italics: false, indent: null, underline: false, row: row };\n\n    if (byte > 0x5F)\n      pacIndex = byte - 0x60;\n    else\n      pacIndex = byte - 0x40;\n\n    pacData.underline = (pacIndex & 1) === 1;\n    if (pacIndex <= 0xd) {\n      pacData.color = ['white', 'green', 'blue', 'cyan', 'red', 'yellow', 'magenta', 'white'][Math.floor(pacIndex / 2)];\n    } else if (pacIndex <= 0xf) {\n      pacData.italics = true;\n      pacData.color = 'white';\n    } else {\n      pacData.indent = (Math.floor((pacIndex - 0x10) / 2)) * 4;\n    }\n    return pacData; // Note that row has zero offset. The spec uses 1.\n  }\n\n  /**\n     * Parse characters.\n     * @returns An array with 1 to 2 codes corresponding to chars, if found. null otherwise.\n     */\n  parseChars (a, b) {\n    let channelNr = null,\n      charCodes = null,\n      charCode1 = null;\n\n    if (a >= 0x19) {\n      channelNr = 2;\n      charCode1 = a - 8;\n    } else {\n      channelNr = 1;\n      charCode1 = a;\n    }\n    if (charCode1 >= 0x11 && charCode1 <= 0x13) {\n      // Special character\n      let oneCode = b;\n      if (charCode1 === 0x11)\n        oneCode = b + 0x50;\n      else if (charCode1 === 0x12)\n        oneCode = b + 0x70;\n      else\n        oneCode = b + 0x90;\n\n      logger.log('INFO', 'Special char \\'' + getCharForByte(oneCode) + '\\' in channel ' + channelNr);\n      charCodes = [oneCode];\n    } else if (a >= 0x20 && a <= 0x7f) {\n      charCodes = (b === 0) ? [a] : [a, b];\n    }\n    if (charCodes) {\n      let hexCodes = numArrayToHexArray(charCodes);\n      logger.log('DEBUG', 'Char codes =  ' + hexCodes.join(','));\n      this.lastCmdA = null;\n      this.lastCmdB = null;\n    }\n    return charCodes;\n  }\n\n  /**\n    * Parse extended background attributes as well as new foreground color black.\n    * @returns{Boolean} Tells if background attributes are found\n    */\n  parseBackgroundAttributes (a, b) {\n    let bkgData,\n      index,\n      chNr,\n      channel;\n\n    let case1 = (a === 0x10 || a === 0x18) && (b >= 0x20 && b <= 0x2f);\n    let case2 = (a === 0x17 || a === 0x1f) && (b >= 0x2d && b <= 0x2f);\n    if (!(case1 || case2))\n      return false;\n\n    bkgData = {};\n    if (a === 0x10 || a === 0x18) {\n      index = Math.floor((b - 0x20) / 2);\n      bkgData.background = backgroundColors[index];\n      if (b % 2 === 1)\n        bkgData.background = bkgData.background + '_semi';\n    } else if (b === 0x2d) {\n      bkgData.background = 'transparent';\n    } else {\n      bkgData.foreground = 'black';\n      if (b === 0x2f)\n        bkgData.underline = true;\n    }\n    chNr = (a < 0x18) ? 1 : 2;\n    channel = this.channels[chNr - 1];\n    channel.setBkgData(bkgData);\n    this.lastCmdA = null;\n    this.lastCmdB = null;\n    return true;\n  }\n\n  /**\n     * Reset state of parser and its channels.\n     */\n  reset () {\n    for (let i = 0; i < this.channels.length; i++) {\n      if (this.channels[i])\n        this.channels[i].reset();\n    }\n    this.lastCmdA = null;\n    this.lastCmdB = null;\n  }\n\n  /**\n     * Trigger the generation of a cue, and the start of a new one if displayScreens are not empty.\n     */\n  cueSplitAtTime (t) {\n    for (let i = 0; i < this.channels.length; i++) {\n      if (this.channels[i])\n        this.channels[i].cueSplitAtTime(t);\n    }\n  }\n}\n\nexport default Cea608Parser;\n","// from http://mp4ra.org/codecs.html\nconst sampleEntryCodesISO = {\n  audio: {\n    'a3ds': true,\n    'ac-3': true,\n    'ac-4': true,\n    'alac': true,\n    'alaw': true,\n    'dra1': true,\n    'dts+': true,\n    'dts-': true,\n    'dtsc': true,\n    'dtse': true,\n    'dtsh': true,\n    'ec-3': true,\n    'enca': true,\n    'g719': true,\n    'g726': true,\n    'm4ae': true,\n    'mha1': true,\n    'mha2': true,\n    'mhm1': true,\n    'mhm2': true,\n    'mlpa': true,\n    'mp4a': true,\n    'raw ': true,\n    'Opus': true,\n    'samr': true,\n    'sawb': true,\n    'sawp': true,\n    'sevc': true,\n    'sqcp': true,\n    'ssmv': true,\n    'twos': true,\n    'ulaw': true\n  },\n  video: {\n    'avc1': true,\n    'avc2': true,\n    'avc3': true,\n    'avc4': true,\n    'avcp': true,\n    'drac': true,\n    'dvav': true,\n    'dvhe': true,\n    'encv': true,\n    'hev1': true,\n    'hvc1': true,\n    'mjp2': true,\n    'mp4v': true,\n    'mvc1': true,\n    'mvc2': true,\n    'mvc3': true,\n    'mvc4': true,\n    'resv': true,\n    'rv60': true,\n    's263': true,\n    'svc1': true,\n    'svc2': true,\n    'vc-1': true,\n    'vp08': true,\n    'vp09': true\n  }\n};\n\nfunction isCodecType (codec, type) {\n  const typeCodes = sampleEntryCodesISO[type];\n  return !!typeCodes && typeCodes[codec.slice(0, 4)] === true;\n}\n\nfunction isCodecSupportedInMp4 (codec, type) {\n  return MediaSource.isTypeSupported(`${type || 'video'}/mp4;codecs=\"${codec}\"`);\n}\n\nexport { isCodecType, isCodecSupportedInMp4 };\n","import { fixLineBreaks } from './vttparser';\n\nexport function newCue (track, startTime, endTime, captionScreen) {\n  let row;\n  let cue;\n  let indenting;\n  let indent;\n  let text;\n  let VTTCue = window.VTTCue || window.TextTrackCue;\n\n  for (let r = 0; r < captionScreen.rows.length; r++) {\n    row = captionScreen.rows[r];\n    indenting = true;\n    indent = 0;\n    text = '';\n\n    if (!row.isEmpty()) {\n      for (let c = 0; c < row.chars.length; c++) {\n        if (row.chars[c].uchar.match(/\\s/) && indenting) {\n          indent++;\n        } else {\n          text += row.chars[c].uchar;\n          indenting = false;\n        }\n      }\n      // To be used for cleaning-up orphaned roll-up captions\n      row.cueStartTime = startTime;\n\n      // Give a slight bump to the endTime if it's equal to startTime to avoid a SyntaxError in IE\n      if (startTime === endTime)\n        endTime += 0.0001;\n\n      cue = new VTTCue(startTime, endTime, fixLineBreaks(text.trim()));\n\n      if (indent >= 16)\n        indent--;\n      else\n        indent++;\n\n      // VTTCue.line get's flakey when using controls, so let's now include line 13&14\n      // also, drop line 1 since it's to close to the top\n      if (navigator.userAgent.match(/Firefox\\//))\n        cue.line = r + 1;\n      else\n        cue.line = (r > 7 ? r - 2 : r + 1);\n\n      cue.align = 'left';\n      // Clamp the position between 0 and 100 - if out of these bounds, Firefox throws an exception and captions break\n      cue.position = Math.max(0, Math.min(100, 100 * (indent / 32) + (navigator.userAgent.match(/Firefox\\//) ? 50 : 0)));\n      track.addCue(cue);\n    }\n  }\n}\n","import BinarySearch from './binary-search';\nimport { logger } from '../utils/logger';\n\nexport function findFirstFragWithCC (fragments, cc) {\n  let firstFrag = null;\n\n  for (let i = 0; i < fragments.length; i += 1) {\n    const currentFrag = fragments[i];\n    if (currentFrag && currentFrag.cc === cc) {\n      firstFrag = currentFrag;\n      break;\n    }\n  }\n\n  return firstFrag;\n}\n\nexport function findFragWithCC (fragments, CC) {\n  return BinarySearch.search(fragments, (candidate) => {\n    if (candidate.cc < CC)\n      return 1;\n    else if (candidate.cc > CC)\n      return -1;\n    else\n      return 0;\n  });\n}\n\nexport function shouldAlignOnDiscontinuities (lastFrag, lastLevel, details) {\n  let shouldAlign = false;\n  if (lastLevel && lastLevel.details && details) {\n    if (details.endCC > details.startCC || (lastFrag && lastFrag.cc < details.startCC))\n      shouldAlign = true;\n  }\n  return shouldAlign;\n}\n\n// Find the first frag in the previous level which matches the CC of the first frag of the new level\nexport function findDiscontinuousReferenceFrag (prevDetails, curDetails) {\n  const prevFrags = prevDetails.fragments;\n  const curFrags = curDetails.fragments;\n\n  if (!curFrags.length || !prevFrags.length) {\n    logger.log('No fragments to align');\n    return;\n  }\n\n  const prevStartFrag = findFirstFragWithCC(prevFrags, curFrags[0].cc);\n\n  if (!prevStartFrag || (prevStartFrag && !prevStartFrag.startPTS)) {\n    logger.log('No frag in previous level to align on');\n    return;\n  }\n\n  return prevStartFrag;\n}\n\nexport function adjustPts (sliding, details) {\n  details.fragments.forEach((frag) => {\n    if (frag) {\n      let start = frag.start + sliding;\n      frag.start = frag.startPTS = start;\n      frag.endPTS = start + frag.duration;\n    }\n  });\n  details.PTSKnown = true;\n}\n\n// If a change in CC is detected, the PTS can no longer be relied upon\n// Attempt to align the level by using the last level - find the last frag matching the current CC and use it's PTS\n// as a reference\nexport function alignDiscontinuities (lastFrag, lastLevel, details) {\n  if (shouldAlignOnDiscontinuities(lastFrag, lastLevel, details)) {\n    const referenceFrag = findDiscontinuousReferenceFrag(lastLevel.details, details);\n    if (referenceFrag) {\n      logger.log('Adjusting PTS using last level due to CC increase within current level');\n      adjustPts(referenceFrag.start, details);\n    }\n  }\n  // try to align using programDateTime attribute (if available)\n  if (details.PTSKnown === false && lastLevel && lastLevel.details && lastLevel.details.fragments && lastLevel.details.fragments.length) {\n    // if last level sliding is 1000 and its first frag PROGRAM-DATE-TIME is 2017-08-20 1:10:00 AM\n    // and if new details first frag PROGRAM DATE-TIME is 2017-08-20 1:10:08 AM\n    // then we can deduce that playlist B sliding is 1000+8 = 1008s\n    let lastPDT = lastLevel.details.programDateTime;\n    let newPDT = details.programDateTime;\n    // date diff is in ms. frag.start is in seconds\n    let sliding = (newPDT - lastPDT) / 1000 + lastLevel.details.fragments[0].start;\n    if (!isNaN(sliding)) {\n      logger.log(`adjusting PTS using programDateTime delta, sliding:${sliding.toFixed(3)}`);\n      adjustPts(sliding, details);\n    }\n  }\n}\n","/*\n * EWMA Bandwidth Estimator\n *  - heavily inspired from shaka-player\n * Tracks bandwidth samples and estimates available bandwidth.\n * Based on the minimum of two exponentially-weighted moving averages with\n * different half-lives.\n */\n\nimport EWMA from '../utils/ewma';\n\nclass EwmaBandWidthEstimator {\n  constructor (hls, slow, fast, defaultEstimate) {\n    this.hls = hls;\n    this.defaultEstimate_ = defaultEstimate;\n    this.minWeight_ = 0.001;\n    this.minDelayMs_ = 50;\n    this.slow_ = new EWMA(slow);\n    this.fast_ = new EWMA(fast);\n  }\n\n  sample (durationMs, numBytes) {\n    durationMs = Math.max(durationMs, this.minDelayMs_);\n    let bandwidth = 8000 * numBytes / durationMs,\n      // console.log('instant bw:'+ Math.round(bandwidth));\n      // we weight sample using loading duration....\n      weight = durationMs / 1000;\n    this.fast_.sample(weight, bandwidth);\n    this.slow_.sample(weight, bandwidth);\n  }\n\n  canEstimate () {\n    let fast = this.fast_;\n    return (fast && fast.getTotalWeight() >= this.minWeight_);\n  }\n\n  getEstimate () {\n    if (this.canEstimate()) {\n      // console.log('slow estimate:'+ Math.round(this.slow_.getEstimate()));\n      // console.log('fast estimate:'+ Math.round(this.fast_.getEstimate()));\n      // Take the minimum of these two estimates.  This should have the effect of\n      // adapting down quickly, but up more slowly.\n      return Math.min(this.fast_.getEstimate(), this.slow_.getEstimate());\n    } else {\n      return this.defaultEstimate_;\n    }\n  }\n\n  destroy () {\n  }\n}\nexport default EwmaBandWidthEstimator;\n","/*\n * compute an Exponential Weighted moving average\n * - https://en.wikipedia.org/wiki/Moving_average#Exponential_moving_average\n *  - heavily inspired from shaka-player\n */\n\nclass EWMA {\n  //  About half of the estimated value will be from the last |halfLife| samples by weight.\n  constructor (halfLife) {\n    // Larger values of alpha expire historical data more slowly.\n    this.alpha_ = halfLife ? Math.exp(Math.log(0.5) / halfLife) : 0;\n    this.estimate_ = 0;\n    this.totalWeight_ = 0;\n  }\n\n  sample (weight, value) {\n    let adjAlpha = Math.pow(this.alpha_, weight);\n    this.estimate_ = value * (1 - adjAlpha) + adjAlpha * this.estimate_;\n    this.totalWeight_ += weight;\n  }\n\n  getTotalWeight () {\n    return this.totalWeight_;\n  }\n\n  getEstimate () {\n    if (this.alpha_) {\n      let zeroFactor = 1 - Math.pow(this.alpha_, this.totalWeight_);\n      return this.estimate_ / zeroFactor;\n    } else {\n      return this.estimate_;\n    }\n  }\n}\n\nexport default EWMA;\n","function noop () {}\n\nconst fakeLogger = {\n  trace: noop,\n  debug: noop,\n  log: noop,\n  warn: noop,\n  info: noop,\n  error: noop\n};\n\nlet exportedLogger = fakeLogger;\n\n/* globals self: false */\n\n// let lastCallTime;\n// function formatMsgWithTimeInfo(type, msg) {\n//   const now = Date.now();\n//   const diff = lastCallTime ? '+' + (now - lastCallTime) : '0';\n//   lastCallTime = now;\n//   msg = (new Date(now)).toISOString() + ' | [' +  type + '] > ' + msg + ' ( ' + diff + ' ms )';\n//   return msg;\n// }\n\nfunction formatMsg (type, msg) {\n  msg = '[' + type + '] > ' + msg;\n  return msg;\n}\n\nfunction consolePrintFn (type) {\n  const func = self.console[type];\n  if (func) {\n    return function (...args) {\n      if (args[0])\n        args[0] = formatMsg(type, args[0]);\n\n      func.apply(self.console, args);\n    };\n  }\n  return noop;\n}\n\nfunction exportLoggerFunctions (debugConfig, ...functions) {\n  functions.forEach(function (type) {\n    exportedLogger[type] = debugConfig[type] ? debugConfig[type].bind(debugConfig) : consolePrintFn(type);\n  });\n}\n\nexport var enableLogs = function (debugConfig) {\n  if (debugConfig === true || typeof debugConfig === 'object') {\n    exportLoggerFunctions(debugConfig,\n      // Remove out from list here to hard-disable a log-level\n      // 'trace',\n      'debug',\n      'log',\n      'info',\n      'warn',\n      'error'\n    );\n    // Some browsers don't allow to use bind on console object anyway\n    // fallback to default if needed\n    try {\n      exportedLogger.log();\n    } catch (e) {\n      exportedLogger = fakeLogger;\n    }\n  } else {\n    exportedLogger = fakeLogger;\n  }\n};\n\nexport var logger = exportedLogger;\n","export default class OutputFilter {\n  constructor (timelineController, trackName) {\n    this.timelineController = timelineController;\n    this.trackName = trackName;\n    this.startTime = null;\n    this.endTime = null;\n    this.screen = null;\n  }\n\n  dispatchCue () {\n    if (this.startTime === null)\n      return;\n\n    this.timelineController.addCues(this.trackName, this.startTime, this.endTime, this.screen);\n    this.startTime = null;\n  }\n\n  newCue (startTime, endTime, screen) {\n    if (this.startTime === null || this.startTime > startTime)\n      this.startTime = startTime;\n\n    this.endTime = endTime;\n    this.screen = screen;\n    this.timelineController.createCaptionsTrack(this.trackName);\n  }\n}\n","\nexport function sendAddTrackEvent (track, videoEl) {\n  let event = null;\n  try {\n    event = new window.Event('addtrack');\n  } catch (err) {\n    // for IE11\n    event = document.createEvent('Event');\n    event.initEvent('addtrack', false, false);\n  }\n  event.track = track;\n  videoEl.dispatchEvent(event);\n}\n\nexport function clearCurrentCues (track) {\n  if (track && track.cues) {\n    while (track.cues.length > 0)\n      track.removeCue(track.cues[0]);\n  }\n}\n","/**\n *  TimeRanges to string helper\n */\n\nconst TimeRanges = {\n  toString: function (r) {\n    let log = '', len = r.length;\n    for (let i = 0; i < len; i++)\n      log += '[' + r.start(i).toFixed(3) + ',' + r.end(i).toFixed(3) + ']';\n\n    return log;\n  }\n};\n\nexport default TimeRanges;\n","/**\n * Copyright 2013 vtt.js Contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default (function () {\n  if (typeof window !== 'undefined' && window.VTTCue)\n    return window.VTTCue;\n\n  let autoKeyword = 'auto';\n  let directionSetting = {\n    '': true,\n    lr: true,\n    rl: true\n  };\n  let alignSetting = {\n    start: true,\n    middle: true,\n    end: true,\n    left: true,\n    right: true\n  };\n\n  function findDirectionSetting (value) {\n    if (typeof value !== 'string')\n      return false;\n\n    let dir = directionSetting[value.toLowerCase()];\n    return dir ? value.toLowerCase() : false;\n  }\n\n  function findAlignSetting (value) {\n    if (typeof value !== 'string')\n      return false;\n\n    let align = alignSetting[value.toLowerCase()];\n    return align ? value.toLowerCase() : false;\n  }\n\n  function extend (obj) {\n    let i = 1;\n    for (; i < arguments.length; i++) {\n      let cobj = arguments[i];\n      for (let p in cobj)\n        obj[p] = cobj[p];\n    }\n\n    return obj;\n  }\n\n  function VTTCue (startTime, endTime, text) {\n    let cue = this;\n    let isIE8 = (function () {\n      if (typeof navigator === 'undefined')\n        return;\n\n      return (/MSIE\\s8\\.0/).test(navigator.userAgent);\n    })();\n    let baseObj = {};\n\n    if (isIE8)\n      cue = document.createElement('custom');\n    else\n      baseObj.enumerable = true;\n\n    /**\n     * Shim implementation specific properties. These properties are not in\n     * the spec.\n     */\n\n    // Lets us know when the VTTCue's data has changed in such a way that we need\n    // to recompute its display state. This lets us compute its display state\n    // lazily.\n    cue.hasBeenReset = false;\n\n    /**\n     * VTTCue and TextTrackCue properties\n     * http://dev.w3.org/html5/webvtt/#vttcue-interface\n     */\n\n    let _id = '';\n    let _pauseOnExit = false;\n    let _startTime = startTime;\n    let _endTime = endTime;\n    let _text = text;\n    let _region = null;\n    let _vertical = '';\n    let _snapToLines = true;\n    let _line = 'auto';\n    let _lineAlign = 'start';\n    let _position = 50;\n    let _positionAlign = 'middle';\n    let _size = 50;\n    let _align = 'middle';\n\n    Object.defineProperty(cue, 'id', extend({}, baseObj, {\n      get: function () {\n        return _id;\n      },\n      set: function (value) {\n        _id = '' + value;\n      }\n    }));\n\n    Object.defineProperty(cue, 'pauseOnExit', extend({}, baseObj, {\n      get: function () {\n        return _pauseOnExit;\n      },\n      set: function (value) {\n        _pauseOnExit = !!value;\n      }\n    }));\n\n    Object.defineProperty(cue, 'startTime', extend({}, baseObj, {\n      get: function () {\n        return _startTime;\n      },\n      set: function (value) {\n        if (typeof value !== 'number')\n          throw new TypeError('Start time must be set to a number.');\n\n        _startTime = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'endTime', extend({}, baseObj, {\n      get: function () {\n        return _endTime;\n      },\n      set: function (value) {\n        if (typeof value !== 'number')\n          throw new TypeError('End time must be set to a number.');\n\n        _endTime = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'text', extend({}, baseObj, {\n      get: function () {\n        return _text;\n      },\n      set: function (value) {\n        _text = '' + value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'region', extend({}, baseObj, {\n      get: function () {\n        return _region;\n      },\n      set: function (value) {\n        _region = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'vertical', extend({}, baseObj, {\n      get: function () {\n        return _vertical;\n      },\n      set: function (value) {\n        let setting = findDirectionSetting(value);\n        // Have to check for false because the setting an be an empty string.\n        if (setting === false)\n          throw new SyntaxError('An invalid or illegal string was specified.');\n\n        _vertical = setting;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'snapToLines', extend({}, baseObj, {\n      get: function () {\n        return _snapToLines;\n      },\n      set: function (value) {\n        _snapToLines = !!value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'line', extend({}, baseObj, {\n      get: function () {\n        return _line;\n      },\n      set: function (value) {\n        if (typeof value !== 'number' && value !== autoKeyword)\n          throw new SyntaxError('An invalid number or illegal string was specified.');\n\n        _line = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'lineAlign', extend({}, baseObj, {\n      get: function () {\n        return _lineAlign;\n      },\n      set: function (value) {\n        let setting = findAlignSetting(value);\n        if (!setting)\n          throw new SyntaxError('An invalid or illegal string was specified.');\n\n        _lineAlign = setting;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'position', extend({}, baseObj, {\n      get: function () {\n        return _position;\n      },\n      set: function (value) {\n        if (value < 0 || value > 100)\n          throw new Error('Position must be between 0 and 100.');\n\n        _position = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'positionAlign', extend({}, baseObj, {\n      get: function () {\n        return _positionAlign;\n      },\n      set: function (value) {\n        let setting = findAlignSetting(value);\n        if (!setting)\n          throw new SyntaxError('An invalid or illegal string was specified.');\n\n        _positionAlign = setting;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'size', extend({}, baseObj, {\n      get: function () {\n        return _size;\n      },\n      set: function (value) {\n        if (value < 0 || value > 100)\n          throw new Error('Size must be between 0 and 100.');\n\n        _size = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'align', extend({}, baseObj, {\n      get: function () {\n        return _align;\n      },\n      set: function (value) {\n        let setting = findAlignSetting(value);\n        if (!setting)\n          throw new SyntaxError('An invalid or illegal string was specified.');\n\n        _align = setting;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    /**\n     * Other <track> spec defined properties\n     */\n\n    // http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#text-track-cue-display-state\n    cue.displayState = undefined;\n\n    if (isIE8)\n      return cue;\n  }\n\n  /**\n   * VTTCue methods\n   */\n\n  VTTCue.prototype.getCueAsHTML = function () {\n    // Assume WebVTT.convertCueToDOMTree is on the global.\n    let WebVTT = window.WebVTT;\n    return WebVTT.convertCueToDOMTree(window, this.text);\n  };\n\n  return VTTCue;\n})();\n","/*\n * Source: https://github.com/mozilla/vtt.js/blob/master/dist/vtt.js#L1716\n */\n\nimport VTTCue from './vttcue';\n\nconst StringDecoder = function StringDecoder () {\n  return {\n    decode: function (data) {\n      if (!data)\n        return '';\n\n      if (typeof data !== 'string')\n        throw new Error('Error - expected string data.');\n\n      return decodeURIComponent(encodeURIComponent(data));\n    }\n  };\n};\n\nfunction VTTParser () {\n  this.window = window;\n  this.state = 'INITIAL';\n  this.buffer = '';\n  this.decoder = new StringDecoder();\n  this.regionList = [];\n}\n\n// Try to parse input as a time stamp.\nfunction parseTimeStamp (input) {\n  function computeSeconds (h, m, s, f) {\n    return (h | 0) * 3600 + (m | 0) * 60 + (s | 0) + (f | 0) / 1000;\n  }\n\n  let m = input.match(/^(\\d+):(\\d{2})(:\\d{2})?\\.(\\d{3})/);\n  if (!m)\n    return null;\n\n  if (m[3]) {\n    // Timestamp takes the form of [hours]:[minutes]:[seconds].[milliseconds]\n    return computeSeconds(m[1], m[2], m[3].replace(':', ''), m[4]);\n  } else if (m[1] > 59) {\n    // Timestamp takes the form of [hours]:[minutes].[milliseconds]\n    // First position is hours as it's over 59.\n    return computeSeconds(m[1], m[2], 0, m[4]);\n  } else {\n    // Timestamp takes the form of [minutes]:[seconds].[milliseconds]\n    return computeSeconds(0, m[1], m[2], m[4]);\n  }\n}\n\n// A settings object holds key/value pairs and will ignore anything but the first\n// assignment to a specific key.\nfunction Settings () {\n  this.values = Object.create(null);\n}\n\nSettings.prototype = {\n  // Only accept the first assignment to any key.\n  set: function (k, v) {\n    if (!this.get(k) && v !== '')\n      this.values[k] = v;\n  },\n  // Return the value for a key, or a default value.\n  // If 'defaultKey' is passed then 'dflt' is assumed to be an object with\n  // a number of possible default values as properties where 'defaultKey' is\n  // the key of the property that will be chosen; otherwise it's assumed to be\n  // a single value.\n  get: function (k, dflt, defaultKey) {\n    if (defaultKey)\n      return this.has(k) ? this.values[k] : dflt[defaultKey];\n\n    return this.has(k) ? this.values[k] : dflt;\n  },\n  // Check whether we have a value for a key.\n  has: function (k) {\n    return k in this.values;\n  },\n  // Accept a setting if its one of the given alternatives.\n  alt: function (k, v, a) {\n    for (let n = 0; n < a.length; ++n) {\n      if (v === a[n]) {\n        this.set(k, v);\n        break;\n      }\n    }\n  },\n  // Accept a setting if its a valid (signed) integer.\n  integer: function (k, v) {\n    if (/^-?\\d+$/.test(v)) { // integer\n      this.set(k, parseInt(v, 10));\n    }\n  },\n  // Accept a setting if its a valid percentage.\n  percent: function (k, v) {\n    let m;\n    if ((m = v.match(/^([\\d]{1,3})(\\.[\\d]*)?%$/))) {\n      v = parseFloat(v);\n      if (v >= 0 && v <= 100) {\n        this.set(k, v);\n        return true;\n      }\n    }\n    return false;\n  }\n};\n\n// Helper function to parse input into groups separated by 'groupDelim', and\n// interprete each group as a key/value pair separated by 'keyValueDelim'.\nfunction parseOptions (input, callback, keyValueDelim, groupDelim) {\n  let groups = groupDelim ? input.split(groupDelim) : [input];\n  for (let i in groups) {\n    if (typeof groups[i] !== 'string')\n      continue;\n\n    let kv = groups[i].split(keyValueDelim);\n    if (kv.length !== 2)\n      continue;\n\n    let k = kv[0];\n    let v = kv[1];\n    callback(k, v);\n  }\n}\n\nlet defaults = new VTTCue(0, 0, 0);\n// 'middle' was changed to 'center' in the spec: https://github.com/w3c/webvtt/pull/244\n//  Safari doesn't yet support this change, but FF and Chrome do.\nlet center = defaults.align === 'middle' ? 'middle' : 'center';\n\nfunction parseCue (input, cue, regionList) {\n  // Remember the original input if we need to throw an error.\n  let oInput = input;\n  // 4.1 WebVTT timestamp\n  function consumeTimeStamp () {\n    let ts = parseTimeStamp(input);\n    if (ts === null)\n      throw new Error('Malformed timestamp: ' + oInput);\n\n    // Remove time stamp from input.\n    input = input.replace(/^[^\\sa-zA-Z-]+/, '');\n    return ts;\n  }\n\n  // 4.4.2 WebVTT cue settings\n  function consumeCueSettings (input, cue) {\n    let settings = new Settings();\n\n    parseOptions(input, function (k, v) {\n      switch (k) {\n      case 'region':\n        // Find the last region we parsed with the same region id.\n        for (let i = regionList.length - 1; i >= 0; i--) {\n          if (regionList[i].id === v) {\n            settings.set(k, regionList[i].region);\n            break;\n          }\n        }\n        break;\n      case 'vertical':\n        settings.alt(k, v, ['rl', 'lr']);\n        break;\n      case 'line':\n        var vals = v.split(','),\n          vals0 = vals[0];\n        settings.integer(k, vals0);\n        if (settings.percent(k, vals0))\n          settings.set('snapToLines', false);\n\n        settings.alt(k, vals0, ['auto']);\n        if (vals.length === 2)\n          settings.alt('lineAlign', vals[1], ['start', center, 'end']);\n\n        break;\n      case 'position':\n        vals = v.split(',');\n        settings.percent(k, vals[0]);\n        if (vals.length === 2)\n          settings.alt('positionAlign', vals[1], ['start', center, 'end', 'line-left', 'line-right', 'auto']);\n\n        break;\n      case 'size':\n        settings.percent(k, v);\n        break;\n      case 'align':\n        settings.alt(k, v, ['start', center, 'end', 'left', 'right']);\n        break;\n      }\n    }, /:/, /\\s/);\n\n    // Apply default values for any missing fields.\n    cue.region = settings.get('region', null);\n    cue.vertical = settings.get('vertical', '');\n    let line = settings.get('line', 'auto');\n    if (line === 'auto' && defaults.line === -1) {\n      // set numeric line number for Safari\n      line = -1;\n    }\n    cue.line = line;\n    cue.lineAlign = settings.get('lineAlign', 'start');\n    cue.snapToLines = settings.get('snapToLines', true);\n    cue.size = settings.get('size', 100);\n    cue.align = settings.get('align', center);\n    let position = settings.get('position', 'auto');\n    if (position === 'auto' && defaults.position === 50) {\n      // set numeric position for Safari\n      position = cue.align === 'start' || cue.align === 'left' ? 0 : cue.align === 'end' || cue.align === 'right' ? 100 : 50;\n    }\n    cue.position = position;\n  }\n\n  function skipWhitespace () {\n    input = input.replace(/^\\s+/, '');\n  }\n\n  // 4.1 WebVTT cue timings.\n  skipWhitespace();\n  cue.startTime = consumeTimeStamp(); // (1) collect cue start time\n  skipWhitespace();\n  if (input.substr(0, 3) !== '-->') { // (3) next characters must match '-->'\n    throw new Error('Malformed time stamp (time stamps must be separated by \\'-->\\'): ' +\n      oInput);\n  }\n  input = input.substr(3);\n  skipWhitespace();\n  cue.endTime = consumeTimeStamp(); // (5) collect cue end time\n\n  // 4.1 WebVTT cue settings list.\n  skipWhitespace();\n  consumeCueSettings(input, cue);\n}\n\nfunction fixLineBreaks (input) {\n  return input.replace(/<br(?: \\/)?>/gi, '\\n');\n}\n\nVTTParser.prototype = {\n  parse: function (data) {\n    let self = this;\n\n    // If there is no data then we won't decode it, but will just try to parse\n    // whatever is in buffer already. This may occur in circumstances, for\n    // example when flush() is called.\n    if (data) {\n      // Try to decode the data that we received.\n      self.buffer += self.decoder.decode(data, { stream: true });\n    }\n\n    function collectNextLine () {\n      let buffer = self.buffer;\n      let pos = 0;\n\n      buffer = fixLineBreaks(buffer);\n\n      while (pos < buffer.length && buffer[pos] !== '\\r' && buffer[pos] !== '\\n')\n        ++pos;\n\n      let line = buffer.substr(0, pos);\n      // Advance the buffer early in case we fail below.\n      if (buffer[pos] === '\\r')\n        ++pos;\n\n      if (buffer[pos] === '\\n')\n        ++pos;\n\n      self.buffer = buffer.substr(pos);\n      return line;\n    }\n\n    // 3.2 WebVTT metadata header syntax\n    function parseHeader (input) {\n      parseOptions(input, function (k, v) {\n        switch (k) {\n        case 'Region':\n          // 3.3 WebVTT region metadata header syntax\n          console.log('parse region', v);\n          // parseRegion(v);\n          break;\n        }\n      }, /:/);\n    }\n\n    // 5.1 WebVTT file parsing.\n    try {\n      let line;\n      if (self.state === 'INITIAL') {\n        // We can't start parsing until we have the first line.\n        if (!/\\r\\n|\\n/.test(self.buffer))\n          return this;\n\n        line = collectNextLine();\n        // strip of UTF-8 BOM if any\n        // https://en.wikipedia.org/wiki/Byte_order_mark#UTF-8\n        let m = line.match(/^()?WEBVTT([ \\t].*)?$/);\n        if (!m || !m[0])\n          throw new Error('Malformed WebVTT signature.');\n\n        self.state = 'HEADER';\n      }\n\n      let alreadyCollectedLine = false;\n      while (self.buffer) {\n        // We can't parse a line until we have the full line.\n        if (!/\\r\\n|\\n/.test(self.buffer))\n          return this;\n\n        if (!alreadyCollectedLine)\n          line = collectNextLine();\n        else\n          alreadyCollectedLine = false;\n\n        switch (self.state) {\n        case 'HEADER':\n          // 13-18 - Allow a header (metadata) under the WEBVTT line.\n          if (/:/.test(line)) {\n            parseHeader(line);\n          } else if (!line) {\n            // An empty line terminates the header and starts the body (cues).\n            self.state = 'ID';\n          }\n          continue;\n        case 'NOTE':\n          // Ignore NOTE blocks.\n          if (!line)\n            self.state = 'ID';\n\n          continue;\n        case 'ID':\n          // Check for the start of NOTE blocks.\n          if (/^NOTE($|[ \\t])/.test(line)) {\n            self.state = 'NOTE';\n            break;\n          }\n          // 19-29 - Allow any number of line terminators, then initialize new cue values.\n          if (!line)\n            continue;\n\n          self.cue = new VTTCue(0, 0, '');\n          self.state = 'CUE';\n          // 30-39 - Check if self line contains an optional identifier or timing data.\n          if (line.indexOf('-->') === -1) {\n            self.cue.id = line;\n            continue;\n          }\n          // Process line as start of a cue.\n          /* falls through */\n        case 'CUE':\n          // 40 - Collect cue timings and settings.\n          try {\n            parseCue(line, self.cue, self.regionList);\n          } catch (e) {\n            // In case of an error ignore rest of the cue.\n            self.cue = null;\n            self.state = 'BADCUE';\n            continue;\n          }\n          self.state = 'CUETEXT';\n          continue;\n        case 'CUETEXT':\n          var hasSubstring = line.indexOf('-->') !== -1;\n          // 34 - If we have an empty line then report the cue.\n          // 35 - If we have the special substring '-->' then report the cue,\n          // but do not collect the line as we need to process the current\n          // one as a new cue.\n          if (!line || hasSubstring && (alreadyCollectedLine = true)) {\n            // We are done parsing self cue.\n            if (self.oncue)\n              self.oncue(self.cue);\n\n            self.cue = null;\n            self.state = 'ID';\n            continue;\n          }\n          if (self.cue.text)\n            self.cue.text += '\\n';\n\n          self.cue.text += line;\n          continue;\n        case 'BADCUE': // BADCUE\n          // 54-62 - Collect and discard the remaining cue.\n          if (!line)\n            self.state = 'ID';\n\n          continue;\n        }\n      }\n    } catch (e) {\n      // If we are currently parsing a cue, report what we have.\n      if (self.state === 'CUETEXT' && self.cue && self.oncue)\n        self.oncue(self.cue);\n\n      self.cue = null;\n      // Enter BADWEBVTT state if header was not parsed correctly otherwise\n      // another exception occurred so enter BADCUE state.\n      self.state = self.state === 'INITIAL' ? 'BADWEBVTT' : 'BADCUE';\n    }\n    return this;\n  },\n  flush: function () {\n    let self = this;\n    try {\n      // Finish decoding the stream.\n      self.buffer += self.decoder.decode();\n      // Synthesize the end of the current cue or region.\n      if (self.cue || self.state === 'HEADER') {\n        self.buffer += '\\n\\n';\n        self.parse();\n      }\n      // If we've flushed, parsed, and we're still on the INITIAL state then\n      // that means we don't have enough of the stream to parse the first\n      // line.\n      if (self.state === 'INITIAL')\n        throw new Error('Malformed WebVTT signature.');\n    } catch (e) {\n      throw e;\n    }\n    if (self.onflush)\n      self.onflush();\n\n    return this;\n  }\n};\n\nexport { fixLineBreaks };\n\nexport default VTTParser;\n","import VTTParser from './vttparser';\nimport { utf8ArrayToStr } from '../demux/id3';\n\n// String.prototype.startsWith is not supported in IE11\nconst startsWith = function (inputString, searchString, position) {\n  return inputString.substr(position || 0, searchString.length) === searchString;\n};\n\nconst cueString2millis = function (timeString) {\n  let ts = parseInt(timeString.substr(-3));\n  let secs = parseInt(timeString.substr(-6, 2));\n  let mins = parseInt(timeString.substr(-9, 2));\n  let hours = timeString.length > 9 ? parseInt(timeString.substr(0, timeString.indexOf(':'))) : 0;\n\n  if (isNaN(ts) || isNaN(secs) || isNaN(mins) || isNaN(hours))\n    return -1;\n\n  ts += 1000 * secs;\n  ts += 60 * 1000 * mins;\n  ts += 60 * 60 * 1000 * hours;\n\n  return ts;\n};\n\n// From https://github.com/darkskyapp/string-hash\nconst hash = function (text) {\n  let hash = 5381;\n  let i = text.length;\n  while (i)\n    hash = (hash * 33) ^ text.charCodeAt(--i);\n\n  return (hash >>> 0).toString();\n};\n\nconst calculateOffset = function (vttCCs, cc, presentationTime) {\n  let currCC = vttCCs[cc];\n  let prevCC = vttCCs[currCC.prevCC];\n\n  // This is the first discontinuity or cues have been processed since the last discontinuity\n  // Offset = current discontinuity time\n  if (!prevCC || (!prevCC.new && currCC.new)) {\n    vttCCs.ccOffset = vttCCs.presentationOffset = currCC.start;\n    currCC.new = false;\n    return;\n  }\n\n  // There have been discontinuities since cues were last parsed.\n  // Offset = time elapsed\n  while (prevCC && prevCC.new) {\n    vttCCs.ccOffset += currCC.start - prevCC.start;\n    currCC.new = false;\n    currCC = prevCC;\n    prevCC = vttCCs[currCC.prevCC];\n  }\n\n  vttCCs.presentationOffset = presentationTime;\n};\n\nconst WebVTTParser = {\n  parse: function (vttByteArray, syncPTS, vttCCs, cc, callBack, errorCallBack) {\n    // Convert byteArray into string, replacing any somewhat exotic linefeeds with \"\\n\", then split on that character.\n    let re = /\\r\\n|\\n\\r|\\n|\\r/g;\n    // Uint8Array.prototype.reduce is not implemented in IE11\n    let vttLines = utf8ArrayToStr(new Uint8Array(vttByteArray)).trim().replace(re, '\\n').split('\\n');\n\n    let cueTime = '00:00.000';\n    let mpegTs = 0;\n    let localTime = 0;\n    let presentationTime = 0;\n    let cues = [];\n    let parsingError;\n    let inHeader = true;\n    // let VTTCue = VTTCue || window.TextTrackCue;\n\n    // Create parser object using VTTCue with TextTrackCue fallback on certain browsers.\n    let parser = new VTTParser();\n\n    parser.oncue = function (cue) {\n      // Adjust cue timing; clamp cues to start no earlier than - and drop cues that don't end after - 0 on timeline.\n      let currCC = vttCCs[cc];\n      let cueOffset = vttCCs.ccOffset;\n\n      // Update offsets for new discontinuities\n      if (currCC && currCC.new) {\n        if (localTime !== undefined) {\n          // When local time is provided, offset = discontinuity start time - local time\n          cueOffset = vttCCs.ccOffset = currCC.start;\n        } else {\n          calculateOffset(vttCCs, cc, presentationTime);\n        }\n      }\n\n      if (presentationTime) {\n        // If we have MPEGTS, offset = presentation time + discontinuity offset\n        cueOffset = presentationTime + vttCCs.ccOffset - vttCCs.presentationOffset;\n      }\n\n      cue.startTime += cueOffset - localTime;\n      cue.endTime += cueOffset - localTime;\n\n      // Create a unique hash id for a cue based on start/end times and text.\n      // This helps timeline-controller to avoid showing repeated captions.\n      cue.id = hash(cue.startTime.toString()) + hash(cue.endTime.toString()) + hash(cue.text);\n\n      // Fix encoding of special characters. TODO: Test with all sorts of weird characters.\n      cue.text = decodeURIComponent(encodeURIComponent(cue.text));\n      if (cue.endTime > 0)\n        cues.push(cue);\n    };\n\n    parser.onparsingerror = function (e) {\n      parsingError = e;\n    };\n\n    parser.onflush = function () {\n      if (parsingError && errorCallBack) {\n        errorCallBack(parsingError);\n        return;\n      }\n      callBack(cues);\n    };\n\n    // Go through contents line by line.\n    vttLines.forEach(line => {\n      if (inHeader) {\n        // Look for X-TIMESTAMP-MAP in header.\n        if (startsWith(line, 'X-TIMESTAMP-MAP=')) {\n          // Once found, no more are allowed anyway, so stop searching.\n          inHeader = false;\n          // Extract LOCAL and MPEGTS.\n          line.substr(16).split(',').forEach(timestamp => {\n            if (startsWith(timestamp, 'LOCAL:'))\n              cueTime = timestamp.substr(6);\n            else if (startsWith(timestamp, 'MPEGTS:'))\n              mpegTs = parseInt(timestamp.substr(7));\n          });\n          try {\n            // Calculate subtitle offset in milliseconds.\n            // If sync PTS is less than zero, we have a 33-bit wraparound, which is fixed by adding 2^33 = 8589934592.\n            syncPTS = syncPTS < 0 ? syncPTS + 8589934592 : syncPTS;\n            // Adjust MPEGTS by sync PTS.\n            mpegTs -= syncPTS;\n            // Convert cue time to seconds\n            localTime = cueString2millis(cueTime) / 1000;\n            // Convert MPEGTS to seconds from 90kHz.\n            presentationTime = mpegTs / 90000;\n\n            if (localTime === -1)\n              parsingError = new Error(`Malformed X-TIMESTAMP-MAP: ${line}`);\n          } catch (e) {\n            parsingError = new Error(`Malformed X-TIMESTAMP-MAP: ${line}`);\n          }\n          // Return without parsing X-TIMESTAMP-MAP line.\n          return;\n        } else if (line === '') {\n          inHeader = false;\n        }\n      }\n      // Parse line by default.\n      parser.parse(line + '\\n');\n    });\n\n    parser.flush();\n  }\n};\n\nexport default WebVTTParser;\n","/**\n * XHR based logger\n*/\n\nimport { logger } from '../utils/logger';\n\nclass XhrLoader {\n  constructor (config) {\n    if (config && config.xhrSetup)\n      this.xhrSetup = config.xhrSetup;\n  }\n\n  destroy () {\n    this.abort();\n    this.loader = null;\n  }\n\n  abort () {\n    let loader = this.loader;\n    if (loader && loader.readyState !== 4) {\n      this.stats.aborted = true;\n      loader.abort();\n    }\n\n    window.clearTimeout(this.requestTimeout);\n    this.requestTimeout = null;\n    window.clearTimeout(this.retryTimeout);\n    this.retryTimeout = null;\n  }\n\n  load (context, config, callbacks) {\n    this.context = context;\n    this.config = config;\n    this.callbacks = callbacks;\n    this.stats = { trequest: performance.now(), retry: 0 };\n    this.retryDelay = config.retryDelay;\n    this.loadInternal();\n  }\n\n  loadInternal () {\n    let xhr, context = this.context;\n    xhr = this.loader = new XMLHttpRequest();\n\n    let stats = this.stats;\n    stats.tfirst = 0;\n    stats.loaded = 0;\n    const xhrSetup = this.xhrSetup;\n\n    try {\n      if (xhrSetup) {\n        try {\n          xhrSetup(xhr, context.url);\n        } catch (e) {\n          // fix xhrSetup: (xhr, url) => {xhr.setRequestHeader(\"Content-Language\", \"test\");}\n          // not working, as xhr.setRequestHeader expects xhr.readyState === OPEN\n          xhr.open('GET', context.url, true);\n          xhrSetup(xhr, context.url);\n        }\n      }\n      if (!xhr.readyState)\n        xhr.open('GET', context.url, true);\n    } catch (e) {\n      // IE11 throws an exception on xhr.open if attempting to access an HTTP resource over HTTPS\n      this.callbacks.onError({ code: xhr.status, text: e.message }, context, xhr);\n      return;\n    }\n\n    if (context.rangeEnd)\n      xhr.setRequestHeader('Range', 'bytes=' + context.rangeStart + '-' + (context.rangeEnd - 1));\n\n    xhr.onreadystatechange = this.readystatechange.bind(this);\n    xhr.onprogress = this.loadprogress.bind(this);\n    xhr.responseType = context.responseType;\n\n    // setup timeout before we perform request\n    this.requestTimeout = window.setTimeout(this.loadtimeout.bind(this), this.config.timeout);\n    xhr.send();\n  }\n\n  readystatechange (event) {\n    let xhr = event.currentTarget,\n      readyState = xhr.readyState,\n      stats = this.stats,\n      context = this.context,\n      config = this.config;\n\n    // don't proceed if xhr has been aborted\n    if (stats.aborted)\n      return;\n\n    // >= HEADERS_RECEIVED\n    if (readyState >= 2) {\n      // clear xhr timeout and rearm it if readyState less than 4\n      window.clearTimeout(this.requestTimeout);\n      if (stats.tfirst === 0)\n        stats.tfirst = Math.max(performance.now(), stats.trequest);\n\n      if (readyState === 4) {\n        let status = xhr.status;\n        // http status between 200 to 299 are all successful\n        if (status >= 200 && status < 300) {\n          stats.tload = Math.max(stats.tfirst, performance.now());\n          let data, len;\n          if (context.responseType === 'arraybuffer') {\n            data = xhr.response;\n            len = data.byteLength;\n          } else {\n            data = xhr.responseText;\n            len = data.length;\n          }\n          stats.loaded = stats.total = len;\n          let response = { url: xhr.responseURL, data: data };\n          this.callbacks.onSuccess(response, stats, context, xhr);\n        } else {\n          // if max nb of retries reached or if http status between 400 and 499 (such error cannot be recovered, retrying is useless), return error\n          if (stats.retry >= config.maxRetry || (status >= 400 && status < 499)) {\n            logger.error(`${status} while loading ${context.url}`);\n            this.callbacks.onError({ code: status, text: xhr.statusText }, context, xhr);\n          } else {\n            // retry\n            logger.warn(`${status} while loading ${context.url}, retrying in ${this.retryDelay}...`);\n            // aborts and resets internal state\n            this.destroy();\n            // schedule retry\n            this.retryTimeout = window.setTimeout(this.loadInternal.bind(this), this.retryDelay);\n            // set exponential backoff\n            this.retryDelay = Math.min(2 * this.retryDelay, config.maxRetryDelay);\n            stats.retry++;\n          }\n        }\n      } else {\n        // readyState >= 2 AND readyState !==4 (readyState = HEADERS_RECEIVED || LOADING) rearm timeout as xhr not finished yet\n        this.requestTimeout = window.setTimeout(this.loadtimeout.bind(this), config.timeout);\n      }\n    }\n  }\n\n  loadtimeout () {\n    logger.warn(`timeout while loading ${this.context.url}`);\n    this.callbacks.onTimeout(this.stats, this.context, null);\n  }\n\n  loadprogress (event) {\n    let xhr = event.currentTarget,\n      stats = this.stats;\n\n    stats.loaded = event.loaded;\n    if (event.lengthComputable)\n      stats.total = event.total;\n\n    let onProgress = this.callbacks.onProgress;\n    if (onProgress) {\n      // third arg is to provide on progress data\n      onProgress(stats, this.context, null, xhr);\n    }\n  }\n}\n\nexport default XhrLoader;\n"],"sourceRoot":""}